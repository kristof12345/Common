!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="_content/Syncfusion.Blazor/scripts/",a(a.s="./bundles/kanban.js")}({"../node_modules/@babel/runtime/helpers/typeof.js":function(e,t){function a(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=a=function(e){return typeof e}:e.exports=a=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(t)}e.exports=a},"./bundles/kanban.js":function(e,t,a){"use strict";a.r(t);var n=a("../node_modules/@babel/runtime/helpers/typeof.js"),r=a.n(n);window.sf=window.sf||{};var s,i,o,l,d,c,p,h,u,f,m,g,y,b,v,C,w,S,E,k,O,D,A,x,M,j,T,F,P,R,q,L,H,N,_,I,B,U,K,V,W,Y,X,Q,z;sf.kanban=sf.base.extend({},sf.kanban,(s={},f="content-ready",m="data-ready",g="e-kanban-content",y="e-show-add-button",b=function(){function e(e){this.parent=e,this.keyField=this.parent.cardSettings.headerField,this.initDataManager(e.dataSource,e.query),this.refreshDataManager()}return e.prototype.initDataManager=function(e,t){this.dataManager=e instanceof sf.data.DataManager?e:new sf.data.DataManager(e),this.query=t instanceof sf.data.Query?t:new sf.data.Query,this.kanbanData=new sf.data.DataManager(this.parent.kanbanData)},e.prototype.getQuery=function(){return this.query.clone()},e.prototype.getData=function(e){return this.dataManager.executeQuery(e)},e.prototype.getTable=function(){return this.parent.query?this.getQuery().fromTable:null},e.prototype.refreshDataManager=function(){var e=this;this.getData(this.getQuery()).then((function(t){return e.dataManagerSuccess(t)})).catch((function(t){return e.dataManagerFailure(t)}))},e.prototype.dataManagerSuccess=function(e){var t=this;this.parent.isDestroyed||this.parent.trigger("dataBinding",e,(function(e){var a=sf.base.extend([],e.result,null,!0);t.kanbanData.saveChanges({addedRecords:a,changedRecords:[],deletedRecords:[]}),t.parent.kanbanData=a,t.parent.notify(m,{processedData:a}),t.parent.trigger("dataBound",null,(function(){return t.parent.hideSpinner()}))}))},e.prototype.dataManagerFailure=function(e){var t=this;this.parent.isDestroyed||this.parent.trigger("actionFailure",{error:e},(function(){return t.parent.hideSpinner()}))},e.prototype.updateDataManager=function(e,t,a,n,r){var s,i=this;this.parent.showSpinner();var o={requestType:a,cancel:!1,addedRecords:t.addedRecords,changedRecords:t.changedRecords,deletedRecords:t.deletedRecords};this.parent.trigger("actionComplete",o,(function(a){if(!a.cancel){switch(e){case"insert":s=i.dataManager.insert(n,i.getTable(),i.getQuery());break;case"update":s=i.dataManager.update(i.keyField,n,i.getTable(),i.getQuery());break;case"delete":s=i.dataManager.remove(i.keyField,n,i.getTable(),i.getQuery());break;case"batch":s=i.dataManager.saveChanges(t,i.keyField,i.getTable(),i.getQuery())}i.dataManager.dataSource.offline?(i.kanbanData=i.dataManager,i.parent.kanbanData=i.dataManager.dataSource.json,i.refreshUI(a,r)):s.then((function(e){i.parent.isDestroyed||i.refreshUI(a,r)})).catch((function(e){i.dataManagerFailure(e)}))}}))},e.prototype.refreshUI=function(e,t){var a=this;this.parent.layoutModule.columnData=this.parent.layoutModule.getColumnCards(),this.parent.swimlaneSettings.keyField&&(this.parent.layoutModule.swimlaneData=this.parent.layoutModule.getSwimlaneCards()),e.addedRecords.forEach((function(e){a.parent.layoutModule.renderCardBasedOnIndex(e)})),e.changedRecords.forEach((function(e){var n=[].slice.call(a.parent.element.querySelectorAll('.e-card[data-id="'+e[a.parent.cardSettings.headerField]+'"]')),r=[].slice.call(n[0].parentElement.children).indexOf(n[0]);a.parent.layoutModule.removeCard(e),a.parent.layoutModule.renderCardBasedOnIndex(e,r),a.parent.sortSettings.field&&"Index"===a.parent.sortSettings.sortBy&&"Descending"===a.parent.sortSettings.direction&&t>0&&--t})),e.deletedRecords.forEach((function(e){a.parent.layoutModule.removeCard(e)})),this.parent.layoutModule.refresh(),this.parent.renderTemplates(),this.parent.trigger("dataBound",null,(function(){return a.parent.hideSpinner()}))},e}(),i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},v=function(e,t){function a(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},C=function(e,t,a,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"==typeof Reflect?"undefined":r()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,a,o):s(t,a))||o);return i>3&&o&&Object.defineProperty(t,a,o),o},w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),C([sf.base.Property()],t.prototype,"keyField",void 0),C([sf.base.Property()],t.prototype,"textField",void 0),C([sf.base.Property(!1)],t.prototype,"showEmptyRow",void 0),C([sf.base.Property(!0)],t.prototype,"showItemCount",void 0),C([sf.base.Property(!1)],t.prototype,"allowDragAndDrop",void 0),C([sf.base.Property()],t.prototype,"template",void 0),C([sf.base.Property("Ascending")],t.prototype,"sortDirection",void 0),C([sf.base.Property(!0)],t.prototype,"showUnassignedRow",void 0),t}(sf.base.ChildProperty),o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},S=function(e,t){function a(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},E=function(e,t,a,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"==typeof Reflect?"undefined":r()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,a,o):s(t,a))||o);return i>3&&o&&Object.defineProperty(t,a,o),o},k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return S(t,e),E([sf.base.Property(!0)],t.prototype,"showHeader",void 0),E([sf.base.Property()],t.prototype,"headerField",void 0),E([sf.base.Property()],t.prototype,"contentField",void 0),E([sf.base.Property()],t.prototype,"tagsField",void 0),E([sf.base.Property()],t.prototype,"grabberField",void 0),E([sf.base.Property()],t.prototype,"footerCssField",void 0),E([sf.base.Property()],t.prototype,"template",void 0),E([sf.base.Property("Single")],t.prototype,"selectionType",void 0),t}(sf.base.ChildProperty),l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},O=function(e,t){function a(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},D=function(e,t,a,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"==typeof Reflect?"undefined":r()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,a,o):s(t,a))||o);return i>3&&o&&Object.defineProperty(t,a,o),o},A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return O(t,e),D([sf.base.Property()],t.prototype,"template",void 0),D([sf.base.Property([])],t.prototype,"fields",void 0),D([sf.base.Property(null)],t.prototype,"model",void 0),t}(sf.base.ChildProperty),d=function(e,t){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},x=function(e,t){function a(){this.constructor=e}d(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},M=function(e,t,a,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"==typeof Reflect?"undefined":r()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,a,o):s(t,a))||o);return i>3&&o&&Object.defineProperty(t,a,o),o},j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return x(t,e),M([sf.base.Property()],t.prototype,"keyField",void 0),M([sf.base.Property()],t.prototype,"headerText",void 0),M([sf.base.Property()],t.prototype,"template",void 0),M([sf.base.Property(!1)],t.prototype,"allowToggle",void 0),M([sf.base.Property(!0)],t.prototype,"isExpanded",void 0),M([sf.base.Property()],t.prototype,"minCount",void 0),M([sf.base.Property()],t.prototype,"maxCount",void 0),M([sf.base.Property(!0)],t.prototype,"showItemCount",void 0),M([sf.base.Property(!1)],t.prototype,"showAddButton",void 0),t}(sf.base.ChildProperty),c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},T=function(e,t){function a(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},F=function(e,t,a,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"==typeof Reflect?"undefined":r()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,a,o):s(t,a))||o);return i>3&&o&&Object.defineProperty(t,a,o),o},P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T(t,e),F([sf.base.Property()],t.prototype,"text",void 0),F([sf.base.Property()],t.prototype,"keyFields",void 0),t}(sf.base.ChildProperty),p=function(e,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},R=function(e,t){function a(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},q=function(e,t,a,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"==typeof Reflect?"undefined":r()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,a,o):s(t,a))||o);return i>3&&o&&Object.defineProperty(t,a,o),o},L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R(t,e),q([sf.base.Property("DataSourceOrder")],t.prototype,"sortBy",void 0),q([sf.base.Property()],t.prototype,"field",void 0),q([sf.base.Property("Ascending")],t.prototype,"direction",void 0),t}(sf.base.ChildProperty),H=function(){function e(e){this.parent=e,this.columnToggleArray=[],this.selectionArray=[],this.lastCardSelection=null,this.lastSelectionRow=null,this.lastCard=null,this.selectedCardsElement=[],this.selectedCardsData=[],this.hideColumnKeys=[]}return e.prototype.clickHandler=function(e){var t=sf.base.closest(e.target,".e-card,.e-header-icon,.e-content-row.e-swimlane-row,.e-show-add-button,.e-content-row:not(.e-swimlane-row) .e-content-cells");t&&(t.classList.contains("e-card")?(this.parent.allowKeyboard&&this.parent.keyboardModule.cardTabIndexRemove(),this.cardClick(e)):t.classList.contains("e-header-icon")?this.columnExpandCollapse(e):t.classList.contains("e-content-row")&&t.classList.contains("e-swimlane-row")?this.rowExpandCollapse(e):t.classList.contains(y)&&this.addButtonClick(t))},e.prototype.addButtonClick=function(e){var t=this,a={};if(0===this.parent.kanbanData.length?a[this.parent.cardSettings.headerField]=1:"number"==typeof this.parent.kanbanData[0][this.parent.cardSettings.headerField]&&(a[this.parent.cardSettings.headerField]=Math.max.apply(Math,this.parent.kanbanData.map((function(e){return parseInt(e[t.parent.cardSettings.headerField],10)})))+1),a[this.parent.keyField]=sf.base.closest(e,".e-content-cells").getAttribute("data-key"),"Index"===this.parent.sortSettings.sortBy&&(a[this.parent.sortSettings.field]=1,sf.base.closest(e,".e-content-cells").querySelector(".e-card"))){var n="Ascending"===this.parent.sortSettings.direction?e.nextElementSibling.lastElementChild:e.nextElementSibling.firstElementChild,r=this.parent.getCardDetails(n);a[this.parent.sortSettings.field]=r[this.parent.sortSettings.field]+1}0!==this.parent.kanbanData.length&&this.parent.swimlaneSettings.keyField&&sf.base.closest(e,".e-content-row").previousElementSibling&&(a[this.parent.swimlaneSettings.keyField]=sf.base.closest(e,".e-content-row").previousElementSibling.getAttribute("data-key")),this.parent.openDialog("Add",a)},e.prototype.doubleClickHandler=function(e){sf.base.closest(e.target,".e-card")&&this.cardDoubleClick(e)},e.prototype.cardClick=function(e,t){var a=this,n=sf.base.closest(t||e.target,".e-card"),r=this.parent.getCardDetails(n);if(r){this.parent.activeCardData={data:r,element:n};var s={data:r,element:n,cancel:!1,event:e};this.parent.trigger("cardClick",s,(function(t){if(!t.cancel){if(n.classList.contains("e-selection")&&"click"===e.type)sf.base.removeClass([n],"e-selection"),a.parent.layoutModule.disableAttributeSelection(n);else{var r=e.ctrlKey;a.parent.isAdaptive&&a.parent.touchModule&&(r=a.parent.touchModule.mobilePopup&&a.parent.touchModule.tabHold||r),a.cardSelection(n,r,e.shiftKey)}a.parent.isAdaptive&&a.parent.touchModule&&a.parent.touchModule.updatePopupContent();var s=sf.base.closest(n,".e-content-cells");a.parent.allowKeyboard&&([].slice.call(s.querySelectorAll(".e-card")).forEach((function(e){e.setAttribute("tabindex","0")})),a.parent.keyboardModule.addRemoveTabIndex("Remove"))}}))}},e.prototype.cardDoubleClick=function(e){var t=this,a=sf.base.closest(e.target,".e-card"),n=this.parent.getCardDetails(a);this.parent.activeCardData={data:n,element:a};var r={data:n,element:a,cancel:!1,event:e};this.parent.trigger("cardDoubleClick",r,(function(e){e.cancel||t.parent.dialogModule.openDialog("Edit",r.data)}))},e.prototype.rowExpandCollapse=function(e){var t=this,a=e instanceof HTMLElement?e:e.target,n={cancel:!1,target:a,requestType:"rowExpandCollapse"};this.parent.trigger("actionBegin",n,(function(e){if(!e.cancel){var n,r=sf.base.closest(a,".e-swimlane-row"),s=r.getAttribute("data-key"),i=t.parent.element.querySelector(".e-content-row:nth-child("+(r.rowIndex+2)+")"),o=r.querySelector(".e-swimlane-row-expand,.e-swimlane-row-collapse"),l=!!r.classList.contains("e-collapsed");l?(sf.base.removeClass([i,r],"e-collapsed"),sf.base.classList(o,["e-swimlane-row-expand"],["e-swimlane-row-collapse"]),t.parent.swimlaneToggleArray.splice(t.parent.swimlaneToggleArray.indexOf(s),1),n="0"):(sf.base.addClass([i,r],"e-collapsed"),sf.base.classList(o,["e-swimlane-row-collapse"],["e-swimlane-row-expand"]),t.parent.swimlaneToggleArray.push(s),n="-1"),o.setAttribute("aria-label",l?s+" Expand":s+" Collapse"),r.setAttribute("aria-expanded",l.toString()),i.setAttribute("aria-expanded",l.toString()),[].slice.call(i.querySelectorAll(".e-content-cells")).forEach((function(e){e.setAttribute("tabindex",n)})),t.parent.notify(f,{}),t.parent.trigger("actionComplete",{target:a,requestType:"rowExpandCollapse"})}}))},e.prototype.columnExpandCollapse=function(e){var t=this,a=e instanceof HTMLElement?e:e.target,n={cancel:!1,target:a,requestType:"columnExpandCollapse"};this.parent.trigger("actionBegin",n,(function(e){if(!e.cancel){var n=sf.base.closest(a,".e-header-cells"),r=n.cellIndex;t.columnToggle(n);var s=t.parent.element.querySelectorAll(".e-header-cells.e-collapsed").length;if(s===t.parent.columns.length-t.hideColumnKeys.length){var i=".e-header-cells:not(.e-stacked-header-cell):nth-child("+(r+1===s?1:r+2)+")",o=t.parent.element.querySelector(i);sf.base.addClass([o],"e-collapsed"),t.columnToggle(o)}t.parent.notify(f,{}),t.parent.trigger("actionComplete",{target:a,requestType:"columnExpandCollapse"})}}))},e.prototype.columnToggle=function(e){var t=this,a=e.cellIndex,n=[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")),r=".e-kanban-table col:nth-child("+(a+1)+")",s=e.querySelector(".e-column-expand,.e-column-collapse"),i=[].slice.call(this.parent.element.querySelectorAll(r));if(e.classList.contains("e-collapsed")){sf.base.removeClass(i,"e-collapsed"),this.parent.isAdaptive&&i.forEach((function(e){return e.style.width=sf.base.formatUnit(t.parent.layoutModule.getWidth())})),sf.base.classList(s,["e-column-expand"],["e-column-collapse"]);for(var o=0,l=n;o<l.length;o++){var d=l[o].querySelector(".e-content-cells:nth-child("+(a+1)+")");sf.base.removeClass([d,e],"e-collapsed"),sf.base.remove(d.querySelector(".e-collapse-header-text")),e.setAttribute("aria-expanded","true"),d.setAttribute("aria-expanded","true")}this.columnToggleArray.splice(this.columnToggleArray.indexOf(e.getAttribute("data-key")),1),this.parent.columns[a].setProperties({isExpanded:!0},!0),e.querySelector(".e-header-icon").setAttribute("aria-label",e.getAttribute("data-key")+" Expand")}else{sf.base.addClass(i,"e-collapsed"),this.parent.isAdaptive&&i.forEach((function(e){return e.style.width=sf.base.formatUnit(50)})),sf.base.classList(s,["e-column-collapse"],["e-column-expand"]);for(var c=e.getAttribute("data-key"),p=0,h=n;p<h.length;p++){var u=(d=h[p].querySelector('.e-content-cells[data-key="'+c+'"]')).cellIndex,f=(this.parent.columns[u].showItemCount?"["+d.querySelectorAll(".e-card").length+"] ":"")+this.parent.columns[u].headerText;d.appendChild(sf.base.createElement("div",{className:"e-collapse-header-text",innerHTML:f})),sf.base.addClass([d,e],"e-collapsed"),e.setAttribute("aria-expanded","false"),d.setAttribute("aria-expanded","false")}this.columnToggleArray.push(e.getAttribute("data-key")),this.parent.columns[a].setProperties({isExpanded:!1},!0),e.querySelector(".e-header-icon").setAttribute("aria-label",c+" Collapse")}},e.prototype.cardSelection=function(e,t,a){var n=this;if(e){var r=this.parent.getSelectedCards();if("None"!==this.parent.cardSettings.selectionType){var s=sf.base.closest(e,".e-content-row");if((sf.base.isNullOrUndefined(this.lastSelectionRow)?s.rowIndex:this.lastSelectionRow.rowIndex)!==s.rowIndex&&(t||a)&&"Multiple"===this.parent.cardSettings.selectionType)return;if(0===r.length||t&&"Single"!==this.parent.cardSettings.selectionType||(sf.base.removeClass(r,"e-selection"),this.parent.layoutModule.disableAttributeSelection(r),r.forEach((function(e){n.selectionArray.splice(n.selectionArray.indexOf(e.getAttribute("data-id")),1),n.selectedCardsElement.splice(n.selectedCardsElement.indexOf(e),1),n.selectedCardsData.splice(n.selectedCardsData.indexOf(n.parent.getCardDetails(e),1))}))),r.length>0&&a&&"Multiple"===this.parent.cardSettings.selectionType){var i=[],o=void 0,l=void 0,d=void 0,c=[].slice.call(s.querySelectorAll(".e-card"));c.forEach((function(e){return i.push(e.getAttribute("data-id"))}));var p=e.getAttribute("data-id"),h=this.lastCard.getAttribute("data-id"),u=l=i.indexOf(p),f=o=i.indexOf(h),m=u>f?"next":"prev";for("prev"===m&&(o=u,l=f),d=o;d<=l;d++){var g=c[d];sf.base.addClass([g],"e-selection"),g.setAttribute("aria-selected","true"),g.setAttribute("tabindex","0"),this.selectionArray.push(g.getAttribute("data-id")),this.selectedCardsElement.push(g),this.selectedCardsData.push(this.parent.getCardDetails(g)),this.lastCardSelection=g,"prev"===m&&(this.lastCardSelection=c[o])}}else if(sf.base.addClass([e],"e-selection"),e.setAttribute("aria-selected","true"),e.setAttribute("tabindex","0"),this.selectionArray.push(e.getAttribute("data-id")),this.selectedCardsElement.push(e),this.selectedCardsData.push(this.parent.getCardDetails(e)),this.lastCard=this.lastCardSelection=e,this.lastSelectionRow=sf.base.closest(e,".e-content-row"),this.lastSelectionRow.previousElementSibling){var y=this.lastSelectionRow.previousElementSibling.querySelector(".e-swimlane-row-expand,.e-swimlane-row-collapse");y&&y.classList.contains("e-swimlane-row-collapse")&&this.rowExpandCollapse(y)}}}},e.prototype.addColumn=function(e,t){this.parent.columns.splice(t,0,e),this.parent.notify(m,{processedData:this.parent.kanbanData})},e.prototype.deleteColumn=function(e){var t=this.parent.element.querySelectorAll(".e-header-cells").item(e);t&&t.classList.contains("e-toggle-header")&&this.columnToggleArray.splice(this.columnToggleArray.indexOf(t.getAttribute("data-key"),0)),this.parent.columns.splice(e,1),0===this.parent.columns.length?this.parent.destroy():this.parent.notify(m,{processedData:this.parent.kanbanData})},e.prototype.showColumn=function(e){var t=this.hideColumnKeys.indexOf(e);-1!==t&&(this.hideColumnKeys.splice(t,1),this.parent.notify(m,{processedData:this.parent.kanbanData}))},e.prototype.hideColumn=function(e){this.hideColumnKeys.push(e),this.parent.notify(m,{processedData:this.parent.kanbanData})},e}(),N=function(){function e(e){this.parent=e}return e.prototype.addCard=function(e){var t=this,a={cancel:!1,requestType:"cardCreate",addedRecords:e instanceof Array?e:[e],changedRecords:[],deletedRecords:[]};this.parent.trigger("actionBegin",a,(function(a){if(!a.cancel){var n=[];t.parent.sortSettings.field&&"Index"===t.parent.sortSettings.sortBy&&(e instanceof Array?n=e:n.push(e),n=t.priorityOrder(n,a));var r={addedRecords:e instanceof Array?e:[e],changedRecords:t.parent.sortSettings.field&&"Index"===t.parent.sortSettings.sortBy?n:[],deletedRecords:[]},s=e instanceof Array||n.length>0?"batch":"insert";t.parent.dataModule.updateDataManager(s,r,"cardCreated",e)}}))},e.prototype.updateCard=function(e,t){var a=this,n={requestType:"cardChange",cancel:!1,addedRecords:[],changedRecords:e instanceof Array?e:[e],deletedRecords:[]};this.parent.trigger("actionBegin",n,(function(n){if(!n.cancel){if(a.parent.sortSettings.field&&"Index"===a.parent.sortSettings.sortBy){var r=[];e instanceof Array?r=e:r.push(e),e=a.priorityOrder(r,n,t)}var s={addedRecords:[],changedRecords:e instanceof Array?e:[e],deletedRecords:[]},i=e instanceof Array?"batch":"update";a.parent.dataModule.updateDataManager(i,s,"cardChanged",e,t)}}))},e.prototype.deleteCard=function(e){var t=this,a={addedRecords:[],changedRecords:[],deletedRecords:[]};a.deletedRecords="string"==typeof e||"number"==typeof e?this.parent.kanbanData.filter((function(a){return a[t.parent.cardSettings.headerField]===e})):e instanceof Array?e:[e];var n={requestType:"cardRemove",cancel:!1,addedRecords:[],changedRecords:[],deletedRecords:a.deletedRecords};this.parent.trigger("actionBegin",n,(function(e){if(!e.cancel){var n=a.deletedRecords.length>1?"batch":"delete",r=a.deletedRecords;t.parent.dataModule.updateDataManager(n,a,"cardRemoved",r[0])}}))},e.prototype.priorityOrder=function(e,t,a){for(var n,r=this,s=e.map((function(e){return e[r.parent.cardSettings.headerField]})),i=e[e.length-1][this.parent.sortSettings.field],o=e.map((function(e){return e[r.parent.keyField]})),l=o.filter((function(e,t){return o.indexOf(e)===t})).sort(),d=[],c=function(t){var o=e.filter((function(e){return e[r.parent.keyField]===t}));n=p.parent.layoutModule.getColumnData(t);for(var l=0,c=o;l<c.length;l++){var h=c[l];if(p.parent.swimlaneSettings.keyField){var u=p.parent.getSwimlaneData(h[p.parent.swimlaneSettings.keyField]);n=p.parent.getColumnData(t,u)}}if(o.forEach((function(e){return d.push(e)})),!sf.base.isNullOrUndefined(a))if("Ascending"===p.parent.sortSettings.direction)for(var f=a;f<n.length;f++)-1===s.indexOf(n[f][p.parent.cardSettings.headerField])&&(n[f][p.parent.sortSettings.field]=++i,d.push(n[f]));else for(f=a-1;f>=0;f--)-1===s.indexOf(n[f][p.parent.cardSettings.headerField])&&(n[f][p.parent.sortSettings.field]=++i,d.push(n[f]))},p=this,h=0,u=l;h<u.length;h++)c(u[h]);return d},e}(),_=function(){function e(e){this.parent=e,this.dragObj={element:null,cloneElement:null,instance:null,targetClone:null,draggedClone:null,targetCloneMulti:null,selectedCards:[],pageX:0,pageY:0,navigationInterval:null,cardDetails:[],modifiedData:[]},this.dragEdges={left:!1,right:!1,top:!1,bottom:!1},this.isDragging=!1}return e.prototype.wireDragEvents=function(e){this.dragObj.instance=new sf.base.Draggable(e,{clone:!0,enableTapHold:this.parent.isAdaptive,enableTailMode:!0,cursorAt:{top:-10,left:-10},dragArea:this.parent.element.querySelector("."+g),dragStart:this.dragStart.bind(this),drag:this.drag.bind(this),dragStop:this.dragStop.bind(this),enableAutoScroll:!1,helper:this.dragHelper.bind(this)}),this.dragObj.instance.enableTapHold&&sf.base.Browser.isDevice&&sf.base.Browser.isTouch||sf.base.EventHandler.remove(e,"touchstart",this.dragObj.instance.initialize)},e.prototype.dragHelper=function(e){if(this.parent.isAdaptive&&this.parent.touchModule.mobilePopup&&this.parent.touchModule.mobilePopup.element.classList.contains("e-popup-open")&&this.parent.touchModule.mobilePopup.hide(),this.dragObj.element=sf.base.closest(e.sender.target,".e-card"),sf.base.isNullOrUndefined(this.dragObj.element))return null;this.dragObj.element.style.width=sf.base.formatUnit(this.dragObj.element.offsetWidth);var t=sf.base.createElement("div",{innerHTML:this.dragObj.element.outerHTML});return this.dragObj.cloneElement=t.children.item(0),sf.base.addClass([this.dragObj.cloneElement],"e-cloned-card"),this.dragObj.element.parentElement.appendChild(this.dragObj.cloneElement),this.dragObj.targetCloneMulti=sf.base.createElement("div",{className:"e-target-multi-clone"}),this.dragObj.targetClone=sf.base.createElement("div",{className:"e-target-dropped-clone",styles:"width:100%;height:"+sf.base.formatUnit(this.dragObj.element.offsetHeight)}),this.dragObj.modifiedData=[],this.dragObj.cloneElement},e.prototype.dragStart=function(e){var t=this;if(this.dragObj.selectedCards=this.dragObj.element,this.dragObj.element.classList.contains("e-selection")){var a=sf.base.closest(this.dragObj.element,".e-content-row");this.dragObj.selectedCards=[].slice.call(a.querySelectorAll(".e-card.e-selection:not(.e-cloned-card)")),this.dragObj.selectedCards.forEach((function(e){t.dragObj.cardDetails.push(t.parent.getCardDetails(e))}))}else this.dragObj.cardDetails=[this.parent.getCardDetails(this.dragObj.element)];var n={cancel:!1,data:this.dragObj.cardDetails,event:e,element:this.dragObj.selectedCards};this.parent.trigger("dragStart",n,(function(a){if(a.cancel)return t.removeElement(t.dragObj.cloneElement),t.dragObj.instance.intDestroy(e),t.dragObj.element=null,t.dragObj.targetClone=null,t.dragObj.draggedClone=null,t.dragObj.cloneElement=null,void(t.dragObj.targetCloneMulti=null);if(t.dragObj.element.classList.contains("e-selection")){if(t.dragObj.selectedCards.forEach((function(e){t.draggedClone(e)})),t.dragObj.selectedCards.length>1){t.dragObj.cloneElement.innerHTML="";var n=sf.base.createElement("div",{className:"e-multi-card-text",innerHTML:t.dragObj.selectedCards.length+" Cards"});t.dragObj.cloneElement.appendChild(n),sf.base.classList(t.dragObj.cloneElement,["e-multi-card-clone"],["e-selection"]),t.parent.layoutModule.disableAttributeSelection(t.dragObj.cloneElement),t.dragObj.cloneElement.style.width="90px"}}else t.draggedClone(t.dragObj.element);t.parent.notify(f,{})}))},e.prototype.draggedClone=function(e){this.dragObj.draggedClone=sf.base.createElement("div",{className:"e-target-dragged-clone",styles:"width:"+sf.base.formatUnit(e.offsetWidth-1)+";height:"+sf.base.formatUnit(e.offsetHeight)}),e.insertAdjacentElement("afterend",this.dragObj.draggedClone),sf.base.addClass([e],"e-kanban-dragged-card")},e.prototype.drag=function(e){var t=this;if(e.target){var a=sf.base.closest(e.target,".e-card")||e.target,n=sf.base.closest(a,".e-content-row:not(.e-swimlane-row) .e-content-cells");if(this.calculateArgs(e),n){var r=this.getColumnKey(n),s=r.split(",");this.multiCloneRemove();var i=r===this.getColumnKey(sf.base.closest(this.dragObj.draggedClone,".e-content-cells"));if(1===s.length||i)if(a.classList.contains("e-target-dragged-clone")&&this.removeElement(this.dragObj.targetClone),a.classList.contains("e-card")){var o=a.classList.contains("e-target-dragged-clone")&&a.previousElementSibling.classList.contains("e-kanban-dragged-card")?null:a.previousElementSibling,l="afterend";if(sf.base.isNullOrUndefined(o)){var d=a.classList.contains("e-target-dragged-clone")?this.dragObj.pageY/2:this.dragObj.pageY,c=a.classList.contains("e-target-dragged-clone")?a.offsetHeight:a.offsetHeight/2;d-(this.parent.element.getBoundingClientRect().top+a.offsetTop)<c&&(l="beforebegin")}a.insertAdjacentElement(l,this.dragObj.targetClone)}else if(a.classList.contains("e-content-cells")&&!sf.base.closest(a,".e-swimlane-row")){if(0!==a.querySelectorAll(".e-kanban-dragged-card").length&&0===a.querySelectorAll(".e-card:not(.e-kanban-dragged-card):not(.e-cloned-card)").length)return;a.querySelector(".e-card-wrapper").appendChild(this.dragObj.targetClone)}else a.classList.contains("e-card-wrapper")&&!sf.base.closest(a,".e-swimlane-row")&&0===n.querySelectorAll(".e-card").length&&a.appendChild(this.dragObj.targetClone);else s.length>1&&this.multiCloneCreate(s,n);this.parent.notify(f,{})}this.addDropping();var p=!1;n&&(p=n.classList.contains("e-collapsed")&&n.classList.contains("e-dropping")),p&&(this.toggleVisible(a,void 0),sf.base.addClass([n],"e-toggle-visible"));var h=[].slice.call(this.parent.element.querySelectorAll(".e-toggle-visible"));h.length>0&&!a.classList.contains("e-toggle-visible")&&!sf.base.closest(a,".e-toggle-visible")&&(this.toggleVisible(a,h.slice(-1)[0]),sf.base.removeClass(h,"e-toggle-visible")),this.parent.notify(f,{});var u=sf.base.closest(a,".e-column-key");if(u){var m=[].slice.call(this.parent.element.querySelectorAll(".e-column-key")).filter((function(e){return t.getColumnKey(e)===t.getColumnKey(u)}));m.length>0&&(sf.base.addClass(m,"e-multi-active"),m[0].previousElementSibling&&sf.base.addClass([m[0].previousElementSibling],"e-multi-bottom-border"))}if(document.body.style.cursor=n?"":"not-allowed",this.parent.swimlaneSettings.keyField&&!this.parent.swimlaneSettings.allowDragAndDrop){var g=sf.base.closest(this.dragObj.element,".e-content-row"),y=sf.base.closest(a,".e-content-row:not(.e-swimlane-row)");g&&y&&g.rowIndex!==y.rowIndex&&(document.body.style.cursor="not-allowed")}"not-allowed"===document.body.style.cursor&&(this.removeElement(this.dragObj.targetClone),this.multiCloneRemove()),this.updateScrollPosition(e);var b={data:this.dragObj.cardDetails,event:e,element:this.dragObj.selectedCards};this.parent.trigger("drag",b)}},e.prototype.removeElement=function(e){this.parent.element.getElementsByClassName(e.className).length>0&&sf.base.remove(e)},e.prototype.multiCloneCreate=function(e,t){var a=t.offsetHeight,n=t.querySelector(".e-limits");n&&(a-=n.offsetHeight),this.dragObj.targetCloneMulti.style.height=sf.base.formatUnit(a),t.querySelector("."+y)&&sf.base.addClass([t.querySelector("."+y)],"e-multi-card-wrapper"),sf.base.addClass([t.querySelector(".e-card-wrapper")],"e-multi-card-wrapper"),t.querySelector(".e-card-wrapper").style.height="auto",t.style.borderStyle="none",this.removeElement(this.dragObj.targetClone);for(var r=0,s=e;r<s.length;r++){var i=s[r],o=sf.base.createElement("div",{className:"e-column-key",attrs:{"data-key":i.trim()}}),l=sf.base.createElement("div",{className:"e-text",innerHTML:i.trim()});t.appendChild(this.dragObj.targetCloneMulti).appendChild(o).appendChild(l),o.style.lineHeight=o.style.height=sf.base.formatUnit(a/e.length),l.style.top=sf.base.formatUnit(a/2-l.offsetHeight/2)}},e.prototype.addDropping=function(){if(this.parent.swimlaneSettings.keyField&&this.parent.swimlaneSettings.allowDragAndDrop)[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row):not(.e-collapsed) .e-content-cells")).forEach((function(e){return sf.base.addClass([e],"e-dropping")}));else{var e=sf.base.closest(this.dragObj.draggedClone,".e-content-row");e&&[].slice.call(e.children).forEach((function(e){return sf.base.addClass([e],"e-dropping")}))}var t=sf.base.closest(this.dragObj.draggedClone,".e-content-cells");t&&sf.base.removeClass([t],"e-dropping")},e.prototype.dragStop=function(e){var t,a,n,r=this,s=sf.base.closest(this.dragObj.targetClone,".e-content-cells");if(this.dragObj.targetClone.parentElement){var i=[].slice.call(this.dragObj.targetClone.parentElement.querySelectorAll(".e-card:not(.e-kanban-dragged-card),.e-target-dropped-clone"));a=i.indexOf(this.dragObj.targetClone)}this.parent.element.querySelector(".e-target-multi-clone")&&(t=sf.base.closest(e.target,".e-column-key")),(s||t)&&(s?n=this.getColumnKey(s):(n=this.getColumnKey(t),s=sf.base.closest(t,".e-content-cells")),this.dragObj.selectedCards instanceof HTMLElement?this.updateDroppedData(this.dragObj.selectedCards,n,s):this.dragObj.selectedCards.forEach((function(e){r.updateDroppedData(e,n,s)})),this.parent.sortSettings.field&&"Index"===this.parent.sortSettings.sortBy&&this.changeOrder(this.dragObj.modifiedData));var o={cancel:!1,data:this.dragObj.modifiedData,event:e,element:this.dragObj.selectedCards};this.parent.trigger("dragStop",o,(function(e){if(r.removeElement(r.dragObj.draggedClone),r.removeElement(r.dragObj.targetClone),r.removeElement(r.dragObj.cloneElement),[].slice.call(r.parent.element.querySelectorAll(".e-target-dragged-clone")).forEach((function(e){sf.base.remove(e)})),r.dragObj.element.style.removeProperty("width"),r.multiCloneRemove(),sf.base.removeClass([r.dragObj.element],"e-kanban-dragged-card"),clearInterval(r.dragObj.navigationInterval),r.dragObj.navigationInterval=null,"not-allowed"===document.body.style.cursor&&(document.body.style.cursor=""),[].slice.call(r.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row) .e-content-cells")).forEach((function(e){return sf.base.removeClass([e],"e-dropping")})),!e.cancel&&(s||t)){var n=e.data instanceof Array&&e.data.length>1?e.data:e.data[0];r.parent.crudModule.updateCard(n,a)}r.parent.isAdaptive&&(r.parent.touchModule.tabHold=!1),r.dragObj.cardDetails=r.dragObj.modifiedData=[],r.isDragging=!1}))},e.prototype.updateDroppedData=function(e,t,a){var n=this.parent.getCardDetails(e),r=sf.base.extend({},n,null,!0);if(1===t.split(",").length&&(r[this.parent.keyField]=t),this.parent.swimlaneSettings.keyField&&this.parent.swimlaneSettings.allowDragAndDrop){var s=sf.base.closest(a,".e-content-row").previousElementSibling;if(this.parent.isAdaptive){var i=this.parent.layoutModule.kanbanRows[this.parent.layoutModule.swimlaneIndex].keyField;r[this.parent.swimlaneSettings.keyField]=i}else r[this.parent.swimlaneSettings.keyField]=this.getColumnKey(s)}this.dragObj.modifiedData.push(r)},e.prototype.changeOrder=function(e){var t=this,a=!1,n="Ascending"===this.parent.sortSettings.direction?this.dragObj.targetClone.previousElementSibling:this.dragObj.targetClone.nextElementSibling;if(!n||n.classList.contains("e-kanban-dragged-card")||n.classList.contains("e-cloned-card")||n.classList.contains("e-target-dragged-clone"))if(this.dragObj.targetClone.nextElementSibling&&"Ascending"===this.parent.sortSettings.direction)n=this.dragObj.targetClone.nextElementSibling;else{if(!this.dragObj.targetClone.previousElementSibling||"Descending"!==this.parent.sortSettings.direction)return;n=this.dragObj.targetClone.previousElementSibling}else a=!0;var r=this.parent.getCardDetails(n)[this.parent.sortSettings.field];e.length>1&&"Descending"===this.parent.sortSettings.direction&&(e=e.reverse()),e.forEach((function(e,n){a?e[t.parent.sortSettings.field]=++r:1!==r&&n<=e[t.parent.sortSettings.field]?e[t.parent.sortSettings.field]=--r:1===r&&(e[t.parent.sortSettings.field]=n+1)}))},e.prototype.toggleVisible=function(e,t){var a=this;[].slice.call(this.parent.element.querySelectorAll(".e-header-cells:not(.e-stacked-header-cell)")).forEach((function(n){a.getColumnKey(n)===a.getColumnKey(t||e)&&a.parent.actionModule.columnToggle(n)}));var n=sf.base.closest(this.dragObj.draggedClone,".e-content-cells");if(n){var r=sf.base.formatUnit(n.offsetWidth-16);this.dragObj.draggedClone.style.width=r,this.dragObj.cloneElement.style.width=r}},e.prototype.multiCloneRemove=function(){var e=[].slice.call(this.parent.element.querySelectorAll(".e-target-multi-clone"));e.length>0&&([].slice.call(this.parent.element.querySelectorAll(".e-column-key")).forEach((function(e){return sf.base.remove(e)})),e.forEach((function(e){var t=sf.base.closest(e,".e-content-cells");t&&(t.style.borderStyle="",t.querySelector("."+y)&&sf.base.removeClass([t.querySelector("."+y)],"e-multi-card-wrapper"),sf.base.removeClass([t.querySelector(".e-card-wrapper")],"e-multi-card-wrapper"))})),this.removeElement(this.dragObj.targetCloneMulti))},e.prototype.calculateArgs=function(e){var t=this.getPageCoordinates(e);this.dragObj.pageY=t.pageY,this.dragObj.pageX=t.pageX,this.isDragging=!0,this.parent.isAdaptive&&this.parent.tooltipModule&&this.parent.tooltipModule.tooltipObj.close()},e.prototype.getPageCoordinates=function(e){var t=e.event;return t&&t.changedTouches?t.changedTouches[0]:e.changedTouches?e.changedTouches[0]:t||e},e.prototype.getColumnKey=function(e){return e&&e.getAttribute("data-key")?e.getAttribute("data-key").trim():""},e.prototype.updateScrollPosition=function(e){var t=this;sf.base.isNullOrUndefined(this.dragObj.navigationInterval)&&(this.dragObj.navigationInterval=window.setInterval((function(){t.autoScrollValidation(e)&&t.autoScroll()}),100))},e.prototype.autoScrollValidation=function(e){var t=this.dragObj.pageY,a=this.dragObj.pageX,n={left:!1,right:!1,top:!1,bottom:!1};return this.dragObj.pageY-window.scrollY<66&&(n.top=!0),t>window.innerHeight-30+window.pageYOffset&&t<window.innerHeight+window.pageYOffset&&(n.bottom=!0),a<30+window.pageXOffset&&a>0+window.pageXOffset&&(n.left=!0),a>window.innerWidth-30+window.pageXOffset&&a<window.innerWidth+window.pageXOffset&&(n.right=!0),this.dragEdges=n,n.bottom||n.top||n.left||n.right},e.prototype.autoScroll=function(){var e;if(this.parent.isAdaptive){if(this.dragEdges.top||this.dragEdges.bottom?e=this.dragObj.targetClone?sf.base.closest(this.dragObj.targetClone,".e-card-wrapper"):sf.base.closest(this.dragObj.draggedClone,".e-card-wrapper"):(this.dragEdges.right||this.dragEdges.left)&&(e=this.parent.element.querySelector("."+g)),e){var t=e.offsetHeight<=e.scrollHeight,a=e.offsetWidth<=e.scrollWidth,n=e.scrollTop>=0&&e.scrollTop+e.offsetHeight<=e.scrollHeight,r=e.scrollLeft>=0&&e.scrollLeft+e.offsetWidth<=e.scrollWidth;t&&n&&(this.dragEdges.top||this.dragEdges.bottom)&&(e.scrollTop+=this.dragEdges.top?-66:30),a&&r&&(this.dragEdges.left||this.dragEdges.right)&&(this.parent.layoutModule.getWidth()*(this.parent.columns.length-1)>e.scrollLeft||this.dragEdges.left)&&(e.scrollLeft+=this.dragEdges.left?-30:30)}}else this.dragObj.pageY-window.scrollY<30?window.scrollTo(window.scrollX,window.scrollY-30):window.innerHeight-(this.dragObj.pageY-window.scrollY)<30&&window.scrollTo(window.scrollX,window.scrollY+30)},e.prototype.unWireDragEvents=function(e){var t=e.ej2_instances[0];t&&!t.isDestroyed&&t.destroy()},e}(),I=function(){function e(e){this.parent=e}return e.prototype.openDialog=function(e,t){this.action=e,this.parent.activeCardData.data=t,this.renderDialog(t,e),this.dialogObj.show()},e.prototype.closeDialog=function(){this.dialogObj.hide()},e.prototype.renderDialog=function(e,t){this.element=sf.base.createElement("div",{id:this.parent.element.id+"_dialog_wrapper"}),this.parent.element.appendChild(this.element);var a={buttons:this.getDialogButtons(t),content:this.getDialogContent(e,t),cssClass:"e-kanban-dialog",enableRtl:this.parent.enableRtl,header:this.parent.localeObj.getConstant("Add"===t?"addTitle":"Edit"===t?"editTitle":"deleteTitle"),height:"auto",isModal:!0,showCloseIcon:!0,width:"Delete"===t?400:350,visible:!1,beforeOpen:this.onBeforeDialogOpen.bind(this),beforeClose:this.onBeforeDialogClose.bind(this)};this.dialogObj=new sf.popups.Dialog(sf.base.extend(a,"Delete"!==t&&this.parent.dialogSettings.model||{}),this.element),"Delete"!==t&&this.applyFormValidation(),this.dialogObj.element.querySelector(".e-dlg-closeicon-btn").title=this.parent.localeObj.getConstant("close")},e.prototype.getDialogContent=function(e,t){if("Delete"===t)return this.parent.localeObj.getConstant("deleteContent");var a=sf.base.createElement("div",{className:"e-kanban-form-wrapper"}),n=sf.base.createElement("form",{id:this.parent.element.id+"EditForm",className:"e-kanban-form",attrs:{onsubmit:"return false;"}});if(this.parent.dialogSettings.template){e&&(this.destroyComponents(),[].slice.call(n.childNodes).forEach((function(e){return sf.base.remove(e)})));var r=this.parent.element.id+"_dialogTemplate",s=this.parent.templateParser(this.parent.dialogSettings.template)(e,this.parent,"template",r,!1);sf.base.append(s,n),this.parent.renderTemplates()}else{var i=sf.base.createElement("div",{className:"e-kanban-dialog-content"});n.appendChild(i);var o=sf.base.createElement("table");i.appendChild(o);for(var l=0,d=this.getDialogFields();l<d.length;l++){var c=d[l],p=sf.base.createElement("tr");o.appendChild(p),p.appendChild(sf.base.createElement("td",{className:"e-label",innerHTML:c.text?c.text:c.key}));var h=sf.base.createElement("td");p.appendChild(h),h.appendChild(this.renderComponents(c))}}return a.appendChild(n),a},e.prototype.getDialogFields=function(){var e=this.parent.dialogSettings.fields;return 0===e.length&&(e=[{text:"ID",key:this.parent.cardSettings.headerField,type:"TextBox"},{key:this.parent.keyField,type:"DropDown"},{key:this.parent.cardSettings.contentField,type:"TextArea"}],"DataSourceOrder"!==this.parent.sortSettings.sortBy&&e.splice(e.length-1,0,{key:this.parent.sortSettings.field,type:"TextBox"}),this.parent.swimlaneSettings.keyField&&e.splice(e.length-1,0,{key:this.parent.swimlaneSettings.keyField,type:"DropDown"})),e},e.prototype.getDialogButtons=function(e){var t="Delete"===e?"e-dialog-no":"e-dialog-cancel",a=[{buttonModel:{cssClass:"e-flat "+("Delete"===e?"e-dialog-yes":"Add"===e?"e-dialog-add":"e-dialog-edit"),isPrimary:!0,content:this.parent.localeObj.getConstant("Add"===e||"Edit"===e?"save":"yes")},click:this.dialogButtonClick.bind(this)},{buttonModel:{cssClass:"e-flat "+t,isPrimary:!1,content:this.parent.localeObj.getConstant("Add"===e||"Edit"===e?"cancel":"no")},click:this.dialogButtonClick.bind(this)}];if("Edit"===e){var n={buttonModel:{cssClass:"e-flat e-dialog-delete",isPrimary:!1,content:this.parent.localeObj.getConstant("delete")},click:this.dialogButtonClick.bind(this)};a.splice(0,0,n)}return a},e.prototype.renderComponents=function(e){var t,a=sf.base.createElement("div",{className:e.key+"_wrapper"}),n=sf.base.createElement("input",{className:"e-field",attrs:{name:e.key}});a.appendChild(n);var r=this.parent.activeCardData.data?this.parent.activeCardData.data[e.key]:null;switch(e.type){case"DropDown":var s=void 0;e.key===this.parent.keyField?s={dataSource:this.parent.layoutModule.columnKeys,value:r}:e.key===this.parent.swimlaneSettings.keyField&&(s={dataSource:[].slice.call(this.parent.layoutModule.kanbanRows),fields:{text:"textField",value:"keyField"},value:r}),t=new sf.dropdowns.DropDownList(s);break;case"Numeric":t=new sf.inputs.NumericTextBox({value:r});break;case"TextBox":t=new sf.inputs.TextBox({value:r}),r&&this.parent.cardSettings.headerField===e.key&&(t.enabled=!1);break;case"TextArea":sf.base.remove(n);var i=sf.base.createElement("div");n=sf.base.createElement("textarea",{className:"e-field",attrs:{name:e.key,rows:"3"},innerHTML:r}),a.appendChild(i).appendChild(n)}return t&&t.appendTo(n),a},e.prototype.onBeforeDialogOpen=function(e){var t={data:this.parent.activeCardData.data,cancel:!1,element:this.element,target:this.parent.activeCardData.element,requestType:this.action};this.storeElement=document.activeElement,parseInt(e.maxHeight,10)<=250&&(e.maxHeight="250px"),this.parent.trigger("dialogOpen",t,(function(t){return e.cancel=t.cancel}))},e.prototype.onBeforeDialogClose=function(e){for(var t=this,a={},n=0,r=this.getFormElements();n<r.length;n++){var s=r[n],i=s.name||this.getColumnName(s);if(!sf.base.isNullOrUndefined(i)&&""!==i){var o=this.getValueFromElement(s);i===this.parent.cardSettings.headerField&&(o="string"===this.getIDType()?o:parseInt(o,10)),a[i]=o}}var l={data:a=sf.base.extend(this.parent.activeCardData.data,a),cancel:!1,element:this.element,requestType:this.action};this.parent.trigger("dialogClose",l,(function(a){e.cancel=a.cancel,a.cancel||(t.cardData=l.data,t.destroy())}))},e.prototype.getIDType=function(){return 0!==this.parent.kanbanData.length?r()(this.parent.kanbanData[0][this.parent.cardSettings.headerField]):"string"},e.prototype.applyFormValidation=function(){for(var e=this,t=this.element.querySelector(".e-kanban-form"),a={},n=0,r=this.parent.dialogSettings.fields;n<r.length;n++){var s=r[n];a[s.key]=s.validationRules&&Object.keys(s.validationRules).length>0?s.validationRules:null}this.formObj=new sf.inputs.FormValidator(t,{rules:a,customPlacement:function(t,a){var n=a.getAttribute("for");e.element.querySelector("#"+n+"_Error")||e.createTooltip(t,a,n,"")},validationComplete:function(t){var a=e.element.querySelector("#"+t.inputName+"_Error");a&&(a.style.display="failure"===t.status?"":"none")}})},e.prototype.createTooltip=function(e,t,a,n){var r,s,i=e.parentElement.getBoundingClientRect();this.element.classList.contains("e-kanban-dialog")?(r=this.element,s=this.element.getBoundingClientRect()):s=(r=this.element.querySelector(".e-kanban-dialog .e-dlg-content")).getBoundingClientRect();var o=sf.base.createElement("div",{className:"e-tooltip-wrap e-popup e-kanban-error",id:a+"_Error",styles:"display:"+n+";top:"+(i.bottom-s.top+r.scrollTop+9)+"px;left:"+(i.left-s.left+r.scrollLeft+i.width/2)+"px;"}),l=sf.base.createElement("div",{className:"e-tip-content"});l.appendChild(t);var d=sf.base.createElement("div",{className:"e-arrow-tip e-tip-top"});d.appendChild(sf.base.createElement("div",{className:"e-arrow-tip-outer e-tip-top"})),d.appendChild(sf.base.createElement("div",{className:"e-arrow-tip-inner e-tip-top"})),o.appendChild(l),o.appendChild(d),r.appendChild(o),o.style.left=parseInt(o.style.left,10)-o.offsetWidth/2+"px"},e.prototype.destroyToolTip=function(){this.element&&this.element.querySelectorAll(".e-kanban-error").forEach((function(e){return sf.base.remove(e)})),this.formObj&&this.formObj.element&&this.formObj.reset()},e.prototype.dialogButtonClick=function(e){var t=e.target.cloneNode(!0),a=this.formObj.element.id;if(document.getElementById(a)&&this.formObj.validate()&&(t.classList.contains("e-dialog-edit")||t.classList.contains("e-dialog-add"))){if(this.dialogObj.hide(),t.classList.contains("e-dialog-edit")){var n=this.parent.activeCardData,r=void 0;n.data[this.parent.keyField]===this.cardData[this.parent.keyField]&&n.element&&(r=[].slice.call(n.element.parentElement.children).indexOf(n.element)),this.parent.crudModule.updateCard(this.cardData,r)}t.classList.contains("e-dialog-add")&&this.parent.crudModule.addCard(this.cardData),this.cardData=null}t.classList.contains("e-dialog-edit")||t.classList.contains("e-dialog-add")||(this.dialogObj.hide(),t.classList.contains("e-dialog-yes")?this.parent.crudModule.deleteCard(this.parent.activeCardData.data):t.classList.contains("e-dialog-no")?this.openDialog("Edit",this.parent.activeCardData.data):t.classList.contains("e-dialog-delete")&&this.openDialog("Delete",this.parent.activeCardData.data))},e.prototype.getFormElements=function(){for(var e=[],t=0,a=[].slice.call(this.element.querySelectorAll(".e-field"));t<a.length;t++){var n=a[t];n.classList.contains("e-control")?e.push(n):n.querySelector(".e-control")?e.push(n.querySelector(".e-control")):e.push(n)}return e},e.prototype.getColumnName=function(e){var t=e.getAttribute("data-name")||"";if(""===t){var a=!1,n="";e.classList.contains("e-dropdownlist")||e.classList.contains("e-multiselect")?(n=e.classList.contains("e-dropdownlist")?"e-ddl":"e-multiselect",a=!0):e.classList.contains("e-numerictextbox")&&(n="e-numeric");var r=a?"."+n+":not(.e-control)":"."+n,s=sf.base.closest(e,r)||e.querySelector("."+n);if(s){var i=s.querySelector("[name]");i&&(t=i.name)}}return t},e.prototype.getValueFromElement=function(e){var t=e.ej2_instances;return t&&t.length>0?t[0].value||t[0].checked:e.value},e.prototype.destroyComponents=function(){for(var e=0,t=this.getFormElements();e<t.length;e++){var a=t[e].ej2_instances;a&&a.length>0&&a.forEach((function(e){return e.destroy()}))}},e.prototype.destroy=function(){this.destroyToolTip(),this.destroyComponents(),this.dialogObj&&(this.dialogObj.destroy(),this.storeElement.focus(),this.dialogObj=null,sf.base.remove(this.element),this.element=null)},e}(),B=function(){function e(e){this.keyConfigs={firstCardSelection:"36",lastCardSelection:"35",upArrow:"38",downArrow:"40",rightArrow:"39",leftArrow:"37",multiSelectionEnter:"ctrl+13",multiSelectionSpace:"ctrl+32",multiSelectionByUpArrow:"shift+38",multiSelectionByDownArrow:"shift+40",shiftTab:"shift+tab",enter:"13",tab:"tab",delete:"46",escape:"27",space:"32"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.keyboardModule=new sf.base.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.multiSelection=!1}return e.prototype.keyActionHandler=function(e){var t=this,a=this.parent.element.querySelectorAll(".e-card.e-selection").item(0);if(a||sf.base.closest(document.activeElement,".e-kanban"))switch(e.action){case"upArrow":case"downArrow":case"multiSelectionByUpArrow":case"multiSelectionByDownArrow":this.processUpDownArrow(e.action,a);break;case"rightArrow":case"leftArrow":this.processLeftRightArrow(e);break;case"firstCardSelection":case"lastCardSelection":this.processCardSelection(e.action,a);break;case"multiSelectionEnter":case"multiSelectionSpace":document.activeElement&&this.parent.actionModule.cardSelection(document.activeElement,!0,!1);break;case"space":case"enter":this.processEnter(e,a);break;case"escape":if(document.activeElement.classList.contains("e-card")||document.activeElement.classList.contains(y))if(document.activeElement.classList.contains("e-selection"))sf.base.removeClass([document.activeElement],"e-selection"),document.activeElement.focus();else{var n=sf.base.closest(document.activeElement,".e-content-cells"),r=[].slice.call(n.querySelectorAll(".e-card"));sf.base.removeClass(r,"e-selection"),n.focus(),this.cardTabIndexRemove(),this.addRemoveTabIndex("Add")}break;case"tab":case"shiftTab":var s=sf.base.closest(document.activeElement,".e-content-cells");document.activeElement.classList.contains("e-card")&&(document.activeElement.nextElementSibling||"tab"!==e.action||e.preventDefault(),!document.activeElement.previousElementSibling&&s.querySelector("."+y)&&"tab"===e.action&&sf.base.addClass([s.querySelector("."+y)],"e-show-add-focus")),document.activeElement.classList.contains(y)&&(!s.querySelector(".e-card")&&"tab"===e.action||"shiftTab"===e.action)&&e.preventDefault(),document.activeElement.classList.contains("e-kanban")&&(this.cardTabIndexRemove(),this.parent.keyboardModule.addRemoveTabIndex("Add"));break;case"delete":var i=[].slice.call(this.parent.element.querySelectorAll(".e-card.e-selection")),o=[];i.forEach((function(e){o.push(t.parent.getCardDetails(e))})),this.parent.crudModule.deleteCard(o)}},e.prototype.processCardSelection=function(e,t){if(t){sf.base.removeClass([t],"e-selection"),this.parent.layoutModule.disableAttributeSelection(t);var a=this.parent.actionModule.selectionArray;a.splice(a.indexOf(t.getAttribute("data-id")),1)}this.cardTabIndexRemove();var n=[].slice.call(this.parent.element.querySelectorAll(".e-card")),r="firstCardSelection"===e?n[0]:n[n.length-1];this.parent.actionModule.cardSelection(r,!1,!1),this.addRemoveTabIndex("Remove"),r.focus(),[].slice.call(sf.base.closest(r,".e-content-cells").querySelectorAll(".e-card")).forEach((function(e){e.setAttribute("tabindex","0")}))},e.prototype.processLeftRightArrow=function(e){document.activeElement.classList.contains("e-content-cells")&&("rightArrow"===e.action&&document.activeElement.nextElementSibling?document.activeElement.nextElementSibling.focus():"leftArrow"===e.action&&document.activeElement.previousElementSibling&&document.activeElement.previousElementSibling.focus())},e.prototype.processUpDownArrow=function(e,t){if("upArrow"===e&&document.activeElement){if(document.activeElement.classList.contains("e-card")&&document.activeElement.previousElementSibling)document.activeElement.previousElementSibling.focus();else if(document.activeElement.classList.contains(y)){document.activeElement.setAttribute("tabindex","-1"),sf.base.removeClass([document.activeElement],"e-show-add-focus");var a=sf.base.closest(document.activeElement,".e-content-cells");a.querySelectorAll(".e-card").length>0&&[].slice.call(a.querySelectorAll(".e-card")).slice(-1)[0].focus()}this.removeSelection()}else if("downArrow"===e&&document.activeElement&&document.activeElement.classList.contains("e-card")){if(document.activeElement.nextElementSibling)document.activeElement.nextElementSibling.focus();else if(sf.base.closest(document.activeElement,".e-card-wrapper").nextElementSibling){var n=sf.base.closest(document.activeElement,".e-card-wrapper").nextElementSibling;n.setAttribute("tabindex","0"),sf.base.addClass([n],"e-show-add-focus"),n.focus()}this.removeSelection()}if(("multiSelectionByUpArrow"===e||"multiSelectionByDownArrow"===e)&&t&&"Multiple"===this.parent.cardSettings.selectionType){var r=void 0;(r="multiSelectionByUpArrow"===e?document.activeElement.previousElementSibling:document.activeElement.nextElementSibling)&&(this.parent.actionModule.cardSelection(r,!1,!0),r.focus(),this.multiSelection=!0)}},e.prototype.removeSelection=function(){if(this.multiSelection){var e=this.parent.getSelectedCards();e.length>0&&(sf.base.removeClass(e,"e-selection"),this.parent.layoutModule.disableAttributeSelection(e)),this.multiSelection=!1}},e.prototype.cardTabIndexRemove=function(){[].slice.call(this.parent.element.querySelectorAll(".e-card")).forEach((function(e){e.setAttribute("tabindex","-1")})),[].slice.call(this.parent.element.querySelectorAll("."+y)).forEach((function(e){e.setAttribute("tabindex","-1"),sf.base.removeClass([e],"e-show-add-focus")}))},e.prototype.processEnter=function(e,t){var a=e.target;if(a.classList.contains("e-header-icon")&&this.parent.actionModule.columnExpandCollapse(e),(a.classList.contains("e-swimlane-row-expand")||a.classList.contains("e-swimlane-row-collapse"))&&this.parent.actionModule.rowExpandCollapse(e),document.activeElement.classList.contains("e-card")&&this.parent.actionModule.cardSelection(document.activeElement,!1,!1),document.activeElement.classList.contains(y)&&(this.parent.dialogModule.dialogObj||this.parent.actionModule.addButtonClick(document.activeElement),document.activeElement.focus()),a.classList.contains("e-content-cells")){var n=[].slice.call(a.querySelectorAll(".e-card"));this.addRemoveTabIndex("Remove"),n.length>0&&(a.querySelector(".e-card").focus(),n.forEach((function(e){e.setAttribute("tabindex","0")}))),a.querySelector("."+y)&&(a.querySelector("."+y).setAttribute("tabindex","0"),a.querySelector("."+y).focus())}t===document.activeElement&&1===this.parent.element.querySelectorAll(".e-selection").length&&(this.parent.activeCardData={data:this.parent.getCardDetails(t),element:t},this.parent.dialogModule.dialogObj||this.parent.dialogModule.openDialog("Edit",this.parent.getCardDetails(t)),t.focus())},e.prototype.addRemoveTabIndex=function(e){var t="Add"===e?"0":"-1",a=[].slice.call(this.parent.element.querySelectorAll(".e-header-icon"));a.length>0&&a.forEach((function(e){e.setAttribute("tabindex",t)}));var n=[].slice.call(this.parent.element.querySelectorAll(".e-swimlane-row-expand"));n.length>0&&n.forEach((function(e){e.setAttribute("tabindex",t)})),[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row) .e-content-cells")).forEach((function(e){e.setAttribute("tabindex",t)}))},e.prototype.destroy=function(){this.keyboardModule.destroy()},e}(),U=function(){function e(e){this.parent=e,this.renderTooltip()}return e.prototype.renderTooltip=function(){this.tooltipObj=new sf.popups.Tooltip({cssClass:this.parent.cssClass+" e-kanban-tooltip",enableRtl:this.parent.enableRtl,mouseTrail:!this.parent.isAdaptive,offsetY:5,position:"BottomCenter",showTipPointer:!0,target:".e-tooltip-text",beforeRender:this.onBeforeRender.bind(this),beforeClose:this.onBeforeClose.bind(this)}),this.tooltipObj.appendTo(this.parent.element),this.tooltipObj.isStringTemplate=!0},e.prototype.onBeforeRender=function(e){if(this.parent.dragAndDropModule.isDragging)e.cancel=!0;else{var t;if(this.parent.tooltipTemplate){t=sf.base.createElement("div");var a=sf.base.closest(e.target,".e-card"),n=this.parent.getCardDetails(a),r=this.parent.element.id+"_tooltipTemplate",s=this.parent.templateParser(this.parent.tooltipTemplate)(n,this.parent,"tooltipTemplate",r,!1);sf.base.append(s,t),this.parent.renderTemplates()}else t='<div class="e-card-header-caption">'+e.target.innerText+"</div>";this.tooltipObj.setProperties({content:t},!0)}},e.prototype.onBeforeClose=function(){this.parent.resetTemplates(["tooltipTemplate"])},e.prototype.destroy=function(){this.tooltipObj.destroy(),sf.base.addClass([this.parent.element],"e-control"),this.tooltipObj=null},e}(),K=function(){function e(e){this.parent=e,this.tabHold=!1}return e.prototype.wireTouchEvents=function(){this.element=this.parent.element.querySelector("."+g),this.touchObj=new sf.base.Touch(this.element,{tapHold:this.tapHoldHandler.bind(this)})},e.prototype.tapHoldHandler=function(e){this.tabHold=!0;var t=sf.base.closest(e.originalEvent.target,".e-card");t&&"Multiple"===this.parent.cardSettings.selectionType&&(this.parent.actionModule.cardSelection(t,!0,!1),this.mobilePopup||(this.renderMobilePopup(),this.mobilePopup.show()),this.updatePopupContent())},e.prototype.renderMobilePopup=function(){if("Multiple"===this.parent.cardSettings.selectionType){var e=sf.base.createElement("div",{className:"e-mobile-popup-wrapper e-popup-close",innerHTML:'<div class="e-popup-header"><button class="e-close"></button></div><div class="e-popup-content"></div>'});document.body.appendChild(e),sf.base.addClass([e],"e-device"),this.mobilePopup=new sf.popups.Popup(e,{targetType:"container",enableRtl:this.parent.enableRtl,hideAnimation:{name:"ZoomOut"},showAnimation:{name:"ZoomIn"},collision:{X:"fit",Y:"fit"},position:{X:"left",Y:"top"},viewPortElement:document.body,zIndex:1004,close:this.popupClose.bind(this)});var t=this.mobilePopup.element.querySelector(".e-close"),a=new sf.buttons.Button({cssClass:"e-flat e-round e-small",enableRtl:this.parent.enableRtl,iconCss:"e-icons e-close-icon"});a.appendTo(t),a.isStringTemplate=!0,sf.base.EventHandler.add(t,"click",this.closeClick,this)}},e.prototype.getPopupContent=function(){var e,t=this.parent.getSelectedCards();return t.length>1?e="("+t.length+") "+this.parent.localeObj.getConstant("cardsSelected"):1===t.length&&(e=" "+this.parent.getCardDetails(t[0])[this.parent.cardSettings.headerField]),e},e.prototype.updatePopupContent=function(){if(this.mobilePopup){var e=this.getPopupContent();e?this.mobilePopup.element.querySelector(".e-popup-content").textContent=e:this.mobilePopup.hide()}},e.prototype.closeClick=function(){this.parent.touchModule.mobilePopup.hide()},e.prototype.popupClose=function(){this.popupDestroy()},e.prototype.popupDestroy=function(){if(this.mobilePopup&&this.mobilePopup.element){var e=this.mobilePopup.element.querySelector(".e-control.e-btn").ej2_instances[0];e&&e.destroy(),this.mobilePopup.destroy(),sf.base.remove(this.mobilePopup.element),this.mobilePopup=null}},e.prototype.unWireTouchEvents=function(){this.touchObj&&this.touchObj.destroy(),this.touchObj=null,this.element=null},e.prototype.destroy=function(){this.popupDestroy(),this.unWireTouchEvents(),this.tabHold=!1},e}(),V=function(){function e(e){this.parent=e}return e.prototype.renderSwimlaneHeader=function(){var e=sf.base.createElement("div",{className:"e-swimlane-header",innerHTML:'<div class="e-swimlane-header-toolbar"><div class="e-toolbar-menu"><div class="e-icons e-icon-menu"></div></div><div class="e-toolbar-level-title"><div class="e-toolbar-swimlane-name"></div></div></div>'});this.parent.element.appendChild(e),sf.base.EventHandler.add(e.querySelector(".e-icon-menu"),"click",this.menuClick,this)},e.prototype.renderSwimlaneTree=function(){var e=this.parent.element.querySelector(".e-swimlane-header").offsetHeight,t=window.innerHeight-e;this.popupOverlay=sf.base.createElement("div",{className:"e-swimlane-overlay",styles:"height: "+t+"px;"});var a=sf.base.createElement("div",{className:"e-swimlane-content",styles:"top:"+e+"px;"}),n=sf.base.createElement("div",{className:"e-swimlane-resource e-popup-close",styles:"height: "+t+"px;"});a.appendChild(n),a.appendChild(this.popupOverlay),this.parent.element.appendChild(a);var r=sf.base.createElement("div",{className:"e-swimlane-tree"});n.appendChild(r),this.treeViewObj=new sf.navigations.TreeView({cssClass:this.parent.cssClass,enableRtl:this.parent.enableRtl,fields:{dataSource:this.parent.layoutModule.kanbanRows,id:"keyField",text:"textField"},nodeTemplate:this.parent.swimlaneSettings.template,nodeClicked:this.treeSwimlaneClick.bind(this)}),this.treeViewObj.appendTo(r);var s={targetType:"relative",actionOnScroll:"none",enableRtl:this.parent.enableRtl,zIndex:10,hideAnimation:{name:"SlideLeftOut",duration:500},showAnimation:{name:"SlideLeftIn",duration:500},viewPortElement:this.parent.element.querySelector("."+g)};s.content=this.treeViewObj.element,this.treePopup=new sf.popups.Popup(n,s)},e.prototype.menuClick=function(e){if(this.parent.element.querySelector(".e-swimlane-resource").classList.contains("e-popup-open"))this.treePopup.hide(),sf.base.removeClass([this.popupOverlay],"e-enable");else{var t=[].slice.call(this.treeViewObj.element.querySelectorAll(".e-list-item"));sf.base.removeClass(t,"e-active"),sf.base.addClass([t[this.parent.layoutModule.swimlaneIndex]],"e-active"),this.treePopup.show(),sf.base.addClass([this.popupOverlay],"e-enable")}},e.prototype.treeSwimlaneClick=function(e){this.treePopup.hide();var t=[].slice.call(this.treeViewObj.element.querySelectorAll(".e-list-item"));this.parent.layoutModule.swimlaneIndex=t.indexOf(e.node),this.parent.layoutModule.scrollLeft=0,this.parent.notify(m,{processedData:this.parent.kanbanData}),e.event.preventDefault()},e.prototype.hidePopup=function(){this.treePopup.hide(),sf.base.removeClass([this.popupOverlay],"e-enable")},e.prototype.getWidth=function(){return 80*window.innerWidth/100},e}(),h=function(e,t){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},W=function(e,t){function a(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},Y=function(e){function t(t){var a=e.call(this,t)||this;return a.kanbanRows=[],a.parent=t,a.columnKeys=[],a.swimlaneIndex=0,a.swimlaneData={},a.scrollLeft=0,a.parent.on(m,a.initRender,a),a.parent.on(f,a.scrollUiUpdate,a),a}return W(t,e),t.prototype.initRender=function(){if(0!==this.parent.columns.length){if(this.columnData=this.getColumnCards(),this.kanbanRows=this.getRows(),this.swimlaneData=this.getSwimlaneCards(),this.parent.isAdaptive){var e=this.parent.element.querySelector("."+g);e&&(this.scrollLeft=e.scrollLeft)}this.destroy(),this.parent.on(m,this.initRender,this),this.parent.on(f,this.scrollUiUpdate,this),this.parent.isAdaptive&&this.parent.swimlaneSettings.keyField&&0!==this.parent.kanbanData.length&&this.renderSwimlaneHeader();var t=sf.base.createElement("div",{className:"e-kanban-header"});this.parent.element.appendChild(t),this.renderHeader(t),this.renderContent(),this.renderCards(),this.renderValidation(),this.parent.renderTemplates(),this.parent.notify(f,{}),this.wireEvents(),this.parent.isInitialRender&&(this.parent.isInitialRender=!1)}},t.prototype.renderHeader=function(e){var t=sf.base.createElement("div",{className:this.parent.swimlaneSettings.keyField?"e-swimlane":""});e.appendChild(t);var a=sf.base.createElement("table",{className:"e-kanban-table e-header-table",attrs:{role:"presentation"}});t.appendChild(a),this.renderColGroup(a);var n=sf.base.createElement("thead");a.appendChild(n),this.parent.stackedHeaders.length>0&&n.appendChild(this.createStackedRow(this.parent.stackedHeaders));var r=sf.base.createElement("tr",{className:"e-header-row"});n.appendChild(r);for(var s=function(e){if(i.isColumnVisible(e)){var t=i.parent.actionModule.columnToggleArray.indexOf(e.keyField),a=sf.base.createElement("th",{className:-1===t?"e-header-cells":"e-header-cells e-collapsed",attrs:{"data-role":"kanban-column","data-key":e.keyField}}),n=[];e.allowToggle&&(n.push("e-toggle-header"),e.isExpanded||n.push("e-collapsed")),sf.base.addClass([a],n);var s=sf.base.createElement("div",{className:"e-header-wrap"});a.appendChild(s);var o=i.columnData[e.keyField].length,l=sf.base.createElement("div",{className:"e-header-title"});if(s.appendChild(l),e.template){var d={keyField:e.keyField,headerText:e.headerText,minCount:e.minCount,maxCount:e.maxCount,allowToggle:e.allowToggle,isExpanded:e.isExpanded,showItemCount:e.showItemCount,count:o};sf.base.addClass([a],"e-template");var c=i.parent.element.id+"_columnTemplate",p=i.parent.templateParser(e.template)(d,i.parent,"template",c,!1);sf.base.append(p,l)}else{var h=sf.base.createElement("div",{className:"e-header-text",innerHTML:e.headerText});if(l.appendChild(h),e.showItemCount){var u=sf.base.createElement("div",{className:"e-item-count",innerHTML:"- "+o.toString()+" "+i.parent.localeObj.getConstant("items")});l.appendChild(u)}}if(e.allowToggle){var f=!(!e.isExpanded||-1!==t),m=f?"e-column-expand":"e-column-collapse",g=sf.base.createElement("div",{className:"e-header-icon e-icons "+m,attrs:{tabindex:"0"}});g.setAttribute("aria-label",f?e.keyField+" Expand":e.keyField+" Collapse"),a.setAttribute("aria-expanded",f.toString()),s.appendChild(g)}var y={data:[{keyField:e.keyField,textField:e.headerText,count:o}],element:r,cancel:!1,requestType:"headerRow"};i.parent.trigger("queryCellInfo",y,(function(e){e.cancel||r.appendChild(a)}))}},i=this,o=0,l=this.parent.columns;o<l.length;o++)s(l[o])},t.prototype.renderContent=function(){var e=sf.base.createElement("div",{className:g});this.parent.element.appendChild(e);var t=sf.base.createElement("div",{className:this.parent.swimlaneSettings.keyField?"e-swimlane":""});e.appendChild(t);var a=sf.base.createElement("table",{className:"e-kanban-table e-content-table",attrs:{role:"presentation"}});t.appendChild(a),this.renderColGroup(a);var n,r=sf.base.createElement("tbody");a.appendChild(r);var s=!1;this.swimlaneRow=this.kanbanRows,this.initializeSwimlaneTree();for(var i=function(e){if(o.parent.swimlaneSettings.keyField&&0!==o.parent.swimlaneToggleArray.length){var t=o.parent.swimlaneToggleArray.indexOf(e.keyField);s=-1!==t}n=s?"e-content-row e-collapsed":"e-content-row";var a=sf.base.createElement("tr",{className:n,attrs:{"aria-expanded":"true"}});o.parent.swimlaneSettings.keyField&&!o.parent.isAdaptive&&o.renderSwimlaneRow(r,e,s);for(var i=0,l=o.parent.columns;i<l.length;i++){var d=l[i];if(o.isColumnVisible(d)){var c=-1===(t=o.parent.actionModule.columnToggleArray.indexOf(d.keyField))?"e-content-cells":"e-content-cells e-collapsed",p=sf.base.createElement("td",{className:c,attrs:{"data-role":"kanban-column","data-key":d.keyField,"aria-expanded":"true",tabindex:"0"}});if(d.allowToggle&&!d.isExpanded||-1!==t){sf.base.addClass([p],"e-collapsed");var h=(d.showItemCount?"["+o.getColumnData(d.keyField,o.swimlaneData[e.keyField]).length+"] ":"")+d.headerText;p.appendChild(sf.base.createElement("div",{className:"e-collapse-header-text",innerHTML:h})),p.setAttribute("aria-expanded","false")}if(d.showAddButton){var u=sf.base.createElement("div",{className:y,attrs:{tabindex:"-1"}});u.appendChild(sf.base.createElement("div",{className:"e-show-add-icon e-icons"})),p.appendChild(u)}a.appendChild(p)}}var f={data:[{keyField:e.keyField,textField:e.textField,count:e.count}],element:a,cancel:!1,requestType:"contentRow"};o.parent.trigger("queryCellInfo",f,(function(e){e.cancel||r.appendChild(a)}))},o=this,l=0,d=this.swimlaneRow;l<d.length;l++)i(d[l])},t.prototype.initializeSwimlaneTree=function(){this.parent.swimlaneSettings.keyField&&this.parent.isAdaptive&&0!==this.parent.kanbanData.length&&(this.swimlaneRow=[this.kanbanRows[this.swimlaneIndex]],this.renderSwimlaneTree(),this.parent.element.querySelector(".e-toolbar-swimlane-name").innerHTML=this.swimlaneRow[0].textField)},t.prototype.renderSwimlaneRow=function(e,t,a){var n=a?" e-collapsed":"",r=sf.base.createElement("tr",{className:"e-content-row e-swimlane-row"+n,attrs:{"data-key":t.keyField,"aria-expanded":(!a).toString()}}),s=this.parent.columns.length-this.parent.actionModule.hideColumnKeys.length,i=sf.base.createElement("td",{className:"e-content-cells",attrs:{"data-role":"kanban-column",colspan:s.toString()}}),o=sf.base.createElement("div",{className:"e-swimlane-header"});i.appendChild(o);var l=a?"e-swimlane-row-collapse":"e-swimlane-row-expand",d=sf.base.createElement("div",{className:"e-icons "+l,attrs:{tabindex:"0","aria-label":a?t.keyField+" Collapse":t.keyField+" Expand"}});o.appendChild(d);var c=sf.base.createElement("div",{className:"e-header-wrap"});o.appendChild(c);var p=this.swimlaneData[t.keyField].length;if(this.parent.swimlaneSettings.template){var h=sf.base.extend({},t,{count:p},!0);sf.base.addClass([i],"e-template");var u=this.parent.element.id+"_swimlaneTemplate",f=this.parent.templateParser(this.parent.swimlaneSettings.template)(h,this.parent,"template",u,!1);sf.base.append(f,c)}else c.appendChild(sf.base.createElement("div",{className:"e-swimlane-text",innerHTML:t.textField,attrs:{"data-role":t.textField}}));this.parent.swimlaneSettings.showItemCount&&o.appendChild(sf.base.createElement("div",{className:"e-item-count",innerHTML:"- "+p.toString()+" "+this.parent.localeObj.getConstant("items")})),r.appendChild(i);var m={data:[{keyField:t.keyField,textField:t.textField,count:t.count}],element:r,cancel:!1,requestType:"swimlaneRow"};this.parent.trigger("queryCellInfo",m,(function(t){t.cancel||e.appendChild(r)}))},t.prototype.renderCards=function(){var e=this,t=this.swimlaneRow,a=[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")),n=[].slice.call(this.parent.element.querySelectorAll(".e-content-row.e-swimlane-row")),r=[];a.forEach((function(a,s){for(var i=0,o=function(n){if(e.isColumnVisible(n)){var r=e.parent.swimlaneSettings.keyField?e.getColumnData(n.keyField,e.swimlaneData[t[s].keyField]):e.columnData[n.keyField];i+=r.length;var o=a.querySelector('[data-key="'+n.keyField+'"]'),l=sf.base.createElement("div",{className:"e-card-wrapper"});o.appendChild(l);for(var d=function(t){var a=t[e.parent.cardSettings.headerField],n=e.parent.actionModule.selectionArray.indexOf(a),r=e.renderCard(t);-1!==n&&(r.setAttribute("aria-selected","true"),sf.base.addClass([r],"e-selection"));var s={data:t,element:r,cancel:!1};e.parent.trigger("cardRendered",s,(function(e){e.cancel||l.appendChild(r)}))},c=0,p=r;c<p.length;c++)d(p[c])}},l=0,d=e.parent.columns;l<d.length;l++)o(d[l]);0===i&&(r.push(a),n.length>0&&r.push(n[s]))})),this.parent.swimlaneSettings.showEmptyRow||0!==this.parent.kanbanData.length||this.parent.showEmptyColumn||r.forEach((function(e){return sf.base.remove(e)}))},t.prototype.renderCard=function(e){var t=sf.base.createElement("div",{className:"e-card",attrs:{"data-id":e[this.parent.cardSettings.headerField],"data-key":e[this.parent.keyField],"aria-selected":"false",tabindex:"-1"}});if(this.parent.cardSettings.template){sf.base.addClass([t],"e-template");var a=this.parent.element.id+"_cardTemplate",n=this.parent.templateParser(this.parent.cardSettings.template)(e,this.parent,"template",a,!1);sf.base.append(n,t)}else{var r=this.parent.enableTooltip?" e-tooltip-text":"";if(this.parent.cardSettings.showHeader){var s=sf.base.createElement("div",{className:"e-card-header"}),i=sf.base.createElement("div",{className:"e-card-header-caption"}),o=sf.base.createElement("div",{className:"e-card-header-title"+r,innerHTML:e[this.parent.cardSettings.headerField]||""});s.appendChild(i),i.appendChild(o),t.appendChild(s)}var l=sf.base.createElement("div",{className:"e-card-content"+r,innerHTML:e[this.parent.cardSettings.contentField]||""});if(t.appendChild(l),this.parent.cardSettings.tagsField&&e[this.parent.cardSettings.tagsField]){for(var d=sf.base.createElement("div",{className:"e-card-tags"}),c=0,p=e[this.parent.cardSettings.tagsField].toString().split(",");c<p.length;c++){var h=p[c];d.appendChild(sf.base.createElement("div",{className:"e-card-tag e-card-label",innerHTML:h}))}t.appendChild(d)}if(this.parent.cardSettings.grabberField&&e[this.parent.cardSettings.grabberField]&&(sf.base.addClass([t],"e-card-color"),t.style.borderLeftColor=e[this.parent.cardSettings.grabberField]),this.parent.cardSettings.footerCssField){for(var u=sf.base.createElement("div",{className:"e-card-footer"}),f=0,m=e[this.parent.cardSettings.footerCssField].split(",");f<m.length;f++){var g=m[f];u.appendChild(sf.base.createElement("div",{className:g.trim()+" e-card-footer-css"}))}t.appendChild(u)}}return t},t.prototype.renderColGroup=function(e){var t=this,a=sf.base.createElement("colgroup");this.parent.columns.forEach((function(e){if(t.isColumnVisible(e)){var n=t.parent.actionModule.columnToggleArray.indexOf(e.keyField),r=e.allowToggle&&!e.isExpanded,s=-1===n?r?"e-collapsed":"":"e-collapsed",i=sf.base.createElement("col",{className:s,attrs:{"data-key":e.keyField},styles:t.parent.isAdaptive?"width: "+(r?sf.base.formatUnit(50):sf.base.formatUnit(t.getWidth())):""});a.appendChild(i)}})),e.appendChild(a)},t.prototype.getRows=function(){var e=this,t=[];return this.parent.swimlaneSettings.keyField?(this.parent.kanbanData.map((function(a){if(e.parent.swimlaneSettings.showEmptyRow||-1!==e.columnKeys.indexOf(a[e.parent.keyField])){var n=a[e.parent.swimlaneSettings.textField]||a[e.parent.swimlaneSettings.keyField],r=a[e.parent.swimlaneSettings.keyField];if(!a[e.parent.swimlaneSettings.keyField]){if(!e.parent.swimlaneSettings.showUnassignedRow)return;n="Unassigned",r=""}t.push({keyField:r,textField:n})}})),(t=t.filter((function(e,t,a){return t===a.map((function(e){return e.keyField})).indexOf(e.keyField)}))).sort((function(e,t){var a=e.textField.toLowerCase(),n=t.textField.toLowerCase();return a>n?1:n>a?-1:0})),"Descending"===this.parent.swimlaneSettings.sortDirection&&t.reverse(),t.forEach((function(t){t.count=e.parent.kanbanData.filter((function(a){return e.columnKeys.indexOf(a[e.parent.keyField])>-1&&a[e.parent.swimlaneSettings.keyField]===t.keyField})).length})),0===t.length&&t.push({keyField:"",textField:""})):t.push({keyField:"",textField:""}),t},t.prototype.createStackedRow=function(e){var t=sf.base.createElement("tr",{className:"e-header-row e-stacked-header-row"}),a=[];this.parent.columns.forEach((function(t){for(var n="",r=0,s=e;r<s.length;r++){var i=s[r];-1!==i.keyFields.indexOf(t.keyField)&&(n=i.text)}a.push(n)}));for(var n=0;n<a.length;n++){for(var r=1,s=n+1;s<a.length&&""!==a[n]&&""!==a[s]&&a[n]===a[s];s++)r++;var i=sf.base.createElement("div",{className:"e-header-text",innerHTML:a[n]}),o=sf.base.createElement("th",{className:"e-header-cells e-stacked-header-cell",attrs:{colspan:r.toString()}});t.appendChild(o).appendChild(i),n+=r-1}return t},t.prototype.scrollUiUpdate=function(){var e=this,t=this.parent.element.querySelector(".e-kanban-header"),a=this.parent.element.querySelector("."+g),n=this.parent.element.offsetHeight-t.offsetHeight;if(this.parent.isAdaptive){n=window.innerHeight-(t.offsetHeight+25);var r=this.parent.element.querySelector(".e-swimlane-header");r&&(n-=r.offsetHeight),[].slice.call(this.parent.element.querySelectorAll(".e-content-cells")).forEach((function(t){var a=t.querySelector(".e-card-wrapper");a.classList.contains("e-multi-card-wrapper")||(a.style.height=sf.base.formatUnit(n),sf.base.EventHandler.add(t,"touchmove",e.onAdaptiveScroll,e))}))}"auto"!==this.parent.height&&"100%"!==this.parent.height&&(a.style.height=sf.base.formatUnit(n)),[].slice.call(t.children).forEach((function(t){var n=0;a.offsetWidth-a.clientWidth>0&&(n=17,a.offsetHeight-a.clientHeight>0&&(t.style.width=sf.base.formatUnit(a.clientWidth))),e.parent.enableRtl?t.style.paddingLeft=sf.base.formatUnit(n):t.style.paddingRight=sf.base.formatUnit(n)})),this.updateScrollPosition()},t.prototype.onContentScroll=function(e){var t=e.target,a=this.parent.element.querySelector(".e-kanban-header");[].slice.call(a.children).forEach((function(e){e.scrollLeft=t.scrollLeft})),this.parent.scrollPosition.content={left:t.scrollLeft,top:t.scrollTop}},t.prototype.onColumnScroll=function(e){var t=e.target;if(t.offsetParent){var a=t.offsetParent.getAttribute("data-key");this.parent.scrollPosition.column[a]={left:t.scrollLeft,top:t.scrollTop}}},t.prototype.onAdaptiveScroll=function(e){this.parent.touchModule.tabHold&&!this.parent.touchModule.mobilePopup&&e.preventDefault()},t.prototype.isColumnVisible=function(e){var t=this,a=!1;return e.keyField.split(",").forEach((function(e){a=-1===t.parent.actionModule.hideColumnKeys.indexOf(e)})),a},t.prototype.renderLimits=function(e,t){var a=sf.base.createElement("div",{className:"e-limits"});e.minCount&&a.appendChild(sf.base.createElement("div",{className:"e-min-count",innerHTML:this.parent.localeObj.getConstant("min")+": "+e.minCount.toString()})),e.maxCount&&a.appendChild(sf.base.createElement("div",{className:"e-max-count",innerHTML:this.parent.localeObj.getConstant("max")+": "+e.maxCount.toString()})),a.childElementCount>0&&(t.querySelector(".e-card-wrapper")?t.insertBefore(a,t.firstElementChild):t.appendChild(a))},t.prototype.renderValidation=function(){var e=this,t=function(e,t){var a;return e.maxCount&&t>e.maxCount?a="e-max-color":e.minCount&&t<e.minCount&&(a="e-min-color"),a};this.parent.columns.forEach((function(a){if(a.minCount||a.maxCount){var n=e.columnData[a.keyField],r='[data-key="'+a.keyField+'"]',s=e.parent.element.querySelector(".e-header-cells"+r),i=[].slice.call(e.parent.element.querySelectorAll(".e-content-cells"+r));if("Swimlane"===e.parent.constraintType&&e.parent.swimlaneSettings.keyField)e.swimlaneRow.forEach((function(r,s){e.renderLimits(a,i[s]);var o=n.filter((function(t){return t[e.parent.swimlaneSettings.keyField]===r.keyField})),l=t(a,o.length);l&&sf.base.addClass([i[s]],l)}));else{e.renderLimits(a,s);var o=t(a,n.length);o&&sf.base.addClass(i.concat(s),o)}}}))},t.prototype.refreshValidation=function(){[].slice.call(this.parent.element.querySelectorAll(".e-limits")).forEach((function(e){sf.base.remove(e)}));var e=[].slice.call(this.parent.element.querySelectorAll(".e-min-color"));sf.base.removeClass(e,"e-min-count");var t=[].slice.call(this.parent.element.querySelectorAll(".e-max-color"));sf.base.removeClass(t,"e-max-color"),this.renderValidation()},t.prototype.getColumnData=function(e,t){var a=this;void 0===t&&(t=this.parent.kanbanData);for(var n=[],r=function(e){var r=t.filter((function(t){return t[a.parent.keyField]===e.trim()}));n=n.concat(r)},s=0,i=e.split(",");s<i.length;s++)r(i[s]);return this.sortCategory(n),n},t.prototype.sortCategory=function(e){var t=this.parent.cardSettings.headerField,a=this.parent.sortSettings.direction;switch(this.parent.sortSettings.sortBy){case"DataSourceOrder":this.sortOrder(t,a,e);break;case"Custom":case"Index":this.parent.sortSettings.field&&(t=this.parent.sortSettings.field),this.sortOrder(t,a,e)}return e},t.prototype.sortOrder=function(e,t,a){var n,r,s=!0;return this.parent.kanbanData.length>0&&(s="number"==typeof this.parent.kanbanData[0][e]),s||"Index"!==this.parent.sortSettings.sortBy?(a=a.sort((function(t,a){return s?(n=t[e],r=a[e]):(n=t[e].toLowerCase(),r=a[e].toLowerCase()),n>r?1:r>n?-1:0})),"Descending"===t&&a.reverse(),a):a},t.prototype.documentClick=function(e){if(e.target.classList.contains("e-swimlane-overlay")&&this.parent.element.querySelector(".e-swimlane-resource").classList.contains("e-popup-open")&&(this.treePopup.hide(),sf.base.removeClass([this.popupOverlay],"e-enable")),!sf.base.closest(e.target,".e-kanban")){var t=[].slice.call(this.parent.element.querySelectorAll(".e-card.e-selection"));sf.base.removeClass(t,"e-selection"),this.disableAttributeSelection(t)}},t.prototype.disableAttributeSelection=function(e){e instanceof Element?e.setAttribute("aria-selected","false"):e.forEach((function(e){e.setAttribute("aria-selected","false")}))},t.prototype.getColumnCards=function(e){var t=this,a={};return this.columnKeys=[],this.parent.columns.forEach((function(n){t.columnKeys=t.columnKeys.concat(n.keyField.split(",").map((function(e){return e.trim()})));var r=t.getColumnData(n.keyField,e);a[n.keyField]=r})),a},t.prototype.getSwimlaneCards=function(){var e=this,t={};return this.parent.swimlaneSettings.keyField&&this.kanbanRows.forEach((function(a){return t[a.keyField]=e.parent.kanbanData.filter((function(t){return e.columnKeys.indexOf(t[e.parent.keyField])>-1&&(!t[e.parent.swimlaneSettings.keyField]&&e.parent.swimlaneSettings.showUnassignedRow?"":t[e.parent.swimlaneSettings.keyField])===a.keyField}))})),t},t.prototype.refreshHeaders=function(){var e=this.parent.element.querySelector(".e-kanban-header");[].slice.call(e.children).forEach((function(e){return sf.base.remove(e)})),this.renderHeader(e)},t.prototype.refreshCards=function(){[].slice.call(this.parent.element.querySelectorAll(".e-card-wrapper")).forEach((function(e){return sf.base.remove(e)})),this.renderCards()},t.prototype.refresh=function(){var e=this;this.parent.columns.forEach((function(t){if(t.showItemCount){var a='.e-header-cells[data-key="'+t.keyField+'"] .e-item-count',n=e.parent.element.querySelector(a);n&&(n.innerHTML="- "+e.columnData[t.keyField].length+" "+e.parent.localeObj.getConstant("items"))}})),this.parent.swimlaneSettings.keyField&&[].slice.call(this.parent.element.querySelectorAll(".e-swimlane-row")).forEach((function(t){var a=t.getAttribute("data-key"),n=t.querySelector(".e-item-count");n&&(n.innerHTML="- "+e.swimlaneData[a].length+" "+e.parent.localeObj.getConstant("items"))})),this.refreshValidation()},t.prototype.updateScrollPosition=function(){var e=this,t=this.parent.element.querySelector("."+g);t&&t.scrollTo(this.parent.scrollPosition.content.left,this.parent.scrollPosition.content.top),[].slice.call(this.parent.element.querySelectorAll(".e-card-wrapper")).forEach((function(t){if(t.offsetParent){var a=e.parent.scrollPosition.column[t.offsetParent.getAttribute("data-key")];a&&t.scrollTo(a.left,a.top)}}))},t.prototype.renderCardBasedOnIndex=function(e,t){var a=e[this.parent.keyField],n=this.parent.element.querySelector(".e-content-row:not(.e-swimlane-row)");if(this.parent.swimlaneSettings.keyField){var r='.e-content-row.e-swimlane-row[data-key="'+e[this.parent.swimlaneSettings.keyField]+'"]';n=this.parent.element.querySelector(r).nextElementSibling}if("Index"!==this.parent.sortSettings.sortBy){var s=this.parent.cardSettings.headerField;if("Custom"===this.parent.sortSettings.sortBy&&(s=this.parent.sortSettings.field),sf.base.isNullOrUndefined(this.parent.swimlaneSettings.keyField))t=this.getColumnData(a,this.parent.kanbanData).findIndex((function(t){return t[s]===e[s]}));else{var i=this.parent.getSwimlaneData(e[this.parent.swimlaneSettings.keyField]);t=this.getColumnData(a,i).findIndex((function(t){return t[s]===e[s]}))}}else"Index"===this.parent.sortSettings.sortBy&&this.parent.sortSettings.field&&"Ascending"===this.parent.sortSettings.direction&&(t=e[this.parent.sortSettings.field]-1);if(n){var o=[].slice.call(n.children).filter((function(e){return-1!==e.getAttribute("data-key").replace(/\s/g,"").split(",").indexOf(a.replace(/\s/g,""))}))[0].querySelector(".e-card-wrapper"),l=this.renderCard(e);this.parent.allowDragAndDrop&&sf.base.addClass([l],"e-draggable");var d={data:e,element:l,cancel:!1};this.parent.trigger("cardRendered",d,(function(e){e.cancel||(sf.base.isNullOrUndefined(t)||0===o.children.length?o.appendChild(l):o.insertBefore(l,o.childNodes[t]))}))}},t.prototype.removeCard=function(e){var t=e[this.parent.cardSettings.headerField],a=this.parent.element.querySelector('.e-card[data-id="'+t+'"]');a&&sf.base.remove(a)},t.prototype.wireEvents=function(){var e=this;sf.base.EventHandler.add(this.parent.element,"click",this.parent.actionModule.clickHandler,this.parent.actionModule),sf.base.EventHandler.add(this.parent.element,"dblclick",this.parent.actionModule.doubleClickHandler,this.parent.actionModule),sf.base.EventHandler.add(document,sf.base.Browser.touchStartEvent,this.documentClick,this);var t=this.parent.element.querySelector("."+g);sf.base.EventHandler.add(t,"scroll",this.onContentScroll,this),[].slice.call(this.parent.element.querySelectorAll(".e-card-wrapper")).forEach((function(t){e.parent.isInitialRender&&t.offsetParent&&(e.parent.scrollPosition.column[t.offsetParent.getAttribute("data-key")]={left:0,top:0}),sf.base.EventHandler.add(t,"scroll",e.onColumnScroll,e)})),this.parent.isAdaptive&&(this.parent.touchModule.wireTouchEvents(),t.scrollLeft=this.scrollLeft),this.wireDragEvent()},t.prototype.unWireEvents=function(){var e=this;sf.base.EventHandler.remove(this.parent.element,"click",this.parent.actionModule.clickHandler),sf.base.EventHandler.remove(this.parent.element,"dblclick",this.parent.actionModule.doubleClickHandler),sf.base.EventHandler.remove(document,sf.base.Browser.touchStartEvent,this.documentClick);var t=this.parent.element.querySelector("."+g);t&&(sf.base.EventHandler.remove(t,"scroll",this.onContentScroll),this.parent.allowDragAndDrop&&this.unWireDragEvent()),[].slice.call(this.parent.element.querySelectorAll(".e-card-wrapper")).forEach((function(t){sf.base.EventHandler.remove(t,"scroll",e.onColumnScroll)})),this.parent.isAdaptive&&this.parent.touchModule.unWireTouchEvents()},t.prototype.wireDragEvent=function(){this.parent.allowDragAndDrop&&(sf.base.addClass(this.parent.element.querySelectorAll(".e-card"),"e-draggable"),this.parent.dragAndDropModule.wireDragEvents(this.parent.element.querySelector("."+g)))},t.prototype.unWireDragEvent=function(){this.parent.dragAndDropModule.unWireDragEvents(this.parent.element.querySelector("."+g))},t.prototype.destroy=function(){this.parent.resetTemplates(),this.parent.off(m,this.initRender),this.parent.off(f,this.scrollUiUpdate),this.unWireEvents();var e=this.parent.element.querySelector(".e-kanban-header");e&&sf.base.remove(e);var t=this.parent.element.querySelector("."+g);t&&sf.base.remove(t),this.treeViewObj&&(this.treeViewObj.destroy(),this.treeViewObj=null),this.treePopup&&(this.treePopup.destroy(),this.treePopup=null);var a=this.parent.element.querySelector(".e-swimlane-header");a&&sf.base.remove(a);var n=this.parent.element.querySelector(".e-swimlane-content");n&&sf.base.remove(n)},t}(V),u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},X=function(e,t){function a(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},Q=function(e,t,a,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"==typeof Reflect?"undefined":r()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,a,o):s(t,a))||o);return i>3&&o&&Object.defineProperty(t,a,o),o},z=function(e){function t(t,a){return e.call(this,t,a)||this}return X(t,e),t.prototype.preRender=function(){this.isAdaptive=sf.base.Browser.isDevice,this.kanbanData=[],this.enablePersistence&&this.swimlaneToggleArray||(this.swimlaneToggleArray=[]),this.activeCardData={data:null,element:null},this.localeObj=new sf.base.L10n(this.getModuleName(),{items:"items",min:"Min",max:"Max",cardsSelected:"Cards Selected",addTitle:"Add New Card",editTitle:"Edit Card Details",deleteTitle:"Delete Card",deleteContent:"Are you sure you want to delete this card?",save:"Save",delete:"Delete",cancel:"Cancel",yes:"Yes",no:"No",close:"Close"},this.locale),this.scrollPosition={content:{left:0,top:0},column:{}},this.isInitialRender=!0},t.prototype.requiredModules=function(){return[]},t.prototype.getPersistData=function(){return this.addOnPersist(["columns","dataSource","swimlaneToggleArray"])},t.prototype.getModuleName=function(){return"kanban"},t.prototype.render=function(){var e=["e-kanban"],t=[];this.enableRtl?e.push("e-rtl"):t.push("e-rtl"),this.isAdaptive?e.push("e-device"):t.push("e-device"),this.cssClass&&e.push(this.cssClass),this.element.setAttribute("role","main"),sf.base.classList(this.element,e,t),this.element.style.width=sf.base.formatUnit(this.width),this.element.style.height=sf.base.formatUnit(this.height),sf.popups.createSpinner({target:this.element}),this.showSpinner(),this.initializeModules()},t.prototype.onPropertyChanged=function(e,t){for(var a=0,n=Object.keys(e);a<n.length;a++)switch(n[a]){case"cssClass":t.cssClass&&sf.base.removeClass([this.element],t.cssClass),e.cssClass&&sf.base.addClass([this.element],e.cssClass);break;case"enableRtl":case"locale":this.refresh();break;case"width":this.element.style.width=sf.base.formatUnit(e.width),this.element.querySelector(".e-kanban-header").firstElementChild.style.width="auto",this.notify(f,{});break;case"height":this.element.style.height=sf.base.formatUnit(e.height),this.element.querySelector("."+g).style.height="auto",this.notify(f,{});break;case"dataSource":case"query":this.dataModule=new b(this);break;case"columns":case"constraintType":this.notify(m,{processedData:this.kanbanData});break;case"swimlaneSettings":this.onSwimlaneSettingsPropertyChanged(e.swimlaneSettings,t.swimlaneSettings);break;case"cardSettings":this.onCardSettingsPropertyChanged(e.cardSettings,t.cardSettings);break;case"allowDragAndDrop":e.allowDragAndDrop?this.layoutModule.wireDragEvent():this.layoutModule.unWireDragEvent();break;case"enableTooltip":this.tooltipModule&&(this.tooltipModule.destroy(),this.tooltipModule=null),e.enableTooltip&&(this.tooltipModule=new U(this),this.layoutModule.refreshCards());break;case"dialogSettings":e.dialogSettings&&(this.dialogModule=new I(this));break;case"allowKeyboard":this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null),e.allowKeyboard&&(this.keyboardModule=new B(this));break;case"stackedHeaders":this.layoutModule.refreshHeaders();break;case"sortSettings":this.notify(m,{processedData:this.kanbanData})}},t.prototype.onSwimlaneSettingsPropertyChanged=function(e,t){for(var a=0,n=Object.keys(e);a<n.length;a++)switch(n[a]){case"keyField":case"textField":case"showEmptyRow":case"showItemCount":case"template":case"sortDirection":this.notify(m,{processedData:this.kanbanData})}},t.prototype.onCardSettingsPropertyChanged=function(e,t){for(var a=0,n=Object.keys(e);a<n.length;a++)switch(n[a]){case"showHeader":case"headerField":case"contentField":case"template":case"tagsField":case"grabberField":case"footerCssField":this.layoutModule.refreshCards();break;case"selectionType":var r=this.getSelectedCards();r.length>0&&(sf.base.removeClass(r,"e-selection"),this.layoutModule.disableAttributeSelection(r))}},t.prototype.initializeModules=function(){this.dataModule=new b(this),this.layoutModule=new Y(this),this.allowKeyboard&&(this.keyboardModule=new B(this)),this.actionModule=new H(this),this.crudModule=new N(this),this.dragAndDropModule=new _(this),this.dialogModule=new I(this),this.enableTooltip&&(this.tooltipModule=new U(this)),(sf.base.Browser.isDevice||sf.base.Browser.isTouch)&&(this.touchModule=new K(this))},t.prototype.renderTemplates=function(){this.isReact&&this.renderReactTemplates()},t.prototype.resetTemplates=function(e){this.isReact&&this.clearTemplate(e)},t.prototype.destroyModules=function(){this.layoutModule&&(this.layoutModule.destroy(),this.layoutModule=null),this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null),this.touchModule&&(this.touchModule.destroy(),this.touchModule=null),this.dialogModule=null,this.actionModule=null,this.crudModule=null,this.dataModule=null,this.dragAndDropModule=null},t.prototype.templateParser=function(e){if(e)try{if(document.querySelectorAll(e).length)return sf.base.compile(document.querySelector(e).innerHTML.trim())}catch(t){return sf.base.compile(e)}},t.prototype.getCardDetails=function(e){var t=this,a="number"==typeof this.kanbanData[0][this.cardSettings.headerField]?parseInt(e.getAttribute("data-id"),10):e.getAttribute("data-id");return this.kanbanData.filter((function(e){return e[t.cardSettings.headerField]===a}))[0]},t.prototype.getColumnData=function(e,t){return this.layoutModule.getColumnCards(t)[e]||[]},t.prototype.getSwimlaneData=function(e){return this.layoutModule.getSwimlaneCards()[e]||[]},t.prototype.getSelectedCards=function(){return[].slice.call(this.element.querySelectorAll(".e-card.e-selection"))},t.prototype.showSpinner=function(){sf.popups.showSpinner(this.element)},t.prototype.hideSpinner=function(){sf.popups.hideSpinner(this.element)},t.prototype.openDialog=function(e,t){this.dialogModule.openDialog(e,t)},t.prototype.closeDialog=function(){this.dialogModule.closeDialog()},t.prototype.addCard=function(e){this.crudModule.addCard(e)},t.prototype.updateCard=function(e){this.crudModule.updateCard(e)},t.prototype.deleteCard=function(e){this.crudModule.deleteCard(e)},t.prototype.addColumn=function(e,t){this.actionModule.addColumn(e,t)},t.prototype.deleteColumn=function(e){this.actionModule.deleteColumn(e)},t.prototype.showColumn=function(e){this.actionModule.showColumn(e)},t.prototype.hideColumn=function(e){this.actionModule.hideColumn(e)},t.prototype.destroy=function(){this.destroyModules(),[].slice.call(this.element.childNodes).forEach((function(e){sf.base.detach(e)}));var t=["e-kanban"];this.cssClass&&(t=t.concat(this.cssClass.split(" "))),sf.base.removeClass([this.element],t),e.prototype.destroy.call(this)},Q([sf.base.Property()],t.prototype,"cssClass",void 0),Q([sf.base.Property("auto")],t.prototype,"width",void 0),Q([sf.base.Property("auto")],t.prototype,"height",void 0),Q([sf.base.Property([])],t.prototype,"dataSource",void 0),Q([sf.base.Property()],t.prototype,"query",void 0),Q([sf.base.Property()],t.prototype,"keyField",void 0),Q([sf.base.Property("Column")],t.prototype,"constraintType",void 0),Q([sf.base.Collection([],j)],t.prototype,"columns",void 0),Q([sf.base.Property(!0)],t.prototype,"allowKeyboard",void 0),Q([sf.base.Collection([],P)],t.prototype,"stackedHeaders",void 0),Q([sf.base.Complex({},w)],t.prototype,"swimlaneSettings",void 0),Q([sf.base.Complex({},k)],t.prototype,"cardSettings",void 0),Q([sf.base.Complex({},L)],t.prototype,"sortSettings",void 0),Q([sf.base.Complex({},A)],t.prototype,"dialogSettings",void 0),Q([sf.base.Property(!0)],t.prototype,"allowDragAndDrop",void 0),Q([sf.base.Property(!1)],t.prototype,"enableTooltip",void 0),Q([sf.base.Property(!1)],t.prototype,"showEmptyColumn",void 0),Q([sf.base.Property(!1)],t.prototype,"enablePersistence",void 0),Q([sf.base.Property()],t.prototype,"tooltipTemplate",void 0),Q([sf.base.Event()],t.prototype,"actionBegin",void 0),Q([sf.base.Event()],t.prototype,"actionComplete",void 0),Q([sf.base.Event()],t.prototype,"actionFailure",void 0),Q([sf.base.Event()],t.prototype,"created",void 0),Q([sf.base.Event()],t.prototype,"dataBinding",void 0),Q([sf.base.Event()],t.prototype,"dataBound",void 0),Q([sf.base.Event()],t.prototype,"cardClick",void 0),Q([sf.base.Event()],t.prototype,"cardDoubleClick",void 0),Q([sf.base.Event()],t.prototype,"queryCellInfo",void 0),Q([sf.base.Event()],t.prototype,"cardRendered",void 0),Q([sf.base.Event()],t.prototype,"dragStart",void 0),Q([sf.base.Event()],t.prototype,"drag",void 0),Q([sf.base.Event()],t.prototype,"dragStop",void 0),Q([sf.base.Event()],t.prototype,"dialogOpen",void 0),Q([sf.base.Event()],t.prototype,"dialogClose",void 0),t=Q([sf.base.NotifyPropertyChanges],t)}(sf.base.Component),s.Kanban=z,s.actionBegin="actionBegin",s.actionComplete="actionComplete",s.actionFailure="actionFailure",s.cardClick="cardClick",s.cardDoubleClick="cardDoubleClick",s.cardRendered="cardRendered",s.queryCellInfo="queryCellInfo",s.dataBinding="dataBinding",s.dataBound="dataBound",s.dragStart="dragStart",s.drag="drag",s.dragStop="dragStop",s.documentClick="document-click",s.dialogOpen="dialogOpen",s.dialogClose="dialogClose",s.contentReady=f,s.dataReady=m,s.bottomSpace=25,s.cardSpace=16,s.toggleWidth=50,s))}});