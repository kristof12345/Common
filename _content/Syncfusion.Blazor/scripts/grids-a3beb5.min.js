!function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="_content/Syncfusion.Blazor/scripts/",i(i.s="./bundles/grids.js")}({"./bundles/grids.js":function(e,t,i){"use strict";i.r(t);i("./modules/grids.js")},"./modules/grids.js":function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sf=window.sf||{},window.sf.grids=function(e){"use strict";var t,r,n,s,o,a=function(){function e(e){this.intl=new sf.base.Internationalization,sf.base.isNullOrUndefined(e)||(this.intl.culture=e)}return e.prototype.getFormatFunction=function(e){return e.type?this.intl.getDateFormat(e):this.intl.getNumberFormat(e)},e.prototype.getParserFunction=function(e){return e.type?this.intl.getDateParser(e):this.intl.getNumberParser(e)},e.prototype.fromView=function(e,t,i){return"date"!==i&&"datetime"!==i&&"number"!==i||sf.base.isNullOrUndefined(t)?e:t(e)},e.prototype.toView=function(e,t){var i=e;return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(e)||(i=t(e)),i},e.prototype.setCulture=function(e){sf.base.isNullOrUndefined(e)||sf.base.setCulture(e)},e}(),l=function(e,t,r,n){var s,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(a=(o<3?s(a):o>3?s(t,r,a):s(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},h=function(){function e(e,t){var i=this;this.disableHtmlEncode=!0,this.allowSorting=!0,this.allowResizing=!0,this.allowFiltering=!0,this.allowGrouping=!0,this.allowReordering=!0,this.showColumnMenu=!0,this.enableGroupByFormat=!1,this.allowEditing=!0,this.filter={},this.showInColumnChooser=!0,this.edit={},this.allowSearching=!0,this.autoFit=!1,this.sortDirection="Descending",this.getEditTemplate=function(){return i.editTemplateFn},this.getFilterTemplate=function(){return i.filterTemplateFn},sf.base.merge(this,e),this.parent=t,"none"===this.type?this.type=null:this.type&&(this.type="string"==typeof this.type?this.type.toLowerCase():void 0),this.editType&&(this.editType=this.editType.toLowerCase()),sf.base.isNullOrUndefined(this.uid)&&(this.uid=Ri("grid-column"));var r=new a;if(e.format&&(e.format.skeleton||e.format.format&&"string"==typeof e.format.format)&&(this.setFormatter(r.getFormatFunction(sf.base.extend({},e.format))),this.setParser(r.getParserFunction(e.format))),this.toJSON=function(){for(var e={},t=["filter","dataSource","headerText","template","headerTemplate","edit","editTemplate","filterTemplate","commandsTemplate","parent"],r=Object.keys(i),n=0;n<r.length;n++)if("columns"===r[n]){e[r[n]]=[];for(var s=0;s<i[r[n]].length;s++)e[r[n]].push(i[r[n]][s].toJSON())}else t.indexOf(r[n])<0&&(e[r[n]]=i[r[n]]);return e},this.field||(this.allowFiltering=!1,this.allowGrouping=!1,this.allowSorting=!1,this.columns&&(this.allowResizing=this.columns.some((function(e){return e.allowResizing})))),this.commands&&!this.textAlign&&(this.textAlign="Right"),(this.template||this.commandsTemplate)&&(this.templateFn=di(this.template||this.commandsTemplate)),this.headerTemplate&&(this.headerTemplateFn=di(this.headerTemplate)),!sf.base.isNullOrUndefined(this.filter)&&this.filter.itemTemplate&&(this.fltrTemplateFn=di(this.filter.itemTemplate)),this.editTemplate&&(this.editTemplateFn=di(this.editTemplate)),this.filterTemplate&&(this.filterTemplateFn=di(this.filterTemplate)),this.isForeignColumn()&&(sf.base.isNullOrUndefined(this.editType)||"dropdownedit"===this.editType||"defaultedit"===this.editType)&&(this.editType="dropdownedit",this.edit.params=sf.base.extend({dataSource:this.dataSource,query:new sf.data.Query,fields:{value:this.foreignKeyField||this.field,text:this.foreignKeyValue}},this.edit.params)),this.sortComparer){var n=this.sortComparer;this.sortComparer=function(e,t,i,r){if("string"==typeof n&&(n=$i(n,window)),"Descending"===this.sortDirection){var s=e;e=t,t=s;var o=i;i=r,r=o}return n(e,t,i,r)}}!this.sortComparer&&this.isForeignColumn()&&(this.sortComparer=function(e,t){return e=$i(i.foreignKeyValue,Qi(i,{},e)[0]),t=$i(i.foreignKeyValue,Qi(i,{},t)[0]),"Descending"===i.sortDirection?sf.data.DataUtil.fnDescending(e,t):sf.data.DataUtil.fnAscending(e,t)})}return e.prototype.getSortDirection=function(){return this.sortDirection},e.prototype.setSortDirection=function(e){this.sortDirection=e},e.prototype.getFreezeTableName=function(){return this.freezeTable},e.prototype.setProperties=function(e){for(var t=Object.keys(e),i=0;i<t.length;i++)this[t[i]]=e[t[i]],this.parent&&this.parent.isReact&&"template"===t[i]&&this.parent.refreshReactColumnTemplateByUid(this.uid)},e.prototype.isForeignColumn=function(){return!(!this.dataSource||!this.foreignKeyValue)},e.prototype.getFormatter=function(){return this.formatFn},e.prototype.setFormatter=function(e){this.formatFn=e},e.prototype.getParser=function(){return this.parserFn},e.prototype.setParser=function(e){this.parserFn=e},e.prototype.getColumnTemplate=function(){return this.templateFn},e.prototype.getHeaderTemplate=function(){return this.headerTemplateFn},e.prototype.getFilterItemTemplate=function(){return this.fltrTemplateFn},e.prototype.getDomSetter=function(){return this.disableHtmlEncode?"textContent":"innerHTML"},e}(),d=function(){function e(){}return l([sf.base.Property()],e.prototype,"title",void 0),l([sf.base.Property()],e.prototype,"type",void 0),l([sf.base.Property()],e.prototype,"buttonOption",void 0),e}(),p="actionBegin",c="actionComplete",u="dataBound",f="initial-load",g="initial-end",m="data-ready",y="content-ready",v="ui-update",b="on-empty",C="inbound-model-changed",w="model-changed",S="header-refreshed",x="key-pressed",R="click",F="destroy",E="auto-col",I="prevent-batch",T="filter-menu-close",z="cbox-filter-complete",D="filter-Prevent",M="get-virtual-data",O="refreshResizeHandlers";(t=e.CellType||(e.CellType={}))[t.Data=0]="Data",t[t.Header=1]="Header",t[t.Summary=2]="Summary",t[t.GroupSummary=3]="GroupSummary",t[t.CaptionSummary=4]="CaptionSummary",t[t.Filter=5]="Filter",t[t.Indent=6]="Indent",t[t.GroupCaption=7]="GroupCaption",t[t.GroupCaptionEmpty=8]="GroupCaptionEmpty",t[t.Expand=9]="Expand",t[t.HeaderIndent=10]="HeaderIndent",t[t.StackedHeader=11]="StackedHeader",t[t.DetailHeader=12]="DetailHeader",t[t.DetailExpand=13]="DetailExpand",t[t.CommandColumn=14]="CommandColumn",t[t.DetailFooterIntent=15]="DetailFooterIntent",t[t.RowDragIcon=16]="RowDragIcon",t[t.RowDragHIcon=17]="RowDragHIcon",(r=e.RenderType||(e.RenderType={}))[r.Header=0]="Header",r[r.Content=1]="Content",r[r.Summary=2]="Summary",(n=e.ToolbarItem||(e.ToolbarItem={}))[n.Add=0]="Add",n[n.Edit=1]="Edit",n[n.Update=2]="Update",n[n.Delete=3]="Delete",n[n.Cancel=4]="Cancel",n[n.Print=5]="Print",n[n.Search=6]="Search",n[n.ColumnChooser=7]="ColumnChooser",n[n.PdfExport=8]="PdfExport",n[n.ExcelExport=9]="ExcelExport",n[n.CsvExport=10]="CsvExport",n[n.WordExport=11]="WordExport",(s=e.ResponsiveDialogAction||(e.ResponsiveDialogAction={}))[s.isEdit=0]="isEdit",s[s.isAdd=1]="isAdd",s[s.isSort=2]="isSort",s[s.isFilter=3]="isFilter",(o=e.ResponsiveToolbarAction||(e.ResponsiveToolbarAction={}))[o.isInitial=0]="isInitial",o[o.isSearch=1]="isSearch";var k,A,B=function(){function e(e,t){this.dataState={isPending:!1,resolver:null,group:[]},this.foreignKeyDataState={isPending:!1,resolver:null},this.parent=e,this.serviceLocator=t,this.initDataManager(),this.parent.isDestroyed||"foreignKey"===this.getModuleName()||(this.parent.on("rows-added",this.addRows,this),this.parent.on("row-position-changed",this.reorderRows,this),this.parent.on("rows-removed",this.removeRows,this),this.parent.on("datasource-modified",this.initDataManager,this),this.parent.on(F,this.destroy,this),this.parent.on("update-data",this.crudActions,this),this.parent.on("add-delete-Action",this.getData,this),this.parent.on(E,this.refreshFilteredCols,this),this.parent.on("columns-prepared",this.refreshFilteredCols,this))}return e.prototype.reorderRows=function(e){this.dataManager.dataSource.json.splice(e.toIndex,0,this.dataManager.dataSource.json.splice(e.fromIndex,1)[0])},e.prototype.getModuleName=function(){return"data"},e.prototype.initDataManager=function(){var e=this.parent;this.dataManager=e.dataSource instanceof sf.data.DataManager?e.dataSource:sf.base.isNullOrUndefined(e.dataSource)?new sf.data.DataManager:new sf.data.DataManager(e.dataSource),!e.isAngular||e.query instanceof sf.data.Query?(this.isQueryInvokedFromData=!0,e.query=e.query instanceof sf.data.Query?e.query:new sf.data.Query):e.setProperties({query:new sf.data.Query},!0)},e.prototype.generateQuery=function(e){var t=this.parent.getQuery().clone();if("ExcludeHidden"===this.parent.columnQueryMode)t.select(this.parent.getColumns().filter((function(e){return!(!0!==e.isPrimaryKey&&!1===e.visible||void 0===e.field)})).map((function(e){return e.field})));else if("Schema"===this.parent.columnQueryMode){for(var i=[],r=this.parent.columns,n=0;n<r.length;n++)i.push(r[n].field);t.select(i)}return this.filterQuery(t),this.searchQuery(t),this.aggregateQuery(t),this.sortQuery(t),Zi(this.parent)?this.virtualGroupPageQuery(t):this.pageQuery(t,e),this.groupQuery(t),t},e.prototype.aggregateQuery=function(e){for(var t=this.parent.aggregates,i=0;i<t.length;i++)for(var r=t[i],n=0;n<r.columns.length;n++)for(var s=r.columns[n],o=s.type instanceof Array?s.type:[s.type],a=0;a<o.length;a++)e.aggregate(o[a].toLowerCase(),s.field);return e},e.prototype.virtualGroupPageQuery=function(e){if(e.queries.length)for(var t=0;t<e.queries.length;t++)"onPage"===e.queries[t].fn&&e.queries.splice(t,1);return e},e.prototype.pageQuery=function(e,t){var i=this.parent,r={query:e,skipPage:!1};if(i.notify("set-virtual-page-query",r),r.skipPage)return e;if((i.allowPaging||i.enableVirtualization||i.enableInfiniteScrolling)&&!0!==t){if(i.pageSettings.currentPage=Math.max(1,i.pageSettings.currentPage),i.pageSettings.pageCount<=0&&(i.pageSettings.pageCount=8),i.pageSettings.pageSize<=0&&(i.pageSettings.pageSize=12),e.queries.length)for(var n=0;n<e.queries.length;n++)"onPage"===e.queries[n].fn&&e.queries.splice(n,1);!sf.base.isNullOrUndefined(i.infiniteScrollModule)&&i.enableInfiniteScrolling?this.parent.notify("infinite-page-query",e):e.page(i.pageSettings.currentPage,i.pageSettings.pageSize)}return e},e.prototype.groupQuery=function(e){var t=this.parent;if(t.allowGrouping&&t.groupSettings.columns.length){this.parent.groupSettings.enableLazyLoading&&e.lazyLoad.push({key:"isLazyLoad",value:this.parent.groupSettings.enableLazyLoading});for(var i=t.groupSettings.columns,r=0,n=i.length;r<n;r++){var s=this.getColumnByField(i[r]);s||this.parent.log("initial_action",{moduleName:"group",columnName:i[r]});var o=s.enableGroupByFormat,a=s.format;o?e.group(i[r],this.formatGroupColumn.bind(this),a):e.group(i[r],null)}}return e},e.prototype.sortQuery=function(e){var t=this.parent;if((t.allowSorting||t.allowGrouping)&&t.sortSettings.columns.length){for(var i=t.sortSettings.columns,r=[],n=i.length-1;n>-1;n--){if(!(a=this.getColumnByField(i[n].field)))return this.parent.log("initial_action",{moduleName:"sort",columnName:i[n].field}),e;a.setSortDirection(i[n].direction);var s=i[n].direction;a.sortComparer&&(this.parent.log("grid_sort_comparer"),s=this.isRemote()?i[n].direction:a.sortComparer.bind(a)),-1===t.groupSettings.columns.indexOf(i[n].field)?a.isForeignColumn()||a.sortComparer?e.sortByForeignKey(a.field,s,void 0,i[n].direction.toLowerCase()):e.sortBy(a.field,s):r.push({direction:s,field:a.field})}n=0;for(var o=r.length;n<o;n++)if("string"==typeof r[n].direction)e.sortBy(r[n].field,r[n].direction);else{var a=this.getColumnByField(r[n].field);e.sortByForeignKey(r[n].field,r[n].direction,void 0,a.getSortDirection().toLowerCase())}}return e},e.prototype.searchQuery=function(e,t,i){var r=this.parent.searchSettings,n=r.fields.length?r.fields:this.getSearchColumnFieldNames(),s=[],o=!1;if(this.parent.searchSettings.key.length){o=this.parent.getForeignKeyColumns().some((function(e){return n.indexOf(e.field)>-1}));var a=i?t.dataSource.adaptor:this.dataManager.adaptor;if(o||a.getModuleName&&"ODataV4Adaptor"===a.getModuleName()){n=i?[t.foreignKeyValue]:n;for(var l=0;l<n.length;l++){var h=i?t:this.getColumnByField(n[l]);h.isForeignColumn()&&!i?s=this.fGeneratePredicate(h,s):s.push(new sf.data.Predicate(n[l],r.operator,r.key,r.ignoreCase,r.ignoreAccent))}var d=sf.data.Predicate.or(s);d.key=r.key,e.where(d)}else e.search(r.key,n,r.operator,r.ignoreCase,r.ignoreAccent)}return e},e.prototype.filterQuery=function(e,t,i){var r,n=this.parent,s=[],o=[],a=this.parent.getForeignKeyColumns();if(n.allowFiltering&&n.filterSettings.columns.length){for(var l=t||n.filterSettings.columns,h={},d=0,p=n.getColumns();d<p.length;d++){h[(m=p[d]).field]=m.filter.type?m.filter.type:n.filterSettings.type}for(var c=[],u=[],f=0,g=l;f<g.length;f++){var m=g[f],y=n.getColumnByField(m.field);sf.base.isNullOrUndefined(m.type)&&y&&("date"===y.type||"datetime"===y.type)&&(m.type=n.getColumnByField(m.field).type),m.isForeignKey?c.push(m):u.push(m)}if(u.length){for(var v=0,b=u.length;v<b;v++)u[v].uid=u[v].uid||this.parent.grabColumnByFieldFromAllCols(u[v].field).uid;for(var C=$r.getPredicate(u),w=0,S=Object.keys(C);w<S.length;w++){var x=S[w];s.push(C[x])}}if(c.length)for(var R=0,F=c;R<F.length;R++){(m=F[R]).uid=m.uid||this.parent.grabColumnByFieldFromAllCols(m.field).uid;var E=this.parent.grabColumnByUidFromAllCols(m.uid);if(E||this.parent.log("initial_action",{moduleName:"filter",columnName:m.field}),E.isForeignColumn()&&Xi(m.field,a)&&!i)o.push(m),E.columnData.length||(r=!0),s=this.fGeneratePredicate(E,s);else{C=$r.getPredicate(l);for(var I=0,T=Object.keys(C);I<T.length;I++){x=T[I];s.push(C[x])}}}s.length&&!r?e.where(sf.data.Predicate.and(s)):this.parent.notify("showEmptyGrid",{})}return e},e.prototype.fGeneratePredicate=function(e,t){var i={};return e&&(this.parent.notify("generateQuery",{predicate:i,column:e}),i.predicate.predicates.length&&t.push(i.predicate)),t},e.prototype.getData=function(e,t){var i=this;void 0===e&&(e={requestType:""});var r=this.getKey(e.foreignKeyData&&Object.keys(e.foreignKeyData).length?e.foreignKeyData:this.parent.getPrimaryKeyFieldNames());if(this.parent.log("datasource_syntax_mismatch",{dataState:this.parent}),this.parent.dataSource&&"result"in this.parent.dataSource)return this.eventPromise(e,t,r).promise;var n=void 0;switch(e.requestType){case"delete":if(t=t||this.generateQuery(),1===Object.keys(e.data).length)n=this.dataManager.remove(r,e.data[0],t.fromTable,t);else{var s={addedRecords:[],deletedRecords:[],changedRecords:[]};s.deletedRecords=e.data,n=this.dataManager.saveChanges(s,r,t.fromTable,t.requiresCount())}break;case"save":t=t||this.generateQuery(),e.index=sf.base.isNullOrUndefined(e.index)?0:e.index,n=this.dataManager.insert(e.data,t.fromTable,t,e.index)}return e.promise=n,!n||Array.isArray(n)||n.hasOwnProperty("deletedRecords")?this.insert(t,e):n.then((function(){return i.insert(t,e)}))},e.prototype.insert=function(e,t){return"save"===t.requestType&&this.parent.notify("recordAdded",t),this.executeQuery(e)},e.prototype.executeQuery=function(e){var t=this;if(this.dataManager.ready){var i=new sf.data.Deferred;return this.dataManager.ready.then((function(){t.dataManager.executeQuery(e).then((function(e){i.resolve(e)}))})).catch((function(e){i.reject(e)})),i.promise}return this.dataManager.executeQuery(e)},e.prototype.formatGroupColumn=function(e,t){var r=this.serviceLocator,n=this.getColumnByField(t),s=e;return n.type||(n.type=s.getDay?s.getHours()>0||s.getMinutes()>0||s.getSeconds()>0||s.getMilliseconds()>0?"datetime":"date":i(e)),sf.base.isNullOrUndefined(n.getFormatter())&&Li(r,n),a.prototype.toView(e,n.getFormatter())},e.prototype.crudActions=function(e){var t=this.generateQuery(),i=null,r="promise",n=this.getKey(e.foreignKeyData&&Object.keys(e.foreignKeyData).length?e.foreignKeyData:this.parent.getPrimaryKeyFieldNames());switch(this.parent.dataSource&&"result"in this.parent.dataSource&&this.eventPromise(e,t,n),e.requestType){case"save":i=this.dataManager.update(n,e.data,t.fromTable,t,e.previousData)}e[r]=i||e[r],this.parent.notify("crud-Action",e)},e.prototype.saveChanges=function(e,t,i,r){if(void 0===r&&(r=this.generateQuery()),r.requiresCount(),"result"in this.parent.dataSource){var n=new sf.data.Deferred,s={requestType:"batchsave",changes:e,key:t,query:r,endEdit:n.resolve};return this.setState({isPending:!0,resolver:n.resolve}),this.parent.trigger("dataSourceChanged",s),n.promise}return this.dataManager.saveChanges(e,t,r.fromTable,r,i)},e.prototype.getKey=function(e){if(e&&e.length)return e[0]},e.prototype.isRemote=function(){return!0!==this.dataManager.dataSource.offline&&void 0!==this.dataManager.dataSource.url&&""!==this.dataManager.dataSource.url},e.prototype.addRows=function(e){for(var t=e.records.length;t>0;t--)this.dataManager.dataSource.json.splice(e.toIndex,0,e.records[t-1])},e.prototype.removeRows=function(e){var t=this.dataManager.dataSource.json;this.dataManager.dataSource.json=t.filter((function(t){return-1===e.records.indexOf(t)}))},e.prototype.getColumnByField=function(e){var t;return this.parent.columnModel.some((function(i){return t=i,i.field===e}))&&t},e.prototype.destroy=function(){this.parent.isDestroyed||(this.parent.off("rows-added",this.addRows),this.parent.off("rows-removed",this.removeRows),this.parent.off("datasource-modified",this.initDataManager),this.parent.off(F,this.destroy),this.parent.off("update-data",this.crudActions),this.parent.off("add-delete-Action",this.getData),this.parent.off(E,this.refreshFilteredCols),this.parent.off("columns-prepared",this.refreshFilteredCols))},e.prototype.getState=function(){return this.dataState},e.prototype.setState=function(e){return this.dataState=e},e.prototype.getForeignKeyDataState=function(){return this.foreignKeyDataState},e.prototype.setForeignKeyDataState=function(e){this.foreignKeyDataState=e},e.prototype.getStateEventArgument=function(e){var t=new sf.data.UrlAdaptor,i=new sf.data.DataManager({url:"",adaptor:new sf.data.UrlAdaptor}),r=t.processQuery(i,e),n=JSON.parse(r.data);return sf.base.extend(n,r.pvtData)},e.prototype.eventPromise=function(e,t,i){var r=this,n=e,s=this.getStateEventArgument(t),o=new sf.data.Deferred,a=new sf.data.Deferred;if(void 0!==e.requestType&&!1!==this.dataState.isDataChanged)if(s.action=e,"save"===e.requestType||"delete"===e.requestType){var l=e;l.key=i;l.promise=a.promise,l.state=s,this.setState({isPending:!0,resolver:a.resolve}),n.endEdit=a.resolve,n.cancelEdit=a.reject,this.parent.trigger("dataSourceChanged",l),a.promise.then((function(){r.setState({isPending:!0,resolver:o.resolve,group:s.group,aggregates:s.aggregates}),"save"===l.requestType&&r.parent.notify("recordAdded",l),r.parent.trigger("dataStateChange",s)})).catch((function(){}))}else this.setState({isPending:!0,resolver:o.resolve,group:s.group,aggregates:s.aggregates}),this.parent.trigger("dataStateChange",s);else this.setState({}),o.resolve(this.parent.dataSource);return o},e.prototype.getSearchColumnFieldNames=function(){for(var e=[],t=0,i=this.parent.getColumns();t<i.length;t++){var r=i[t];r.allowSearching&&!sf.base.isNullOrUndefined(r.field)&&e.push(r.field)}return e},e.prototype.refreshFilteredCols=function(){this.parent.allowFiltering&&this.parent.filterSettings.columns.length&&ar(this.parent,this.parent.filterSettings.columns)},e}(),N=function(){function e(e,t){sf.base.merge(this,e),this.parent=t}return e.prototype.clone=function(){var t=new e({});return sf.base.merge(t,this),t.cells=this.cells.map((function(e){return e.clone()})),t},e.prototype.setRowValue=function(e){if(this.parent){var t=this.data[this.parent.getPrimaryKeyFieldNames()[0]];this.parent.setRowData(t,e)}},e.prototype.setCellValue=function(e,t){if(this.parent&&!(this.data[e].toString()===t.toString())){var i=this.parent.getPrimaryKeyFieldNames()[0],r=this.data[i];this.parent.setCellValue(r,e,t),this.makechanges(i,this.data)}},e.prototype.makechanges=function(e,t){this.parent&&this.parent.getDataModule().dataManager.update(e,t)},e}(),P=function(){function e(e){this.isSpanned=!1,this.isRowSpanned=!1,sf.base.merge(this,e)}return e.prototype.clone=function(){var t=new e({});return sf.base.merge(t,this),t},e}(),L=function(){function t(e,t){this.serviceLocator=e,this.parent=t}return t.prototype.render=function(t,i,r,n){var s,o=this.serviceLocator.getService("cellRendererFactory").getCellRenderer(i.cells[r].cellType||e.CellType.Data),a=i.cells[r].cellSpan?i.cells[r].cellSpan:t.colSpan+r<=i.cells.length?t.colSpan:i.cells.length-r,l=t.rowSpan,h=0;if(i.index>0){var d=this.parent.groupSettings.columns.length>0&&!this.parent.getRowsObject()[i.index-1].isDataRow?this.parent.getRowsObject()[i.index].cells:this.parent.getRowsObject()[i.index-1].cells,p=i.cells[r];s=d.filter((function(e){return e.column.uid===p.column.uid}))[0]}for(var c=s&&s.colSpanRange>1&&s.rowSpanRange>1?s.colSpanRange:a,u=r+1;u<r+c&&u<i.cells.length;u++)!1===i.cells[u].visible?h++:i.cells[u].isSpanned=!0;if(h>0){for(u=r+a;u<r+a+h&&u<i.cells.length;u++)i.cells[u].isSpanned=!0;r+a+h>=i.cells.length&&(a-=r+a+h-i.cells.length)}return i.cells[r].cellSpan&&(i.data[t.column.field]=i.cells[r].spanText,n=o.render(i.cells[r],i.data,{index:sf.base.isNullOrUndefined(i.index)?"":i.index.toString()})),a>1&&sf.base.attributes(n,{colSpan:a.toString(),"aria-colSpan":a.toString()}),l>1&&(sf.base.attributes(n,{rowspan:l.toString(),"aria-rowspan":l.toString()}),i.cells[r].isRowSpanned=!0,i.cells[r].rowSpanRange=Number(l),a>1&&(i.cells[r].colSpanRange=Number(a))),i.index>0&&s.rowSpanRange>1&&(i.cells[r].isSpanned=!0,i.cells[r].rowSpanRange=Number(s.rowSpanRange-1),i.cells[r].colSpanRange=s.rowSpanRange>0?s.colSpanRange:1),!this.parent.enableColumnVirtualization||i.cells[r].cellSpan||this.containsKey(t.column.field,t.data[t.column.field])||this.backupMergeCells(t.column.field,t.data[t.column.field],t.colSpan),n},t.prototype.backupMergeCells=function(e,t,i){this.setMergeCells(this.generteKey(e,t),i)},t.prototype.generteKey=function(e,t){return e+"__"+t.toString()},t.prototype.splitKey=function(e){return e.split("__")},t.prototype.containsKey=function(e,t){return this.getMergeCells().hasOwnProperty(this.generteKey(e,t))},t.prototype.getMergeCells=function(){return this.parent.mergeCells},t.prototype.setMergeCells=function(e,t){this.parent.mergeCells[e]=t},t.prototype.updateVirtualCells=function(e){for(var t=this.getMergeCells(),i=0,r=Object.keys(t);i<r.length;i++){var n=r[i],s=t[n],o=this.splitKey(n),a=this.getIndexFromAllColumns(o[0]),l=this.parent.getColumnIndexesInView(),h=s-(l[0]-a);if(a<l[0]&&h>1)for(var d=0,p=e;d<p.length;d++){var c=p[d];if(c.data[o[0]].toString()===o[1].toString()){c.cells[0].cellSpan=h,c.cells[0].spanText=o[1];break}}}return e},t.prototype.getIndexFromAllColumns=function(e){return li(this.parent.getVisibleColumns(),(function(t,i){if(t.field===e)return i}))[0]},t}(),q="e-rowcell",H="e-gridheader",U="e-gridcontent",j="e-gridfooter",V="e-headercontent",G="e-movablecontent",_="e-movableheader",W="e-frozencontent",K="e-frozenheader",Q="e-content",X="e-table",Y="e-row",J="e-gridchkbox",Z="e-editedrow",$="e-addedrow",ee="Left-Right",te="frozen-right",ie="frozen-left",re="aria-colindex",ne="aria-rowindex",se="tbody",oe="colgroup",ae="open",le=function(){function t(e,t,i){this.isSpan=!1,this.cellType=t,this.serviceLocator=e,this.parent=i,this.element=this.parent.createElement("tr",{attrs:{role:"row"}})}return t.prototype.render=function(e,t,i,r,n){return this.refreshRow(e,t,i,r,n)},t.prototype.refresh=function(e,t,i,r,n){i&&(e.data=rr({},e.changes),this.refreshMergeCells(e));var s=this.parent.element.querySelector("[data-uid="+e.uid+"]"),o=this.refreshRow(e,t,r,n,null,i),a=[].slice.call(o.cells);s.innerHTML="";for(var l=0,h=a;l<h.length;l++){var d=h[l];s.appendChild(d)}},t.prototype.refreshRow=function(t,i,r,n,s,o){var a=sf.base.isNullOrUndefined(s)?this.element.cloneNode():s,l={data:t.data},h={data:t.data},d=this.parent.getColumns().filter((function(e){return"checkbox"===e.type&&e.field}))[0],p=!1;d&&(p=$i(d.field,l.data));var c=this.parent.getSelectedRowIndexes();t.isDataRow&&(t.isSelected=c.indexOf(t.index)>-1||p),t.isDataRow&&this.parent.isCheckBoxSelection&&"Check"===this.parent.checkAllRows&&this.parent.enableVirtualization&&(t.isSelected=!0,-1===c.indexOf(t.index)&&c.push(t.index)),this.buildAttributeFromRow(a,t),sf.base.attributes(a,sf.base.extend({},r,{})),pi(a,t.attributes);for(var u=this.serviceLocator.getService("cellRendererFactory"),f=function(i,r){var n=t.cells[i];n.isSelected=t.isSelected,n.isColumnSelected=n.column.isSelected;var s=u.getCellRenderer(t.cells[i].cellType||e.CellType.Data),l={index:sf.base.isNullOrUndefined(t.index)?"":t.index.toString()};t.isExpand&&t.cells[i].cellType===e.CellType.DetailExpand&&(l.class=g.parent.isPrinting?"e-detailrowcollapse":"e-detailrowexpand");var d=s.render(t.cells[i],t.data,l,t.isExpand,o);if(t.cells[i].cellType!==e.CellType.Filter){if(t.cells[i].cellType===e.CellType.Data||t.cells[i].cellType===e.CellType.CommandColumn){g.parent.trigger("queryCellInfo",sf.base.extend(h,{cell:d,column:n.column,colSpan:1,rowSpan:1,foreignKeyData:t.cells[i].foreignKeyData,requestType:g.parent.requestTypeAction}));var p=!1;if(t.index>0&&g.isSpan){var c=g.parent.groupSettings.columns.length>0&&!g.parent.getRowsObject()[t.index-1].isDataRow?g.parent.getRowsObject()[t.index].cells:g.parent.getRowsObject()[t.index-1].cells,f=c.filter((function(e){return e.column.uid===t.cells[i].column.uid}))[0];p=f.isRowSpanned?f.isRowSpanned:f.rowSpanRange>1}if(h.colSpan>1||t.cells[i].cellSpan>1||h.rowSpan>1||p)g.isSpan=!0,d=new L(g.serviceLocator,g.parent).render(h,t,i,d)}t.cells[i].isSpanned||a.appendChild(d)}},g=this,m=0,y=t.cells.length;m<y;m++)f(m);var v={row:a,rowHeight:this.parent.rowHeight};if(t.isDataRow&&(this.parent.trigger("rowDataBound",sf.base.extend(l,v)),this.parent.childGrid||this.parent.isRowDragable()||this.parent.detailTemplate)){var b=a.querySelectorAll(".e-rowcell:not(.e-hide)")[0];b&&b.classList.add("e-detailrowvisible")}if(this.parent.enableVirtualization&&(l.rowHeight=this.parent.rowHeight),l.rowHeight?a.style.height=l.rowHeight+"px":this.parent.rowHeight&&(a.querySelector(".e-headercell")||a.querySelector(".e-groupcaption"))&&(a.style.height=this.parent.rowHeight+"px"),t.cssClass&&a.classList.add(t.cssClass),t.lazyLoadCssClass&&a.classList.add(t.lazyLoadCssClass),!(this.parent.enableColumnVirtualization&&0!==this.parent.frozenColumns)&&this.parent.element.scrollHeight>this.parent.height&&this.parent.aggregates.length)for(m=0;m<this.parent.aggregates.length;m++){if(this.parent.aggregates[m].properties.columns[0].footerTemplate){var C=[].slice.call(a.getElementsByClassName("e-summarycell"));if(C.length){var w=C[C.length-1];sf.base.addClass([w],["e-lastsummarycell"]);var S=C[0];sf.base.addClass([S],["e-firstsummarycell"])}}}return a},t.prototype.refreshMergeCells=function(e){for(var t=0,i=e.cells;t<i.length;t++){i[t].isSpanned=!1}return e},t.prototype.buildAttributeFromRow=function(e,t){var i={},r=ne,n="data-uid",s="aria-selected",o=[];t.isDataRow&&o.push(Y),t.isAltRow&&o.push("e-altrow"),sf.base.isNullOrUndefined(t.index)||(i[r]=t.index),t.rowSpan&&(i.rowSpan=t.rowSpan),t.uid&&(i[n]=t.uid),t.isSelected&&(i[s]=!0),!1===t.visible&&o.push("e-hide"),i.class=o,pi(e,i)},t}(),he=function(){function t(e){this.parent=e}return t.prototype.generateRows=function(e,t){var i=[],r=this.parent.enableVirtualization&&t?t.startIndex:0;r=this.parent.enableInfiniteScrolling&&t?this.getInfiniteIndex(t):r;for(var n=0,s=Object.keys(e).length;n<s;n++,r++)i[n]=this.generateRow(e[n],r);return i},t.prototype.ensureColumns=function(){var t=[];if(this.parent.detailTemplate||this.parent.childGrid){var i={};this.parent.notify("detail-indentcell-info",i),t.push(this.generateCell(i,null,e.CellType.DetailExpand))}return this.parent.isRowDragable()&&t.push(this.generateCell({},null,e.CellType.RowDragIcon)),t},t.prototype.generateRow=function(e,t,i,r,n,s,o){var a={foreignKeyData:{}};a.uid=Ri("grid-row"),a.data=e,a.index=t,a.indent=r,a.tIndex=s,a.isDataRow=!0,a.parentGid=n,a.parentUid=o,this.parent.isPrinting&&("All"===this.parent.hierarchyPrintMode?a.isExpand=!0:"Expanded"===this.parent.hierarchyPrintMode&&this.parent.expandedRows&&this.parent.expandedRows[t]&&(a.isExpand=this.parent.expandedRows[t].isExpand)),a.cssClass=i,a.isAltRow=!!this.parent.enableAltRow&&t%2!=0,a.isAltRow=!!this.parent.enableAltRow&&t%2!=0,a.isSelected=this.parent.getSelectedRowIndexes().indexOf(t)>-1,this.refreshForeignKeyRow(a);var l=this.ensureColumns(),h=new N(a,this.parent);return h.cells="Right"===this.parent.getFrozenMode()?this.generateCells(a).concat(l):l.concat(this.generateCells(a)),h},t.prototype.refreshForeignKeyRow=function(e){for(var t=this.parent.getForeignKeyColumns(),i=0;i<t.length;i++)sf.base.setValue(t[i].field,Qi(t[i],e.data),e.foreignKeyData)},t.prototype.generateCells=function(t){for(var i=this.parent.getColumns(),r=[],n=0;n<i.length;n++)r.push(this.generateCell(i[n],t.uid,sf.base.isNullOrUndefined(i[n].commands)?void 0:e.CellType.CommandColumn,null,n,t.foreignKeyData));return r},t.prototype.generateCell=function(t,i,r,n,s,o){var a={visible:t.visible,isDataCell:!sf.base.isNullOrUndefined(t.field||t.template),isTemplate:!sf.base.isNullOrUndefined(t.template),rowID:i,column:t,cellType:sf.base.isNullOrUndefined(r)?e.CellType.Data:r,colSpan:n,commands:t.commands,isForeignKey:t.isForeignColumn&&t.isForeignColumn(),foreignKeyData:t.isForeignColumn&&t.isForeignColumn()&&sf.base.getValue(t.field,o)};return(a.isDataCell||"checkbox"===a.column.type||a.commands)&&(a.index=s),new P(a)},t.prototype.refreshRows=function(e){for(var t=0;t<e.length;t++)this.refreshForeignKeyRow(e[t]),e[t].cells=this.generateCells(e[t]);return e},t.prototype.getInfiniteIndex=function(e){return"infiniteScroll"===e.requestType||"delete"===e.requestType||"add"===e.action?e.startIndex:0},t}(),de=(k=function(e,t){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}k(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),pe=function(){function t(e){this.parent=e}return t.prototype.getData=function(){for(var e=this,t=[],i=this.parent.aggregates.slice(),r=0;r<i.length;r++){var n=i[r].columns.filter((function(t){return!(t.footerTemplate||t.groupFooterTemplate||t.groupCaptionTemplate)||e.columnSelector(t)}));n.length&&t.push({columns:n})}return t},t.prototype.columnSelector=function(e){return void 0!==e.footerTemplate},t.prototype.getColumns=function(e,t){var i=[];if(this.parent.allowGrouping)for(var r=0;r<this.parent.groupSettings.columns.length;r++)i.push(new h({}));return!this.parent.detailTemplate&&sf.base.isNullOrUndefined(this.parent.childGrid)||i.push(new h({})),this.parent.isRowDragable()&&!e&&i.push(new h({})),i.push.apply(i,this.parent.getColumns()),t=t&&!e?t+this.parent.getIndentCount():t,sf.base.isNullOrUndefined(e)?i:i.slice(e,t)},t.prototype.generateRows=function(e,t,i,r,n){if(0===e.length&&(void 0===t||!t.count))return[];for(var s=this.buildSummaryData(e,t),o=[],a=this.getData(),l=0;l<a.length;l++)o.push(this.getGeneratedRow(a[l],s[l],t?t.level:void 0,i,r,t?t.parentUid:void 0,n));return o},t.prototype.getGeneratedRow=function(t,i,r,n,s,o,a){var l=[],h=this.getIndentByLevel(),d=!sf.base.isNullOrUndefined(this.parent.childGrid),p=n?0:this.parent.getIndentCount();this.parent.isRowDragable()&&!n&&(h=["e-indentcelltop"]);for(var c=a||this.getColumns(n,s),u=0;u<c.length;u++)l.push(this.getGeneratedCell(c[u],t,u>=p?this.getCellType():u<this.parent.groupSettings.columns.length?e.CellType.Indent:e.CellType.DetailFooterIntent,h[u],d));var f=new N({data:i,attributes:{class:"e-summaryrow"}});return f.cells=l,f.uid=Ri("grid-row"),f.parentUid=o,f.visible=l.some((function(e){return e.isDataCell&&e.visible})),f},t.prototype.getGeneratedCell=function(e,t,i,r,n){var s=t.columns.filter((function(t){return t.columnName===e.field}))[0],o={style:{textAlign:e.textAlign},"e-mappinguid":e.uid,index:e.index};r&&(o.class=r),sf.base.isNullOrUndefined(r)&&n&&(o.class="e-detailindentcelltop");var a={visible:e.visible,isDataCell:!sf.base.isNullOrUndefined(s),isTemplate:s&&!sf.base.isNullOrUndefined(s.footerTemplate||s.groupFooterTemplate||s.groupCaptionTemplate),column:s||{},attributes:o,cellType:i};return a.column.headerText=e.headerText,new P(a)},t.prototype.buildSummaryData=function(e,t){for(var i=[],r=this.getData(),n={},s=0;s<r.length;s++){n={};for(var o=r[s].columns,a=0;a<o.length;a++)n=this.setTemplate(o[a],t&&t.aggregates?t:e,n);i.push(n)}return i},t.prototype.getIndentByLevel=function(){return this.parent.groupSettings.columns.map((function(){return"e-indentcelltop"}))},t.prototype.setTemplate=function(e,t,i){var r=e.type,n={},s=e.getFormatter()||function(e){return e},o=t;r instanceof Array||(r=[e.type]);for(var a=0;a<r.length;a++){var l=e.field+" - "+r[a].toLowerCase(),h=e.columnName,d="Custom"!==r[a]&&o.aggregates&&l in o.aggregates?o.aggregates[l]:Ii(r[a],o.aggregates?o:t,e,this.parent);i[h]=i[h]||{},i[h][l]=d,i[h][r[a]]=sf.base.isNullOrUndefined(d)?" ":s(d),o.field&&(i[h].field=o.field,i[h].key=o.key)}return n.format=e.getFormatter(),e.setTemplate(n),i},t.prototype.getCellType=function(){return e.CellType.Summary},t}(),ce=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return de(i,t),i.prototype.columnSelector=function(e){return void 0!==e.groupFooterTemplate},i.prototype.getIndentByLevel=function(e){return void 0===e&&(e=this.parent.groupSettings.columns.length),this.parent.groupSettings.columns.map((function(t,i){return i<=e-1?"":"e-indentcelltop"}))},i.prototype.getCellType=function(){return e.CellType.GroupSummary},i}(pe),ue=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return de(i,t),i.prototype.columnSelector=function(e){return void 0!==e.groupCaptionTemplate},i.prototype.getData=function(){return[t.prototype.getData.call(this).reduce((function(e,t){return e.columns=e.columns.concat(t.columns),e}),{columns:[]})]},i.prototype.isEmpty=function(){return 0===(this.getData()[0].columns||[]).length},i.prototype.getCellType=function(){return e.CellType.CaptionSummary},i}(pe),fe=(A=function(e,t){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}A(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ge=function(t){function i(e){var i=t.call(this,e)||this;return i.rows=[],i.index=0,i.infiniteChildCount=0,i.renderInfiniteAgg=!0,i.parent=e,i.summaryModelGen=new ce(e),i.captionModelGen=new ue(e),i}return fe(i,t),i.prototype.generateRows=function(e,i){if(0===this.parent.groupSettings.columns.length)return t.prototype.generateRows.call(this,e,i);this.isInfiniteScroll="infiniteScroll"===i.requestType,this.rows=[],this.index=this.parent.enableVirtualization||this.isInfiniteScroll?i.startIndex:0;for(var r=0,n=e.length;r<n;r++)this.infiniteChildCount=0,this.renderInfiniteAgg=!0,this.getGroupedRecords(0,e[r],e.level,r,void 0,this.rows.length);return this.index=0,this.parent.isCollapseStateEnabled()&&this.ensureRowVisibility(),this.rows},i.prototype.getGroupedRecords=function(e,t,i,r,n,s,o){var a,l=i;if(sf.base.isNullOrUndefined(t.items))if(sf.base.isNullOrUndefined(t.GroupGuid))this.rows=this.rows.concat(this.generateDataRows(t,e,r,this.rows.length,o));else for(var h=0,d=t.length;h<d;h++)this.getGroupedRecords(e,t[h],t.level,r,e,this.rows.length,o);else{var p=void 0,c=this.generateCaptionRow(t,e,r,n,s,o);if(this.isInfiniteScroll&&(p=this.getPreCaption(e,c.data.key)),p?c.uid=p.uid:this.rows=this.rows.concat(c),t.items&&t.items.length&&this.getGroupedRecords(e+1,t.items,t.items.level,r,e+1,this.rows.length,c.uid),this.parent.aggregates.length&&this.isRenderAggregate(c)){var u=this.rows.length;(a=this.rows).push.apply(a,this.summaryModelGen.generateRows(t,{level:l,parentUid:c.uid}));for(var f=u-1;f>=0;f--)if(this.rows[f].isCaptionRow)this.rows[f].aggregatesCount=this.rows.length-u;else if(!this.rows[f].isCaptionRow&&!this.rows[f].isDataRow)break}p&&this.setInfiniteRowVisibility(p)}},i.prototype.isRenderAggregate=function(e){return this.parent.enableInfiniteScrolling?!!this.renderInfiniteAgg&&(this.getPreCaption(e.indent,e.data.key),this.renderInfiniteAgg=e.data.count===this.infiniteChildCount,this.renderInfiniteAgg):!this.parent.enableInfiniteScrolling},i.prototype.getPreCaption=function(e,t){var i,r=this.parent.getRowsObject().concat(this.rows);this.infiniteChildCount=0;for(var n=r.length;n--&&(r[n].isCaptionRow&&r[n].indent===e&&r[n].data.key===t&&(i=r[n]),!(r[n].indent===e||r[n].indent<e));)r[n].indent===e+1&&this.infiniteChildCount++;return i},i.prototype.getCaptionRowCells=function(t,i,r){var n=[],s=[],o=this.parent.getColumnByField(t),a=this.parent.getColumnIndexesInView();this.parent.enableColumnVirtualization&&(o=this.parent.columns.filter((function(e){return e.field===t}))[0]);var l=this.parent.groupSettings.columns.length,h=this.parent;if(!this.parent.enableColumnVirtualization||-1!==a.indexOf(i)){for(var d=0;d<i;d++)n.push(this.generateIndentCell());n.push(this.generateCell({},null,e.CellType.Expand))}if(i=this.parent.enableColumnVirtualization?1:this.parent.getVisibleColumns().length+l+(h.detailTemplate||h.childGrid?1:0)-i+(this.parent.getVisibleColumns().length?-1:0),this.parent.aggregates.length&&!this.captionModelGen.isEmpty()){var p=this.captionModelGen.generateRows(r)[0];sf.base.extend(r,p.data);var c=0;p.cells.some((function(e,t){return c=t,e.visible&&e.isDataCell})),s=p.cells.slice(c).filter((function(e){return e.visible})),p.visible&&s[0].column.field===this.parent.getVisibleColumns()[0].field&&(s=s.slice(1)),1===this.parent.getVisibleColumns().length&&(s=[]),i-=s.length}for(var u=this.parent.enableColumnVirtualization?this.parent.getColumns():[o],f=!0,g=0;g<u.length;g++){var m=f&&-1!==a.indexOf(i);m&&(f=!1);var y=!this.parent.enableColumnVirtualization||m?e.CellType.GroupCaption:e.CellType.GroupCaptionEmpty;i=this.parent.enableColumnVirtualization&&y===e.CellType.GroupCaption?i+l:i,h.isRowDragable()&&i++,n.push(this.generateCell(o,null,y,i))}return n.push.apply(n,s),n},i.prototype.generateCaptionRow=function(e,t,i,r,n,s){var o={},a=this.parent.getColumnByField(e.field);o.data=sf.base.extend({},e),a&&(o.data.field=e.field),o.isDataRow=!1,o.isExpand=!this.parent.groupSettings.enableLazyLoading&&!this.parent.isCollapseStateEnabled(),o.parentGid=i,o.childGid=r,o.tIndex=n,o.isCaptionRow=!0,o.parentUid=s,o.gSummary=sf.base.isNullOrUndefined(e.items.records)?e.items.length:e.items.records.length,o.uid=Ri("grid-row");var l=new N(o);return l.indent=t,this.getForeignKeyData(l),l.cells=this.getCaptionRowCells(e.field,t,l.data),l},i.prototype.getForeignKeyData=function(e){var t=e.data,i=this.parent.getColumnByField(t.field);if(i&&i.isForeignColumn&&i.isForeignColumn()){var r=sf.base.isNullOrUndefined(t.key)?"":i.valueAccessor(i.foreignKeyValue,Qi(i,{},t.key)[0],i);sf.base.setValue("foreignKey",r,e.data)}},i.prototype.generateDataRows=function(e,t,i,r,n){for(var s=[],o=this.parent.getColumnIndexesInView(),a=0,l=e.length;a<l;a++,r++){s[a]=this.generateRow(e[a],this.index,a?void 0:"e-firstchildrow",t,i,r,n);for(var h=0;h<t;h++)this.parent.enableColumnVirtualization&&-1===o.indexOf(t)||s[a].cells.unshift(this.generateIndentCell());this.index++}return s},i.prototype.generateIndentCell=function(){return this.generateCell({},null,e.CellType.Indent)},i.prototype.refreshRows=function(e){for(var t=this.parent.getColumnIndexesInView(),i=0;i<e.length;i++)if(e[i].isDataRow){e[i].cells=this.generateCells(e[i]);for(var r=0;r<e[i].indent;r++)this.parent.enableColumnVirtualization&&-1===t.indexOf(e[i].indent)||e[i].cells.unshift(this.generateIndentCell())}else{var n=this.generateCaptionRow(e[i].data,e[i].indent);e[i].cells=n.cells}return e},i.prototype.setInfiniteRowVisibility=function(e){if(!e.isExpand||!1===e.visible)for(var t=0,i=this.rows;t<i.length;t++){var r=i[t];r.parentUid===e.uid&&(r.visible=!1,r.isCaptionRow&&this.setInfiniteRowVisibility(r))}},i.prototype.ensureRowVisibility=function(){for(var e=0;e<this.rows.length;e++){var t=this.rows[e];if(t.isCaptionRow)for(var i=e+1;i<this.rows.length;i++){var r=this.rows[i];t.uid===r.parentUid&&(this.rows[i].visible=t.isExpand)}}},i}(he),me=function(){function e(e,t){var i=this;this.rows=[],this.freezeRows=[],this.movableRows=[],this.freezeRowElements=[],this.currentInfo={},this.prevCurrentView=[],this.isLoaded=!0,this.viewColIndexes=[],this.drop=function(e){i.parent.notify("columnDrop",{target:e.target,droppedElement:e.droppedElement}),sf.base.remove(e.droppedElement)},this.infiniteCache={},this.isRemove=!1,this.visibleRows=[],this.visibleFrozenRows=[],this.rightFreezeRows=[],this.isAddRows=!1,this.isInfiniteFreeze=!1,this.useGroupCache=!1,this.rafCallback=function(e){var t=e;return function(){if(i.parent.isFrozenGrid()&&i.parent.enableVirtualization){var r=e.tableName;if(i.isLoaded=i.parent.getFrozenMode()===ee?"frozen-right"===r:"movable"===r,i.parent.enableColumnVirtualization&&"virtualscroll"===e.requestType&&i.isLoaded){var n=[].slice.call(i.parent.getMovableVirtualHeader().getElementsByClassName(Y)),s=[].slice.call(i.parent.getFrozenVirtualHeader().getElementsByClassName(Y));i.isLoaded=n.length===s.length}}if(i.ariaService.setBusy(i.getPanel().querySelector("."+Q),!1),!i.parent.isDestroyed){var o=i.rows.slice(0);if(i.parent.enableInfiniteScrolling){o=i.parent.getRowsObject();var a=t.prevPage;if(i.parent.infiniteScrollSettings.enableCache&&a){var l=i.parent.infiniteScrollSettings.maxBlocks;o=[];for(var h=parseInt(i.rowElements[0].getAttribute("aria-rowindex"),10)+1,d=0,p=Math.ceil(h/i.parent.pageSettings.pageSize);d<l;d++,p++)i.infiniteCache[p]&&(o=o.concat(i.infiniteCache[p]))}}if(i.parent.isFrozenGrid()&&(o=e.isFrozen?i.freezeRows:e.renderFrozenRightContent?i.parent.getFrozenRightRowsObject():i.movableRows),i.parent.notify(y,{rows:o,args:t}),i.isLoaded&&(i.parent.isManualRefresh=!1,i.parent.trigger(u,{},(function(){i.parent.allowTextWrap&&i.parent.notify("freezerender",{case:"textwrap"})}))),t){var f=(t.requestType||"").toLowerCase()+"-complete";i.parent.notify(f,t),"batchsave"===e.requestType&&(e.cancel=!1,i.parent.trigger(c,e))}i.isLoaded&&i.parent.hideSpinner()}}},this.parent=e,this.serviceLocator=t,this.ariaService=this.serviceLocator.getService("ariaService"),this.parent.enableDeepCompare=this.parent.getDataModule().isRemote(),this.generator=this.getModelGenerator(),this.parent.isDestroyed||(this.parent.enableColumnVirtualization||this.parent.enableVirtualization||this.parent.groupSettings.enableLazyLoading||this.parent.on("column-visible-changed",this.setVisible,this),this.parent.on("colgroup-refresh",this.colGroupRefresh,this),this.parent.on(v,this.enableAfterRender,this),this.parent.on("refresh-infinite-mode-blocks",this.refreshContentRows,this),this.parent.on("beforecellfocused",this.beforeCellFocused,this),this.parent.on(F,this.droppableDestroy,this))}return e.prototype.beforeCellFocused=function(e){!e.byKey||"upArrow"!==e.keyArgs.action&&"downArrow"!==e.keyArgs.action?this.pressedKey=void 0:this.pressedKey=e.keyArgs.action},e.prototype.renderPanel=function(){var e=this.parent,t=this.parent.element.querySelector("."+U);if(t)return this.ariaService.setOptions(this.parent.element.querySelector("."+Q),{busy:!1}),void this.setPanel(t);t=this.parent.createElement("div",{className:U});var i=this.parent.createElement("div",{className:Q});this.ariaService.setOptions(i,{busy:!1}),t.appendChild(i),this.setPanel(t),e.element.appendChild(t)},e.prototype.renderTable=function(){var e=this.getPanel(),t=e.querySelector(".e-virtualtable"),i=e.querySelector(".e-virtualtrack");!this.parent.enableVirtualization||sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(i)||(sf.base.remove(t),sf.base.remove(i)),e.appendChild(this.createContentTable("_content_table")),this.setTable(e.querySelector("."+X)),this.ariaService.setOptions(this.getTable(),{multiselectable:"Multiple"===this.parent.selectionSettings.type}),this.initializeContentDrop(),this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont")},e.prototype.createContentTable=function(e){var t=this.getPanel().firstElementChild;this.getTable()&&sf.base.remove(this.getTable());var i=t.querySelector("."+X)?t.querySelector("."+X):this.parent.createElement("table",{className:X,attrs:{cellspacing:"0.25px",role:"grid",id:this.parent.element.id+e}});return this.setColGroup(this.parent.getHeaderTable().querySelector(oe).cloneNode(!0)),i.appendChild(this.getColGroup()),i.appendChild(this.parent.createElement(se)),t.appendChild(i),t},e.prototype.refreshContentRows=function(e){var t=this;void 0===e&&(e={});var i=this.parent;if(0!==i.currentViewData.length){var r=this.currentMovableRows||i.currentViewData,n=this.parent.contentModule,s=i.isReact&&!sf.base.isNullOrUndefined(i.rowTemplate),o=s?i.createElement(se):document.createDocumentFragment();this.initialPageRecords||(this.initialPageRecords=sf.base.extend([],r));var a,l,h,d=s?i.createElement(se):document.createDocumentFragment(),p=i.getColumns(),c=i.getFrozenColumns(),u=this.parent.isFrozenGrid(),f=new le(this.serviceLocator,null,this.parent),g=this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.requestType;i.notify("destroy-child-grid",{}),this.rowElements=[],this.rows=[];var m,y,v,b=this.getPanel().querySelector("."+W),C=this.getPanel().querySelector("."+G),w=this.getPanel().querySelector("."+Q);Zi(i)&&["sorting","filtering","searching","grouping","ungrouping","reorder"].some((function(t){return e.requestType===t}))&&this.emptyVcRows(),this.parent.enableVirtualization&&this.parent.isFrozenGrid()?(this.parent.enableColumnVirtualization&&"virtualscroll"===e.requestType&&"X"===e.virtualInfo.sentinelInfo.axis&&(v=this.parent.contentModule.generateRows(r,e),e.renderMovableContent=!0),v=this.parent.contentModule.generateRows(r,e)):(v=this.checkCache(v,e),this.isAddRows||this.useGroupCache||(v=this.generator.generateRows(r,e))),this.setGroupCache(v,e),this.parent.notify("set-infinite-cache",{isInfiniteScroll:g,modelData:v,args:e});var S=v[0].cells[0].index;u&&(y=n.setTbody(v,e),m=n.getTbody(y));var x=this.parent.getFrozenMode()===ee&&y===te;if("infiniteScroll"!==e.requestType&&this.parent.registeredTemplate&&this.parent.registeredTemplate.template&&!e.isFrozen&&!x){for(var R=[],F=0;F<this.parent.registeredTemplate.template.length;F++)for(var E=0;E<this.parent.registeredTemplate.template[F].rootNodes.length;E++)sf.base.isNullOrUndefined(this.parent.registeredTemplate.template[F].rootNodes[E].parentNode)&&R.push(this.parent.registeredTemplate.template[F]);this.parent.destroyTemplate(["template"],R)}if((this.parent.isReact||this.parent.isVue)&&"infiniteScroll"!==e.requestType&&!e.isFrozen){var I=[this.parent.isVue?"template":"columnTemplate","rowTemplate","detailTemplate","captionTemplate","commandsTemplate","groupFooterTemplate","groupCaptionTemplate"];jr(this.parent,I)}if(this.parent.enableColumnVirtualization)new L(this.serviceLocator,this.parent).updateVirtualCells(v);u||(this.tbody=this.getTable().querySelector(se));var T=0,z=!0;if(Zi(i)&&i.vcRows.length){var D=sf.base.isNullOrUndefined(e.virtualInfo.offsets)?sf.base.isNullOrUndefined(e.scrollTop)?0:e.scrollTop.top:e.virtualInfo.offsets.top;if(0!==D){for(var M=i.vGroupOffsets,O=i.pageSettings.pageSize/2,k=Object.keys(M).map((function(e){return M[e]})),A=0;A<k.length;A++)if(D<k[A]){if(sf.base.isNullOrUndefined(e.virtualInfo)||"up"!==e.virtualInfo.direction){T=A*O,(this.parent.contentModule.isEndBlock(A)||this.parent.contentModule.isEndBlock(A+1))&&(e.virtualInfo.blockIndexes=[A,A+1]);break}T=A>0?(A-1)*O:A*O;break}Math.round(D+this.contentPanel.firstElementChild.offsetHeight)>=this.contentPanel.firstElementChild.scrollHeight&&!e.rowObject&&(z=!1)}}var B=i.frozenRows&&!i.isFrozenGrid()&&this.parent.enableVirtualization&&"reorder"===e.requestType;if(i.frozenRows&&"virtualscroll"===e.requestType&&"X"===e.virtualInfo.sentinelInfo.axis||B){var N=e.virtualInfo.blockIndexes,P=e.virtualInfo.page;e.virtualInfo.blockIndexes=[1,2],B&&(e.virtualInfo.page=1);var q=B?this.initialPageRecords:r,H=this.vgenerator.generateRows(q,e);H.splice(this.parent.frozenRows);for(F=0;F<this.parent.frozenRows;F++)H[F].cells.splice(0,this.parent.getFrozenColumns()),a=f.render(H[F],p),d.appendChild(a);e.virtualInfo.blockIndexes=N,e.virtualInfo.page=P,B&&1===e.virtualInfo.page&&v.splice(0,this.parent.frozenRows)}this.virtualFrozenHdrRefresh(d,v,f,e,r,p);F=T;for(var U=v.length;F<U;F++)if(this.rows.push(v[F]),!this.parent.groupSettings.enableLazyLoading||this.useGroupCache||!this.parent.groupSettings.columns.length||(this.setRowsInLazyGroup(v[F],F),!sf.base.isNullOrUndefined(v[F].indent))){if(this.setInfiniteVisibleRows(e,v[F],y),Zi(i)&&e.virtualInfo&&e.virtualInfo.blockIndexes&&this.rowElements.length>=e.virtualInfo.blockIndexes.length*this.parent.contentModule.getBlockSize()&&z){this.parent.currentViewData.records=this.rows.map((function(e){return e.data}));break}if(i.rowTemplate){var j=i.element.id+"rowTemplate",V=void 0;if(i.isReact){var _=i.frozenRows&&F<i.frozenRows,K=sf.base.extend({index:F},r[F]);i.getRowTemplate()(K,i,"rowTemplate",j,null,null,_?d:o),i.renderTemplates()}else V=i.getRowTemplate()(sf.base.extend({index:F},r[F]),i,"rowTemplate",j);if(i.isReact||"TBODY"!==V[0].tagName)i.frozenRows&&F<i.frozenRows?a=i.isReact?d.lastElementChild:Fi(d,V):(i.isReact||(a=Fi(o,V)),h=i.isReact?o.lastElementChild:a.lastElementChild);else{for(E=0;E<V.length;E++){var X="tr"===V[E].nodeName.toLowerCase();(X||V[E].querySelectorAll&&V[E].querySelectorAll("tr").length)&&(a=X?V[E]:V[E].querySelector("tr"))}i.frozenRows&&F<i.frozenRows?d.appendChild(a):o.appendChild(a)}var Y={data:v[F].data,row:h||a};this.parent.trigger("rowDataBound",Y)}else{a=f.render(v[F],p);var J=this.ensureFrozenHeaderRender(e);i.frozenRows&&F<i.frozenRows&&!g&&"virtualscroll"!==e.requestType&&J&&this.ensureVirtualFrozenHeaderRender(e)?d.appendChild(a):o.appendChild(a),v[F].isExpand&&i.notify("expandchildgrid",a.cells[i.groupSettings.columns.length])}v[F].isDataRow&&this.rowElements.push(a),this.ariaService.setOptions(this.getTable(),{colcount:i.getColumns().length.toString()})}if(u&&n.splitRows(y),i.frozenRows&&"virtualscroll"!==e.requestType&&!g&&this.ensureVirtualFrozenHeaderRender(e)||"virtualscroll"===e.requestType&&e.virtualInfo.sentinelInfo&&"X"===e.virtualInfo.sentinelInfo.axis)if(l=u?n.getFrozenHeader(y):i.getHeaderTable().querySelector(se),s){var Z=l.parentElement;sf.base.remove(l),Z.appendChild(d)}else l.innerHTML="",l.appendChild(d);!i.enableVirtualization&&i.frozenRows&&0===S&&w.offsetHeight===Number(i.height)&&(w.style.height=w.offsetHeight-l.offsetHeight+"px"),e.rows=this.rows.slice(0),u&&n.setIsFrozen(e,y),this.index=S,ti((function(){t.parent.notify("beforeFragAppend",e);var r=t.parent.enableVirtualization&&t.parent.isFrozenGrid();if(t.parent.enableVirtualization||g||(t.parent.isFrozenGrid()?(sf.base.remove(n.getTbody(y)),m=t.parent.createElement(se)):(t.tbody.innerHTML="",sf.base.remove(t.tbody),t.tbody=t.parent.createElement(se))),!u||r||t.parent.enableInfiniteScrolling)if(i.rowTemplate&&sf.base.updateBlazorTemplate(i.element.id+"rowTemplate","RowTemplate",i),r){if(e.renderFrozenRightContent){var s=i.getContent().querySelector(".e-frozen-right-content").querySelector(se);t.appendContent(s,o,e)}else e.renderMovableContent?(t.appendContent(C.querySelector(se),o,e),e.renderMovableContent=!1):t.appendContent(b.querySelector(se),o,e);t.parent.getFrozenColumns()||n.renderNextFrozentPart(e,y)}else!sf.base.isNullOrUndefined(t.parent.infiniteScrollModule)&&t.parent.enableInfiniteScrolling?(t.isAddRows=!1,t.parent.notify("remove-infinite-rows",{args:e}),t.parent.notify("append-infinite-content",{tbody:m||t.tbody,frag:o,args:e,rows:t.rows,rowElements:t.rowElements,visibleRows:t.visibleRows,tableName:y}),!c&&u&&((i.getFrozenMode()===ee||y!==ie&&y!==te)&&(i.getFrozenMode()!==ee||y!==ie&&"movable"!==y)||t.refreshContentRows(sf.base.extend({},e)))):(t.useGroupCache=!1,t.appendContent(t.tbody,o,e));else t.appendContent(m,o,e,y);c&&n.renderNextFrozentPart(e,y),o=null}),this.rafCallback(sf.base.extend({},e)))}},e.prototype.emptyVcRows=function(){this.parent.vcRows=[],this.parent.vRows=[]},e.prototype.appendContent=function(e,t,i,r){this.parent.isReact&&!sf.base.isNullOrUndefined(this.parent.rowTemplate)?this.getTable().appendChild(t):(e.appendChild(t),this.getTable().appendChild(e))},e.prototype.setRowsInLazyGroup=function(e,t){this.parent.groupSettings.enableLazyLoading&&!this.useGroupCache&&this.parent.groupSettings.columns.length&&this.parent.contentModule.maintainRows(e,t)},e.prototype.setGroupCache=function(e,t){!this.useGroupCache&&this.parent.groupSettings.enableLazyLoading&&this.parent.notify("group-cache",{args:t,data:e})},e.prototype.ensureFrozenHeaderRender=function(e){return!(this.parent.enableVirtualization&&("reorder"===e.requestType||"refresh"===e.requestType)||this.parent.infiniteScrollSettings.enableCache&&this.parent.frozenRows&&"delete"===this.parent.infiniteScrollModule.requestType&&1!==this.parent.pageSettings.currentPage)},e.prototype.ensureVirtualFrozenHeaderRender=function(e){return!(this.parent.enableVirtualization&&"delete"===e.requestType)},e.prototype.checkCache=function(e,t){if(this.parent.infiniteScrollSettings.enableCache&&"infiniteScroll"===t.requestType){var i=t.isFrozen?1:0,r=this.parent.isFrozenGrid();if(this.isAddRows=!sf.base.isNullOrUndefined(this.infiniteCache[this.parent.pageSettings.currentPage]),r&&!sf.base.isNullOrUndefined(this.infiniteCache[this.parent.pageSettings.currentPage])&&(this.isAddRows=0!==this.infiniteCache[this.parent.pageSettings.currentPage][i].length),this.isAddRows){var n=r?this.infiniteCache[this.parent.pageSettings.currentPage][i]:this.infiniteCache[this.parent.pageSettings.currentPage];e=1===this.parent.pageSettings.currentPage?n.slice(this.parent.frozenRows):n}return e}return this.parent.groupSettings.enableLazyLoading&&this.parent.groupSettings.columns.length&&("paging"===t.requestType||"columnstate"===t.requestType||"reorder"===t.requestType)&&this.parent.contentModule.getGroupCache()[this.parent.pageSettings.currentPage]?(this.useGroupCache=!0,this.parent.contentModule.initialGroupRows("reorder"===t.requestType)):null},e.prototype.setInfiniteVisibleRows=function(e,t,i){var r=this.parent.isFrozenGrid();this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&(r?i===ie||"Right"===this.parent.getFrozenMode()&&i===te?this.visibleFrozenRows.push(t):"movable"===i?this.visibleRows.push(t):this.rightFreezeRows.push(t):this.parent.infiniteScrollSettings.enableCache||this.visibleRows.push(t))},e.prototype.getCurrentBlockInfiniteRecords=function(e){var t=[];if(this.parent.infiniteScrollSettings.enableCache){if(!Object.keys(this.infiniteCache).length)return[];var i=this.parent.isFrozenGrid(),r=this.parent.getRows(),n=parseInt(r[this.parent.frozenRows].getAttribute(ne),10),s=Math.ceil((n+1)/this.parent.pageSettings.pageSize);n=parseInt(r[r.length-1].getAttribute(ne),10);var o=Math.ceil(n/this.parent.pageSettings.pageSize);if(i){for(var a=e?0:1,l=s;l<=o;l++)t=t.length?t.concat(this.infiniteCache[l][a]):this.infiniteCache[l][a];this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(t=this.infiniteCache[1][a].slice(0,this.parent.frozenRows).concat(t))}else{for(l=s;l<=o;l++)t=t.length?t.concat(this.infiniteCache[l]):this.infiniteCache[l];this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(t=this.infiniteCache[1].slice(0,this.parent.frozenRows).concat(t))}}return t},e.prototype.getReorderedVFRows=function(e){return this.parent.contentModule.getReorderedFrozenRows(e)},e.prototype.getReorderedRows=function(e){return this.parent.contentModule.getReorderedFrozenRows(e)},e.prototype.virtualFrozenHdrRefresh=function(e,t,i,r,n,s){if(this.parent.frozenRows&&this.parent.enableVirtualization&&("reorder"===r.requestType||"refresh"===r.requestType)){var o=void 0,a=[];this.parent.isFrozenGrid()?(this.currentMovableRows=n,a=this.getReorderedVFRows(r)):a=this.getReorderedRows(r);for(var l=0;l<a.length;l++)o=i.render(a[l],s),e.appendChild(o);1===r.virtualInfo.page&&t.splice(0,this.parent.frozenRows),r.renderMovableContent&&(this.parent.currentViewData=this.currentMovableRows,this.currentMovableRows=null)}},e.prototype.getInfiniteRows=function(){var e=[],t=this.parent.isFrozenGrid();if(this.parent.enableInfiniteScrolling)if(this.parent.infiniteScrollSettings.enableCache)for(var i=Object.keys(this.infiniteCache),r=0;r<i.length;r++)e=t?e.concat(this.infiniteCache[i[r]][0]):e.concat(this.infiniteCache[i[r]]);else e=t?this.visibleFrozenRows:this.visibleRows;return e},e.prototype.getInfiniteMovableRows=function(){var e=this.getCurrentBlockInfiniteRecords();return this.parent.enableInfiniteScrolling?e.length?e:this.visibleRows:[]},e.prototype.getPanel=function(){return this.contentPanel},e.prototype.setPanel=function(e){this.contentPanel=e},e.prototype.getTable=function(){return this.contentTable},e.prototype.setTable=function(e){this.contentTable=e},e.prototype.getRows=function(){var e=this.getInfiniteRows();return e.length?e:this.parent.getFrozenColumns()?this.freezeRows:this.rows},e.prototype.getMovableRows=function(){var e=this.getInfiniteMovableRows();return e.length?e:this.movableRows},e.prototype.getRowElements=function(){return this.parent.getFrozenColumns()?this.freezeRowElements:this.rowElements},e.prototype.getMovableRowElements=function(){return this.rowElements},e.prototype.setRowElements=function(e){this.rowElements=e},e.prototype.getColGroup=function(){return this.colgroup},e.prototype.setColGroup=function(e){return sf.base.isNullOrUndefined(e)||(e.id="content-"+e.id),this.colgroup=e},e.prototype.setVisible=function(e){var t,i=this.parent,r=this.parent.isFrozenGrid(),n=i.getFrozenColumns(),s=[];if(r){var o=this.freezeRows,a=this.movableRows,l=o.length,h=void 0,d=[];i.getFrozenMode()===ee&&(d=i.getFrozenRightRowsObject());for(var p=0,c=void 0;p<l;p++){h=a[p].cells.length;var u=d.length?d[p].cells.length:0;c=o[p].clone();for(var f=0;f<h;f++)c.cells.push(a[p].cells[f]);for(var g=0;g<u;g++)c.cells.push(d[p].cells[g]);s.push(c)}}else s=this.getRows();s.some((function(e){return e.isDataRow&&(t=e),e.isDataRow}));var m=!0;!i.groupSettings.columns.length&&t&&(m=!1);for(var y=i.getDataRows(),v=this.infiniteRowVisibility(),b=v||this.rows.filter((function(e){return!e.isDetailRow})),C=0,w=e.length;C<w;C++){var S=e[C],x=this.parent.getNormalizedColumnIndex(S.uid),R=this.parent.getColumnIndexByUid(S.uid),F=!0===S.visible?"":"none";if(-1!==x&&t&&x<t.cells.length)if(r)if("movable"!==S.getFreezeTableName())if(S.getFreezeTableName()===te){R=x-=this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount();var E=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(oe);sf.base.setStyleAttribute(E.childNodes[x],{display:F}),b=i.getFrozenRightRowsObject(),y=i.getFrozenRightDataRows()}else{sf.base.setStyleAttribute(this.getColGroup().childNodes[x],{display:F});var I=this.infiniteRowVisibility(!0);b=I||this.freezeRows,y=i.getDataRows()}else{var T=i.getContent().querySelector("."+G).querySelector(oe);R=x=x-n-this.parent.getFrozenLeftColumnsCount(),sf.base.setStyleAttribute(T.childNodes[x],{display:F}),y=i.getMovableDataRows();var z=this.infiniteRowVisibility();b=z||this.movableRows}else sf.base.setStyleAttribute(this.getColGroup().childNodes[x],{display:F});m||this.setDisplayNone(y,R,F,b),!this.parent.invokedFromMedia&&S.hideAtMedia&&this.parent.updateMediaColumns(S),this.parent.invokedFromMedia=!1}m?this.refreshContentRows({requestType:"refresh"}):this.parent.getFrozenColumns()?(this.parent.notify("partial-refresh",{rows:this.freezeRows,args:{isFrozen:!0,rows:this.freezeRows}}),this.parent.notify("partial-refresh",{rows:this.movableRows,args:{isFrozen:!1,rows:this.movableRows}})):this.parent.notify("partial-refresh",{rows:b,args:{}})},e.prototype.setDisplayNone=function(e,t,i,r){Br(e,t,i,r,this.parent,this.parent.isRowDragable()),this.parent.notify("infinite-show-hide",{visible:i,index:t,isFreeze:this.isInfiniteFreeze})},e.prototype.infiniteRowVisibility=function(e){var t;return this.parent.enableInfiniteScrolling&&(this.isInfiniteFreeze=e,t=this.parent.infiniteScrollSettings.enableCache?e?this.getCurrentBlockInfiniteRecords(!0):this.getCurrentBlockInfiniteRecords():e?this.visibleFrozenRows:this.visibleRows),t},e.prototype.colGroupRefresh=function(){if(this.getColGroup()){var e=void 0;e=this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&this.parent.contentModule.isXaxis()?this.parent.getMovableVirtualHeader().querySelector(oe).cloneNode(!0):this.getHeaderColGroup(),this.getTable().replaceChild(e,this.getColGroup()),this.setColGroup(e)}},e.prototype.getHeaderColGroup=function(){return this.parent.element.querySelector("."+H).querySelector(oe).cloneNode(!0)},e.prototype.initializeContentDrop=function(){var e=this.parent;this.droppable=new sf.base.Droppable(e.element,{accept:".e-dragclone",drop:this.drop})},e.prototype.droppableDestroy=function(){this.droppable&&!this.droppable.isDestroyed&&this.droppable.destroy()},e.prototype.canSkip=function(e,t,i){return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(e.visible)||t.cells[i].visible===e.visible},e.prototype.getModelGenerator=function(){return this.generator=this.parent.allowGrouping?new ge(this.parent):new he(this.parent)},e.prototype.renderEmpty=function(e){this.getTable().appendChild(e),this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector(se).innerHTML="")},e.prototype.setSelection=function(e,t,i){this.parent.notify("set-freeze-selection",{uid:e,set:t,clearAll:i});var r=this.parent.isFrozenGrid();if(!r||!this.parent.enableVirtualization){if(r)for(var n=this.getMovableRows().filter((function(t){return i||e===t.uid})),s=0;s<n.length;s++)n[s].isSelected=t;for(var o=this.getRows().filter((function(t){return i||e===t.uid})),a=0;a<o.length;a++){o[a].isSelected=t;for(var l=o[a].cells,h=0;h<l.length;h++)l[h].isSelected=t}}},e.prototype.getRowByIndex=function(e){return e=this.getInfiniteRowIndex(e),this.parent.getDataRows()[e]},e.prototype.getInfiniteRowIndex=function(e){if(this.parent.infiniteScrollSettings.enableCache){var t=this.parent.frozenRows,i=t>e?0:t,r=parseInt(this.parent.getRows()[i].getAttribute(ne),10);e=t>e?e:e-r+t}return e},e.prototype.getVirtualRowIndex=function(e){return e},e.prototype.getMovableRowByIndex=function(e){return e=this.getInfiniteRowIndex(e),this.parent.getMovableDataRows()[e]},e.prototype.enableAfterRender=function(e){"group"===e.module&&e.enable&&(this.generator=this.getModelGenerator())},e.prototype.setRowObjects=function(e){this.rows=e},e.prototype.immutableModeRendering=function(e){var t=this;void 0===e&&(e={});var i=this.parent;i.hideSpinner();var r=i.getPrimaryKeyFieldNames()[0],n={},s={},o=[],a={},l=i.getRowsObject().slice(),h=this.getBatchEditedRecords(r,l),d={},p=0!==Object.keys(h).length;if(i.getContent().querySelector(".e-emptyrow")||"reorder"===e.requestType||this.parent.groupSettings.columns.length)this.refreshContentRows(e);else{if(0===i.currentViewData.length)return;var c={},f=i.createElement(se),g=i.currentViewData,m=[].slice.call(this.getTable().querySelector(se).children);if(this.prevCurrentView.length){var y=this.prevCurrentView.length,v=g.length;if(y===v)for(var b=0;b<v;b++)"Batch"===this.parent.editSettings.mode&&m[b].classList.contains("e-insertedrow")?(m.splice(b,1),--b):(s[g[b][r]]=n[this.prevCurrentView[b][r]]=b,d[b]=g[b][r],c[l[b].uid]=m[b],a[b]=this.prevCurrentView[b][r]);else{for(b=0;b<v;b++)s[g[b][r]]=b,d[b]=g[b][r];for(b=0;b<y;b++)"Batch"===this.parent.editSettings.mode&&m[b].classList.contains("e-insertedrow")?(m.splice(b,1),--b):(c[l[b].uid]=m[b],n[this.prevCurrentView[b][r]]=b,a[b]=this.prevCurrentView[b][r])}}for(b=0;b<g.length;b++){var C=n[g[b][r]];if(sf.base.isNullOrUndefined(C)){var w=new le(this.serviceLocator,null,i),S=this.generator.generateRows([g[b]]);o.push(S[0]);R=w.render(S[0],i.getColumns());f.appendChild(R),this.refreshImmutableContent(b,R,o[b])}else{var x=!1;this.parent.enableDeepCompare&&(x=this.objectEqualityChecker(this.prevCurrentView[C],g[b]));var R=c[l[C].uid];if(o.push(l[C]),this.rowElements[C]&&this.rowElements[C].getAttribute("data-uid")===o[b].uid&&(p&&sf.base.isNullOrUndefined(h[d[b]])||!p&&(x||this.prevCurrentView[C]===g[b]))){C!==b&&this.refreshImmutableContent(b,R,o[b]),f.appendChild(R);continue}(p&&!sf.base.isNullOrUndefined(h[d[b]])||!this.parent.enableDeepCompare&&g[b]!==this.prevCurrentView[C]||this.parent.enableDeepCompare&&!x)&&l[C].setRowValue(g[b]),f.appendChild(R),this.refreshImmutableContent(b,R,o[b])}}if(this.rows=o,this.rowElements=[].slice.call(f.children),sf.base.remove(this.getTable().querySelector(se)),this.getTable().appendChild(f),this.parent.trigger(u,{},(function(){t.parent.allowTextWrap&&t.parent.notify("freezerender",{case:"textwrap"})})),e){var F=(e.requestType||"").toLowerCase()+"-complete";this.parent.notify(F,e)}}},e.prototype.objectEqualityChecker=function(e,t){for(var i=Object.keys(e),r=!0,n=0;n<i.length;n++){if(e[i[n]]!==t[i[n]])if(!(e[i[n]]instanceof Date&&t[i[n]]instanceof Date)||e[i[n]].getTime()!==t[i[n]].getTime()){r=!1;break}}return r},e.prototype.getBatchEditedRecords=function(e,t){var i={},r=this.parent.getBatchChanges(),n=[],s=[];Object.keys(r).length&&(n=r.changedRecords,s=r.addedRecords);var o={cancel:!1};this.parent.notify("immutable-batch-cancel",{rows:t,args:o}),s.length&&("Bottom"===this.parent.editSettings.newRowPosition?t.splice(t.length-1,s.length):o.cancel||t.splice(0,s.length));for(var a=0;a<n.length;a++)i[n[a][e]]=a;return i},e.prototype.refreshImmutableContent=function(e,t,i){i.isAltRow=!!this.parent.enableAltRow&&e%2!=0,i.isAltRow?t.classList.add("e-altrow"):t.classList.remove("e-altrow"),i.index=e,i.edit=void 0,i.isDirty=!1,t.setAttribute(ne,e.toString()),this.updateCellIndex(t,e)},e.prototype.updateCellIndex=function(e,t){for(var i=0;i<e.cells.length;i++)e.cells[i].setAttribute("index",t.toString())},e}(),ye=function(){function t(e,t){var i=this;this.frzIdx=0,this.notfrzIdx=0,this.isFirstCol=!1,this.isReplaceDragEle=!0,this.helper=function(e){var t=i.parent,r=i.draggable.currentStateTarget,n=yi(r,"e-headercell");if(!t.allowReordering&&!t.allowGrouping||!sf.base.isNullOrUndefined(n)&&n.getElementsByClassName("e-checkselectall").length>0)return!1;var s=i.parent.createElement("div",{className:"e-cloneproperties e-dragclone e-headerclone"}),o=r.classList.contains("e-headercell")?r:n;if(!o||!t.allowReordering&&o.classList.contains("e-stackedheadercell"))return!1;var a,l=o.offsetHeight,h=o.querySelector(".e-headercelldiv")||o.querySelector(".e-stackedheadercelldiv");if(h){if(a=o.querySelector(".e-stackedheadercelldiv")?t.getStackedHeaderColumnByHeaderText(h.innerText.trim(),t.columns):t.getColumnByUid(h.getAttribute("e-mappinguid")),i.column=a,i.column.lockColumn)return!1;s.setAttribute("e-mappinguid",i.column.uid)}if(a&&!sf.base.isNullOrUndefined(a.headerTemplate))if(sf.base.isNullOrUndefined(a.headerTemplate))s.innerHTML=a.headerTemplate;else{var d=t.getColumnIndexByField(a.field);Fi(s,a.getHeaderTemplate()(sf.base.extend({index:d},a),t,"headerTemplate"))}else s.innerHTML=h?a.headerText:o.firstElementChild.innerHTML;return s.style.width=o.offsetWidth+"px",s.style.height=o.offsetHeight+"px",s.style.lineHeight=(l-6).toString()+"px",t.element.appendChild(s),s},this.dragStart=function(e){var t=i.parent;t.element.querySelector(".e-gridpopup").style.display="none",t.notify("columnDragStart",{target:i.draggable.currentStateTarget,column:i.column,event:e.event})},this.drag=function(e){var t=i.parent,r=e.target;if(r){var n=sf.base.closest(r,".e-grid"),s=i.parent.element.querySelector(".e-cloneproperties");if(!(n&&n.getAttribute("id")===t.element.getAttribute("id")||(sf.base.classList(s,["e-notallowedcur"],["e-defaultcur"]),t.allowReordering&&(t.element.querySelector(".e-reorderuparrow").style.display="none",t.element.querySelector(".e-reorderdownarrow").style.display="none"),t.groupSettings.allowReordering)))return;t.notify("columnDrag",{target:e.target,column:i.column,event:e.event})}},this.dragStop=function(e){var t,r=i.parent;r.element.querySelector(".e-gridpopup").style.display="none",(!yi(e.target,"e-headercell")&&!yi(e.target,"e-groupdroparea")||!r.allowReordering&&yi(e.target,"e-headercell")||!e.helper.getAttribute("e-mappinguid")&&yi(e.target,"e-groupdroparea"))&&(sf.base.remove(e.helper),t=!0),r.notify("column-drag-stop",{target:e.target,event:e.event,column:i.column,cancel:t})},this.drop=function(e){var t=i.parent,r=e.droppedElement.getAttribute("e-mappinguid"),n=sf.base.closest(e.target,".e-grid");sf.base.remove(e.droppedElement),n&&n.getAttribute("id")!==t.element.getAttribute("id")||!t.allowReordering&&!t.allowGrouping||t.notify("header-drop",{target:e.target,uid:r,droppedElement:e.droppedElement})},this.parent=e,this.serviceLocator=t,this.ariaService=this.serviceLocator.getService("ariaService"),this.widthService=this.serviceLocator.getService("widthService"),this.parent.isDestroyed||(this.parent.enableColumnVirtualization||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount()||this.parent.on("column-visible-changed",this.setVisible,this),this.parent.on("column-position-changed",this.colPosRefresh,this),this.parent.on(g,this.renderCustomToolbar,this),"Vertical"===this.parent.rowRenderingMode&&this.parent.on(v,this.updateCustomResponsiveToolbar,this))}return t.prototype.renderPanel=function(){var e=this.parent.element.querySelector("."+H),t=null!=e;e=t?e:this.parent.createElement("div",{className:"e-gridheader"});var i=t?e.querySelector("."+V):this.parent.createElement("div",{className:V});this.toggleStackClass(e),e.appendChild(i),this.setPanel(e),t||this.parent.element.appendChild(e)},t.prototype.renderTable=function(){var e=this.getPanel();e.appendChild(this.createHeaderTable()),this.setTable(e.querySelector("."+X)),this.parent.getFrozenColumns()||this.parent.getFrozenRightColumnsCount()||this.parent.getFrozenLeftColumnsCount()||(this.initializeHeaderDrag(),this.initializeHeaderDrop()),this.parent.notify(S,{rows:this.rows,args:{isFrozen:this.parent.isFrozenGrid()}})},t.prototype.getPanel=function(){return this.headerPanel},t.prototype.setPanel=function(e){this.headerPanel=e},t.prototype.getTable=function(){return this.headerTable},t.prototype.setTable=function(e){this.headerTable=e},t.prototype.getColGroup=function(){return this.colgroup},t.prototype.setColGroup=function(e){return this.colgroup=e},t.prototype.getRows=function(){return this.getTable().tHead.rows},t.prototype.createHeaderTable=function(){var e=this.createTable(),t=this.getPanel().querySelector("."+V);return t.appendChild(e),t},t.prototype.createHeader=function(e,t){void 0===e&&(e=null);var i=this.parent,r=i.isFrozenGrid();this.getTable()&&!r&&sf.base.remove(this.getTable());var n=this.parent.createElement("table",{className:X,attrs:{cellspacing:"0.25px",role:"grid"}}),s=t||(i.getFrozenLeftCount()?"frozen-left":"frozen-right"),o=this.createHeaderContent(s),a=o.thead,l=this.parent.createElement(se,{className:this.parent.frozenRows?"":"e-hide"});this.caption=this.parent.createElement("caption",{innerHTML:this.parent.element.id+"_header_table",className:"e-hide"});for(var h,d=this.parent.createElement(oe),p=this.parent.createElement("tr"),c=this.rows=o.rows,u=0,f=c.length;u<f;u++)for(var g=0,m=c[u].cells.length;g<m;g++)h=this.parent.createElement("td"),p.appendChild(h);return(i.allowFiltering||i.allowSorting||i.allowGrouping)&&n.classList.add("e-sortfilter"),this.updateColGroup(d),l.appendChild(p),n.appendChild(this.setColGroup(d)),n.appendChild(a),n.appendChild(l),n.appendChild(this.caption),this.ariaService.setOptions(n,{colcount:i.getColumns().length.toString()}),n},t.prototype.createTable=function(e){return void 0===e&&(e=null),this.createHeader(e)},t.prototype.createHeaderContent=function(t){var i=this.parent,r=1,n=i.getFrozenMode(),s=i.getColumns(),o=this.parent.createElement("thead"),a=this.parent.createElement("tr",{className:"e-columnheader"}),l=new le(this.serviceLocator,e.CellType.Header,i);l.element=a;var h,d=[];this.colDepth=sr(i.columns);for(var p=0,c=this.colDepth;p<c;p++)d[p]=this.generateRow(p),d[p].cells=[];"Right"!==n&&(d=this.ensureColumns(d)),d=this.getHeaderCells(d,t),"Right"===n&&(r=0,d=this.ensureColumns(d));var u=this.parent.getFrozenColumns();if(this.parent.isRowDragable()&&this.parent.isFrozenGrid()&&d[0].cells[r]){var f=d[0].cells[r].column.getFreezeTableName();"movable"===f||n===ee&&f===te?"Right"===n?d[0].cells.pop():d[0].cells.shift():u||f!==ie?"Right"===n&&f===te&&(d[0].cells[d[0].cells.length-1].column.freeze="Right"):d[0].cells[0].column.freeze=f===ie?"Left":"Right"}for(p=0,c=this.colDepth;p<c;p++)h=l.render(d[p],s),this.parent.rowHeight&&h.querySelector(".e-headercell")&&(h.style.height=this.parent.rowHeight+"px"),o.appendChild(h);return{thead:o,rows:d}},t.prototype.updateColGroup=function(e){var t,i=this.parent.getColumns(),r=this.parent.getColumnIndexesInView();if(this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&this.parent.contentModule.isXaxis()&&(i=sf.base.extend([],this.parent.getColumns())).splice(0,this.parent.getFrozenColumns()),e.id=this.parent.element.id+oe,this.parent.allowGrouping)for(var n=0,s=this.parent.groupSettings.columns.length;n<s;n++)this.parent.enableColumnVirtualization&&-1===r.indexOf(n)||(t=this.parent.createElement("col",{className:"e-group-intent"}),e.appendChild(t));(this.parent.detailTemplate||this.parent.childGrid)&&(t=this.parent.createElement("col",{className:"e-detail-intent"}),e.appendChild(t)),this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()&&(t=this.parent.createElement("col",{className:"e-drag-intent"}),e.appendChild(t));for(n=0,s=i.length;n<s;n++)t=this.parent.createElement("col"),!1===i[n].visible&&sf.base.setStyleAttribute(t,{display:"none"}),e.appendChild(t);return this.parent.isRowDragable()&&"Right"===this.parent.getFrozenMode()&&(t=this.parent.createElement("col",{className:"e-drag-intent"}),e.appendChild(t)),e},t.prototype.ensureColumns=function(t){for(var i=this.parent,r=this.parent.getColumnIndexesInView(),n=0,s=t.length;n<s;n++){if(i.allowGrouping)for(var o=0,a=i.groupSettings.columns.length;o<a;o++)this.parent.enableColumnVirtualization&&-1===r.indexOf(o)||t[n].cells.push(this.generateCell({},e.CellType.HeaderIndent));if(i.detailTemplate||i.childGrid){var l={};this.parent.notify("detail-indentcell-info",l),t[n].cells.push(this.generateCell(l,e.CellType.DetailHeader))}i.isRowDragable()&&t[n].cells.push(this.generateCell({},e.CellType.RowDragHIcon))}return t},t.prototype.getHeaderCells=function(e,t){var i=this.parent.getHeaderTable()&&this.parent.getHeaderTable().querySelector("thead"),r=this.parent.enableColumnVirtualization?this.parent.getColumns(this.parent.enablePersistence):this.parent.columns;if(this.frzIdx=0,this.notfrzIdx=0,this.parent.lockcolPositionCount)for(var n=0;n<r.length;n++)this.lockColsRendered=!1,e=this.appendCells(r[n],e,0,0===n,!1,n===r.length-1,i,t);n=0;for(var s=r.length;n<s;n++)this.notfrzIdx=0,this.lockColsRendered=!0,e=this.appendCells(r[n],e,0,0===n,!1,n===s-1,i,t);return e},t.prototype.appendCells=function(t,i,r,n,s,o,a,l){var h,d=o?"e-lastcell":"",p=this.parent.isFrozenGrid(),c=!this.parent.lockcolPositionCount||t.lockColumn&&!this.lockColsRendered||!t.lockColumn&&this.lockColsRendered,u=!this.parent.lockcolPositionCount||t.lockColumn&&!this.lockColsRendered||!t.lockColumn&&this.lockColsRendered,f=this.parent.getContent().querySelector(".e-movablescrollbar");if(p&&f&&this.parent.enableColumnVirtualization&&(h=f.scrollLeft),t.columns){this.isFirstCol=!1;var g=this.getCellCnt(t,0);if(g){var m=this.getStackedLockColsCount(t,0),y=0===this.parent.lockcolPositionCount||!this.lockColsRendered&&0!==m||this.lockColsRendered&&g-m!=0,v=p&&this.ensureStackedFrozen(t.columns,l,!1);(!p&&y||v)&&i[r].cells.push(new P({cellType:e.CellType.StackedHeader,column:t,colSpan:this.getColSpan(g,m,t.columns,l,p)}))}if(this.parent.lockcolPositionCount&&!this.lockColsRendered)for(var b=0;b<t.columns.length;b++)i=this.appendCells(t.columns[b],i,r+1,n,0===b,b===t.columns.length-1&&o,a,l);if(this.lockColsRendered){b=0;for(var C=t.columns.length;b<C;b++){var w=this.isFirstCol=t.columns[b].visible&&!this.isFirstCol&&1!==C,S=b===C-1;i=this.appendCells(t.columns[b],i,r+1,n,w,S&&o,a,l)}}}else(h&&h>0&&this.parent.contentModule.isXaxis()&&0!==this.parent.inViewIndexes[0]&&"movable"===t.getFreezeTableName()||!p&&c||p&&t.getFreezeTableName()===l&&u)&&i[r].cells.push(this.generateCell(t,e.CellType.Header,this.colDepth-r,(n?"":s?"e-firstcell":"")+d,r,this.parent.getColumnIndexByUid(t.uid))),this.parent.lockcolPositionCount?this.frzIdx+this.notfrzIdx<this.parent.frozenColumns&&(t.lockColumn&&!this.lockColsRendered||!t.lockColumn&&this.lockColsRendered)?this.frzIdx++:this.notfrzIdx++:this.frzIdx++;return i},t.prototype.ensureStackedFrozen=function(e,t,i){for(var r=e.length,n=0;n<r;n++)if(e[n].columns)i=this.ensureStackedFrozen(e[n].columns,t,i);else if(e[n].getFreezeTableName()===t){i=!0;break}return i},t.prototype.getStackedLockColsCount=function(e,t){if(e.columns)for(var i=0;i<e.columns.length;i++)t=this.getStackedLockColsCount(e.columns[i],t);else e.lockColumn&&t++;return t},t.prototype.getColSpan=function(e,t,i,r,n){return n?e=this.getFrozenColSpan(i,r,0):this.parent.lockcolPositionCount&&(e=this.lockColsRendered?e-t:t),e},t.prototype.getFrozenColSpan=function(e,t,i){for(var r=e.length,n=0;n<r;n++)e[n].columns?i=this.getFrozenColSpan(e[n].columns,t,i):e[n].getFreezeTableName()===t&&e[n].visible&&i++;return i},t.prototype.generateRow=function(e){return new N({})},t.prototype.generateCell=function(e,t,i,r,n,s){var o={visible:e.visible,isDataCell:!1,isTemplate:!sf.base.isNullOrUndefined(e.headerTemplate),rowID:"",column:e,cellType:t,rowSpan:i,className:r,index:n,colIndex:s};return(!o.rowSpan||o.rowSpan<2)&&delete o.rowSpan,new P(o)},t.prototype.setVisible=function(e){for(var t,i,r=this.parent,n=r.getFrozenColumns(),s=0,o=e.length;s<o;s++){var a=e[s];if(i=r.getNormalizedColumnIndex(a.uid),t=a.visible?"":"none",n){var l=this.parent.isRowDragable()?n+1:n;if(i<l)sf.base.setStyleAttribute(this.getColGroup().children[i],{display:t});else{var h=r.getHeaderContent().querySelector("."+_).querySelector(oe);sf.base.setStyleAttribute(h.children[i-l],{display:t})}}else sf.base.setStyleAttribute(this.getColGroup().children[i],{display:t})}this.refreshUI()},t.prototype.colPosRefresh=function(){this.refreshUI()},t.prototype.refreshUI=function(){var e=this.parent.isFrozenGrid(),t=this.parent.enableColumnVirtualization&&e,i=this.getPanel();this.toggleStackClass(i);var r=this.freezeReorder?this.headerPanel.querySelector("."+_).querySelector("."+X):this.getTable(),n=this.parent.isFrozenGrid()?this.parent.getFrozenLeftCount()?"frozen-left":"frozen-right":void 0;if(t&&(r=this.parent.contentModule.getVirtualFreezeHeader(),n=this.parent.contentModule.isXaxis()?"movable":n),r){sf.base.remove(r),r.removeChild(r.firstChild),r.removeChild(r.childNodes[0]);var s=this.parent.createElement(oe),o=this.createHeaderContent(n);this.rows=o.rows,r.insertBefore(o.thead,r.firstChild),this.updateColGroup(s),r.insertBefore(this.setColGroup(s),r.firstChild),t||this.setTable(r),this.appendContent(r),this.parent.notify("colgroup-refresh",{}),this.widthService.setWidthToColumns(),this.parent.updateDefaultCursor(),(!e||this.parent.enableColumnVirtualization&&e)&&this.initializeHeaderDrag();for(var a=[].slice.call(i.querySelectorAll("tr.e-columnheader")),l=0,h=a;l<h.length;l++){var d=h[l],p=[].slice.call(d.getElementsByClassName("e-grouptopleftcell"));p.length&&p[p.length-1].classList.add("e-lastgrouptopleftcell")}e||this.parent.notify(S,{rows:this.rows,args:{isFrozen:e}}),this.parent.enableColumnVirtualization&&yi(r,_)&&this.parent.notify(S,{rows:this.rows,args:{isFrozen:!1,isXaxis:!0}}),this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&Pi(a,!0)}},t.prototype.toggleStackClass=function(e){this.parent.columns.some((function(e){return!sf.base.isNullOrUndefined(e.columns)}))?e.classList.add("e-stackedheader"):e.classList.remove("e-stackedheader")},t.prototype.appendContent=function(e){this.getPanel().querySelector("."+V).appendChild(e)},t.prototype.getCellCnt=function(e,t){if(e.columns)for(var i=0,r=e.columns.length;i<r;i++)t=this.getCellCnt(e.columns[i],t);else e.visible&&t++;return t},t.prototype.initializeHeaderDrag=function(){var e=this.parent;(this.parent.allowReordering||this.parent.allowGrouping&&this.parent.groupSettings.showDropArea)&&(this.draggable=new sf.base.Draggable(e.getHeaderContent(),{dragTarget:".e-headercell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop,abort:".e-rhandler",isReplaceDragEle:this.isReplaceDragEle}))},t.prototype.initializeHeaderDrop=function(){var e=this.parent;new sf.base.Droppable(e.getHeaderContent(),{accept:".e-dragclone",drop:this.drop})},t.prototype.renderCustomToolbar=function(){var e=this,t=this.parent;if("Vertical"===t.rowRenderingMode&&!t.toolbar&&(t.allowSorting||t.allowFiltering&&"FilterBar"!==t.filterSettings.type)){for(var i=t.createElement("div",{className:"e-res-toolbar e-toolbar"}),r=t.createElement("div",{className:"e-toolbar-items"}),n=t.createElement("div",{className:"e-toolbar-left"}),s=this.parent.allowFiltering&&this.parent.allowSorting?2:1,o=0;o<s;o++){var a=t.createElement("div",{className:"e-toolbar-item e-gridresponsiveicons e-icons e-tbtn-align"}),l=1===s?this.parent.allowSorting?"sort":"filter":1===o?"sort":"filter",h=t.createElement("button",{className:"e-tbar-btn e-control e-btn e-lib e-icon-btn"}),d=t.createElement("span",{className:"e-btn-icon e-res"+l+"-icon e-icons"});h.appendChild(d),new sf.buttons.Button({}).appendTo(h),h.onclick=function(t){t.target.classList.contains("e-ressort-btn")||t.target.classList.contains("e-ressort-icon")?e.parent.showResponsiveCustomSort():e.parent.showResponsiveCustomFilter()},a.appendChild(h),n.appendChild(a)}r.appendChild(n),i.appendChild(r),t.element.insertBefore(i,this.parent.element.querySelector("."+H))}else t.enableAdaptiveUI&&!t.toolbar&&t.getContent().classList.add("e-responsive-header")},t.prototype.updateCustomResponsiveToolbar=function(e){var t=this.parent.element.querySelector(".e-responsive-toolbar");"toolbar"===e.module&&(t?sf.base.remove(t):this.renderCustomToolbar())},t}(),ve=function(){function t(e,t){this.localizer=t.getService("localization"),this.formatter=t.getService("valueFormatter"),this.parent=e,this.element=this.parent.createElement("TD",{className:q,attrs:{role:"gridcell",tabindex:"-1"}}),this.rowChkBox=this.parent.createElement("input",{className:"e-checkselect",attrs:{type:"checkbox"}})}return t.prototype.getGui=function(){return""},t.prototype.format=function(e,t,i){return sf.base.isNullOrUndefined(e.format)||("number"===e.type&&isNaN(parseInt(t,10))&&(t=null),t=this.formatter.toView(t,e.getFormatter())),sf.base.isNullOrUndefined(t)?"":t.toString()},t.prototype.evaluate=function(e,t,i,r,n,s){var o,a;if(t.column.template){var l=this.parent.isReact&&"string"!=typeof t.column.template,h=["index"],d=rr({},i,((o={}).foreignKeyData=n,o.column=t.column,o)),p=this.parent.element.id+t.column.uid,c="isStringTemplate";if(l){var u={index:r[h[0]]};t.column.getColumnTemplate()(sf.base.extend(u,d),this.parent,"columnTemplate",p,this.parent[c],null,e),this.parent.renderTemplates()}else a=t.column.getColumnTemplate()(sf.base.extend({index:r[h[0]]},d),this.parent,"template",p,this.parent[c]);return l||Fi(e,a),this.parent.notify("template-result",{template:a}),a=null,e.setAttribute("aria-label",e.innerText+" is template cell column header "+t.column.headerText),!1}return!0},t.prototype.invokeFormatter=function(e,t,i){sf.base.isNullOrUndefined(e.formatter)||(t=$t(e.formatter,"getValue")?(new(0,e.formatter)).getValue(e,i):"function"==typeof e.formatter?e.formatter(e,i):e.formatter.getValue(e,i));return t},t.prototype.render=function(e,t,i,r,n){return this.refreshCell(e,t,i,n)},t.prototype.refreshTD=function(e,t,i,r){var n="Batch"===this.parent.editSettings.mode&&e.classList.contains("e-editedbatchcell");if(this.parent.isReact){e.innerHTML="";var s=e.cellIndex,o=e.parentElement;sf.base.remove(e);var a=this.refreshCell(t,i,r,n);this.cloneAttributes(a,e),o.cells.length!==s-1?o.insertBefore(a,o.cells[s]):o.appendChild(a)}else{var l=this.refreshCell(t,i,r,n);e.innerHTML="",e.setAttribute("aria-label",l.getAttribute("aria-label"));for(var h=0,d=[].slice.call(l.childNodes);h<d.length;h++){var p=d[h];e.appendChild(p)}}},t.prototype.cloneAttributes=function(e,t){for(var i,r=t.attributes,n=r.length;n--;)i=r[n],e.setAttribute(i.name,i.value)},t.prototype.refreshCell=function(e,t,i,r){var n,s,o=this.element.cloneNode(),a=e.column;e.isForeignKey&&(s=e.foreignKeyData[0]||((n={})[a.foreignKeyValue]=a.format?null:"",n));var l=this.getGui(),h=e.isForeignKey?this.getValue(a.foreignKeyValue,s,a):this.getValue(a.field,t,a);if("date"!==a.type&&"datetime"!==a.type||sf.base.isNullOrUndefined(h)||(h=new Date(h)),l=(h=this.format(a,h,t)).toString(),"boolean"===a.type&&!a.displayAsCheckBox){var d="true"!==h&&"false"!==h?null:"true"===h?"True":"False";l=d?this.localizer.getConstant(d):l}var p=this.invokeFormatter(a,h,t);if(l=sf.base.isNullOrUndefined(a.formatter)?l:sf.base.isNullOrUndefined(p)?"":p.toString(),o.setAttribute("aria-label",l+" column header "+e.column.headerText),this.evaluate(o,e,t,i,s,r)&&"checkbox"!==a.type)this.appendHtml(o,l,a.getDomSetter?a.getDomSetter():"innerHTML");else if("checkbox"===a.type){o.classList.add(J),o.setAttribute("aria-label","checkbox"),h=!!this.parent.selectionSettings.persistSelection&&"true"===h,(u=sf.buttons.createCheckBox(this.parent.createElement,!1,{checked:h,label:" "})).insertBefore(this.rowChkBox.cloneNode(),u.firstChild),o.appendChild(u)}if("Check"===this.parent.checkAllRows&&this.parent.enableVirtualization&&(e.isSelected=!0),this.setAttributes(o,e,i),"boolean"===a.type&&a.displayAsCheckBox){var c=isNaN(parseInt(h.toString(),10))?"true"===h:parseInt(h.toString(),10)>0,u=sf.buttons.createCheckBox(this.parent.createElement,!1,{checked:c,label:" "});o.innerHTML="",u.classList.add("e-checkbox-disabled"),o.appendChild(u),o.setAttribute("aria-label",c+" column header "+e.column.headerText)}return o},t.prototype.appendHtml=function(e,t,i){return void 0===i&&(i="innerHTML"),e[i]=t,e},t.prototype.setAttributes=function(e,t,i){var r=t.column;this.buildAttributeFromCell(e,t,"checkbox"===r.type),pi(e,i),pi(e,t.attributes),r.customAttributes&&pi(e,r.customAttributes),"Vertical"===this.parent.rowRenderingMode&&pi(e,{"data-cell":r.headerText}),r.textAlign&&(e.style.textAlign=r.textAlign),"Clip"===r.clipMode||!r.clipMode&&"Clip"===this.parent.clipMode?e.classList.add("e-gridclip"):("EllipsisWithTooltip"===r.clipMode||!r.clipMode&&"EllipsisWithTooltip"===this.parent.clipMode)&&"checkbox"!==r.type&&e.classList.add("e-ellipsistooltip")},t.prototype.buildAttributeFromCell=function(t,i,r){var n={},s=re,o=[];i.colSpan&&(n.colSpan=i.colSpan),i.rowSpan&&(n.rowSpan=i.rowSpan),i.isTemplate&&o.push("e-templatecell"),i.isSelected&&(o.push.apply(o,["e-selectionbackground","e-active"]),r&&t.querySelector(".e-frame").classList.add("e-check")),i.isColumnSelected&&o.push.apply(o,["e-columnselection"]),i.cellType===e.CellType.Header?n[s]=i.colIndex:sf.base.isNullOrUndefined(i.index)||(n[s]=i.index),i.visible||o.push("e-hide"),n.class=o,pi(t,n)},t.prototype.getValue=function(e,t,i){return i.valueAccessor(e,t,i)},t}(),be=function(){function e(){}return e.prototype.setOptions=function(e,t){for(var i=Object.keys(t),r=0;r<i.length;r++)Ce(e,Ne[i[r]],t[i[r]])},e.prototype.setExpand=function(e,t){Ce(e,Ne.expand,t)},e.prototype.setSort=function(e,t){Ce(e,Ne.sort,t,"boolean"==typeof t)},e.prototype.setBusy=function(e,t){Ce(e,Ne.busy,t),Ce(e,Ne.invalid,null,!0)},e.prototype.setGrabbed=function(e,t,i){Ce(e,Ne.grabbed,t,i)},e.prototype.setDropTarget=function(e,t){Ce(e,Ne.dropeffect,"copy",!t)},e}();function Ce(e,t,i,r){r&&e?e.removeAttribute(t):e&&e.setAttribute(t,i)}var we,Se,xe,Re,Fe,Ee,Ie,Te,ze,De,Me,Oe,ke,Ae,Be,Ne={expand:"aria-expanded",role:"role",selected:"aria-selected",multiselectable:"aria-multiselectable",sort:"aria-sort",busy:"aria-busy",invalid:"aria-invalid",grabbed:"aria-grabbed",dropeffect:"aria-dropeffect",haspopup:"aria-haspopup",level:"aria-level",colcount:"aria-colcount",rowcount:"aria-rowcount"},Pe=(we=function(e,t){return(we=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}we(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-headercell",attrs:{role:"columnheader",tabindex:"-1"}}),t.ariaService=new be,t.hTxtEle=t.parent.createElement("span",{className:"e-headertext"}),t.sortEle=t.parent.createElement("div",{className:"e-sortfilterdiv e-icons"}),t.gui=t.parent.createElement("div"),t.chkAllBox=t.parent.createElement("input",{className:"e-checkselectall",attrs:{type:"checkbox"}}),t}return Pe(t,e),t.prototype.getGui=function(){return this.gui.cloneNode()},t.prototype.render=function(e,t,i){var r=this.element.cloneNode(),n=this.parent.createElement("div",{className:"e-filtermenudiv e-icons e-icon-filter"});return this.prepareHeader(e,r,n)},t.prototype.refresh=function(e,t){this.clean(t);var i=this.parent.createElement("div",{className:"e-filtermenudiv e-icons e-icon-filter"});return this.prepareHeader(e,t,i)},t.prototype.clean=function(e){e.innerHTML=""},t.prototype.prepareHeader=function(e,t,i){var r,n,s=e.column,o={},a=this.getGui();if(sf.base.attributes(a,{"e-mappinguid":s.uid,class:"e-headercelldiv"}),sf.base.isNullOrUndefined(s.headerValueAccessor)||(r=this.getValue(s.headerText,s)),"checkbox"!==s.type){var l=s.headerText;sf.base.isNullOrUndefined(r)||(l=r);var h=this.hTxtEle.cloneNode();h[s.getDomSetter()]=l,a.appendChild(h)}else{s.editType="booleanedit";var d=sf.buttons.createCheckBox(this.parent.createElement,!1,{checked:!1,label:" "});d.insertBefore(this.chkAllBox.cloneNode(),d.firstChild),a.appendChild(d),a.classList.add("e-headerchkcelldiv")}if(this.buildAttributeFromCell(t,e),this.appendHtml(t,a),t.appendChild(this.sortEle.cloneNode()),this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&s.allowFiltering&&!sf.base.isNullOrUndefined(s.field)&&(!this.parent.showColumnMenu||!s.showColumnMenu)){sf.base.attributes(i,{"e-mappinguid":"e-flmenu-"+s.uid}),t.classList.add("e-fltr-icon");var p=[];if(this.parent.filterSettings.columns.length&&this.parent.filterSettings.columns.length!==p.length)for(var c=this.parent.getForeignKeyColumns(),u=0;u<this.parent.columns.length;u++)for(var f=0;f<this.parent.filterSettings.columns.length;f++)if(this.parent.filterSettings.columns[f].field===s.field||c.length&&s.foreignKeyValue===this.parent.filterSettings.columns[f].field){i.classList.add("e-filtered"),p.push(s.field);break}t.appendChild(i.cloneNode())}e.className&&t.classList.add(e.className),s.customAttributes&&pi(t,s.customAttributes),s.allowSorting&&(o.sort="none"),s.allowGrouping&&(o.grabbed=!1),t=this.extendPrepareHeader(s,t);var g=this.parent,m=g.getColumnIndexByField(s.field);if(!sf.base.isNullOrUndefined(s.headerTemplate)){var y=g.element.id+s.uid+"headerTemplate",v="isStringTemplate",b=s;if(this.parent.isReact&&"string"!=typeof s.headerTemplate){var C={index:m};t.firstElementChild.innerHTML="",s.getHeaderTemplate()(sf.base.extend(C,b),g,"headerTemplate",y,this.parent[v],null,t.firstElementChild),this.parent.renderTemplates()}else n=s.getHeaderTemplate()(sf.base.extend({index:m},b),g,"headerTemplate",y,this.parent[v]),t.firstElementChild.innerHTML="",Fi(t.firstElementChild,n)}if(this.ariaService.setOptions(t,o),!sf.base.isNullOrUndefined(s.headerTextAlign)||!sf.base.isNullOrUndefined(s.textAlign)){var w=s.headerTextAlign||s.textAlign;a.style.textAlign=w,"Right"===w||"Left"===w?t.classList.add("Right"===w?"e-rightalign":"e-leftalign"):"Center"===w&&t.classList.add("e-centeralign")}return"Clip"===s.clipMode||!s.clipMode&&"Clip"===this.parent.clipMode?t.classList.add("e-gridclip"):("EllipsisWithTooltip"===s.clipMode||!s.clipMode&&"EllipsisWithTooltip"===this.parent.clipMode)&&"checkbox"!==s.type&&t.classList.add("e-ellipsistooltip"),t.setAttribute("aria-rowspan",(sf.base.isNullOrUndefined(e.rowSpan)?1:e.rowSpan).toString()),t.setAttribute("aria-colspan","1"),this.parent.trigger("headerCellInfo",{cell:e,node:t}),t},t.prototype.getValue=function(e,t){return t.headerValueAccessor(e,t)},t.prototype.extendPrepareHeader=function(e,t){if(this.parent.showColumnMenu&&e.showColumnMenu&&!sf.base.isNullOrUndefined(e.field)){var i=this.parent.createElement("div",{className:"e-icons e-columnmenu"}),r=[];if(this.parent.filterSettings.columns.length&&this.parent.filterSettings.columns.length!==r.length)for(var n=0;n<this.parent.columns.length;n++)for(var s=0;s<this.parent.filterSettings.columns.length;s++)if(this.parent.filterSettings.columns[s].field===e.field){i.classList.add("e-filtered"),r.push(e.field);break}t.classList.add("e-fltr-icon"),t.appendChild(i)}if(this.parent.allowResizing){var o=this.parent.createElement("div");o.className=e.allowResizing?"e-rhandler e-rcursor":"e-rsuppress",t.appendChild(o)}return t},t.prototype.appendHtml=function(e,t){return e.appendChild(t),e},t}(ve),qe=(Se=function(e,t){return(Se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Se(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),He=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-headercell e-stackedheadercell",attrs:{role:"columnheader",tabindex:"-1"}}),t}return qe(t,e),t.prototype.render=function(e,t,i){var r=this.element.cloneNode(),n=this.parent.createElement("div",{className:"e-stackedheadercelldiv",attrs:{"e-mappinguid":e.column.uid}}),s=e.column;if(r.appendChild(n),sf.base.isNullOrUndefined(s.headerTemplate)?this.appendHtml(n,s.headerText,s.getDomSetter()):Fi(n,s.getHeaderTemplate()(s,this.parent,"headerTemplate")),e.column.toolTip&&r.setAttribute("title",e.column.toolTip),"Clip"===s.clipMode||!s.clipMode&&"Clip"===this.parent.clipMode?r.classList.add("e-gridclip"):("EllipsisWithTooltip"===s.clipMode||!s.clipMode&&"EllipsisWithTooltip"===this.parent.clipMode)&&r.classList.add("e-ellipsistooltip"),sf.base.isNullOrUndefined(e.column.textAlign)||(n.style.textAlign=e.column.textAlign),e.column.customAttributes&&pi(r,e.column.customAttributes),r.setAttribute("colspan",e.colSpan.toString()),r.setAttribute("aria-colspan",e.colSpan.toString()),r.setAttribute("aria-rowspan","1"),this.parent.allowResizing){var o=this.parent.createElement("div");o.className=e.column.allowResizing?"e-rhandler e-rcursor":"e-rsuppress",r.appendChild(o)}return this.parent.trigger("headerCellInfo",{cell:e,node:r}),r},t}(ve),Ue=(xe=function(e,t){return(xe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}xe(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),je=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-indentcell"}),t}return Ue(t,e),t.prototype.render=function(e,t){var i=this.element.cloneNode();return pi(i,e.attributes),i},t}(ve),Ve=(Re=function(e,t){return(Re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Re(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-groupcaption",attrs:{id:t.parent.element.id+"captioncell",role:"gridcell",tabindex:"-1"}}),t}return Ve(t,e),t.prototype.render=function(e,t){var i,r,n=this.element.cloneNode(),s=this.parent;t.headerText=e.column.headerText,e.isForeignKey&&(r=this.format(e.column,e.column.valueAccessor("foreignKey",t,e.column)));var o=e.isForeignKey?r:e.column.enableGroupByFormat?t.key:this.format(e.column,e.column.valueAccessor("key",t,e.column));if(sf.base.isNullOrUndefined(s.groupSettings.captionTemplate))s.groupSettings.enableLazyLoading?n.innerHTML=e.column.headerText+": "+o:n.innerHTML=e.column.headerText+": "+o+" - "+t.count+" "+(t.count<2?this.localizer.getConstant("Item"):this.localizer.getConstant("Items"));else{var a=this.parent.isReact&&"string"!=typeof s.groupSettings.captionTemplate;if(a){var l=s.element.id+"captionTemplate";di(s.groupSettings.captionTemplate)(t,this.parent,"captionTemplate",l,null,null,n),this.parent.renderTemplates()}else i=this.parent.isVue?di(s.groupSettings.captionTemplate)(t,this.parent):di(s.groupSettings.captionTemplate)(t);a||Fi(n,i)}return n.setAttribute("colspan",e.colSpan.toString()),n.setAttribute("aria-label",n.innerHTML+" is groupcaption cell"),n.setAttribute("title",n.innerHTML),n},t}(ve),_e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-groupcaption"}),t}return Ve(t,e),t.prototype.render=function(e,t){var i=this.element.cloneNode();return i.innerHTML="&nbsp;",i.setAttribute("colspan",e.colSpan.toString()),i},t}(ve),We=(Fe=function(e,t){return(Fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Fe(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return We(t,e),t.prototype.render=function(e,t,i,r){var n=this.element.cloneNode();return n.className=r?"e-recordplusexpand":"e-recordpluscollapse",n.setAttribute("ej-mappingname",t.field),n.setAttribute("ej-mappingvalue",t.key),n.setAttribute("aria-expanded",r?"true":"false"),n.setAttribute("tabindex","-1"),n.appendChild(this.parent.createElement("div",{className:r?"e-icons e-gdiagonaldown e-icon-gdownarrow":"e-icons e-gnextforward e-icon-grightarrow"})),n},t}(je),Qe=(Ee=function(e,t){return(Ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ee(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Xe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-grouptopleftcell"}),t}return Qe(t,e),t.prototype.render=function(e,t){var i=this.element.cloneNode();return i.appendChild(this.parent.createElement("div",{className:"e-headercelldiv e-emptycell",innerHTML:""})),i},t}(ve),Ye=(Ie=function(e,t){return(Ie=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ie(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Je=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-detailheadercell"}),t}return Ye(t,e),t.prototype.render=function(e,t){var i=this.element.cloneNode();return i.appendChild(this.parent.createElement("div",{className:"e-emptycell"})),i},t}(ve),Ze=(Te=function(e,t){return(Te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Te(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),$e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-detailrowcollapse",attrs:{"aria-expanded":"false",role:"gridcell",tabindex:"-1"}}),t}return Ze(t,e),t.prototype.render=function(e,t,i){var r=this.element.cloneNode();return i&&!sf.base.isNullOrUndefined(i.class)?(r.className="",r.className=i.class,r.appendChild(this.parent.createElement("div",{className:"e-icons e-dtdiagonaldown e-icon-gdownarrow"}))):r.appendChild(this.parent.createElement("div",{className:"e-icons e-dtdiagonalright e-icon-grightarrow"})),r},t}(ve),et=(ze=function(e,t){return(ze=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ze(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),tt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-rowdragdrop e-rowdragdropcell",attrs:{role:"gridcell",tabindex:"-1"}}),t}return et(t,e),t.prototype.render=function(e,t){var i=this.element.cloneNode();return i.appendChild(this.parent.createElement("div",{className:"e-icons e-rowcelldrag e-dtdiagonalright e-icon-rowdragicon"})),e.isSelected&&(i.classList.add("e-selectionbackground"),i.classList.add("e-active")),i},t}(ve),it=(De=function(e,t){return(De=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}De(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),rt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-rowdragheader"}),t}return it(t,e),t.prototype.render=function(e,t){var i=this.element.cloneNode();return i.appendChild(sf.base.createElement("div",{className:"e-emptycell"})),i},t}(ve),nt=function(){function t(e,t){this.emptyGrid=!1,this.counter=0,this.parent=e,this.locator=t,this.data=new B(e,t),this.l10n=t.getService("localization"),this.ariaService=this.locator.getService("ariaService"),this.renderer=this.locator.getService("rendererFactory"),this.addEventListener()}return t.prototype.render=function(){var t=this.parent;this.headerRenderer=this.renderer.getRenderer(e.RenderType.Header),this.contentRenderer=this.renderer.getRenderer(e.RenderType.Content),this.headerRenderer.renderPanel(),this.contentRenderer.renderPanel(),t.getColumns().length&&(this.isLayoutRendered=!0,this.headerRenderer.renderTable(),this.contentRenderer.renderTable(),this.emptyRow(!1)),this.parent.scrollModule.setWidth(),this.parent.scrollModule.setHeight(),"auto"!==this.parent.height&&this.parent.scrollModule.setPadding(),this.refreshDataManager()},t.prototype.refresh=function(e){var t=this;void 0===e&&(e={requestType:"refresh"});var i=this.parent;i.notify(e.requestType+"-begin",e),i.trigger(p,e,(function(e){if(void 0===e&&(e={requestType:"refresh"}),e.cancel)i.notify("cancel-Begin",e);else{if("delete"===e.requestType&&i.allowPaging){var r=e.data.length,n=i.pageSettings.totalRecordsCount-r;i.getCurrentViewRecords().length-r||!n||(i.pageSettings.currentPage-1)*i.pageSettings.pageSize!==n||(i.prevPageMoving=!0,i.setProperties({pageSettings:{totalRecordsCount:n,currentPage:Math.ceil(n/i.pageSettings.pageSize)}},!0),i.pagerModule.pagerObj.totalRecordsCount=n)}"reorder"===e.requestType&&t.parent.dataSource&&"result"in t.parent.dataSource||("paging"===e.requestType||"columnstate"===e.requestType||"reorder"===e.requestType)&&t.parent.groupSettings.enableLazyLoading&&t.parent.groupSettings.columns.length&&t.parent.contentModule.getGroupCache()[t.parent.pageSettings.currentPage]?t.contentRenderer.refreshContentRows(e):t.refreshDataManager(e)}}))},t.prototype.resetTemplates=function(){var e=this.parent,t=e.getColumns();if(e.detailTemplate){var i=e.element.id+"detailTemplate";sf.base.blazorTemplates[i]=[],sf.base.resetBlazorTemplate(i,"DetailTemplate")}e.groupSettings.captionTemplate&&sf.base.resetBlazorTemplate(e.element.id+"captionTemplate","CaptionTemplate"),e.rowTemplate&&sf.base.resetBlazorTemplate(e.element.id+"rowTemplate","RowTemplate"),e.toolbarTemplate&&sf.base.resetBlazorTemplate(e.element.id+"toolbarTemplate","ToolbarTemplate"),e.pageSettings.template&&sf.base.resetBlazorTemplate(e.element.id+"_template","pageSettings");for(var r=0;r<t.length;r++)t[r].template&&(sf.base.blazorTemplates[e.element.id+t[r].uid]=[],sf.base.resetBlazorTemplate(e.element.id+t[r].uid,"Template")),t[r].headerTemplate&&sf.base.resetBlazorTemplate(e.element.id+t[r].uid+"headerTemplate","HeaderTemplate"),t[r].filterTemplate&&sf.base.resetBlazorTemplate(e.element.id+t[r].uid+"filterTemplate","FilterTemplate");for(var n=0;n<e.aggregates.length;n++)for(var s=0;s<e.aggregates[n].columns.length;s++){if(e.aggregates[n].columns[s].footerTemplate){var o=e.element.id+e.aggregates[n].columns[s].guid+"footerTemplate";sf.base.resetBlazorTemplate(o,"FooterTemplate")}if(e.aggregates[n].columns[s].groupFooterTemplate){o=e.element.id+e.aggregates[n].columns[s].guid+"groupFooterTemplate";sf.base.resetBlazorTemplate(o,"GroupFooterTemplate")}if(e.aggregates[n].columns[s].groupCaptionTemplate){o=e.element.id+e.aggregates[n].columns[s].guid+"groupCaptionTemplate";sf.base.resetBlazorTemplate(o,"GroupCaptionTemplate")}}},t.prototype.refreshComplete=function(e){this.parent.trigger(c,e)},t.prototype.refreshDataManager=function(e){var t,i=this;void 0===e&&(e={}),"virtualscroll"!==e.requestType&&"infiniteScroll"!==e.requestType&&this.parent.showSpinner(),this.parent.notify("reset-infinite-blocks",e),this.emptyGrid=!1;var r=this.isNeedForeignAction();if(this.ariaService.setBusy(this.parent.getContent().querySelector("."+Q),!0),r){var n=new sf.data.Deferred;t=this.getFData(n,e)}if(t=t?t.then((function(t){var r=i.data.generateQuery().requiresCount();if(i.emptyGrid){var n=new sf.data.Deferred;return n.resolve({result:[],count:0}),n.promise}return i.data.getData(e,r)})):this.data.getData(e,this.data.generateQuery().requiresCount()),this.parent.getForeignKeyColumns().length&&(!r||this.parent.searchSettings.key.length)){var s=new sf.data.Deferred;t=t.then((function(r){return i.parent.notify("getForeignKeyData",{dataManager:t,result:r,promise:s,action:e}),s.promise}))}this.parent.groupSettings.disablePageWiseAggregates&&this.parent.groupSettings.columns.length&&(t=t.then((function(e){return i.validateGroupRecords(e)}))),t.then((function(t){return i.dataManagerSuccess(t,e)})).catch((function(t){return i.dataManagerFailure(t,e)}))},t.prototype.getFData=function(e,t){return this.parent.notify("getForeignKeyData",{isComplex:!0,promise:e,action:t}),e.promise},t.prototype.isNeedForeignAction=function(){var e=this.parent;return!!(e.allowFiltering&&e.filterSettings.columns.length||e.searchSettings.key.length)&&this.foreignKey(this.parent.getForeignKeyColumns())},t.prototype.foreignKey=function(e){var t=this;return e.some((function(e){return!(!t.parent.filterSettings.columns.some((function(t){return e.uid===t.uid}))&&!t.parent.searchSettings.key.length)}))},t.prototype.sendBulkRequest=function(e){var t=this;e.requestType="batchsave";var i=this.data.saveChanges(e.changes,this.parent.getPrimaryKeyFieldNames()[0],e.original),r=this.data.generateQuery().requiresCount();this.data.dataManager.dataSource.offline?this.refreshDataManager({requestType:"batchsave"}):i.then((function(i){t.data.getData(e,r).then((function(i){return t.dmSuccess(i,e)})).catch((function(i){return t.dmFailure(i,e)}))})).catch((function(i){return t.dmFailure(i,e)}))},t.prototype.dmSuccess=function(e,t){this.dataManagerSuccess(e,t)},t.prototype.dmFailure=function(e,t){this.dataManagerFailure(e,t)},t.prototype.renderEmptyRow=function(){this.emptyRow(!0)},t.prototype.emptyRow=function(e){var t=this.parent,i=this.contentRenderer.getTable().querySelector(se);sf.base.isNullOrUndefined(i)||sf.base.remove(i),i=this.parent.createElement(se);var r=0;(t.detailTemplate||t.childGrid)&&++r;var n=this.parent.createElement("tr",{className:"e-emptyrow"});n.appendChild(this.parent.createElement("td",{innerHTML:this.l10n.getConstant("EmptyRecord"),attrs:{colspan:(t.getVisibleColumns().length+r).toString()}})),i.appendChild(n),this.contentRenderer.renderEmpty(i),e&&(this.parent.trigger(u,{}),this.parent.notify(b,{rows:[new N({isDataRow:!0,cells:[new P({isDataCell:!0,visible:!0})]})]}))},t.prototype.dynamicColumnChange=function(){this.parent.getCurrentViewRecords().length&&this.updateColumnType(this.parent.getCurrentViewRecords()[0])},t.prototype.updateColumnType=function(e){for(var t,r=this.parent.getColumns(),n=e&&e.items?e.items[0]:e,s=this.locator.getService("valueFormatter"),o=0,l=r.length;o<l;o++){t=$i(r[o].field||"",n),sf.base.isNullOrUndefined(r[o].customFormat)||(r[o].format=r[o].customFormat),sf.base.isNullOrUndefined(r[o].validationRules)||sf.base.isNullOrUndefined(r[o].validationRules.equalTo)||(r[o].validationRules.equalTo[0]=this.parent.element.id+r[o].validationRules.equalTo[0]),r[o].isForeignColumn()&&r[o].columnData&&(t=$i(r[o].foreignKeyValue||"",r[o].columnData[0])),sf.base.isNullOrUndefined(t)?r[o].type=r[o].type||null:(this.isColTypeDef=!0,r[o].type||(r[o].type=t.getDay?t.getHours()>0||t.getMinutes()>0||t.getSeconds()>0||t.getMilliseconds()>0?"datetime":"date":i(t)));var h=new a;r[o].format&&(r[o].format.skeleton||r[o].format.format&&"string"==typeof r[o].format.format)&&(r[o].setFormatter(h.getFormatFunction(sf.base.extend({},r[o].format))),r[o].setParser(h.getParserFunction(r[o].format))),"string"==typeof r[o].format?Li(this.locator,r[o]):r[o].format||"number"!==r[o].type||r[o].setParser(s.getParserFunction({format:"n2"}))}},t.prototype.dataManagerSuccess=function(t,i){var r=this,n=this.parent;this.contentRenderer=this.renderer.getRenderer(e.RenderType.Content),this.headerRenderer=this.renderer.getRenderer(e.RenderType.Header),t.actionArgs=i;var s=this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&("delete"===i.requestType||"save"===i.requestType&&"add"===this.parent.infiniteScrollModule.requestType);n.trigger("beforeDataBound",t,(function(e){if(!e.cancel){e.result=sf.base.isNullOrUndefined(e.result)?[]:e.result;var o=Object.keys(e.result).length;if(!r.parent.isDestroyed)if(n.getColumns().length||o||n.columns.length&&n.columns[0]instanceof h)if(!r.isInfiniteEnd(i)||o){if(r.parent.isEdit=!1,r.parent.notify("edit-reset",{}),r.parent.notify("tooltip-destroy",{}),r.contentRenderer.prevCurrentView=r.parent.currentViewData.slice(),n.currentViewData=e.result,n.notify("refresh-infinite-current-view-data",{args:i,data:e.result}),!o&&e.count&&n.allowPaging&&i&&"delete"!==i.requestType)return!r.parent.groupSettings.enableLazyLoading||"grouping"!==i.requestType&&"ungrouping"!==i.requestType||r.parent.notify("grouping-complete",i),n.prevPageMoving=!0,n.pageSettings.totalRecordsCount=e.count,"paging"!==i.requestType&&(n.pageSettings.currentPage=Math.ceil(e.count/n.pageSettings.pageSize)),void n.dataBind();if((n.getColumns().length||!o)&&r.isLayoutRendered||Zi(n)||r.updatesOnInitialRender(e),!r.isColTypeDef&&n.getCurrentViewRecords()&&(r.data.dataManager.dataSource.offline&&n.dataSource&&n.dataSource.length?r.updateColumnType(n.dataSource[0]):r.updateColumnType(n.getCurrentViewRecords()[0])),r.parent.isInitialLoad||!r.parent.groupSettings.disablePageWiseAggregates||r.parent.groupSettings.columns.length||(e.result=r.parent.dataSource instanceof Array?r.parent.dataSource:r.parent.currentViewData),!r.parent.isReact&&!r.parent.isVue||"infiniteScroll"===i.requestType||i.isFrozen||jr(r.parent,["footerTemplate"]),r.parent.notify(m,sf.base.extend({count:e.count,result:e.result,aggregates:e.aggregates},i)),(n.groupSettings.columns.length||i&&"ungrouping"===i.requestType)&&i&&"filtering"!==i.requestType&&r.headerRenderer.refreshUI(),o){if(Zi(n)){i.scrollTop={top:r.contentRenderer.content.scrollTop}}s?r.parent.notify("infinite-edit-handler",{e:i,result:t.result,count:t.count,agg:t.aggregates}):r.parent.enableImmutableMode?r.contentRenderer.immutableModeRendering(i):r.contentRenderer.refreshContentRows(i)}else{if(i&&i.isCaptionCollapse)return;if(!n.getColumns().length)return n.element.innerHTML="",void alert(r.l10n.getConstant("EmptyDataSourceError"));if(r.contentRenderer.setRowElements([]),r.contentRenderer.setRowObjects([]),r.ariaService.setBusy(r.parent.getContent().querySelector("."+Q),!1),r.renderEmptyRow(),i){var a=(i.requestType||"").toLowerCase()+"-complete";r.parent.notify(a,i),"batchsave"===i.requestType&&(i.cancel=!1,i.rows=[],i.isFrozen=0!==r.parent.getFrozenColumns()&&!i.isFrozen,r.parent.trigger(c,i))}r.parent.hideSpinner()}r.parent.notify("toolbar-refresh",{}),r.setRowCount(r.parent.getCurrentViewRecords().length),r.parent.getDataModule().isQueryInvokedFromData=!1}else r.parent.notify("infinite-edit-handler",{e:i,result:t.result,count:t.count,agg:t.aggregates});else n.hideSpinner()}}))},t.prototype.dataManagerFailure=function(e,t){this.ariaService.setOptions(this.parent.getContent().querySelector("."+Q),{busy:!1,invalid:!0}),this.setRowCount(1),this.parent.trigger("actionFailure",{error:e}),this.parent.hideSpinner(),"save"!==t.requestType&&"delete"!==t.requestType&&"bulk-save"!==t.name&&(this.parent.currentViewData=[],this.renderEmptyRow(),this.parent.log("actionfailure",{error:e}))},t.prototype.setRowCount=function(e){this.ariaService.setOptions(this.parent.getHeaderTable(),{rowcount:e?e.toString():"1"})},t.prototype.isInfiniteEnd=function(e){return this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&"delete"===e.requestType},t.prototype.updatesOnInitialRender=function(e){this.isLayoutRendered=!0,this.parent.columns.length<1&&this.buildColumns(e.result[0]),fi(this.parent.columns,null,this.parent),this.headerRenderer.renderTable(),this.contentRenderer.renderTable(),this.parent.isAutoGen=!0,this.parent.notify(E,{})},t.prototype.iterateComplexColumns=function(e,t,r){for(var n=Object.keys(e),s=0;s<n.length;s++){("object"!==i(e[n[s]])||!e[n[s]]||e[n[s]]instanceof Date?[]:Object.keys(e[n[s]])).length?this.iterateComplexColumns(e[n[s]],t+(n[s]+"."),r):(r[this.counter]=t+n[s],this.counter++)}},t.prototype.buildColumns=function(e){var t=[],i={};this.iterateComplexColumns(e,"",i);for(var r=Object.keys(i).filter((function(e){return"BlazId"!==i[e]})).map((function(e){return i[e]})),n=0,s=r.length;n<s;n++)t[n]={field:r[n]},this.parent.enableColumnVirtualization&&(t[n].width=sf.base.isNullOrUndefined(t[n].width)?200:t[n].width);this.parent.setProperties({columns:t},!0)},t.prototype.instantiateRenderer=function(){this.renderer.addRenderer(e.RenderType.Header,new ye(this.parent,this.locator)),this.renderer.addRenderer(e.RenderType.Content,new me(this.parent,this.locator));var t=this.locator.getService("cellRendererFactory");t.addCellRenderer(e.CellType.Header,new Le(this.parent,this.locator)),t.addCellRenderer(e.CellType.Data,new ve(this.parent,this.locator)),t.addCellRenderer(e.CellType.StackedHeader,new He(this.parent,this.locator)),t.addCellRenderer(e.CellType.Indent,new je(this.parent,this.locator)),t.addCellRenderer(e.CellType.GroupCaption,new Ge(this.parent,this.locator)),t.addCellRenderer(e.CellType.GroupCaptionEmpty,new _e(this.parent,this.locator)),t.addCellRenderer(e.CellType.Expand,new Ke(this.parent,this.locator)),t.addCellRenderer(e.CellType.HeaderIndent,new Xe(this.parent,this.locator)),t.addCellRenderer(e.CellType.StackedHeader,new He(this.parent,this.locator)),t.addCellRenderer(e.CellType.DetailHeader,new Je(this.parent,this.locator)),t.addCellRenderer(e.CellType.RowDragHIcon,new rt(this.parent,this.locator)),t.addCellRenderer(e.CellType.DetailExpand,new $e(this.parent,this.locator)),t.addCellRenderer(e.CellType.DetailFooterIntent,new je(this.parent,this.locator)),t.addCellRenderer(e.CellType.RowDragIcon,new tt(this.parent,this.locator))},t.prototype.addEventListener=function(){var e=this;this.parent.isDestroyed||(this.parent.on(f,this.instantiateRenderer,this),this.parent.on("refreshdataSource",this.dataManagerSuccess,this),this.parent.on(w,this.refresh,this),this.parent.on("refresh-complete",this.refreshComplete,this),this.parent.on("bulk-save",this.sendBulkRequest,this),this.parent.on("showEmptyGrid",(function(){e.emptyGrid=!0}),this),this.parent.on(E,this.dynamicColumnChange,this))},t.prototype.validateGroupRecords=function(e){var t=this,i=e.result.length-1;if(i<0)return Promise.resolve(e);var r=e.result[0],n=e.result[i],s=[],o=function(e){for(var i=[r,n],o=0;o<i.length;o++)s.push(new sf.data.Predicate("field","==",i[o].field).and(t.getPredicate("key","equal",i[o].key)));e.where(sf.data.Predicate.or(s))},a=new sf.data.Query;o(a);var l=new sf.data.DataManager(e.result).executeLocal(a),h=this.data.generateQuery(!0),d=[];if(this.data.isRemote()){for(var p=[r,n],c=0;c<p.length;c++)d.push(this.getPredicate(p[c].field,"equal",p[c].key));h.where(sf.data.Predicate.or(d))}else o(h);var u=new sf.data.Deferred;return this.data.getData({},h).then((function(i){t.updateGroupInfo(l,i.result),u.resolve(e)})).catch((function(e){return u.reject(e)})),u.promise},t.prototype.getPredicate=function(e,t,i){return i instanceof Date?Yi({field:e,operator:t,value:i}):new sf.data.Predicate(e,t,i)},t.prototype.updateGroupInfo=function(e,t){for(var i=new sf.data.DataManager(t),r=e,n=0;n<r.length;n++){var s=i.executeLocal((new sf.data.Query).where(new sf.data.Predicate("field","==",r[n].field).and(this.getPredicate("key","equal",r[n].key))))[0];r[n].count=s.count;var o=r[n].items,a=s.items;o.GroupGuid&&(r[n].items=this.updateGroupInfo(r[n].items,s.items));for(var l=this.parent.aggregates,h=0;h<l.length;h++)for(var d=l[h],p=0;p<d.columns.length;p++)for(var c=d.columns[p].type instanceof Array?d.columns[p].type:[d.columns[p].type],u=0;u<c.length;u++){var f=d.columns[p].field+" - "+c[u].toLowerCase(),g=o.level?a.records:s.items,m=this.parent;if("Custom"===c[u]){var y=o.level?a:s,v=d.columns[p].customAggregate;"string"==typeof v&&(v=sf.base.getValue(v,window)),r[n].aggregates[f]=v?v.call(m,y,d.columns[p]):""}else r[n].aggregates[f]=sf.data.DataUtil.aggregates[c[u].toLowerCase()](g,d.columns[p].field)}}return e},t}(),st=function(){function t(){this.cellRenderMap={}}return t.prototype.addCellRenderer=function(t,i){t="string"==typeof t?t:sf.base.getEnumValue(e.CellType,t),sf.base.isNullOrUndefined(this.cellRenderMap[t])&&(this.cellRenderMap[t]=i)},t.prototype.getCellRenderer=function(t){if(t="string"==typeof t?t:sf.base.getEnumValue(e.CellType,t),sf.base.isNullOrUndefined(this.cellRenderMap[t]))throw"The cellRenderer "+t+" is not found";return this.cellRenderMap[t]},t}(),ot=function(){function t(e,t){this.sortedCols=[],this.sortPredicate=[],this.isCustomDialog=!1,this.parent=e,this.serviceLocator=t,this.addEventListener()}return t.prototype.addEventListener=function(){this.evtHandlers=[{event:"filter-dialog-close",handler:this.closeCustomDialog},{event:"refresh-cutsom-filter-ok-button",handler:this.refreshCustomFilterOkBtn},{event:"render-responsive-cmenu",handler:this.renderResponsiveContextMenu},{event:"filter-cmenu-select",handler:this.renderCustomFilterDiv},{event:"custom-filter-close",handler:this.customExFilterClose},{event:"refresh-cutsom-filter-clear-button",handler:this.refreshCustomFilterClearBtn}],Nr(this.parent,this.evtHandlers,!0,this),this.onActionCompleteFn=this.editComplate.bind(this),this.parent.addEventListener(c,this.onActionCompleteFn)},t.prototype.customExFilterClose=function(){this.isCustomDlgRender=!1},t.prototype.renderCustomFilterDiv=function(){var e=this.customResponsiveDlg.element.querySelector(".e-dlg-header-content"),t=e.querySelector(".e-dlg-custom-header"),i=e.querySelector(".e-dlg-closeicon-btn");this.isCustomDlgRender=!0,this.parent.filterModule.filterModule.closeDialog(),this.saveBtn.element.style.display="",this.refreshCustomFilterOkBtn({disabled:!1}),this.backBtn.element.style.display="none",i.style.display="",t.innerHTML=this.parent.localeObj.getConstant("CustomFilter");var r=this.customResponsiveDlg.element.querySelector(".e-dlg-content");this.customExcelFilterParent=this.parent.createElement("div",{className:"e-xl-customfilterdiv e-default-filter"}),r.appendChild(this.customExcelFilterParent)},t.prototype.renderResponsiveContextMenu=function(t){if(this.action===e.ResponsiveDialogAction.isFilter){var i=this.customResponsiveDlg.element.querySelector(".e-dlg-content"),r=this.customResponsiveDlg.element.querySelector(".e-dlg-header-content"),n=r.querySelector(".e-dlg-closeicon-btn"),s=r.querySelector(".e-dlg-custom-header");if(t.isOpen){i.firstChild.style.display="none",i.appendChild(t.target),n.style.display="none",this.saveBtn.element.style.display="none",this.filterClearBtn.element.style.display="none",s.innerHTML=t.header;var o=this.parent.createElement("button"),a=this.parent.createElement("span",{className:"e-btn-icon e-resfilterback e-icons"});o.appendChild(a),this.backBtn=new sf.buttons.Button({cssClass:"e-res-back-btn"}),this.backBtn.appendTo(o),s.parentElement.insertBefore(o,s)}else this.backBtn&&!this.isCustomDlgRender&&(i.firstChild.style.display="",sf.base.remove(this.backBtn.element),n.style.display="",this.saveBtn.element.style.display="",this.isFiltered&&(this.filterClearBtn.element.style.display=""),s.innerHTML=this.getHeaderTitle({action:e.ResponsiveDialogAction.isFilter},t.col))}},t.prototype.refreshCustomFilterClearBtn=function(e){this.filterClearBtn&&(this.isFiltered=e.isFiltered,this.filterClearBtn.element.style.display=e.isFiltered?"":"none")},t.prototype.refreshCustomFilterOkBtn=function(e){this.saveBtn&&(this.saveBtn.disabled=e.disabled)},t.prototype.renderResponsiveContent=function(t){var i=this,r=this.parent;if(t)return this.filterParent=this.parent.createElement("div",{className:"e-mainfilterdiv e-default-filter",id:t.uid+"-main-filter"}),this.filterParent;var n=r.getColumns();this.customColumnDiv=r.createElement("div",{className:"columndiv",styles:"width: 100%"});var s=r.createElement("div",{className:"e-ressortbutton-parent"}),o=[],a=this.action===e.ResponsiveDialogAction.isSort,l=this.action===e.ResponsiveDialogAction.isFilter;if(l)for(var h=0;h<r.filterSettings.columns.length;h++)o.push(r.filterSettings.columns[h].field);for(h=0;h<n.length;h++)if(!(!n[h].visible||!n[h].allowSorting&&a||!n[h].allowFiltering&&l)){var d=r.createElement("div",{className:"e-responsivecoldiv"});d.setAttribute("data-e-mappingname",n[h].field),d.setAttribute("data-e-mappinguid",n[h].uid);var p=r.createElement("span",{innerHTML:n[h].headerText,className:"e-res-header-text"});if(d.appendChild(p),this.customColumnDiv.appendChild(d),a){var c=this.getSortedFieldsAndDirections("field").indexOf(n[h].field),u=r.createElement("button",{id:r.element.id+n[h].field+"sortbutton"}),f=s.cloneNode();f.appendChild(u),d.appendChild(f),new sf.buttons.Button({cssClass:"e-ressortbutton"}).appendTo(u),u.innerHTML=c>-1?this.parent.sortSettings.columns[c].direction:"None",u.onclick=function(e){i.sortButtonClickHandler(e.target)}}if(l&&o.indexOf(n[h].field)>-1){var g=r.createElement("div",{className:"e-icons e-res-icon e-filtersetdiv"}),m=r.createElement("span",{className:"e-icons e-res-icon e-filterset"});m.setAttribute("colType",n[h].type),g.appendChild(m),d.appendChild(g)}}return sf.base.EventHandler.add(this.customColumnDiv,"click",this.customFilterColumnClickHandler,this),this.customColumnDiv},t.prototype.getSortedFieldsAndDirections=function(e){for(var t=[],i=0;i<this.parent.sortSettings.columns.length;i++)t.push(this.parent.sortSettings.columns[i][e]);return t},t.prototype.sortButtonClickHandler=function(e){if(e){var t=yi(e,"e-responsivecoldiv").getAttribute("data-e-mappingname");this.parent.allowMultiSorting||(this.sortPredicate=[],this.sortedCols=[],this.isSortApplied=!1,this.resetSortButtons(e));var i=e.textContent,r="None"===i?"Ascending":"Ascending"===i?"Descending":"None";e.innerHTML=r,this.setSortedCols(t,r)}},t.prototype.resetSortButtons=function(e){for(var t=[].slice.call(this.customColumnDiv.getElementsByClassName("e-ressortbutton")),i=0;i<t.length;i++)t[i]!==e&&(t[i].innerHTML="None")},t.prototype.setSortedCols=function(e,t){var i=this.getCurrentSortedFields().indexOf(e);this.parent.allowMultiSorting&&i>-1&&(this.sortedCols.splice(i,1),this.sortPredicate.splice(i,1)),this.isSortApplied=!0,"None"!==t&&(this.sortedCols.push(e),this.sortPredicate.push({field:e,direction:t}))},t.prototype.getCurrentSortedFields=function(){for(var e=[],t=0;t<this.sortedCols.length;t++)e.push(this.sortedCols[t]);return e},t.prototype.customFilterColumnClickHandler=function(t){if(this.action===e.ResponsiveDialogAction.isFilter){var i=this.parent,r=t.target;if("FilterBar"!==i.filterSettings.type)if(r.classList.contains("e-responsivecoldiv")||r.parentElement.classList.contains("e-responsivecoldiv")){if((o=r.getAttribute("data-e-mappingname"))||(o=r.parentElement.getAttribute("data-e-mappingname")),o){var n=i.getColumnByField(o);this.isRowResponsive=!0,this.showResponsiveDialog(n)}}else if(r.classList.contains("e-filterset")||r.parentElement.classList.contains("e-filtersetdiv")){var s=yi(r,"e-responsivecoldiv");if(s){var o=s.getAttribute("data-e-mappingname");("Menu"===(n=i.getColumnByField(o)).filter.type||!n.filter.type&&"Menu"===i.filterSettings.type)&&(this.isDialogClose=!0),this.parent.filterModule.filterModule.clearCustomFilter(n),this.removeCustomDlgFilterEle(r)}}}},t.prototype.showResponsiveDialog=function(t){if(this.isCustomDialog&&this.action===e.ResponsiveDialogAction.isFilter&&!this.isRowResponsive)this.renderCustomFilterDialog();else{if(this.filteredCol=t,this.renderResponsiveDialog(t),this.parent.enableAdaptiveUI&&t&&(this.parent.filterModule.setFilterModel(t),this.parent.filterModule.filterModule.openDialog(this.parent.filterModule.createOptions(t,void 0))),this.action===e.ResponsiveDialogAction.isSort){var i={cancel:!1,dialogObj:this.customResponsiveDlg,requestType:"beforeOpenAptiveSortDialog"};if(this.parent.trigger("beforeOpenAdaptiveDialog",i),i.cancel)return}this.customResponsiveDlg.show(!0),this.customResponsiveDlg.element.style.maxHeight="100%",this.setTopToChildDialog(this.customResponsiveDlg.element)}},t.prototype.setTopToChildDialog=function(e){var t=e.querySelector(".e-dialog");if(t){var i=e.querySelector(".e-dlg-header-content").getBoundingClientRect().height;t.style.top=i+"px"}},t.prototype.renderCustomFilterDialog=function(t){var i=this.parent;if(this.action!==e.ResponsiveDialogAction.isFilter||"FilterBar"!==i.filterSettings.type){var r=this.parent.createElement("div",{id:i.element.id+"customfilter",className:"e-customfilterdiv e-responsive-dialog"});this.parent.element.appendChild(r),this.customFilterDlg=this.getDialogOptions(t,!0);var n={cancel:!1,dialogObj:this.customFilterDlg,requestType:"beforeOpenAptiveFilterDialog"};this.parent.trigger("beforeOpenAdaptiveDialog",n),n.cancel||(this.customFilterDlg.appendTo(r),this.customFilterDlg.show(!0),this.customFilterDlg.element.style.maxHeight="100%")}},t.prototype.getDialogOptions=function(t,i,r){var n=new sf.popups.Dialog({isModal:!0,showCloseIcon:!0,closeOnEscape:!1,locale:this.parent.locale,target:this.parent.adaptiveDlgTarget?this.parent.adaptiveDlgTarget:document.body,visible:!1,enableRtl:this.parent.enableRtl,content:this.renderResponsiveContent(t),open:this.dialogOpen.bind(this),created:this.dialogCreated.bind(this),close:this.beforeDialogClose.bind(this),width:"100%",height:"100%",animationSettings:{effect:"None"}});return n.isStringTemplate=!0,i?(n.header=this.renderResponsiveHeader(t,void 0,!0),n.cssClass="e-customfilter"):(n.header=this.renderResponsiveHeader(t),n.cssClass="Vertical"===this.parent.rowRenderingMode&&this.action===e.ResponsiveDialogAction.isFilter?"e-res"+r+" e-row-responsive-filter":"e-res"+r),n},t.prototype.renderResponsiveDialog=function(t){var i=this.parent;if(this.action!==e.ResponsiveDialogAction.isFilter||"FilterBar"!==i.filterSettings.type){var r=this.action===e.ResponsiveDialogAction.isFilter?"filter":"sort",n=this.parent.createElement("div",{id:i.element.id+"responsive"+r,className:"e-res"+r+"div e-responsive-dialog"});this.parent.element.appendChild(n),this.customResponsiveDlg=this.getDialogOptions(t,!1,r),this.customResponsiveDlg.appendTo(n)}},t.prototype.dialogCreated=function(){kr(this.parent)},t.prototype.dialogOpen=function(){if(this.action===e.ResponsiveDialogAction.isSort&&this.parent.allowMultiSorting)for(var t=0;t<this.parent.sortSettings.columns.length;t++){this.sortedCols.push(this.parent.sortSettings.columns[t].field);var i=this.parent.sortSettings.columns[t].field,r=this.parent.sortSettings.columns[t].direction;this.sortPredicate.push({field:i,direction:r})}},t.prototype.beforeDialogClose=function(t){this.isDialogClose=t.element&&!t.element.querySelector(".e-xl-customfilterdiv")&&t.element.classList.contains("e-resfilterdiv"),this.action===e.ResponsiveDialogAction.isFilter?t.element.classList.contains("e-resfilterdiv")?this.parent.filterModule.filterModule.closeResponsiveDialog(this.isCustomDlgRender):t.element.classList.contains("e-customfilterdiv")&&this.closeCustomFilter():this.action===e.ResponsiveDialogAction.isSort&&this.closeCustomDialog(),this.parent.off("enter-key-handler",this.keyHandler)},t.prototype.sortColumn=function(){if(this.isSortApplied){this.sortPredicate.length&&this.parent.setProperties({sortSettings:{columns:[]}},!0);for(var e=0;e<this.sortPredicate.length;e++)this.parent.sortColumn(this.sortPredicate[e].field,this.sortPredicate[e].direction,this.parent.allowMultiSorting);this.sortPredicate.length||this.parent.clearSorting(),this.closeCustomDialog()}else this.closeCustomDialog()},t.prototype.getHeaderTitle=function(t,i){var r,n=this.parent;return this.action===e.ResponsiveDialogAction.isEdit?r=n.localeObj.getConstant("EditFormTitle")+t.primaryKeyValue[0]:this.action===e.ResponsiveDialogAction.isAdd?r=n.localeObj.getConstant("AddFormTitle"):this.action===e.ResponsiveDialogAction.isFilter?r=i?i.headerText||i.field:n.localeObj.getConstant("FilterButton"):this.action===e.ResponsiveDialogAction.isSort&&(r=n.localeObj.getConstant("Sort")),r},t.prototype.getDialogName=function(t){var i;return t===e.ResponsiveDialogAction.isAdd||t===e.ResponsiveDialogAction.isEdit?i="dialogEdit_wrapper_title":t===e.ResponsiveDialogAction.isFilter&&(i="responsive_filter_dialog_wrapper"),i},t.prototype.getButtonText=function(t){var i;return t===e.ResponsiveDialogAction.isAdd||t===e.ResponsiveDialogAction.isEdit?i="Save":t!==e.ResponsiveDialogAction.isFilter&&this.action!==e.ResponsiveDialogAction.isSort||(i="OKButton"),i},t.prototype.renderResponsiveHeader=function(t,i,r){var n=this,s=this.parent;s.on("enter-key-handler",this.keyHandler,this);var o=s.element.id+this.getDialogName(this.action),a=s.createElement("div",{className:"e-res-custom-element"}),l=s.createElement("div",{className:"e-dlg-custom-header",id:o});l.innerHTML=this.getHeaderTitle(i,t),a.appendChild(l);var h=s.createElement("button");r||(this.saveBtn=new sf.buttons.Button({cssClass:"e-primary e-flat e-res-apply-btn"}),h.innerHTML=s.localeObj.getConstant(this.getButtonText(this.action)),this.saveBtn.appendTo(h),h.onclick=function(e){n.dialogHdrBtnClickHandler()});var d=this.action===e.ResponsiveDialogAction.isSort,p=this.action===e.ResponsiveDialogAction.isFilter;if(p||d){var c=d?"sort":"filter",u=s.createElement("button");if(this.filterClearBtn=new sf.buttons.Button({cssClass:"e-primary e-flat e-res-"+c+"-clear-btn"}),p){var f=s.createElement("span",{className:"e-btn-icon e-icon-filter-clear e-icons"});u.appendChild(f)}else u.innerHTML=s.localeObj.getConstant("Clear");a.appendChild(u),this.filterClearBtn.appendTo(u),u.onclick=function(e){yi(e.target,"e-customfilter")?(n.parent.filterModule.clearFiltering(),n.removeCustomDlgFilterEle()):p?n.filterClear():(n.resetSortButtons(),n.sortedCols=[],n.sortPredicate=[],n.isSortApplied=!0)},a.appendChild(u)}return r||a.appendChild(h),a},t.prototype.filterClear=function(){this.parent.filterModule.filterModule.clearCustomFilter(this.filteredCol),this.parent.filterModule.filterModule.closeResponsiveDialog()},t.prototype.dialogHdrBtnClickHandler=function(){this.action===e.ResponsiveDialogAction.isEdit||this.action===e.ResponsiveDialogAction.isAdd?this.parent.endEdit():this.action===e.ResponsiveDialogAction.isFilter?this.parent.filterModule.filterModule.applyCustomFilter({col:this.filteredCol,isCustomFilter:this.isCustomDlgRender}):this.action===e.ResponsiveDialogAction.isSort&&this.sortColumn()},t.prototype.closeCustomDialog=function(){if(this.isCustomDlgRender){var e=this.customResponsiveDlg.element.querySelector(".e-mainfilterdiv");sf.base.remove(e)}else this.isRowResponsive=!1,this.isCustomDlgRender=!1,this.destroyCustomFilterDialog()},t.prototype.destroyCustomFilterDialog=function(){if(this.customResponsiveDlg){var t=document.getElementById(this.customResponsiveDlg.element.id);this.customResponsiveDlg&&!this.customResponsiveDlg.isDestroyed&&t&&(this.customResponsiveDlg.destroy(),sf.base.remove(t)),this.closeCustomFilter(),this.action===e.ResponsiveDialogAction.isSort&&(this.sortPredicate=[],this.sortedCols=[],this.isSortApplied=!1)}},t.prototype.closeCustomFilter=function(){if(!this.isDialogClose&&this.customFilterDlg){var e=document.getElementById(this.customFilterDlg.element.id);this.customFilterDlg&&!this.customFilterDlg.isDestroyed&&e&&(this.customFilterDlg.destroy(),sf.base.remove(e))}this.isCustomDialog=!1,this.isDialogClose=!1},t.prototype.removeCustomDlgFilterEle=function(e){if(e)e.parentElement.classList.contains("e-filtersetdiv")?sf.base.remove(e.parentElement):sf.base.remove(e);else for(var t=this.customColumnDiv.children,i=0;i<t.length;i++)(e=t[i].querySelector(".e-filtersetdiv"))&&(sf.base.remove(e),i--)},t.prototype.keyHandler=function(t){13===t.keyCode&&(this.action===e.ResponsiveDialogAction.isFilter&&t.target.classList.contains("e-searchinput")||this.action===e.ResponsiveDialogAction.isEdit||this.action===e.ResponsiveDialogAction.isAdd)&&this.dialogHdrBtnClickHandler()},t.prototype.editComplate=function(e){"save"!==e.requestType&&"cancel"!==e.requestType||this.parent.off("enter-key-handler",this.keyHandler)},t.prototype.removeEventListener=function(){this.customColumnDiv&&sf.base.EventHandler.remove(this.customColumnDiv,"click",this.customFilterColumnClickHandler),Nr(this.parent,this.evtHandlers,!0,this),this.parent.removeEventListener(c,this.onActionCompleteFn)},t}(),at=function(){function e(){this.services={}}return e.prototype.register=function(e,t){sf.base.isNullOrUndefined(this.services[e])&&(this.services[e]=t)},e.prototype.getService=function(e){if(sf.base.isNullOrUndefined(this.services[e]))throw"The service "+e+" is not registered";return this.services[e]},e.prototype.registerAdaptiveService=function(e,t,i){t?(e.responsiveDialogRenderer=new ot(e.parent,e.serviceLocator),e.responsiveDialogRenderer.action=i):e.responsiveDialogRenderer&&(e.responsiveDialogRenderer.removeEventListener(),e.responsiveDialogRenderer=void 0)},e}(),lt=function(){function t(){this.rendererMap={}}return t.prototype.addRenderer=function(t,i){var r=sf.base.getEnumValue(e.RenderType,t);sf.base.isNullOrUndefined(this.rendererMap[r])&&(this.rendererMap[r]=i)},t.prototype.getRenderer=function(t){var i=sf.base.getEnumValue(e.RenderType,t);if(sf.base.isNullOrUndefined(this.rendererMap[i]))throw"The renderer "+i+" is not found";return this.rendererMap[i]},t}(),ht=function(){function e(e){this.parent=e}return e.prototype.setWidthToColumns=function(){var e,t=0,i=this.parent.getColumnIndexesInView(),r=!0;if(this.parent.allowGrouping)for(var n=this.parent.groupSettings.columns.length;t<n;t++)this.parent.enableColumnVirtualization&&-1===i.indexOf(t)?r=!1:this.setColumnWidth(new h({width:"30px"}),t);(this.parent.detailTemplate||this.parent.childGrid)&&(this.setColumnWidth(new h({width:"30px"}),t),t++),this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()&&(this.setColumnWidth(new h({width:"30px"}),t),t++);for(var s=this.parent.getColumns(),o=0;o<s.length;o++)this.setColumnWidth(s[o],r&&this.parent.enableColumnVirtualization?void 0:o+t);this.parent.isRowDragable()&&"Right"===this.parent.getFrozenMode()&&this.setColumnWidth(new h({width:"30px"}),s.length),e=this.getTableWidth(this.parent.getColumns()),"auto"!==this.parent.width&&-1===this.parent.width.toString().indexOf("%")&&this.setMinwidthBycalculation(e)},e.prototype.setMinwidthBycalculation=function(e){var t=0,i=this.parent.getColumns().filter((function(e){return sf.base.isNullOrUndefined(e.width)||"auto"===e.width}));if(i.length){t=sf.base.isNullOrUndefined(this.parent.width)||"auto"===this.parent.width||"string"!=typeof this.parent.width||-1!==this.parent.width.indexOf("%")?this.parent.element.getBoundingClientRect().width-e:("string"==typeof this.parent.width?parseInt(this.parent.width,10):this.parent.width)-e;for(var r=0,n=0,s=i;n<s.length;n++){var o=s[n];r+=sf.base.isNullOrUndefined(o.minWidth)?0:"string"==typeof o.minWidth?parseInt(o.minWidth,10):o.minWidth}for(var a=0;a<i.length;a++){0===e&&this.parent.allowResizing&&this.isWidthUndefined()&&a!==i.length-1&&this.setUndefinedColumnWidth(i);var l=this.parent.getColumnIndexByField(i[a].field)+this.parent.getIndentCount();0!==e&&t<r?this.setWidth(i[a].minWidth,l):0!==e&&t>r&&this.setWidth("",l,!0)}}},e.prototype.setUndefinedColumnWidth=function(e){for(var t=0;t<e.length;t++)t!==e.length-1&&(e[t].width=200,this.setWidth(200,this.parent.getColumnIndexByField(e[t].field)))},e.prototype.setColumnWidth=function(e,t,i){if(!(this.parent.getColumns().length<1)){var r=sf.base.isNullOrUndefined(t)?this.parent.getNormalizedColumnIndex(e.uid):t,n=this.getWidth(e),s=this.getTableWidth(this.parent.getColumns());null!==n&&(this.setWidth(n,r),"auto"!==this.parent.width&&-1===this.parent.width.toString().indexOf("%")&&this.setMinwidthBycalculation(s),(this.parent.allowResizing&&"resize"===i||this.parent.getFrozenColumns()&&this.parent.allowResizing)&&this.setWidthToTable(),this.parent.notify("column-width-changed",{index:r,width:n,column:e,module:i}))}},e.prototype.setWidth=function(e,t,i){this.parent.groupSettings.columns.length>t&&yr(this.parent)&&(e=(30/this.parent.element.offsetWidth*100).toFixed(1)+"%");var r,n=this.parent.getHeaderTable(),s=this.parent.getContentTable(),o=sf.base.formatUnit(e),a=this.parent.getFrozenColumns(),l=this.parent.isRowDragable();a=a&&l?a+1:a;var h,d=this.parent.getHeaderContent().querySelector("."+_),p=this.parent.getContent().querySelector("."+G),c=this.parent.getFrozenLeftColumnsCount(),u=this.parent.getFrozenRightColumnsCount(),f=this.parent.getMovableColumnsCount(),g=0!==c||0!==u;if(a&&t>=a){if(!d||!d.querySelector(oe))return;r=d.querySelector(oe).children[t-a]}else if(this.parent.enableColumnVirtualization&&a&&this.parent.contentModule.isXaxis()&&d.scrollLeft>0){r=(v=d.querySelector(oe)).children[v.children.length-1-t]}else if(g){var m=void 0;if(c&&!u)m=(t=l?t-1:t)<c?n:d;else if(!c&&u)m=t>=f?n:d;else if(c&&u){t=l?t-1:t;var y=this.parent.getFrozenRightHeader();m=t<c?n:t<c+f?d:y}if(!(r=this.getColumnLevelFrozenColgroup(t,c,f,m)))return}else r=n.querySelector(oe).children[t];if(r&&!i?r.style.width=o:r&&i&&(r.style.width=""),a&&t>=a)h=this.parent.getContent().querySelector("."+G).querySelector(oe).children[t-a];else if(this.parent.enableColumnVirtualization&&a&&this.parent.contentModule.isXaxis()&&p.scrollLeft>0){var v;h=(v=this.parent.getContent().querySelector("."+G).querySelector(oe)).children[v.children.length-1-t]}else if(g){m=void 0;if(c&&!u&&(m=t<c?s:p),!c&&u&&(m=t>=f?s:p),c&&u){var b=this.parent.getContent().querySelector(".e-frozen-right-content");m=t<c?s:t<c+f?p:b}h=this.getColumnLevelFrozenColgroup(t,c,f,m)}else h=s.querySelector(oe).children[t];if(h&&!i?h.style.width=o:h&&i&&(h.style.width=""),!this.parent.enableColumnVirtualization){for(var C=this.parent.element.querySelectorAll(".e-table.e-inline-edit"),w=[],S=0;S<C.length;S++)if(yi(C[S],"e-grid").id===this.parent.element.id)for(var x=0;x<C[S].querySelector("colgroup").children.length;x++)w.push(C[S].querySelector("colgroup").children[x]);C.length&&w.length&&(w[t].style.width=o)}this.parent.isFrozenGrid()&&this.refreshFrozenScrollbar()},e.prototype.getColumnLevelFrozenColgroup=function(e,t,i,r){if(!r||!r.querySelector(oe))return null;var n=this.parent.getColumns(),s=this.parent.isRowDragable(),o=this.parent.getFrozenMode(),a=[].slice.call(r.querySelector(oe).children);return"Right"===o&&s&&e===i+this.parent.getFrozenRightColumnsCount()?a[a.length-1]:s&&-1===e?a[0]:"Left"===n[e].freeze?a[s?e+1:e]:"Right"===n[e].freeze?a[e-(t+i)]:a[e-t]},e.prototype.refreshFrozenScrollbar=function(){var e={cancel:!1};if(this.parent.notify("prevent-frozen-scroll-refresh",e),!e.cancel){var t=Di(),i=this.parent.element.querySelector(".e-frozenscrollbar"),r=this.parent.element.querySelector(".e-movablescrollbar"),n=this.parent.getContent().querySelector("."+W),s=this.parent.getContent().querySelector("."+G),o=n.firstElementChild.getBoundingClientRect().width,a=s.firstElementChild.getBoundingClientRect().width;if("Right"===this.parent.getFrozenMode()&&(o+=t),i.style.width=o+"px",this.parent.getFrozenMode()===ee){var l=this.parent.element.querySelector(".e-frozen-right-scrollbar"),h=this.parent.getContent().querySelector(".e-frozen-right-content").firstElementChild.getBoundingClientRect().width;"auto"!==this.parent.height&&(h+=t),l.style.width=h+"px"}else{if(this.parent.enableColumnVirtualization){var d=this.parent.getMovableVirtualContent().querySelector(".e-virtualtrack");d&&(a=d.scrollWidth)}"Right"!==this.parent.getFrozenMode()&&"auto"!==this.parent.height&&(a+=t)}r.firstElementChild.style.width=a+"px"}},e.prototype.getSiblingsHeight=function(e){return this.getHeightFromDirection(e,"previous")+this.getHeightFromDirection(e,"next")},e.prototype.getHeightFromDirection=function(e,t){for(var i=e[t+"ElementSibling"],r=0,n=[H,j,"e-groupdroparea","e-gridpager","e-toolbar"];i;)n.some((function(e){return i.classList.contains(e)}))&&(r+=i.offsetHeight),i=i[t+"ElementSibling"];return r},e.prototype.isWidthUndefined=function(){var e=this.parent.getColumns().filter((function(e){return sf.base.isNullOrUndefined(e.width)&&sf.base.isNullOrUndefined(e.minWidth)})).length;return this.parent.getColumns().length===e},e.prototype.getWidth=function(e){if(sf.base.isNullOrUndefined(e.width)&&this.parent.allowResizing&&sf.base.isNullOrUndefined(e.minWidth)&&!this.isWidthUndefined()&&(e.width=200),this.parent.isFrozenGrid()&&sf.base.isNullOrUndefined(e.width)&&(e.getFreezeTableName()===ie||e.getFreezeTableName()===te)&&(e.width=200),!e.width)return null;var t=parseInt(e.width.toString(),10);return e.minWidth&&t<parseInt(e.minWidth.toString(),10)?e.minWidth:e.maxWidth&&t>parseInt(e.maxWidth.toString(),10)?e.maxWidth:e.width},e.prototype.getTableWidth=function(e){for(var t=0,i=0,r=e;i<r.length;i++){var n=r[i],s=this.getWidth(n);"auto"===n.width&&(s=0),!1!==n.visible&&null!==s&&(t+=parseInt(s.toString(),10))}return t},e.prototype.calcMovableOrFreezeColWidth=function(e){var t=this.parent.getColumns().slice(),i=this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenColumns(),r=this.parent.getMovableColumnsCount(),n=this.parent.getFrozenRightColumnsCount();return"movable"===e?(n&&t.splice(i+r,t.length),i&&t.splice(0,i)):"freeze-left"===e?t.splice(i,t.length):"freeze-right"===e&&t.splice(0,i+r),sf.base.formatUnit(this.getTableWidth(t))},e.prototype.setWidthToFrozenRightTable=function(){var e=this.calcMovableOrFreezeColWidth("freeze-right");e=this.isAutoResize()?"100%":e;var t=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("."+X),i=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("."+X);t.style.width=e,i.style.width=e},e.prototype.setWidthToFrozenLeftTable=function(){var e=this.calcMovableOrFreezeColWidth("freeze-left");e=this.isAutoResize()?"100%":e,this.parent.getHeaderTable().style.width=e,this.parent.getContentTable().style.width=e},e.prototype.setWidthToMovableTable=function(){var e="",t=this.parent.getColumns().filter((function(e){return sf.base.isNullOrUndefined(e.width)})).length>=1,i=this.parent.getColumns().filter((function(e){return"auto"===e.width})).length>=1;"number"!=typeof this.parent.width||t||i?t||i||(e=this.calcMovableOrFreezeColWidth("movable")):e=sf.base.formatUnit(this.parent.width-parseInt(this.calcMovableOrFreezeColWidth("freeze").split("px")[0],10)-5),e=this.isAutoResize()?"100%":e,this.parent.getHeaderContent().querySelector("."+_).firstElementChild&&(this.parent.getHeaderContent().querySelector("."+_).firstElementChild.style.width=e),this.parent.getContent().querySelector("."+G).firstElementChild.style.width=e},e.prototype.setWidthToFrozenEditTable=function(){var e=this.calcMovableOrFreezeColWidth("freeze");e=this.isAutoResize()?"100%":e,this.parent.element.querySelectorAll(".e-table.e-inline-edit")[0].style.width=e},e.prototype.setWidthToMovableEditTable=function(){var e=this.calcMovableOrFreezeColWidth("movable");e=this.isAutoResize()?"100%":e,this.parent.element.querySelectorAll(".e-table.e-inline-edit")[1].style.width=e},e.prototype.setWidthToTable=function(){var e=sf.base.formatUnit(this.getTableWidth(this.parent.getColumns()));this.parent.isFrozenGrid()?((this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount())&&this.setWidthToFrozenLeftTable(),this.setWidthToMovableTable(),this.parent.getFrozenRightColumnsCount()&&this.setWidthToFrozenRightTable()):((this.parent.detailTemplate||this.parent.childGrid)&&this.setColumnWidth(new h({width:"30px"})),e=this.isAutoResize()?"100%":e,this.parent.getHeaderTable().style.width=e,this.parent.getContentTable().style.width=e);var t=this.parent.element.querySelector(".e-table.e-inline-edit");t&&this.parent.getFrozenColumns()?(this.setWidthToFrozenEditTable(),this.setWidthToMovableEditTable()):t&&(t.style.width=e)},e.prototype.isAutoResize=function(){return this.parent.allowResizing&&"Auto"===this.parent.resizeSettings.mode},e}(),dt=(Me=function(e,t){return(Me=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Me(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),pt=function(){function e(e){this.currentInfo={},this.oneTime=!0,this.swap={},this.isInfiniteScroll=!1,this.forget=!1,this.skipFocus=!0,this.focusByClick=!1,this.prevIndexes={},this.refMatrix=this.refreshMatrix(!0),this.actions=["downArrow","upArrow"],this.isVirtualScroll=!1,this.parent=e,this.rowModelGen=new he(this.parent),this.addEventListener()}return e.prototype.focusCheck=function(e){var t=e.target;this.focusByClick=!0,this.skipFocus=t.classList.contains("e-grid")},e.prototype.onFocus=function(e){if(!(this.parent.isDestroyed||sf.base.Browser.isDevice||this.parent.enableVirtualization)){this.setActive(!this.parent.enableHeaderFocus&&0===this.parent.frozenRows,this.parent.isFrozenGrid()),this.parent.enableHeaderFocus||this.parent.getCurrentViewRecords().length||"Batch"===this.parent.editSettings.mode&&("Batch"!==this.parent.editSettings.mode||this.parent.editModule.getBatchChanges().addedRecords.length)||this.getContent().matrix.generate(this.rowModelGen.generateRows({rows:[new N({isDataRow:!0})]}),this.getContent().selector,!1);var t=this.getContent().matrix.get(0,-1,[0,1],null,this.getContent().validator());this.getContent().matrix.select(t[0],t[1]),this.skipFocus&&(this.focus(e),this.skipFocus=!1)}},e.prototype.passiveFocus=function(e){this.parent.isDestroyed||e.target&&e.target.classList.contains("e-detailcell")&&(this.currentInfo.skipAction=!1,sf.base.addClass([this.currentInfo.element],["e-focused","e-focus"]))},e.prototype.onBlur=function(e){(!this.parent.isEdit&&(!e||e.relatedTarget&&!sf.base.closest(e.relatedTarget,".e-grid"))||sf.base.isNullOrUndefined(e.relatedTarget)&&0===parseInt(e.target.getAttribute("aria-colindex"),10)&&0===parseInt(e.target.getAttribute("index"),10))&&(this.removeFocus(),this.skipFocus=!0,this.currentInfo.skipAction=!1,this.parent.element.tabIndex=0)},e.prototype.onClick=function(e,t){if(!yi(e.target,"e-filterbarcell")||!yi(e.target,"e-multiselect")&&!e.target.classList.contains("e-input-group-icon")){var i=!sf.base.isNullOrUndefined(sf.base.closest(e.target,"."+U)),r=!sf.base.isNullOrUndefined(sf.base.closest(e.target,"."+H));i=i&&r?!i:i;var n=!sf.base.isNullOrUndefined(sf.base.closest(e.target,"."+W))||!sf.base.isNullOrUndefined(sf.base.closest(e.target,"."+K)),s=!1;if(this.parent.getFrozenMode()===ee&&(s=!sf.base.isNullOrUndefined(sf.base.closest(e.target,".e-frozen-right-content"))||!sf.base.isNullOrUndefined(sf.base.closest(e.target,".e-frozen-right-header")),n=n&&!s),!(!i&&sf.base.isNullOrUndefined(sf.base.closest(e.target,"."+H))||e.target.classList.contains(Q))&&sf.base.isNullOrUndefined(sf.base.closest(e.target,".e-unboundcell")))if(this.setActive(i,n,s),i||!sf.base.isNullOrUndefined(sf.base.closest(e.target,"."+H))){var o={cancel:!1,byKey:!1,byClick:!sf.base.isNullOrUndefined(e.target),clickArgs:e};if(this.parent.notify("beforecellfocused",o),!o.cancel&&!sf.base.closest(e.target,".e-inline-edit")&&(this.setActive(i,n,s),this.getContent())){if(!1===this.getContent().onClick(e,t))return;this.focus()}}else this.clearOutline()}},e.prototype.onKeyPress=function(e){if(!this.skipOn(e)){this.activeKey=e.action;var t={cancel:!1,byKey:!0,byClick:!1,keyArgs:e};if(this.parent.notify("beforecellfocused",t),!t.cancel){var i=this.getContent().matrix.current;this.currentInfo.outline=!0;var r=this.getContent().jump(e.action,i);if(this.swap=r,r.swap&&(this.setActive(!r.toHeader,r.toFrozen,r.toFrozenRight),this.getContent().matrix.current=this.getContent().getNextCurrent(i,r,this.active,e.action),this.prevIndexes={}),this.setActiveByKey(e.action,this.getContent()),!1===(!this.content.lastIdxCell&&this.getContent().onKeyPress(e)))return this.clearIndicator(),void("shiftTab"===e.action&&i.toString()===[0,0].toString()&&(this.parent.element.tabIndex=-1));e.preventDefault(),this.focus(e)}}},e.prototype.skipOn=function(e){var t=e.target;if(!t)return!1;if(this.currentInfo.skipAction)return this.clearIndicator(),!0;if(["pageUp","pageDown","altDownArrow"].indexOf(e.action)>-1)return this.clearIndicator(),!0;var i=sf.base.closest(t,"th")&&!sf.base.closest(t,"th").tabIndex;!e.target.classList.contains("e-filterbaroperator")||13!==e.keyCode&&27!==e.keyCode||sf.base.closest(e.target,".e-filterbarcell").querySelector("input").focus();i&&null!==sf.base.closest(document.activeElement,".e-filterbarcell")&&this.removeFocus();var r=null!==sf.base.closest(document.activeElement,".e-filterbarcell");if(this.parent.enableHeaderFocus&&r){var n=this.active.matrix,s=n.current;r=n.matrix[s[0]].lastIndexOf(1)!==s[1]}return"delete"===e.action||"Batch"!==this.parent.editSettings.mode&&(this.parent.isEdit||["insert","f2"].indexOf(e.action)>-1)||r||null!==sf.base.closest(document.activeElement,"#"+this.parent.element.id+"_searchbar")&&["enter","leftArrow","rightArrow","shiftLeft","shiftRight","ctrlPlusA"].indexOf(e.action)>-1||null===sf.base.closest(t,"."+U)&&null===sf.base.closest(t,"."+H)||"space"===e.action&&!t.classList.contains(J)&&null===sf.base.closest(t,"."+J)&&null===sf.base.closest(t,".e-headerchkcelldiv")||null!==sf.base.closest(t,".e-filter-popup")},e.prototype.focusVirtualElement=function(e){var t=this;if(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling){var i={virtualData:{},isAdd:!1,isCancel:!1};this.parent.notify(M,i);var r=this.actions.some((function(e){return e===t.activeKey})),n=!!this.parent.contentModule&&this.parent.contentModule.selectedRowIndex>-1;i.isAdd||Object.keys(i.virtualData).length||r||i.isCancel||n?(this.parent.notify("reset-virtual-focus",{isCancel:!1}),i.isCancel=!1,this.parent.contentModule.selectedRowIndex=-1,r&&(this.activeKey=this.empty,this.parent.notify("virtaul-key-handler",e)),this.currentInfo.elementToFocus.focus({preventScroll:!0})):this.isVirtualScroll||this.isInfiniteScroll?this.currentInfo.elementToFocus.focus({preventScroll:!0}):this.currentInfo.elementToFocus.focus()}this.isVirtualScroll=this.isInfiniteScroll=!1},e.prototype.getFocusedElement=function(){return this.currentInfo.elementToFocus},e.prototype.getContent=function(){return this.active||this.content},e.prototype.setActive=function(e,t,i){this.active=e?t?this.fContent:i?this.frContent:this.content:t?this.fHeader:i?this.frHeader:this.header},e.prototype.setFocusedElement=function(e,t){var i=this;this.currentInfo.elementToFocus=e,setTimeout((function(){sf.base.isNullOrUndefined(i.currentInfo.elementToFocus)||(i.parent.enableVirtualization||i.parent.enableInfiniteScrolling?i.focusVirtualElement(t):i.currentInfo.elementToFocus.focus())}),0)},e.prototype.focus=function(e){this.parent.notify("virtaul-cell-focus",e),this.removeFocus(),this.addFocus(this.getContent().getFocusInfo(),e)},e.prototype.removeFocus=function(e){this.currentInfo.element&&(sf.base.removeClass([this.currentInfo.element,this.currentInfo.elementToFocus],["e-focused","e-focus"]),this.currentInfo.element.tabIndex=-1)},e.prototype.addOutline=function(){var e=this.getContent().getFocusInfo();e.element&&(sf.base.addClass([e.element],["e-focused"]),sf.base.addClass([e.elementToFocus],["e-focus"]))},e.prototype.focusHeader=function(){this.setActive(!1,this.parent.isFrozenGrid()),this.resetFocus()},e.prototype.focusContent=function(){this.setActive(!0,this.parent.isFrozenGrid()),this.resetFocus()},e.prototype.resetFocus=function(){var e=this.getContent().matrix.get(0,-1,[0,1],null,this.getContent().validator());this.getContent().matrix.select(e[0],e[1]),this.focus()},e.prototype.addFocus=function(e,t){if(this.currentInfo=e,this.currentInfo.outline=e.outline&&!sf.base.isNullOrUndefined(t),this.isInfiniteScroll&&(this.currentInfo.outline=!0),e.element){var i=e.elementToFocus.classList.contains("e-focus");if(!i){this.currentInfo.outline&&sf.base.addClass([e.element],["e-focused"]),sf.base.addClass([e.elementToFocus],["e-focus"]),e.element.tabIndex=0,i||this.setFocusedElement(e.elementToFocus,t),this.parent.notify("cellfocused",{element:e.elementToFocus,parent:e.element,indexes:this.getContent().matrix.current,byKey:!sf.base.isNullOrUndefined(t),byClick:sf.base.isNullOrUndefined(t),keyArgs:t,isJump:this.swap.swap,container:this.getContent().getInfo(t),outline:!sf.base.isNullOrUndefined(t),swapInfo:this.swap});var r=this.getContent().matrix.current,n=r[0],s=r[1];this.prevIndexes={rowIndex:n,cellIndex:s},this.focusedColumnUid=this.parent.getColumnByIndex(s).uid,this.focusByClick=!1}}},e.prototype.refreshMatrix=function(e){var t=this;return function(i){e&&i.args&&i.args.isFrozen&&!t.fContent?t.fContent=new gt(t.parent):e&&!t.frContent&&i.args&&i.args.renderFrozenRightContent?t.frContent=new vt(t.parent):e&&!t.content&&(t.content=new ut(t.parent)),!e&&i.args&&i.args.isFrozen&&!t.fHeader?t.fHeader=new mt(t.parent):!e&&i.args&&i.args.renderFrozenRightContent&&!t.frHeader?t.frHeader=new bt(t.parent):e||t.header||(t.header=new ft(t.parent));var r=e?i.args&&i.args.isFrozen?t.fContent:i.args&&i.args.renderFrozenRightContent?t.frContent:t.content:i.args&&i.args.isFrozen?t.fHeader:i.args&&i.args.renderFrozenRightContent?t.frHeader:t.header,n=e?i.rows.slice(t.parent.frozenRows):i.rows,s=e?i.rows.slice(0,t.parent.frozenRows):i.rows;t.parent.isCollapseStateEnabled()&&e&&(n=n.filter((function(e){return!1!==e.visible})));var o,a=!sf.base.isNullOrUndefined(t.parent.rowTemplate),l=r.matrix.generate(s,r.selector,a);if("batchAdd"===i.name&&t.parent.isFrozenGrid()){var h=t.parent.getMovableRowsObject().map((function(e){return e.clone()})),d=n.map((function(e){return e.clone()}));if(t.fContent.matrix.generate(d,t.fContent.selector,a),t.content.matrix.generate(h,t.content.selector,a),t.parent.getFrozenMode()===ee){var p=t.parent.getFrozenRightRowsObject().map((function(e){return e.clone()}));t.frContent.matrix.generate(p,t.frContent.selector,a)}}else r.matrix.generate(n,r.selector,a);if(r.generateRows(s,{matrix:l,handlerInstance:i.args&&i.args.isFrozen?t.fHeader:i.args&&i.args.renderFrozenRightContent?t.frHeader:t.header}),!sf.base.Browser.isDevice&&i&&i.args&&(t.focusByClick||"paging"!==i.args.requestType||(t.skipFocus=!1,t.parent.element.focus()),"grouping"===i.args.requestType&&(t.skipFocus=!0)),i&&i.args&&"virtualscroll"===i.args.requestType)if(t.currentInfo.uid){if(i.rows.some((function(e,i){return o=i,e.uid===t.currentInfo.uid}))&&(t.content.matrix.current[0]=o,t.content.matrix.current[1]=t.parent.getColumnIndexByUid(t.focusedColumnUid)||0,f=t.getContent().getFocusInfo().elementToFocus)){var c=f.getBoundingClientRect(),u=t.parent.element.getBoundingClientRect();c.top>=0&&c.left>=0&&c.right<=Math.min(u.right,window.innerWidth||document.documentElement.clientWidth)&&c.bottom<=Math.min(u.bottom,window.innerHeight||document.documentElement.clientHeight)&&(t.isVirtualScroll=!0,t.focus())}}else if(i.args.focusElement&&i.args.focusElement.classList.contains("e-filtertext")){var f;(f=t.parent.element.querySelector("#"+i.args.focusElement.id))&&f.focus()}}},e.prototype.addEventListener=function(){var e=this;this.parent.isDestroyed||(sf.base.EventHandler.add(this.parent.element,"mousedown",this.focusCheck,this),sf.base.EventHandler.add(this.parent.element,"focus",this.onFocus,this),this.parent.element.addEventListener("focus",this.passiveHandler=function(t){return e.passiveFocus(t)},!0),sf.base.EventHandler.add(this.parent.element,"focusout",this.onBlur,this),this.evtHandlers=[{event:x,handler:this.onKeyPress},{event:R,handler:this.onClick},{event:y,handler:this.refMatrix},{event:"partial-refresh",handler:this.refMatrix},{event:"refresh-Expand-and-Collapse",handler:this.refMatrix},{event:S,handler:this.refreshMatrix()},{event:"close-edit",handler:this.restoreFocus},{event:"restore-Focus",handler:this.restoreFocus},{event:"start-edit",handler:this.clearIndicator},{event:"start-add",handler:this.clearIndicator},{event:"sorting-complete",handler:this.restoreFocus},{event:"filtering-complete",handler:this.filterfocus},{event:"grouping-complete",handler:this.restoreFocusWithAction},{event:"ungrouping-complete",handler:this.restoreFocusWithAction},{event:"batchAdd",handler:this.refMatrix},{event:"batchCancel",handler:this.refMatrix},{event:"batchDelete",handler:this.refMatrix},{event:"detailDataBound",handler:this.refMatrix},{event:b,handler:this.refMatrix},{event:"cellfocused",handler:this.internalCellFocus}],Nr(this.parent,this.evtHandlers,!0,this))},e.prototype.filterfocus=function(){"FilterBar"!==this.parent.filterSettings.type&&this.restoreFocus()},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(sf.base.EventHandler.remove(this.parent.element,"mousedown",this.focusCheck),sf.base.EventHandler.remove(this.parent.element,"focus",this.onFocus),sf.base.EventHandler.remove(this.parent.element,"focusout",this.onBlur),this.parent.element.removeEventListener("focus",this.passiveHandler,!0),Nr(this.parent,this.evtHandlers,!1))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.restoreFocus=function(){this.addFocus(this.getContent().getFocusInfo())},e.prototype.restoreFocusWithAction=function(e){if(!this.parent.enableInfiniteScrolling){var t=this.getContent().matrix,i=t.current;switch(e.requestType){case"grouping":case"ungrouping":i[1]=!i.length||this.parent.groupSettings.showGroupedColumn||sf.base.isNullOrUndefined(t.matrix[i[0]])?"grouping"===e.requestType?i[1]+1:i[1]-1:t.matrix[i[0]].indexOf(1)}this.getContent().matrix.current=i,this.addFocus(this.getContent().getFocusInfo())}},e.prototype.clearOutline=function(){this.getContent().matrix.current=this.getContent().matrix.get(0,-1,[0,1],"downArrow",this.getContent().validator()),this.clearIndicator()},e.prototype.clearIndicator=function(){this.currentInfo.element&&this.currentInfo.elementToFocus&&sf.base.removeClass([this.currentInfo.element,this.currentInfo.elementToFocus],["e-focus","e-focused"])},e.prototype.getPrevIndexes=function(){var e=this.forget;return this.forget=!1,e||!Object.keys(this.prevIndexes).length?{rowIndex:null,cellIndex:null}:this.prevIndexes},e.prototype.forgetPrevious=function(){this.forget=!0},e.prototype.setActiveByKey=function(e,t){var i=this;if(this.parent.isFrozenGrid()||0!==this.parent.frozenRows){var r,n={home:function(){return{toHeader:!r.isContent,toFrozen:!0}},end:function(){return{toHeader:!r.isContent,toFrozen:!1}},ctrlHome:function(){return{toHeader:!0,toFrozen:i.parent.isFrozenGrid()}},ctrlEnd:function(){return{toHeader:!1,toFrozen:!1}}};if(e in n){r=t.getInfo();var s=n[e]();this.setActive(!s.toHeader,s.toFrozen),this.getContent().matrix.current=t.matrix.current}}},e.prototype.internalCellFocus=function(e){if(e.byKey&&e.container.isContent&&"enter"===e.keyArgs.action&&(e.parent.classList.contains("e-detailcell")||e.parent.classList.contains("e-unboundcell")||e.parent.classList.contains("e-templatecell"))){this.clearIndicator();var t=this.getContent().getFocusable(this.getFocusedElement());this.setFocusedElement(t),this.currentInfo.skipAction=!0}},e}(),ct=function(){function e(){this.matrix=[],this.current=[]}return e.prototype.set=function(e,t,i){e=Math.max(0,Math.min(e,this.rows)),t=Math.max(0,Math.min(t,this.columns)),this.matrix[e]=this.matrix[e]||[],this.matrix[e][t]=i?1:0},e.prototype.get=function(e,t,i,r,n){var s=t;if(e+i[0]<0)return[e,t];e=Math.max(0,Math.min(e+i[0],this.rows));var o=!0;if(sf.base.isNullOrUndefined(this.matrix[e]))return null;if(t=Math.max(0,Math.min(t+i[1],this.matrix[e].length-1)),s+i[1]>this.matrix[e].length-1&&n(e,t,r))return[e,s];var a=this.first(this.matrix[e],t,i,!0,r);t=null===a?s:a;var l=sf.base.getValue(e+"."+t,this.matrix);if(e!==this.rows||"downArrow"!==r&&"enter"!==r||(i[0]=-1),null===a){for(var h=0;h<this.rows;h++)if(this.matrix[h].some((function(e){return 1===e}))){o=!1;break}if(o)return[e=this.current[0],t]}return this.inValid(l)||!n(e,t,r)?this.get(e,s,i,r,n):[e,t]},e.prototype.first=function(e,t,i,r,n){return(t<0||t===e.length)&&this.inValid(e[t])&&"upArrow"!==n&&"downArrow"!==n||!e.some((function(e){return 1===e}))?null:this.inValid(e[t])?this.first(e,-1!==["upArrow","downArrow","shiftUp","shiftDown"].indexOf(n)?r?0:++t:t+i[1],i,!1,n):t},e.prototype.select=function(e,t){e=Math.max(0,Math.min(e,this.rows)),t=Math.max(0,Math.min(t,this.matrix[e].length-1)),this.current=[e,t]},e.prototype.generate=function(e,t,i){this.rows=e.length-1,this.matrix=[];for(var r=0;r<e.length;r++){var n=e[r].cells.filter((function(e){return!0!==e.isSpanned}));this.columns=Math.max(n.length-1,0|this.columns);for(var s=0;s<n.length;s++)this.set(r,s,!1!==e[r].visible&&t(e[r],n[s],i))}return this.matrix},e.prototype.inValid=function(e){return 0===e||void 0===e},e}(),ut=function(){function t(e){var t=this;this.matrix=new ct,this.lastIdxCell=!1,this.parent=e,this.keyActions={rightArrow:[0,1],tab:[0,1],leftArrow:[0,-1],shiftTab:[0,-1],upArrow:[-1,0],downArrow:[1,0],shiftUp:[-1,0],shiftDown:[1,0],shiftRight:[0,1],shiftLeft:[0,-1],enter:[1,0],shiftEnter:[-1,0]},this.indexesByKey=function(e){return{home:[t.matrix.current[0],-1,0,1],end:[t.matrix.current[0],t.matrix.columns+1,0,-1],ctrlHome:[0,-1,0,1],ctrlEnd:[t.matrix.rows,t.matrix.columns+1,0,-1]}[e]||null}}return t.prototype.getTable=function(){return this.parent.isFrozenGrid()?this.parent.getContent().querySelector(".e-movablecontent .e-table"):this.parent.getContentTable()},t.prototype.onKeyPress=function(e){var t=this.keyActions[e.action],i=this.getCurrentFromAction(e.action,t,e.action in this.keyActions,e);if(i){if((["tab","shiftTab"].indexOf(e.action)>-1&&this.matrix.current||[]).toString()===i.toString()){if(i.toString()===[this.matrix.rows,this.matrix.columns].toString()||i.toString()===[0,0].toString()||this.matrix.current[0]===this.matrix.rows&&this.matrix.current.toString()===i.toString())return!1;i=this.editNextRow(i[0],i[1],e.action)}this.matrix.select(i[0],i[1])}},t.prototype.editNextRow=function(e,t,i){var r=this.parent,n=r.editSettings.allowNextRowEdit&&(r.isEdit||r.isLastCellPrimaryKey),s=r.getColumnIndexByField(r.getVisibleColumns()[0].field),o=this.getTable().rows[e].cells[t];"tab"===i&&n&&(e++,t=s+(this.getTable().rows[e].getElementsByClassName("e-indentcell").length+this.getTable().rows[e].getElementsByClassName("e-detailrowcollapse").length));return"shiftTab"===i&&n&&(e--,t=r.getColumnIndexByField(r.getVisibleColumns()[r.getVisibleColumns().length-1].field)),o.classList.contains(q)||o.classList.contains("e-headercell")||o.classList.contains("e-groupcaption")?[e,t]:this.editNextRow(e,t,i)},t.prototype.getCurrentFromAction=function(e,t,i,r){if(void 0===t&&(t=[0,0]),!i&&!this.indexesByKey(e)||0===this.matrix.current.length)return null;if(!this.shouldFocusChange(r))return this.matrix.current;var n=this.indexesByKey(e)||this.matrix.current.concat(t),s=n[0],o=n[1],a=n[2],l=n[3];return this.matrix.get(s,o,[a,l],e,this.validator())},t.prototype.onClick=function(e,t){var i=e.target;if(this.target=i,i=(i=i.classList.contains(q)?i:sf.base.closest(i,"td"))||(sf.base.closest(e.target,"td.e-detailrowcollapse")||sf.base.closest(e.target,"td.e-detailrowexpand")),!(i=(i=sf.base.closest(e.target,"td.e-detailcell")&&sf.base.isNullOrUndefined(sf.base.closest(sf.base.closest(e.target,".e-grid"),"td.e-detailcell"))?null:i)&&sf.base.closest(i,"table").classList.contains(X)?i:null))return!1;var r=[i.parentElement.rowIndex,i.cellIndex],n=r[0],s=r[1],o=this.matrix.current,a=o[0],l=o[1],h=sf.base.getValue(n+"."+s,this.matrix.matrix);if(this.matrix.inValid(h)||!t&&a===n&&l===s||!yi(e.target,q)&&!yi(e.target,"e-groupcaption"))return!1;this.matrix.select(n,s)},t.prototype.getFocusInfo=function(){var e={},t=this.matrix.current,i=t[0],r=void 0===i?0:i,n=t[1],s=void 0===n?0:n;return this.matrix.current=[r,s],e.element=sf.base.isNullOrUndefined(this.getTable().rows[r])?null:this.getTable().rows[r].cells[s],e.element?(e.elementToFocus=e.element.classList.contains("e-unboundcell")||e.element.classList.contains("e-detailcell")?e.element:this.getFocusable(e.element),e.outline=!0,e.uid=e.element.parentElement.getAttribute("data-uid"),e):e},t.prototype.getFocusable=function(e){var t='button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])',i=!sf.base.isNullOrUndefined(sf.base.closest(e,".e-templatecell"));this.parent.isEdit&&(t='input:not([type="hidden"]), select:not([aria-hidden="true"]), textarea');var r=[].slice.call(e.querySelectorAll(t));return r.length?i&&r.length>1?this.target:r[0]:e},t.prototype.selector=function(t,i,r){var n=[e.CellType.Expand,e.CellType.GroupCaption,e.CellType.CaptionSummary,e.CellType.GroupSummary];return(t.isDataRow&&i.visible&&(i.isDataCell||i.isTemplate)||t.isDataRow&&i.cellType===e.CellType.DetailExpand&&sf.base.isNullOrUndefined(i.visible)||!t.isDataRow&&n.indexOf(i.cellType)>-1||i.column&&"checkbox"===i.column.type||i.cellType===e.CellType.CommandColumn||t.isDataRow&&r)&&!("delete"===t.edit&&t.isDirty)},t.prototype.nextRowFocusValidate=function(e){for(var t=e,i=e,r=this.matrix.rows;i<=r;i++){if(-1!==this.matrix.matrix[e].indexOf(1))return e;e+=1}return this.lastIdxCell=!0,t},t.prototype.previousRowFocusValidate=function(e){for(var t=e,i=e;i>=0;i--){if(-1!==this.matrix.matrix[e].indexOf(1))return e;if((e-=1)<0)return this.lastIdxCell=!0,t}return t},t.prototype.jump=function(e,t){var i=this.parent.getFrozenLeftCount()&&("leftArrow"===e||"shiftTab"===e)&&0===t[1],r=("rightArrow"===e||"tab"===e)&&t[1]===this.matrix.columns,n=this.parent.getFrozenMode()===ee&&r;"Right"===this.parent.getFrozenMode()&&(i=r),this.lastIdxCell=!1;var s=0!==this.parent.frozenRows&&"shiftEnter"===e;"tab"!==e||this.parent.isEdit||t[1]!==this.matrix.matrix[t[0]].lastIndexOf(1)||this.matrix.matrix.length-1===t[0]||(this.matrix.current[0]=this.nextRowFocusValidate(this.matrix.current[0]+1),this.matrix.current[1]=-1,i=this.parent.isFrozenGrid()),"shiftTab"!==e||this.parent.isEdit||0===t[0]||this.matrix.matrix[t[0]].indexOf(1)!==t[1]||(this.matrix.current[0]=this.previousRowFocusValidate(this.matrix.current[0]-1),this.matrix.current[1]=this.matrix.matrix[t[0]].length);var o=!1,a=document.activeElement.parentElement;(this.parent.enableVirtualization||this.parent.infiniteScrollSettings.enableCache)&&a.classList.contains(Y)&&(o=parseInt(a.getAttribute(ne),10)>0);return{swap:!o&&(("upArrow"===e||s)&&0===t[0]||i||n),toHeader:("upArrow"===e||s)&&0===t[0],toFrozen:i,toFrozenRight:n}},t.prototype.getNextCurrent=function(e,t,i,r){void 0===e&&(e=[]);var n=[];return"Right"===this.parent.getFrozenMode()||this.parent.getFrozenMode()===ee?("leftArrow"!==r&&"shiftTab"!==r||(n[0]=e[0],n[1]=i.matrix.columns+1),this.parent.getFrozenMode()!==ee||"rightArrow"!==r&&"tab"!==r||(n[0]=e[0],n[1]=-1)):"rightArrow"!==r&&"tab"!==r||(n[0]=e[0],n[1]=-1),"downArrow"!==r&&"enter"!==r||(n[0]=-1,n[1]=e[1]),n},t.prototype.generateRows=function(e,t){var i,r=t.matrix,n=t.handlerInstance,s=n.matrix.matrix.length,o=this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type?s+1:s;n.matrix.matrix=n.matrix.matrix.slice(0,o),n.matrix.rows=o,(i=n.matrix.matrix).push.apply(i,r),n.matrix.rows+=r.length},t.prototype.getInfo=function(e){var t=this.getFocusInfo(),i=this.matrix.current,r=i[0],n=i[1],s=t.element.classList.contains(q),o=s||e&&"enter"!==e.action&&(t.element.classList.contains("e-detailrowcollapse")||t.element.classList.contains("e-detailrowexpand")),a=[Math.min(parseInt(t.element.parentElement.getAttribute(ne),10),r),Math.min(parseInt(t.element.getAttribute(re),10),n)];return{isContent:!0,isDataCell:s,indexes:[a[0],a[1]],isSelectable:o}},t.prototype.validator=function(){var e=this.getTable();return function(t,i,r){if(!sf.base.isNullOrUndefined(e.rows[t])){var n=void 0;i=e.querySelector(".e-emptyrow")?0:i;var s=0!==(n=e.rows[t].cells[0].classList.contains("e-editcell")?e.rows[t].cells[0].querySelectorAll("td")[i]:e.rows[t].cells[i]).getBoundingClientRect().width;if("enter"===r||"shiftEnter"===r)return s&&n.classList.contains(q);if(("shiftUp"===r||"shiftDown"===r)&&n.classList.contains(q))return s;if("shiftUp"!==r&&"shiftDown"!==r)return s}return!1}},t.prototype.shouldFocusChange=function(e){var t=this.matrix.current,i=t[0],r=void 0===i?-1:i,n=t[1],s=void 0===n?-1:n;if(r<0||s<0)return!0;var o=sf.base.getValue(r+".cells."+s,this.getTable().rows);return!o||("enter"!==e.action&&"shiftEnter"!==e.action||o.classList.contains(q)&&!o.classList.contains("e-unboundcell")&&(!o.classList.contains("e-templatecell")||o.classList.contains("e-editedbatchcell"))&&!o.classList.contains("e-detailcell"))},t.prototype.getGridSeletion=function(){return this.parent.allowSelection&&this.parent.selectionSettings.allowColumnSelection},t}(),ft=function(t){function i(e){return t.call(this,e)||this}return dt(i,t),i.prototype.getTable=function(){return this.parent.isFrozenGrid()?this.parent.getHeaderContent().querySelector(".e-movableheader .e-table"):this.parent.getHeaderTable()},i.prototype.onClick=function(e){var t=e.target;if(this.target=t,(t=t.classList.contains("e-headercell")?t:sf.base.closest(t,"th"))||0===this.parent.frozenRows||(t=e.target.classList.contains(q)?e.target:sf.base.closest(e.target,"td")),e.target.classList.contains("e-columnheader")||e.target.querySelector(".e-stackedheadercell"))return!1;if(t){var i=[t.parentElement.rowIndex,t.cellIndex],r=i[0],n=i[1],s=sf.base.getValue(r+"."+n,this.matrix.matrix);if(this.matrix.inValid(s))return!1;this.matrix.select(t.parentElement.rowIndex,t.cellIndex)}},i.prototype.getFocusInfo=function(){var e={},t=this.matrix.current,i=t[0],r=void 0===i?0:i,n=t[1],s=void 0===n?0:n;return e.element=this.getTable().rows[r].cells[s],sf.base.isNullOrUndefined(e.element)||(e.elementToFocus=this.getFocusable(e.element),e.outline=!e.element.classList.contains("e-filterbarcell")),e},i.prototype.selector=function(t,i){return i.visible&&(void 0!==i.column.field||i.isTemplate||!sf.base.isNullOrUndefined(i.column.template))||"checkbox"===i.column.type||i.cellType===e.CellType.StackedHeader},i.prototype.jump=function(e,t){var i=this.parent.getFrozenLeftCount()&&("leftArrow"===e||"shiftLeft"===e&&this.getGridSeletion()||"shiftTab"===e)&&0===t[1],r=("rightArrow"===e||"shiftRight"===e&&this.getGridSeletion()||"tab"===e)&&t[1]===this.matrix.columns,n=this.parent.getFrozenMode()===ee&&r;"Right"===this.parent.getFrozenMode()&&(i=r);var s,o,a=0!==this.parent.frozenRows&&"enter"===e,l=i||n,h=this.parent.focusModule.fHeader&&this.parent.focusModule.fHeader.matrix.matrix,d=h&&!sf.base.isNullOrUndefined(h[t[0]]);return this.parent.enableHeaderFocus&&"tab"===e&&(o=this.matrix.matrix.length-1===t[0],(s=t[1]===this.matrix.matrix[t[0]].lastIndexOf(1))&&(this.matrix.current[0]=o?0:this.matrix.current[0]+1,this.matrix.current[1]=-1),this.parent.isFrozenGrid()&&o&&s&&(i=!0,l=!1)),{swap:("downArrow"===e||a)&&t[0]===this.matrix.matrix.length-1||d&&(i||n)||"tab"===e&&o&&s,toHeader:l,toFrozen:i,toFrozenRight:n}},i.prototype.getNextCurrent=function(e,t,i,r){void 0===e&&(e=[]);var n=[];return"Right"===this.parent.getFrozenMode()||this.parent.getFrozenMode()===ee?(("leftArrow"===r||"shiftLeft"===r&&this.getGridSeletion()||"shiftTab"===r)&&(n[0]=e[0],n[1]=i.matrix.columns+1),this.parent.getFrozenMode()===ee&&("rightArrow"===r||"shiftRight"===r&&this.getGridSeletion()||"tab"===r)&&(n[0]=e[0],n[1]=-1)):("rightArrow"===r||"shiftRight"===r&&this.getGridSeletion()||"tab"===r)&&(n[0]=e[0],n[1]=-1),"upArrow"!==r&&"shiftEnter"!==r||(n[0]=this.matrix.matrix.length,n[1]=e[1]),n},i.prototype.generateRows=function(e){var t=this.matrix.matrix.length;if(this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type){this.matrix.rows=++this.matrix.rows;for(var i=e[0].cells,r=0;r<i.length;r++)this.matrix.set(t,r,i[r].visible&&!1!==i[r].column.allowFiltering)}},i.prototype.getInfo=function(e){return sf.base.extend(t.prototype.getInfo.call(this,e),{isContent:!1,isHeader:!0})},i.prototype.validator=function(){return function(){return!0}},i.prototype.shouldFocusChange=function(e){var t=this.matrix.current,i=t[0],r=t[1];if(i<0||r<0)return!0;var n=sf.base.getValue(i+".cells."+r,this.getTable().rows);return!n||("enter"!==e.action&&"altDownArrow"!==e.action||!n.classList.contains("e-headercell"))},i}(ut),gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return dt(t,e),t.prototype.getTable=function(){return this.parent.getContent().querySelector(".e-frozencontent .e-table")},t.prototype.jump=function(e,t){var i=0!==this.parent.frozenRows&&"shiftEnter"===e,r=("upArrow"===e||i)&&0===t[0];return"Right"===this.parent.getFrozenMode()?{swap:r||("shiftTab"===e||"leftArrow"===e)&&0===t[1],toHeader:r,toFrozen:r}:{swap:r||("tab"===e||"rightArrow"===e)&&t[1]===this.matrix.columns,toHeader:r,toFrozen:r}},t.prototype.getNextCurrent=function(e,t,i,r){void 0===e&&(e=[]);var n=[];return"Right"===this.parent.getFrozenMode()?"rightArrow"!==r&&"tab"!==r||(n[0]=e[0],n[1]=-1):("tab"===r&&this.parent.enableHeaderFocus&&(n[0]=e[0],n[1]=-1),"leftArrow"!==r&&"shiftTab"!==r||(n[0]=e[0],n[1]=i.matrix.columns+1)),"downArrow"!==r&&"enter"!==r||(n[0]=-1,n[1]=e[1]),n},t}(ut),mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return dt(t,e),t.prototype.jump=function(e,t){var i=0!==this.parent.frozenRows&&"enter"===e,r=this.parent.focusModule.header&&this.parent.focusModule.header.matrix.matrix,n=r&&!sf.base.isNullOrUndefined(r[t[0]]);if("Right"===this.parent.getFrozenMode()){var s=("leftArrow"===e||"shiftLeft"===e&&this.getGridSeletion()||"shiftTab"===e)&&0===t[1];return{swap:("downArrow"===e||i)&&t[0]===this.matrix.matrix.length-1||n&&s,toHeader:s,toFrozen:("downArrow"===e||i)&&t[0]===this.matrix.matrix.length-1}}return{swap:("downArrow"===e||i)&&t[0]===this.matrix.matrix.length-1||("rightArrow"===e||"shiftRight"===e&&this.getGridSeletion()||"tab"===e)&&t[1]===this.matrix.columns&&n,toHeader:("rightArrow"===e||"shiftRight"===e&&this.getGridSeletion()||"tab"===e)&&t[1]===this.matrix.columns,toFrozen:("downArrow"===e||i)&&t[0]===this.matrix.matrix.length-1}},t.prototype.getTable=function(){return this.parent.getHeaderContent().querySelector(".e-frozenheader .e-table")},t.prototype.getNextCurrent=function(e,t,i,r){void 0===e&&(e=[]);var n=[];return"Right"===this.parent.getFrozenMode()?("rightArrow"===r||"shiftRight"===r&&this.getGridSeletion()||"tab"===r)&&(n[0]=e[0],n[1]=-1):("leftArrow"===r||"shiftLeft"===r&&this.getGridSeletion()||"shiftTab"===r)&&(n[0]=e[0],n[1]=i.matrix.columns+1),"upArrow"!==r&&"shiftEnter"!==r||(n[0]=this.matrix.matrix.length,n[1]=e[1]),n},t}(ft),yt=function(){function e(e){this.searchBox=e}return e.prototype.searchFocus=function(e){e.target.parentElement.classList.add("e-input-focus")},e.prototype.searchBlur=function(e){e.target.parentElement.classList.remove("e-input-focus")},e.prototype.wireEvent=function(){this.searchBox&&(sf.base.EventHandler.add(this.searchBox,"focus",this.searchFocus,this),sf.base.EventHandler.add(this.searchBox,"blur",this.searchBlur,this))},e.prototype.unWireEvent=function(){this.searchBox&&(sf.base.EventHandler.remove(this.searchBox,"focus",this.searchFocus),sf.base.EventHandler.remove(this.searchBox,"blur",this.searchBlur))},e}(),vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return dt(t,e),t.prototype.getTable=function(){return this.parent.getContent().querySelector(".e-frozen-right-content .e-table")},t.prototype.jump=function(e,t){var i=0!==this.parent.frozenRows&&"shiftEnter"===e,r=("upArrow"===e||i)&&0===t[0];return{swap:r||("shiftTab"===e||"leftArrow"===e)&&0===t[1],toHeader:r,toFrozenRight:r}},t.prototype.getNextCurrent=function(e,t,i,r){void 0===e&&(e=[]);var n=[];return"rightArrow"!==r&&"tab"!==r||(n[0]=e[0],n[1]=-1),"downArrow"!==r&&"enter"!==r||(n[0]=-1,n[1]=e[1]),n},t}(ut),bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return dt(t,e),t.prototype.jump=function(e,t){var i=this.parent.focusModule.header&&this.parent.focusModule.header.matrix.matrix,r=i&&!sf.base.isNullOrUndefined(i[t[0]]),n=0!==this.parent.frozenRows&&"enter"===e,s=("leftArrow"===e||"shiftLeft"===e&&this.getGridSeletion()||"shiftTab"===e)&&0===t[1];return{swap:("downArrow"===e||n)&&t[0]===this.matrix.matrix.length-1||r&&s,toHeader:s,toFrozenRight:("downArrow"===e||n)&&t[0]===this.matrix.matrix.length-1}},t.prototype.getTable=function(){return this.parent.getHeaderContent().querySelector(".e-frozen-right-header .e-table")},t.prototype.getNextCurrent=function(e,t,i,r){void 0===e&&(e=[]);var n=[];return("rightArrow"===r||"shiftRight"===r&&this.getGridSeletion()||"tab"===r)&&(n[0]=e[0],n[1]=0),"upArrow"!==r&&"shiftEnter"!==r||(n[0]=this.matrix.matrix.length,n[1]=e[1]),n},t}(ft),Ct=(Oe=function(e,t){return(Oe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Oe(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),wt=function(e,t,r,n){var s,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(a=(o<3?s(a):o>3?s(t,r,a):s(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},St=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ct(t,e),wt([sf.base.Property(12)],t.prototype,"pageSize",void 0),wt([sf.base.Property(8)],t.prototype,"pageCount",void 0),wt([sf.base.Property(1)],t.prototype,"currentPage",void 0),wt([sf.base.Property()],t.prototype,"totalRecordsCount",void 0),wt([sf.base.Property(!1)],t.prototype,"enableQueryString",void 0),wt([sf.base.Property(!1)],t.prototype,"pageSizes",void 0),wt([sf.base.Property(null)],t.prototype,"template",void 0),t}(sf.base.ChildProperty),xt=(ke=function(e,t){return(ke=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ke(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Rt=function(e,t,r,n){var s,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(a=(o<3?s(a):o>3?s(t,r,a):s(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xt(t,e),Rt([sf.base.Property("startsWith")],t.prototype,"operator",void 0),Rt([sf.base.Property(!1)],t.prototype,"ignoreAccent",void 0),t}(sf.base.ChildProperty),Et=function(){return(Et=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},It=function(){function t(e,t,i){this.selectedRowIndexes=[],this.selectedRowCellIndexes=[],this.selectedRecords=[],this.preventFocus=!1,this.selectedColumnsIndexes=[],this.checkBoxState=!1,this.isMultiShiftRequest=!1,this.isMultiCtrlRequest=!1,this.enableSelectMultiTouch=!1,this.clearRowCheck=!1,this.selectRowCheck=!1,this.selectedRowState={},this.totalRecordsCount=0,this.chkAllCollec=[],this.isCheckedOnAdd=!1,this.persistSelectedData=[],this.deSelectedData=[],this.needColumnSelection=!1,this.isCancelDeSelect=!1,this.isPreventCellSelect=!1,this.disableUI=!1,this.isPersisted=!1,this.cmdKeyPressed=!1,this.cellselected=!1,this.isMultiSelection=!1,this.isAddRowsToSelection=!1,this.initialRowSelection=!1,this.isPrevRowSelection=!1,this.isKeyAction=!1,this.isRowDragSelected=!1,this.autoFillRLselection=!0,this.bottom="0 0 2px 0",this.top="2px 0 0 0",this.right_bottom="0 2px 2px 0",this.bottom_left="0 0 2px 2px",this.top_right="2px 2px 0 0",this.top_left="2px 0 0 2px",this.top_bottom="2px 0 2px 0",this.top_right_bottom="2px 2px 2px 0",this.top_bottom_left="2px 0 2px 2px",this.top_right_left="2px 2px 0 2px",this.right_bottom_left="0 2px 2px 2px",this.all_border="2px",this.parent=e,this.selectionSettings=t,this.factory=i.getService("rendererFactory"),this.focus=i.getService("focus"),this.addEventListener(),this.wireEvents()}return t.prototype.initializeSelection=function(){this.parent.log("selection_key_missing"),this.render()},t.prototype.onActionBegin=function(e,t){this.parent.trigger(t,this.fDataUpdate(e))},t.prototype.fDataUpdate=function(e){if(!(this.isMultiSelection||sf.base.isNullOrUndefined(e.cellIndex)&&sf.base.isNullOrUndefined(e.rowIndex))){var t=this.getRowObj(sf.base.isNullOrUndefined(e.rowIndex)?sf.base.isNullOrUndefined(e.cellIndex)?this.currentIndex:e.cellIndex.rowIndex:e.rowIndex);e.foreignKeyData=t.foreignKeyData}return e},t.prototype.onActionComplete=function(e,t){this.parent.trigger(t,this.fDataUpdate(e)),this.isMultiSelection=!1},t.prototype.getModuleName=function(){return"selection"},t.prototype.destroy=function(){var e=this.parent.element;e&&(e.querySelector("."+H)||e.querySelector("."+U))&&(this.hidePopUp(),this.clearSelection(),this.removeEventListener(),this.unWireEvents(),sf.base.EventHandler.remove(this.parent.getContent(),"mousedown",this.mouseDownHandler),sf.base.EventHandler.remove(this.parent.getHeaderContent(),"mousedown",this.mouseDownHandler))},t.prototype.isEditing=function(){return("Normal"===this.parent.editSettings.mode||"Batch"===this.parent.editSettings.mode&&this.parent.editModule&&this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate())&&this.parent.isEdit&&!this.parent.isPersistSelection},t.prototype.getSelectedMovableRow=function(e){var t=this.parent;return t.isFrozenGrid()&&this.parent.getContent().querySelector("."+G)?t.getMovableRowByIndex(e):null},t.prototype.getSelectedFrozenRightRow=function(e){var t=this.parent;return t.isFrozenGrid()&&t.getFrozenMode()===ee&&t.getFrozenRightContent()?t.getFrozenRightRowByIndex(e):null},t.prototype.getCurrentBatchRecordChanges=function(){var e=this.parent;if("Batch"===e.editSettings.mode&&e.editModule){var t=hi(this.parent.getCurrentViewRecords());t="Bottom"===e.editSettings.newRowPosition?t.concat(this.parent.editModule.getBatchChanges().addedRecords):this.parent.editModule.getBatchChanges().addedRecords.concat(t);for(var i=this.parent.editModule.getBatchChanges().deletedRecords,r=this.parent.getPrimaryKeyFieldNames()[0],n=0;n<i.length;n++)for(var s=0;s<t.length;s++)if(i[n][r]===t[s][r]){t.splice(s,1);break}return t}return e.getCurrentViewRecords()},t.prototype.selectRow=function(e,t){if(this.selectedRowIndexes.length&&this.selectionSettings.enableSimpleMultiRowSelection)this.addRowsToSelection([e]);else{var i,r=this.parent,n=r.getRowByIndex(e),s=this.getSelectedMovableRow(e),o=this.getSelectedFrozenRightRow(e);if(r.enableVirtualization&&e>-1){var a={selectedIndex:e,isAvailable:!0};this.parent.notify("select-virtual-Row",a);var l=r.isFrozenGrid()?r.contentModule.getRowObjectByIndex(e):null;if(!n||!r.getRowObjectFromUID(n.getAttribute("data-uid"))&&!l){if(a.isAvailable&&!r.selectionSettings.persistSelection)this.parent.getSelectedRecords().length>0&&this.clearRowSelection();return}i=l||r.getRowObjectFromUID(n.getAttribute("data-uid")).data}else i=this.getCurrentBatchRecordChanges()[e];if(this.isRowType()&&n&&!this.isEditing()){var h,d=n.hasAttribute("aria-selected");this.activeTarget(),t=t?!!this.selectedRowIndexes.length&&(1===this.selectedRowIndexes.length&&((!this.isKeyAction||!this.parent.isCheckBoxSelection)&&e===this.selectedRowIndexes[0])):t,this.isKeyAction=!1;t?this.rowSelectingCallBack(h,t,e,i,!1,d,"cancel")(h):(h={data:i,rowIndex:e,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,row:n,previousRow:r.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked},h=this.addMovableArgs(h,s,o),this.parent.trigger("rowSelecting",this.fDataUpdate(h),this.rowSelectingCallBack(h,t,e,i,!1,d,"cancel")))}}},t.prototype.rowSelectingCallBack=function(e,t,i,r,n,s,o){var a=this;return function(e){sf.base.isNullOrUndefined(e)||!0!==e[o]?(a.index=i,a.toggle=t,a.data=r,a.removed=n,s&&a.selectionSettings.persistSelection&&"ResetOnRowClick"!==a.selectionSettings.checkboxMode?(a.clearSelectedRow(i),a.selectRowCallBack()):!s&&a.selectionSettings.persistSelection&&"ResetOnRowClick"!==a.selectionSettings.checkboxMode&&a.selectRowCallBack(),"ResetOnRowClick"===a.selectionSettings.checkboxMode&&a.clearSelection(),(!a.selectionSettings.persistSelection||"ResetOnRowClick"===a.selectionSettings.checkboxMode||!a.parent.isCheckBoxSelection&&a.selectionSettings.persistSelection)&&(a.selectRowCheck=!0,a.clearRow())):a.disableInteracted()}},t.prototype.selectRowCallBack=function(){var e,t=this.parent,i=this.index,r=this.toggle,n=this.data,s=this.removed,o=t.getRowByIndex(i),a=this.getSelectedMovableRow(i),l=this.getSelectedFrozenRightRow(i);r||s||(this.selectedRowIndexes.indexOf(i)<=-1&&(this.updateRowSelection(o,i),this.selectMovableRow(a,l,i)),this.selectRowIndex(i)),r||(e={data:n,rowIndex:i,row:o,previousRow:t.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget,isInteracted:this.isInteracted,isHeaderCheckBoxClicked:this.isHeaderCheckboxClicked},e=this.addMovableArgs(e,a,l),this.onActionComplete(e,"rowSelected")),this.isInteracted=!1,this.updateRowProps(i)},t.prototype.selectMovableRow=function(e,t,i){this.parent.isFrozenGrid()&&(this.updateRowSelection(e,i),this.parent.getFrozenMode()===ee&&t&&this.updateRowSelection(t,i))},t.prototype.addMovableArgs=function(e,t,i){if(this.parent.isFrozenGrid()){var r={mRow:t,previousMovRow:this.parent.getMovableRows()[this.prevRowIndex]};this.parent.getFrozenMode()===ee&&i&&(r.frozenRightRow=i,r.previousFrozenRightRow=this.parent.getFrozenRightDataRows()[this.prevRowIndex]),e=Et({},e,r)}return e},t.prototype.selectRowsByRange=function(e,t){this.selectRows(this.getCollectionFromIndexes(e,t)),this.selectRowIndex(t)},t.prototype.selectRows=function(e){var t=this,i=this.parent,r=this.isSingleSel()?e[e.length-1]:e[0];this.isMultiSelection=!0;var n=[],s=[],o=this.getSelectedMovableRow(r),a=this.getSelectedFrozenRightRow(r),l=[];if(this.isRowType()&&!this.isEditing()){for(var h=0,d=e.length;h<d;h++){var p=this.parent.getDataRows()[e[h]],c=this.getRowObj(p);c&&(l.push(c.data),n.push(p),s.push(c.foreignKeyData))}this.activeTarget();var u={cancel:!1,rowIndexes:e,row:n,rowIndex:r,target:this.actualTarget,prevRow:i.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,isInteracted:this.isInteracted,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,data:l,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,foreignKeyData:s};u=this.addMovableArgs(u,o,a),this.parent.trigger("rowSelecting",this.fDataUpdate(u),(function(l){if(sf.base.isNullOrUndefined(l)||!0!==l.cancel){t.clearRow(),t.selectRowIndex(e.slice(-1)[0]);var h=function(e){if(t.updateRowSelection(i.getRowByIndex(e),e),i.isFrozenGrid()){var n=t.parent.getFrozenMode()===ee?i.getFrozenRightRowByIndex(e):void 0;t.selectMovableRow(i.getMovableRowByIndex(e),n,e)}t.updateRowProps(r)};if(t.isSingleSel())h(r);else for(var d=0,p=e;d<p.length;d++){h(p[d])}l={rowIndexes:e,row:n,rowIndex:r,target:t.actualTarget,prevRow:i.getRows()[t.prevRowIndex],previousRowIndex:t.prevRowIndex,data:t.getSelectedRecords(),isInteracted:t.isInteracted,isHeaderCheckboxClicked:t.isHeaderCheckboxClicked,foreignKeyData:s},l=t.addMovableArgs(l,o,a),t.isRowSelected&&t.onActionComplete(l,"rowSelected"),t.isInteracted=!1}else t.disableInteracted()}))}},t.prototype.addRowsToSelection=function(e){var t=this.parent,i=this.target;this.isMultiSelection=!0;var r=t.getSelectedRowIndexes().concat(e),n=this.isSingleSel()?t.getRowByIndex(e[e.length-1]):t.getRowByIndex(e[0]),s=this.isSingleSel()?this.getSelectedMovableRow(e[e.length-1]):this.getSelectedMovableRow(e[0]),o=this.isSingleSel()?this.getSelectedFrozenRightRow(e[e.length-1]):this.getSelectedFrozenRightRow(e[0]);if(this.isRowType()&&!this.isEditing()||this.selectionSettings.checkboxOnly)for(var a,l=this.parent.getColumns().filter((function(e){return"checkbox"===e.type})),h=0,d=e;h<d.length;h++){var p=d[h],c=this.getRowObj(p),u=this.selectedRowIndexes.indexOf(p)>-1;if(this.selectRowIndex(p),u&&(l.length||this.selectionSettings.enableToggle||this.isMultiCtrlRequest)){if(this.isAddRowsToSelection=!0,this.rowDeselect("rowDeselecting",[p],[c.data],[n],[c.foreignKeyData],i),this.isCancelDeSelect)return;this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(p),1),this.selectedRecords.splice(this.selectedRecords.indexOf(n),1),this.selectRowIndex(this.selectedRowIndexes.length?this.selectedRowIndexes[this.selectedRowIndexes.length-1]:-1),n.removeAttribute("aria-selected"),this.addRemoveClassesForRow(n,!1,null,"e-selectionbackground","e-active"),s&&(this.selectedRecords.splice(this.selectedRecords.indexOf(s),1),s.removeAttribute("aria-selected"),this.addRemoveClassesForRow(s,!1,null,"e-selectionbackground","e-active")),o&&(this.selectedRecords.splice(this.selectedRecords.indexOf(o),1),o.removeAttribute("aria-selected"),this.addRemoveClassesForRow(o,!1,null,"e-selectionbackground","e-active")),this.rowDeselect("rowDeselected",[p],[c.data],[n],[c.foreignKeyData],i,[s],void 0,[o]),this.isInteracted=!1,this.isMultiSelection=!1,this.isAddRowsToSelection=!1}else{if(this.activeTarget(),a={cancel:!1,data:c.data,rowIndex:p,row:n,target:this.actualTarget,prevRow:t.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,foreignKeyData:c.foreignKeyData,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,rowIndexes:r},a=this.addMovableArgs(a,s,o),this.parent.trigger("rowSelecting",this.fDataUpdate(a)),!sf.base.isNullOrUndefined(a)&&!0===a.cancel)return void this.disableInteracted();this.isSingleSel()&&this.clearRow(),this.updateRowSelection(n,p),this.selectMovableRow(s,o,p)}if(u||(a={data:c.data,rowIndex:p,row:n,target:this.actualTarget,prevRow:t.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,foreignKeyData:c.foreignKeyData,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,rowIndexes:r},a=this.addMovableArgs(a,s,o),this.onActionComplete(a,"rowSelected")),this.isInteracted=!1,this.updateRowProps(p),this.isSingleSel())break}},t.prototype.getCollectionFromIndexes=function(e,t){for(var i=[],r=e<=t?{i:e,max:t}:{i:t,max:e},n=r.i,s=r.max;n<=s;n++)i.push(n);return e>t&&i.reverse(),i},t.prototype.clearRow=function(){this.clearRowCheck=!0,this.clearRowSelection()},t.prototype.clearRowCallBack=function(){this.isCancelDeSelect&&"Check"!==this.parent.checkAllRows||(this.selectedRowIndexes=[],this.selectedRecords=[],this.selectRowIndex(-1),this.isSingleSel()&&this.parent.isPersistSelection&&(this.selectedRowState={}))},t.prototype.clearSelectedRow=function(e){if(this.toggle){var t=this.parent.getRowByIndex(e);this.disableUI||(t.removeAttribute("aria-selected"),this.addRemoveClassesForRow(t,!1,!0,"e-selectionbackground","e-active")),this.removed=!0,this.updatePersistCollection(t,!1),this.updateCheckBoxes(t),this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(e),1),this.selectedRecords.splice(this.selectedRecords.indexOf(this.parent.getRowByIndex(e)),1)}},t.prototype.updateRowProps=function(e){this.prevRowIndex=e,this.isRowSelected=this.selectedRowIndexes.length&&!0},t.prototype.updatePersistCollection=function(e,t){var i=this;if((this.parent.isPersistSelection||this.parent.selectionSettings.persistSelection&&this.parent.getPrimaryKeyFieldNames().length>0)&&!sf.base.isNullOrUndefined(e)){this.parent.isPersistSelection||this.ensureCheckboxFieldSelection();var r=this.getRowObj(e),n=r.data?r.data[this.primaryKey]:null;if(null===n)return;r.isSelected=t,t?(this.selectedRowState[n]=t,this.persistSelectedData.some((function(e){return e[i.primaryKey]===n}))||this.persistSelectedData.push(r.data)):this.updatePersistDelete(n)}},t.prototype.updatePersistDelete=function(e){var t,i=this;delete this.selectedRowState[e],this.persistSelectedData.some((function(r,n){return t=n,r[i.primaryKey]===e}))&&this.persistSelectedData.splice(t,1)},t.prototype.updateCheckBoxes=function(e,t,i){if(!sf.base.isNullOrUndefined(e)){var r=e.querySelector(".e-checkselect");sf.base.isNullOrUndefined(r)||(Wi(r.nextElementSibling,t),Gi(r,t),(sf.base.isNullOrUndefined(this.checkedTarget)||!sf.base.isNullOrUndefined(this.checkedTarget)&&!this.checkedTarget.classList.contains("e-checkselectall"))&&this.setCheckAllState(i))}},t.prototype.updateRowSelection=function(e,t){if(e){this.selectedRowIndexes.push(t);var i=this.selectedRowIndexes.length;if(this.parent.isFrozenGrid()&&i>1&&this.selectedRowIndexes[i-2]===this.selectedRowIndexes[i-1]&&this.selectedRowIndexes.pop(),this.selectedRecords.push(e),e.setAttribute("aria-selected","true"),this.updatePersistCollection(e,!0),this.updateCheckBoxes(e,!0),this.addRemoveClassesForRow(e,!0,null,"e-selectionbackground","e-active"),!this.preventFocus){var r=this.focus.getPrevIndexes().cellIndex?e.cells[this.focus.getPrevIndexes().cellIndex]:e.querySelector(".e-selectionbackground:not(.e-hide):not(.e-detailrowcollapse):not(.e-detailrowexpand)");if(this.parent.contextMenuModule&&2===this.mouseButton&&(r=this.parent.contextMenuModule.cell),!r)return;this.focus.onClick({target:r},!0)}}},t.prototype.clearSelection=function(){if(this.checkSelectAllClicked=!0,this.selectionSettings.persistSelection&&this.persistSelectedData.length&&(this.deSelectedData=hi(this.persistSelectedData)),!this.parent.isPersistSelection||this.parent.isPersistSelection&&!this.parent.isEdit||!sf.base.isNullOrUndefined(this.checkedTarget)&&this.checkedTarget.classList.contains("e-checkselectall")){var e=this.parent.element.querySelector(".e-gridpopup").querySelector("span");e.classList.contains("e-rowselect")&&e.classList.remove("e-spanclicked"),this.parent.isPersistSelection&&(this.persistSelectedData=[],this.selectedRowState={}),this.clearRowSelection(),this.clearCellSelection(),this.clearColumnSelection(),this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevECIdxs=void 0,this.enableSelectMultiTouch=!1,this.isInteracted=!1,this.checkSelectAllClicked=!1}},t.prototype.clearRowSelection=function(){var e=this;if(this.isRowSelected){for(var t=this.parent,i=this.parent.getDataRows(),r=[],n=[],s=[],o=[],a=[],l=[],h=this.target,d=0,p=this.selectedRowIndexes.length;d<p;d++){var c="Batch"===this.parent.editSettings.mode?this.parent.getRows()[this.selectedRowIndexes[d]]:this.parent.getDataRows()[this.selectedRowIndexes[d]],u=this.getRowObj(c);if(u&&(r.push(u.data),n.push(c),a.push(this.selectedRowIndexes[d]),l.push(u.foreignKeyData)),t.isFrozenGrid()){var f=t.getMovableRows();if(f&&f.length&&s.push(f[this.selectedRowIndexes[d]]),t.getFrozenMode()===ee){var g=t.getFrozenRightRows();g&&g.length&&o.push(g[this.selectedRowIndexes[d]])}}}this.selectionSettings.persistSelection&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode&&(this.isRowClicked=!!this.checkSelectAllClicked),this.rowDeselect("rowDeselecting",a,r,n,l,h,s,(function(){if(e.isCancelDeSelect&&(e.isRowClicked||e.checkSelectAllClicked||e.isInteracted&&!e.parent.isPersistSelection)){if(e.parent.isPersistSelection)if("Intermediate"===e.getCheckAllStatus(e.parent.element.querySelector(".e-checkselectall")))for(var t=0;t<e.selectedRecords.length;t++)e.updatePersistCollection(e.selectedRecords[t],!0);else e.parent.checkAllRows="Check",e.updatePersistSelectedData(!0);e.clearRowCheck&&(e.clearRowCallBack(),e.clearRowCheck=!1,e.selectRowCheck&&(e.selectRowCallBack(),e.selectRowCheck=!1))}else{for(var d=[].slice.call(i.filter((function(e){return e.hasAttribute("aria-selected")}))),p=0;p<d.length;p++)e.disableUI||(d[p].removeAttribute("aria-selected"),e.addRemoveClassesForRow(d[p],!1,!0,"e-selectionbackground","e-active")),e.isPrevRowSelection||e.updatePersistCollection(d[p],!1),e.updateCheckBoxes(d[p]);t=0;for(var c=e.selectedRowIndexes.length;t<c;t++){var u=e.getSelectedMovableRow(e.selectedRowIndexes[t]);u&&(e.disableUI||(u.removeAttribute("aria-selected"),e.addRemoveClassesForRow(u,!1,!0,"e-selectionbackground","e-active")),e.updateCheckBoxes(u),e.isPrevRowSelection||e.updatePersistCollection(u,!1));var f=e.getSelectedFrozenRightRow(e.selectedRowIndexes[t]);f&&(e.disableUI||(f.removeAttribute("aria-selected"),e.addRemoveClassesForRow(f,!1,!0,"e-selectionbackground","e-active")),e.updateCheckBoxes(f),e.isPrevRowSelection||e.updatePersistCollection(f,!1))}e.selectedRowIndexes=[],e.selectedRecords=[],e.isRowSelected=!1,e.selectRowIndex(-1),e.isPrevRowSelection=!1,e.rowDeselect("rowDeselected",a,r,n,l,h,s,void 0,o),e.clearRowCheck&&(e.clearRowCallBack(),e.clearRowCheck=!1,e.selectRowCheck&&(e.selectRowCallBack(),e.selectRowCheck=!1))}}),o)}else this.clearRowCheck&&(this.clearRowCallBack(),this.clearRowCheck=!1,this.selectRowCheck&&(this.selectRowCallBack(),this.selectRowCheck=!1))},t.prototype.rowDeselect=function(e,t,i,r,n,s,o,a,l){var h=this;if(this.selectionSettings.persistSelection&&(this.isRowClicked||this.checkSelectAllClicked)||!this.selectionSettings.persistSelection){var d=1===t.length&&1===this.deSelectedData.length,p={rowIndex:t[0],data:this.selectionSettings.persistSelection&&"Uncheck"===this.parent.checkAllRows&&!d&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode?this.deSelectedData:i,foreignKeyData:n,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked};"rowDeselected"===e&&delete p.cancel;p.row=r,p.target=this.actualTarget,this.actualTarget&&!sf.base.isNullOrUndefined(sf.base.closest(this.actualTarget,"thead"))||t.length>1?(p.rowIndex=t[0],p.rowIndexes=t):1===t.length&&(p.data=p.data[0],p.row=p.row[0],p.foreignKeyData=p.foreignKeyData[0],this.isAddRowsToSelection&&(p.rowIndexes=t)),this.parent.trigger(e,this.parent.isFrozenGrid()?Et({},p,{mRow:o,frozenRightRow:l}):p,(function(e){h.isCancelDeSelect=e.cancel,h.isCancelDeSelect&&(h.isRowClicked||h.isInteracted||h.checkSelectAllClicked)||(h.updatePersistCollection(r[0],!1),h.updateCheckBoxes(r[0],void 0,t[0]),o&&h.updateCheckBoxes(o[0],void 0,t[0]),l&&h.updateCheckBoxes(l[0],void 0,t[0])),void 0!==a&&a()}))}else this.selectionSettings.persistSelection&&!this.isInteracted&&void 0!==a&&a()},t.prototype.getRowObj=function(e){return void 0===e&&(e=this.currentIndex),sf.base.isNullOrUndefined(e)?{}:("number"==typeof e&&(e=this.parent.getRowByIndex(e)),e&&this.parent.getRowObjectFromUID(e.getAttribute("data-uid"))||{})},t.prototype.getSelectedMovableCell=function(e){var t=this.parent,i=t.getColumnByIndex(e.cellIndex);return t.isFrozenGrid()&&"movable"===i.getFreezeTableName()?t.getMovableCellFromIndex(e.rowIndex,this.getColIndex(e.rowIndex,e.cellIndex)):null},t.prototype.selectCell=function(e,t){if(this.isCellType()){var i,r=this.parent,n=this.getSelectedMovableCell(e);n||(n=r.getCellFromIndex(e.rowIndex,this.getColIndex(e.rowIndex,e.cellIndex))),this.currentIndex=e.rowIndex;var s=this.getCurrentBatchRecordChanges()[this.currentIndex];if(this.isCellType()&&n&&!this.isEditing()){var o=n.classList.contains("e-cellselectionbackground");if(t=t?!sf.base.isUndefined(this.prevCIdxs)&&e.rowIndex===this.prevCIdxs.rowIndex&&e.cellIndex===this.prevCIdxs.cellIndex&&o:t)this.successCallBack(i,t,e,n,s)(i);else{(i={data:s,cellIndex:e,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,cancel:!1}).currentCell=n;i.previousRowCellIndex=this.prevECIdxs,this.parent.trigger("cellSelecting",this.fDataUpdate(i),this.successCallBack(i,t,e,n,s)),this.cellselected=!0}}}},t.prototype.successCallBack=function(e,t,i,r,n){var s=this;return function(e){if((sf.base.isNullOrUndefined(e)||!0!==e.cancel)&&(t||(e.currentCell=e.currentCell?e.currentCell:r),s.clearCell(),t||s.updateCellSelection(r,i.rowIndex,i.cellIndex),!t)){var o={data:n,cellIndex:i,currentCell:r,selectedRowCellIndex:s.selectedRowCellIndexes,previousRowCell:s.prevECIdxs?s.getCellIndex(s.prevECIdxs.rowIndex,s.prevECIdxs.cellIndex):void 0};o.previousRowCellIndex=s.prevECIdxs,s.updateCellProps(i,i),s.onActionComplete(o,"cellSelected")}}},t.prototype.getCellIndex=function(e,t){return this.parent.getFrozenColumns()&&t>=this.parent.getFrozenColumns()?this.parent.getMovableCellFromIndex(e,t):this.parent.getCellFromIndex(e,t)},t.prototype.selectCellsByRange=function(e,t){var i=this;if(this.isCellType()){var r,n,s=this.parent,o=this.getSelectedMovableCell(e),a=s.getFrozenColumns();o||(o=s.getCellFromIndex(e.rowIndex,e.cellIndex));var l,h=e,d=t=t||e;this.currentIndex=e.rowIndex;var p=this.getCurrentBatchRecordChanges()[this.currentIndex];if(!this.isSingleSel()&&this.isCellType()&&!this.isEditing()){var c={data:p,cellIndex:e,currentCell:o,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};c.previousRowCellIndex=this.prevECIdxs,this.parent.trigger("cellSelecting",this.fDataUpdate(c),(function(c){if(sf.base.isNullOrUndefined(c)||!0!==c.cancel){if(i.clearCell(),e.rowIndex>t.rowIndex){var u=e;e=t,t=u}for(var f=e.rowIndex;f<=t.rowIndex;f++){i.selectionSettings.cellSelectionMode.indexOf("Box")<0?(r=f===e.rowIndex?e.cellIndex:0,n=f===t.rowIndex?t.cellIndex:i.getLastColIndex(f)):(r=e.cellIndex,n=t.cellIndex),l=[];for(var g=r<n?r:n,m=r>n?r:n;g<=m;g++)(o=a?g<a?s.getCellFromIndex(f,g):s.getMovableCellFromIndex(f,g):s.getCellFromIndex(f,g))&&(l.push(g),i.updateCellSelection(o),i.addAttribute(o));i.selectedRowCellIndexes.push({rowIndex:f,cellIndexes:l})}var y={data:p,cellIndex:d,currentCell:s.getCellFromIndex(d.rowIndex,d.cellIndex),selectedRowCellIndex:i.selectedRowCellIndexes,previousRowCell:i.prevECIdxs?i.getCellIndex(i.prevECIdxs.rowIndex,i.prevECIdxs.cellIndex):void 0};y.previousRowCellIndex=i.prevECIdxs,i.isDragged||(i.onActionComplete(y,"cellSelected"),i.cellselected=!0),i.updateCellProps(h,d)}}))}}},t.prototype.selectCells=function(e){if(this.isCellType()){var t=this.parent,i=this.getSelectedMovableCell(e[0]),r=t.getFrozenColumns();i||(i=t.getCellFromIndex(e[0].rowIndex,e[0].cellIndexes[0])),this.currentIndex=e[0].rowIndex;var n=this.getCurrentBatchRecordChanges()[this.currentIndex];if(!this.isSingleSel()&&this.isCellType()&&!this.isEditing()){var s={data:n,cellIndex:e[0].cellIndexes[0],currentCell:i,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};s.previousRowCellIndex=this.prevECIdxs,this.onActionBegin(s,"cellSelecting");for(var o=0,a=e.length;o<a;o++)for(var l=0,h=e[o].cellIndexes.length;l<h;l++)(i=r?e[o].cellIndexes[l]<r?t.getCellFromIndex(e[o].rowIndex,e[o].cellIndexes[l]):t.getMovableCellFromIndex(e[o].rowIndex,e[o].cellIndexes[l]):t.getCellFromIndex(e[o].rowIndex,e[o].cellIndexes[l]))&&(this.updateCellSelection(i),this.addAttribute(i),this.addRowCellIndex({rowIndex:e[o].rowIndex,cellIndex:e[o].cellIndexes[l]}));this.updateCellProps({rowIndex:e[0].rowIndex,cellIndex:e[0].cellIndexes[0]},{rowIndex:e[0].rowIndex,cellIndex:e[0].cellIndexes[0]});var d={data:n,cellIndex:e[0].cellIndexes[0],currentCell:i,selectedRowCellIndex:this.selectedRowCellIndexes,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};d.previousRowCellIndex=this.prevECIdxs,this.onActionComplete(d,"cellSelected")}}},t.prototype.addCellsToSelection=function(e){if(this.isCellType()){var t,i,r=this.parent;this.currentIndex=e[0].rowIndex;var n=this.getCurrentBatchRecordChanges()[this.currentIndex],s=r.getFrozenLeftCount(),o=r.getMovableColumnsCount();if(!this.isSingleSel()&&this.isCellType()&&!this.isEditing()){this.hideAutoFill();var a,l=r.getColumnByIndex(e[0].cellIndex);Sr(this.parent,(function(t,i){a=i[e[0].rowIndex]}),[l.getFreezeTableName()&&l.getFreezeTableName()!==ie?[]:r.getRowsObject(),"movable"===l.getFreezeTableName()?r.getMovableRowsObject():[],l.getFreezeTableName()===te?r.getFrozenRightRowsObject():[]]);for(var h=[],d=0,p=e;d<p.length;d++){for(var c=p[d],u=0,f=this.selectedRowCellIndexes.length;u<f;u++)if(this.selectedRowCellIndexes[u].rowIndex===c.rowIndex){i=u;break}(t=this.getSelectedMovableCell(c))||(t=r.getCellFromIndex(c.rowIndex,this.getColIndex(c.rowIndex,c.cellIndex)));var g="movable"===l.getFreezeTableName()?c.cellIndex-s:l.getFreezeTableName()===te?c.cellIndex-(s+o):c.cellIndex;h.push(a.cells[g].foreignKeyData);var m={cancel:!1,data:n,cellIndex:e[0],isShiftPressed:this.isMultiShiftRequest,currentCell:t,isCtrlPressed:this.isMultiCtrlRequest,previousRowCell:this.prevECIdxs?r.getCellFromIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};m.previousRowCellIndex=this.prevECIdxs;var y=i>-1;if(y){var v=this.selectedRowCellIndexes[i].cellIndexes;v.indexOf(c.cellIndex)>-1?(this.cellDeselect("cellDeselecting",[{rowIndex:c.rowIndex,cellIndexes:[c.cellIndex]}],n,[t],h),v.splice(v.indexOf(c.cellIndex),1),0===v.length&&this.selectedRowCellIndexes.splice(i,1),t.classList.remove("e-cellselectionbackground"),t.removeAttribute("aria-selected"),this.cellDeselect("cellDeselected",[{rowIndex:c.rowIndex,cellIndexes:[c.cellIndex]}],n,[t],h)):(y=!1,this.onActionBegin(m,"cellSelecting"),this.addRowCellIndex({rowIndex:c.rowIndex,cellIndex:c.cellIndex}),this.updateCellSelection(t),this.addAttribute(t))}else{if(this.onActionBegin(m,"cellSelecting"),!sf.base.isNullOrUndefined(m)&&!0===m.cancel)return;this.updateCellSelection(t,c.rowIndex,c.cellIndex)}if(!y){var b={data:n,cellIndex:e[0],currentCell:t,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,selectedRowCellIndex:this.selectedRowCellIndexes};b.previousRowCellIndex=this.prevECIdxs,this.onActionComplete(b,"cellSelected"),this.cellselected=!0}this.updateCellProps(c,c)}}}},t.prototype.getColIndex=function(e,t){var i=this.parent.isFrozenGrid(),r=this.parent.getColumnByIndex(t),n=Er(this.parent,r,e);if(n)for(var s=0;s<n.length;s++){if(parseInt(n[s].getAttribute(re),10)===t)return i&&("movable"===r.getFreezeTableName()?s+=this.parent.getFrozenLeftCount():r.getFreezeTableName()===te&&(s+=this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount())),s}return-1},t.prototype.getLastColIndex=function(e){var t=this.parent.getFrozenColumns()?this.parent.getMovableDataRows()[e].querySelectorAll("td.e-rowcell"):this.parent.getDataRows()[e].querySelectorAll("td.e-rowcell");return parseInt(t[t.length-1].getAttribute(re),10)},t.prototype.clearCell=function(){this.clearCellSelection()},t.prototype.cellDeselect=function(e,t,i,r,n){r[0]&&r[0].classList.contains(J)&&this.updateCheckBoxes(sf.base.closest(r[0],"tr"));var s={cells:r,data:i,cellIndexes:t,foreignKeyData:n,cancel:!1};this.parent.trigger(e,s),this.isPreventCellSelect=s.cancel},t.prototype.updateCellSelection=function(e,t,i){sf.base.isNullOrUndefined(t)||this.addRowCellIndex({rowIndex:t,cellIndex:i}),e.classList.add("e-cellselectionbackground"),e.classList.contains(J)&&this.updateCheckBoxes(sf.base.closest(e,"tr"),!0),this.addAttribute(e)},t.prototype.addAttribute=function(e){this.target=e,sf.base.isNullOrUndefined(e)||(e.setAttribute("aria-selected","true"),this.preventFocus||this.focus.onClick({target:e},!0))},t.prototype.updateCellProps=function(e,t){this.prevCIdxs=e,this.prevECIdxs=t,this.isCellSelected=this.selectedRowCellIndexes.length&&!0},t.prototype.addRowCellIndex=function(e){for(var t,i,r=0,n=this.selectedRowCellIndexes.length;r<n;r++)if(this.selectedRowCellIndexes[r].rowIndex===e.rowIndex){t=!0,i=r;break}t?this.selectedRowCellIndexes[i].cellIndexes.indexOf(e.cellIndex)<0&&this.selectedRowCellIndexes[i].cellIndexes.push(e.cellIndex):this.selectedRowCellIndexes.push({rowIndex:e.rowIndex,cellIndexes:[e.cellIndex]})},t.prototype.clearCellSelection=function(){if(this.isCellSelected){var e=this.parent,t=this.getSelectedCellsElement(),i=this.selectedRowCellIndexes,r=[],n=[],s=[],o=this.getCurrentBatchRecordChanges(),a=e.isFrozenGrid();this.hideAutoFill();for(var l=0,h=i.length;l<h;l++){r.push(o[i[l].rowIndex]);for(var d=this.getRowObj(i[l].rowIndex),p=0,c=i[l].cellIndexes.length;p<c;p++)if(a){var u=e.getColumnByIndex(i[l].cellIndexes[p]);n.push(Ir(this.parent,u,i[l].rowIndex,i[l].cellIndexes[p]))}else d.cells&&s.push(d.cells[i[l].cellIndexes[p]].foreignKeyData),n.push(e.getCellFromIndex(i[l].rowIndex,i[l].cellIndexes[p]))}if(this.cellDeselect("cellDeselecting",i,r,n,s),!0===this.isPreventCellSelect)return;for(l=0,h=t.length;l<h;l++)t[l].classList.remove("e-cellselectionbackground"),t[l].removeAttribute("aria-selected");this.bdrElement&&this.showHideBorders("none"),this.selectedRowCellIndexes=[],this.isCellSelected=!1,!this.isDragged&&this.cellselected&&this.cellDeselect("cellDeselected",i,r,n,s)}},t.prototype.getSelectedCellsElement=function(){var e,t=this.parent,i=t.getDataRows();t.isFrozenGrid()&&(e=t.getMovableDataRows(),i=t.addMovableRows(i,e),t.getFrozenMode()===ee&&(i=t.addMovableRows(i,t.getFrozenRightDataRows())));for(var r=[],n=0,s=i.length;n<s;n++)r=r.concat([].slice.call(i[n].getElementsByClassName("e-cellselectionbackground")));return r},t.prototype.mouseMoveHandler=function(e){e.preventDefault();var t,i=this.parent.element.getBoundingClientRect(),r=this.x,n=this.y,s=Si(e),o=s.x-i.left,a=s.y-i.top,l=sf.base.closest(e.target,"tr");if(this.isDragged=!0,this.isCellDrag||(l||(l=sf.base.closest(document.elementFromPoint(this.parent.element.offsetLeft+2,e.clientY),"tr")),r>o&&(t=o,o=r,r=t),n>a&&(t=a,a=n,n=t),this.element.style.left=r+"px",this.element.style.top=n+"px",this.element.style.width=o-r+"px",this.element.style.height=a-n+"px"),l&&!e.ctrlKey&&!e.shiftKey){var h=parseInt(l.getAttribute(ne),10);if(this.isCellDrag){var d=yi(e.target,q);d&&(this.startAFCell=this.startCell,this.endAFCell=yi(e.target,q),this.selectLikeExcel(e,h,parseInt(d.getAttribute(re),10)))}else this.hideAutoFill(),this.selectRowsByRange(this.startDIndex,h),this.isRowDragSelected=!0}},t.prototype.selectLikeExcel=function(e,t,i){this.isAutoFillSel?(this.showAFBorders(),this.selectLikeAutoFill(e)):(this.clearCellSelection(),this.selectCellsByRange({rowIndex:this.startDIndex,cellIndex:this.startDCellIndex},{rowIndex:t,cellIndex:i}),this.drawBorders())},t.prototype.drawBorders=function(){"BoxWithBorder"===this.selectionSettings.cellSelectionMode&&this.selectedRowCellIndexes.length&&!this.parent.isEdit?(this.parent.element.classList.add("e-enabledboxbdr"),this.bdrElement||this.createBorders(),this.positionBorders()):this.showHideBorders("none")},t.prototype.isLastCell=function(e){var t=[].slice.call(e.parentElement.querySelectorAll(".e-rowcell:not(.e-hide)"));return t[t.length-1]===e},t.prototype.isLastRow=function(e){var t=[].slice.call(sf.base.closest(e,se).querySelectorAll(".e-row:not(.e-hiddenrow)"));return e.parentElement===t[t.length-1]},t.prototype.isFirstRow=function(e){var t=[].slice.call(sf.base.closest(e,se).querySelectorAll(".e-row:not(.e-hiddenrow)"));return e.parentElement===t[0]},t.prototype.isFirstCell=function(e){return[].slice.call(e.parentElement.querySelectorAll(".e-rowcell:not(.e-hide)"))[0]===e},t.prototype.setBorders=function(e,t,i){var r=[].slice.call(e.getElementsByClassName("e-cellselectionbackground")).filter((function(e){return""===e.style.display}));if(r.length){var n=this.parent.isFrozenGrid(),s=r[0],o=r[r.length-1],a=s.getBoundingClientRect(),l=o.getBoundingClientRect(),h=s.offsetParent.getBoundingClientRect(),d=!this.isLastRow(o)||"1"!==i&&"2"!==i&&"5"!==i?0:2,p=this.parent.frozenRows&&("1"===i||"2"===i)&&this.isFirstRow(s)?1.5:0,c=n&&("2"===i||"4"===i)&&this.isFirstCell(s)?1:0,u=("Right"!==this.parent.getFrozenMode()||"1"!==i&&"3"!==i)&&(this.parent.getFrozenMode()!==ee||"5"!==i&&"6"!==i)||!this.isFirstCell(s)?0:1;this.parent.enableRtl?(t.style.right=h.right-a.right-c+"px",t.style.width=a.right-l.left+c+1+"px"):(t.style.left=a.left-h.left-c-u+"px",t.style.width=l.right-a.left+c-u+1+"px"),t.style.top=a.top-h.top-p+"px",t.style.height=l.top-a.top>0?l.top-h.top+l.height+1-(a.top-h.top)-d+p+"px":l.height+p-d+1+"px",this.selectDirection+=i}else t.style.display="none"},t.prototype.positionBorders=function(){this.updateStartEndCells(),this.startCell&&this.bdrElement&&this.selectedRowCellIndexes.length&&(this.selectDirection="",this.showHideBorders(""),this.setBorders(this.parent.getContentTable(),this.bdrElement,"1"),this.parent.isFrozenGrid()&&(this.setBorders(this.parent.contentModule.getMovableContent(),this.mcBdrElement,"2"),this.parent.getFrozenMode()===ee&&this.setBorders(this.parent.contentModule.getFrozenRightContent(),this.frcBdrElement,"5")),this.parent.frozenRows&&(this.setBorders(this.parent.getHeaderTable(),this.fhBdrElement,"3"),this.parent.isFrozenGrid()&&(this.setBorders(this.parent.headerModule.getMovableHeader(),this.mhBdrElement,"4"),this.parent.getFrozenMode()===ee&&this.setBorders(this.parent.headerModule.getFrozenRightHeader(),this.frhBdrElement,"6"))),this.applyBorders(this.selectDirection))},t.prototype.applyBothFrozenBorders=function(e){var t=this.parent.enableRtl;switch(e.length){case 6:this.bdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.mcBdrElement.style.borderWidth=this.bottom,this.fhBdrElement.style.borderWidth=t?this.top_right:this.top_left,this.mhBdrElement.style.borderWidth=this.top,this.frcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom,this.frhBdrElement.style.borderWidth=t?this.top_left:this.top_right;break;case 4:e.includes("1")&&e.includes("2")&&e.includes("3")&&e.includes("4")&&(this.fhBdrElement.style.borderWidth=t?this.top_right:this.top_left,this.mhBdrElement.style.borderWidth=t?this.top_left:this.top_right,this.bdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.mcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom),e.includes("2")&&e.includes("4")&&e.includes("5")&&e.includes("6")&&(this.mcBdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.mhBdrElement.style.borderWidth=t?this.top_right:this.top_left,this.frcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom,this.frhBdrElement.style.borderWidth=t?this.top_left:this.top_right);break;case 3:this.bdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.mcBdrElement.style.borderWidth=this.top_bottom,this.frcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.mhBdrElement.style.borderWidth=this.top_bottom,this.frcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom);break;case 2:e.includes("1")&&(this.mcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=this.top_right_left)),e.includes("2")&&(this.bdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.frcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.parent.frozenRows&&(this.mhBdrElement.style.borderWidth=this.top_right_left)),e.includes("3")&&(this.mhBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.bdrElement.style.borderWidth=this.right_bottom_left),e.includes("4")&&(this.fhBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.frhBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.mcBdrElement.style.borderWidth=this.right_bottom_left),e.includes("5")&&(this.mcBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.parent.frozenRows&&(this.frhBdrElement.style.borderWidth=this.top_right_left)),e.includes("6")&&(this.mhBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.frcBdrElement.style.borderWidth=this.right_bottom_left);break;default:this.bdrElement.style.borderWidth=this.all_border,this.mcBdrElement.style.borderWidth=this.all_border,this.frcBdrElement.style.borderWidth=this.all_border,this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=this.all_border,this.mhBdrElement.style.borderWidth=this.all_border,this.frhBdrElement.style.borderWidth=this.all_border)}},t.prototype.applyBorders=function(e){var t=this.parent.enableRtl;if(this.parent.getFrozenMode()===ee)this.applyBothFrozenBorders(e);else switch(e.length){case 4:"Right"===this.parent.getFrozenMode()?(this.bdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom,this.mcBdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.fhBdrElement.style.borderWidth=t?this.top_left:this.top_right,this.mhBdrElement.style.borderWidth=t?this.top_right:this.top_left):(this.bdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.mcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom,this.fhBdrElement.style.borderWidth=t?this.top_right:this.top_left,this.mhBdrElement.style.borderWidth=t?this.top_left:this.top_right);break;case 2:"Right"===this.parent.getFrozenMode()?(this.bdrElement.style.borderWidth=e.includes("2")?t?this.top_bottom_left:this.top_right_bottom:this.right_bottom_left,this.mcBdrElement.style.borderWidth=e.includes("1")?t?this.top_right_bottom:this.top_bottom_left:this.right_bottom_left,this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=e.includes("1")?this.top_right_left:t?this.top_bottom_left:this.top_right_bottom,this.mhBdrElement.style.borderWidth=e.includes("2")?this.top_right_left:t?this.top_right_bottom:this.top_bottom_left)):(this.bdrElement.style.borderWidth=e.includes("2")?t?this.top_right_bottom:this.top_bottom_left:this.right_bottom_left,this.parent.isFrozenGrid()&&(this.mcBdrElement.style.borderWidth=e.includes("1")?t?this.top_bottom_left:this.top_right_bottom:this.right_bottom_left),this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=e.includes("1")?this.top_right_left:t?this.top_right_bottom:this.top_bottom_left,this.parent.isFrozenGrid()&&(this.mhBdrElement.style.borderWidth=e.includes("2")?this.top_right_left:t?this.top_bottom_left:this.top_right_bottom)));break;default:this.bdrElement.style.borderWidth=this.all_border,this.parent.isFrozenGrid()&&(this.mcBdrElement.style.borderWidth=this.all_border),this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=this.all_border,this.parent.isFrozenGrid()&&(this.mhBdrElement.style.borderWidth=this.all_border))}},t.prototype.createBorders=function(){this.bdrElement||(this.bdrElement=this.parent.getContentTable().parentElement.appendChild(sf.base.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_bdr",styles:"width: 2px; border-width: 0;"})),this.parent.isFrozenGrid()&&(this.mcBdrElement=this.parent.contentModule.getMovableContent().appendChild(sf.base.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_mcbdr",styles:"height: 2px; border-width: 0;"})),this.parent.getFrozenMode()===ee&&(this.frcBdrElement=this.parent.contentModule.getFrozenRightContent().appendChild(sf.base.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_frcbdr",styles:"height: 2px; border-width: 0;"})))),this.parent.frozenRows&&(this.fhBdrElement=this.parent.getHeaderTable().parentElement.appendChild(sf.base.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_fhbdr",styles:"height: 2px;"}))),this.parent.frozenRows&&this.parent.isFrozenGrid()&&(this.mhBdrElement=this.parent.headerModule.getMovableHeader().appendChild(sf.base.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_mhbdr",styles:"height: 2px;"})),this.parent.getFrozenMode()===ee&&(this.frhBdrElement=this.parent.headerModule.getFrozenRightHeader().appendChild(sf.base.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_frhbdr",styles:"height: 2px;"})))))},t.prototype.showHideBorders=function(e){this.bdrElement&&(this.bdrElement.style.display=e,this.parent.isFrozenGrid()&&(this.mcBdrElement.style.display=e,this.parent.getFrozenMode()===ee&&(this.frcBdrElement.style.display=e)),this.parent.frozenRows&&(this.fhBdrElement.style.display=e),this.parent.frozenRows&&this.parent.isFrozenGrid()&&(this.mhBdrElement.style.display=e,this.parent.getFrozenMode()===ee&&(this.frhBdrElement.style.display=e)))},t.prototype.drawAFBorders=function(){this.bdrAFBottom||this.createAFBorders(),this.positionAFBorders()},t.prototype.positionAFBorders=function(){if(this.startCell&&this.bdrAFLeft){var e=this.startAFCell.getBoundingClientRect(),t=this.endAFCell.getBoundingClientRect(),i=t.top-e.top>0?1:0,r=t.top-e.top>=0&&(yi(this.startAFCell,G)||yi(this.startAFCell,"e-frozencontent"))&&this.isFirstRow(this.startAFCell)?1.5:0,n=(yi(this.startAFCell,G)||yi(this.startAFCell,_))&&this.isFirstCell(this.startAFCell)?1:0,s=this.isLastRow(this.endAFCell)&&(yi(this.endAFCell,G)||yi(this.endAFCell,"e-frozencontent"))?2:0,o=this.startAFCell.offsetParent.getBoundingClientRect(),a=this.parent.element.getBoundingClientRect(),l=this.startAFCell.offsetParent.parentElement.scrollTop,h=this.startAFCell.offsetParent.parentElement.scrollLeft,d=l-this.startAFCell.offsetTop,p=h-this.startAFCell.offsetLeft,c=this.parent.element.clientHeight,u=this.parent.element.clientWidth;d=d>0?Math.floor(d)-1:0,p=p>0?p:0;var f=e.left-a.left;if(this.parent.enableRtl){var g=yi(this.startAFCell,G)||yi(this.startAFCell,_)?e.right-this.startAFCell.offsetParent.parentElement.getBoundingClientRect().width-a.left:0;this.bdrAFLeft.style.right=a.right-t.right-2+t.width+"px",this.bdrAFLeft.style.width=u<=parseInt(this.bdrAFLeft.style.right,10)?"0px":"2px",this.bdrAFRight.style.right=a.right-e.right-n+g-1+"px",this.bdrAFTop.style.left=t.left-a.left-.5+"px",this.bdrAFTop.style.width=parseInt(this.bdrAFLeft.style.right,10)-parseInt(this.bdrAFRight.style.right,10)-n+1+"px",parseInt(this.bdrAFTop.style.left,10)<0&&(this.bdrAFTop.style.width=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)+"px",this.bdrAFTop.style.left="0px")}else if(this.bdrAFLeft.style.left=f-n+p-1+"px",this.bdrAFRight.style.left=t.left-a.left-2+t.width+"px",this.bdrAFRight.style.width=u<=parseInt(this.bdrAFRight.style.left,10)?"0px":"2px",this.bdrAFTop.style.left=f+p-.5+"px",this.bdrAFTop.style.width=parseInt(this.bdrAFRight.style.left,10)-parseInt(this.bdrAFLeft.style.left,10)-n+1+"px",u<=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)){var m=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)-u;this.bdrAFTop.style.width=parseInt(this.bdrAFTop.style.width,10)-m+"px"}if(this.bdrAFLeft.style.top=e.top-a.top-r+d+"px",this.bdrAFLeft.style.height=t.top-e.top>0?t.top-o.top+t.height+1-(e.top-o.top)+r-s-d+"px":t.height+r-s-d+"px",this.bdrAFRight.style.top=this.bdrAFLeft.style.top,this.bdrAFRight.style.height=parseInt(this.bdrAFLeft.style.height,10)+"px",this.bdrAFTop.style.top=this.bdrAFRight.style.top,this.bdrAFBottom.style.left=this.bdrAFTop.style.left,this.bdrAFBottom.style.top=parseFloat(this.bdrAFLeft.style.top)+parseFloat(this.bdrAFLeft.style.height)-i-1+"px",this.bdrAFBottom.style.width=c<=parseFloat(this.bdrAFBottom.style.top)?"0px":this.bdrAFTop.style.width,c<=parseInt(this.bdrAFLeft.style.height,10)+parseInt(this.bdrAFLeft.style.top,10)){var y=parseInt(this.bdrAFLeft.style.height,10)+parseInt(this.bdrAFLeft.style.top,10)-c;this.bdrAFLeft.style.height=parseInt(this.bdrAFLeft.style.height,10)-y+"px",this.bdrAFRight.style.height=parseInt(this.bdrAFLeft.style.height,10)+"px"}}},t.prototype.createAFBorders=function(){this.bdrAFLeft||(this.bdrAFLeft=this.parent.element.appendChild(sf.base.createElement("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafleft",styles:"width: 2px;"})),this.bdrAFRight=this.parent.element.appendChild(sf.base.createElement("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafright",styles:"width: 2px;"})),this.bdrAFBottom=this.parent.element.appendChild(sf.base.createElement("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafbottom",styles:"height: 2px;"})),this.bdrAFTop=this.parent.element.appendChild(sf.base.createElement("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdraftop",styles:"height: 2px;"})))},t.prototype.showAFBorders=function(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="",this.bdrAFRight.style.display="",this.bdrAFBottom.style.display="",this.bdrAFTop.style.display="")},t.prototype.hideAFBorders=function(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="none",this.bdrAFRight.style.display="none",this.bdrAFBottom.style.display="none",this.bdrAFTop.style.display="none")},t.prototype.updateValue=function(e,t,i){var r=this.createBeforeAutoFill(e,t,i);if(!r.cancel){var n=this.parent.getColumnByIndex(t);this.parent.editModule&&i&&("number"===n.type?this.parent.editModule.updateCell(e,n.field,parseInt(r.value,10)):this.parent.editModule.updateCell(e,n.field,r.value))}},t.prototype.createBeforeAutoFill=function(e,t,i){var r={column:this.parent.getColumnByIndex(t),value:i.innerText};return this.parent.trigger("beforeAutoFill",r),r},t.prototype.getAutoFillCells=function(e,t){var i=".e-cellselectionbackground",r=[].slice.call(this.parent.getDataRows()[e].querySelectorAll(i));return this.parent.isFrozenGrid()&&(r=r.concat([].slice.call(this.parent.getMovableDataRows()[e].querySelectorAll(i))),this.parent.getFrozenMode()===ee&&(r=r.concat([].slice.call(this.parent.getFrozenRightDataRows()[e].querySelectorAll(i))))),r},t.prototype.selectLikeAutoFill=function(e,t){var i=parseInt(yi(this.startAFCell,Y).getAttribute(ne),10),r=parseInt(this.startAFCell.getAttribute(re),10),n=parseInt(yi(this.endAFCell,Y).getAttribute(ne),10),s=parseInt(this.endAFCell.getAttribute(re),10),o=this.selectedRowCellIndexes.length-1,a=this.selectedRowCellIndexes[0].cellIndexes.length-1;switch(!0){case!t&&this.endAFCell.classList.contains("e-cellselectionbackground")&&!!yi(e.target,q):this.startAFCell=this.parent.getCellFromIndex(i,r),this.endAFCell=this.parent.getCellFromIndex(i+o,r+a),this.drawAFBorders();break;case this.autoFillRLselection&&r+a<s&&s-r-a+1>n-i-o&&s-r-a+1>i-n:if(this.endAFCell=this.parent.getCellFromIndex(i+o,s),n=parseInt(yi(this.endAFCell,Y).getAttribute(ne),10),s=parseInt(this.endAFCell.getAttribute(re),10),t){for(var l=parseInt(this.endCell.getAttribute(re),10),h=i;h<=n;h++)for(var d=this.getAutoFillCells(h,r),p=0,c=l+1;c<=s;c++)p>a&&(p=0),this.updateValue(h,c,d[p]),p++;this.selectCellsByRange({rowIndex:i,cellIndex:this.startCellIndex},{rowIndex:n,cellIndex:s})}else this.drawAFBorders();break;case this.autoFillRLselection&&r>s&&r-s+1>n-i-o&&r-s+1>i-n:if(this.startAFCell=this.parent.getCellFromIndex(i,s),this.endAFCell=this.endCell,t){for(h=i;h<=i+o;h++){(d=this.getAutoFillCells(h,r)).reverse();for(p=0,c=this.startCellIndex-1;c>=s;c--)p>a&&(p=0),this.updateValue(h,c,d[p]),p++}this.selectCellsByRange({rowIndex:i,cellIndex:s},{rowIndex:i+o,cellIndex:this.startCellIndex+a})}else this.drawAFBorders();break;case i>n:if(this.startAFCell=this.parent.getCellFromIndex(n,r),this.endAFCell=this.endCell,t){var u=f=parseInt(this.endCell.parentElement.getAttribute(ne),10);for(h=i-1;h>=n;h--){u===this.startIndex-1&&(u=f);d=this.getAutoFillCells(u,r),p=0;u--;for(c=this.startCellIndex;c<=this.startCellIndex+a;c++)this.updateValue(h,c,d[p]),p++}this.selectCellsByRange({rowIndex:n,cellIndex:r+a},{rowIndex:i+o,cellIndex:r})}else this.drawAFBorders();break;default:if(this.endAFCell=this.parent.getCellFromIndex(n,r+a),t){var f=parseInt(this.endCell.parentElement.getAttribute(ne),10);for(u=this.startIndex,h=f+1;h<=n;h++){u===f+1&&(u=this.startIndex);d=this.getAutoFillCells(u,r);u++;p=0;for(var g=this.startCellIndex;g<=this.startCellIndex+a;g++)this.updateValue(h,g,d[p]),p++}this.selectCellsByRange({rowIndex:f-o,cellIndex:r},{rowIndex:n,cellIndex:r+a})}else this.drawAFBorders()}},t.prototype.mouseUpHandler=function(e){if(document.body.classList.remove("e-disableuserselect"),this.element&&sf.base.remove(this.element),this.isDragged&&1===this.selectedRowCellIndexes.length&&1===this.selectedRowCellIndexes[0].cellIndexes.length?this.mUPTarget=yi(e.target,q):this.mUPTarget=null,this.isDragged&&!this.isAutoFillSel&&"Cell"===this.selectionSettings.mode&&e.target.classList.contains(q)){var t=e.target,i=parseInt(t.parentElement.getAttribute(ne),10),r=parseInt(t.getAttribute(re),10);this.isDragged=!1,this.clearCellSelection(),this.selectCellsByRange({rowIndex:this.startDIndex,cellIndex:this.startDCellIndex},{rowIndex:i,cellIndex:r})}if(this.isDragged=!1,this.updateAutoFillPosition(),this.isAutoFillSel){var n=yi(e.target,q);this.endAFCell=n||(this.endCell===this.endAFCell?this.startAFCell:this.endAFCell),this.startAFCell=this.startCell,this.updateStartCellsIndex(),this.selectLikeAutoFill(e,!0),this.updateAutoFillPosition(),this.hideAFBorders(),this.positionBorders(),this.isAutoFillSel=!1}sf.base.EventHandler.remove(this.parent.getContent(),"mousemove",this.mouseMoveHandler),this.parent.frozenRows&&sf.base.EventHandler.remove(this.parent.getHeaderContent(),"mousemove",this.mouseMoveHandler),sf.base.EventHandler.remove(document,"mouseup",this.mouseUpHandler)},t.prototype.hideAutoFill=function(){this.autofill&&(this.autofill.style.display="none")},t.prototype.updateAutoFillPosition=function(){if(this.parent.enableAutoFill&&!this.parent.isEdit&&this.selectionSettings.cellSelectionMode.indexOf("Box")>-1&&!this.isRowType()&&!this.isSingleSel()&&this.selectedRowCellIndexes.length){var e=parseInt(this.target.getAttribute(re),10),t=parseInt(this.target.getAttribute("index"),10),i=this.selectedRowCellIndexes[this.selectedRowCellIndexes.length-1].rowIndex,r=this.getAutoFillCells(i,e).filter((function(e){return""===e.style.display})),n=this.parent.getColumnByIndex(e),s="movable"===n.getFreezeTableName(),o=t<this.parent.frozenRows,a=this.parent.getFrozenMode()===ee&&n.getFreezeTableName()===te;sf.base.select("#"+this.parent.element.id+"_autofill",yi(this.target,X))||(sf.base.select("#"+this.parent.element.id+"_autofill",this.parent.element)&&sf.base.select("#"+this.parent.element.id+"_autofill",this.parent.element).remove(),this.autofill=sf.base.createElement("div",{className:"e-autofill",id:this.parent.element.id+"_autofill"}),this.autofill.style.display="none",o?s?this.parent.headerModule.getMovableHeader().appendChild(this.autofill):this.parent.getHeaderTable().parentElement.appendChild(this.autofill):s?this.parent.contentModule.getMovableContent().appendChild(this.autofill):this.parent.getContentTable().parentElement.appendChild(this.autofill),a&&(o?this.parent.getFrozenRightHeader().appendChild(this.autofill):this.parent.getFrozenRightContent().appendChild(this.autofill)));var l=r[r.length-1];if(l&&l.offsetParent){var h=l.getBoundingClientRect(),d=l.offsetParent.getBoundingClientRect(),p=this.isLastCell(l)?4:0,c=this.isLastRow(l)?3:0;this.parent.enableRtl?this.autofill.style.right=d.right-h.right+h.width-4-p+"px":this.autofill.style.left=h.left-d.left+h.width-4-p+"px",this.autofill.style.top=h.top-d.top+h.height-5-c+"px"}this.autofill.style.display=""}else this.hideAutoFill()},t.prototype.mouseDownHandler=function(e){this.mouseButton=e.button;var t,i=e.target,r=this.parent,n=yi(i,"e-grid");if(!(n&&n.id!==r.element.id||yi(i,V)&&!this.parent.frozenRows||yi(i,"e-editedbatchcell")||yi(i,Z))){if((e.shiftKey||e.ctrlKey)&&e.preventDefault(),yi(i,q)&&!e.shiftKey&&!e.ctrlKey){if(r.selectionSettings.cellSelectionMode.indexOf("Box")>-1&&!this.isRowType()&&!this.isSingleSel())this.isCellDrag=!0,t=!0;else if(r.allowRowDragAndDrop&&!r.isEdit&&!this.parent.selectionSettings.checkboxOnly){if(this.isRowDragSelected=!1,!this.isRowType()||this.isSingleSel()||sf.base.closest(i,"td").classList.contains("e-selectionbackground"))return void(this.isDragged=!1);t=!0,this.element=this.parent.createElement("div",{className:"e-griddragarea"}),r.getContent().appendChild(this.element)}t&&this.enableDrag(e,!0)}this.updateStartEndCells(),(i.classList.contains("e-autofill")||i.classList.contains("e-xlsel"))&&(this.isCellDrag=!0,this.isAutoFillSel=!0,this.enableDrag(e))}},t.prototype.updateStartEndCells=function(){var e=[].slice.call(this.parent.element.getElementsByClassName("e-cellselectionbackground"));this.startCell=e[0],this.endCell=e[e.length-1],this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute(ne),10),this.startCellIndex=parseInt(yi(this.startCell,q).getAttribute(re),10))},t.prototype.updateStartCellsIndex=function(){this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute(ne),10),this.startCellIndex=parseInt(yi(this.startCell,q).getAttribute(re),10))},t.prototype.enableDrag=function(e,t){var i=this.parent;if(t){var r=sf.base.closest(e.target,"tr");this.startDIndex=parseInt(r.getAttribute(ne),10),this.startDCellIndex=parseInt(yi(e.target,q).getAttribute(re),10)}document.body.classList.add("e-disableuserselect");var n=i.element.getBoundingClientRect(),s=Si(e);this.x=s.x-n.left,this.y=s.y-n.top,sf.base.EventHandler.add(i.getContent(),"mousemove",this.mouseMoveHandler,this),this.parent.frozenRows&&sf.base.EventHandler.add(i.getHeaderContent(),"mousemove",this.mouseMoveHandler,this),sf.base.EventHandler.add(document,"mouseup",this.mouseUpHandler,this)},t.prototype.clearSelAfterRefresh=function(e){var t=this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.requestType;"virtualscroll"===e.requestType||this.parent.isPersistSelection||t||this.clearSelection()},t.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:v,handler:this.enableAfterRender},{event:g,handler:this.initializeSelection},{event:"rowselected",handler:this.onActionComplete},{event:"cellselected",handler:this.onActionComplete},{event:C,handler:this.onPropertyChanged},{event:"cellfocused",handler:this.onCellFocused},{event:"beforeFragAppend",handler:this.clearSelAfterRefresh},{event:"column-position-changed",handler:this.columnPositionChanged},{event:y,handler:this.initialEnd},{event:"rows-removed",handler:this.rowsRemoved},{event:S,handler:this.refreshHeader},{event:F,handler:this.destroy}],Nr(this.parent,this.evtHandlers,!0,this),this.actionBeginFunction=this.actionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.parent.addEventListener(p,this.actionBeginFunction),this.parent.addEventListener(c,this.actionCompleteFunction),this.addEventListener_checkbox())},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(Nr(this.parent,this.evtHandlers,!1),this.parent.removeEventListener(p,this.actionBeginFunction),this.parent.removeEventListener(c,this.actionCompleteFunction),this.removeEventListener_checkbox())},t.prototype.wireEvents=function(){this.isMacOS=-1!==navigator.userAgent.indexOf("Mac OS"),this.isMacOS&&(sf.base.EventHandler.add(this.parent.element,"keydown",this.keyDownHandler,this),sf.base.EventHandler.add(this.parent.element,"keyup",this.keyUpHandler,this))},t.prototype.unWireEvents=function(){this.isMacOS&&(sf.base.EventHandler.remove(this.parent.element,"keydown",this.keyDownHandler),sf.base.EventHandler.remove(this.parent.element,"keyup",this.keyUpHandler))},t.prototype.columnPositionChanged=function(){this.parent.isPersistSelection||this.clearSelection()},t.prototype.refreshHeader=function(){this.setCheckAllState()},t.prototype.rowsRemoved=function(e){for(var t=0;t<e.records.length;t++)delete this.selectedRowState[e.records[t][this.primaryKey]],--this.totalRecordsCount;this.setCheckAllState()},t.prototype.beforeFragAppend=function(e){"virtualscroll"===e.requestType||this.parent.isPersistSelection||this.clearSelection()},t.prototype.getCheckAllBox=function(){return this.parent.getHeaderContent().querySelector(".e-checkselectall")},t.prototype.enableAfterRender=function(e){e.module===this.getModuleName()&&e.enable&&(this.render(),this.initPerisistSelection())},t.prototype.render=function(e){sf.base.EventHandler.add(this.parent.getContent(),"mousedown",this.mouseDownHandler,this),sf.base.EventHandler.add(this.parent.getHeaderContent(),"mousedown",this.mouseDownHandler,this)},t.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName()){var t=this.parent;sf.base.isNullOrUndefined(e.properties.type)||"Single"!==this.selectionSettings.type||(this.selectedRowCellIndexes.length>1&&(this.clearCellSelection(),this.prevCIdxs=void 0),this.selectedRowIndexes.length>1&&(this.clearRowSelection(),this.prevRowIndex=void 0),this.selectedColumnsIndexes.length>1&&(this.clearColumnSelection(),this.prevColIndex=void 0),this.enableSelectMultiTouch=!1,this.hidePopUp()),sf.base.isNullOrUndefined(e.properties.mode)&&sf.base.isNullOrUndefined(e.properties.cellSelectionMode)||(this.clearSelection(),this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevColIndex=void 0),this.isPersisted=!0,this.checkBoxSelectionChanged(),this.isPersisted=!1,this.parent.isCheckBoxSelection||this.initPerisistSelection(),this.parent.getColumns().filter((function(e){return"checkbox"===e.type})).length&&(t.isCheckBoxSelection=!("ResetOnRowClick"===this.selectionSettings.checkboxMode)),this.drawBorders()}},t.prototype.hidePopUp=function(){this.parent.element.querySelector(".e-gridpopup").getElementsByClassName("e-rowselect").length&&(this.parent.element.querySelector(".e-gridpopup").style.display="none")},t.prototype.initialEnd=function(e){var t=this.parent.isFrozenGrid(),i=this.parent.getFrozenMode()===ee;(!t||t&&!i&&!e.args.isFrozen||i&&e.args.renderFrozenRightContent)&&(this.parent.off(y,this.initialEnd),this.selectRow(this.parent.selectedRowIndex))},t.prototype.checkBoxSelectionChanged=function(){var e=this.parent;e.off(y,this.checkBoxSelectionChanged);var t=e.getColumns().filter((function(e){return"checkbox"===e.type}));t.length>0&&(e.isCheckBoxSelection=!0,this.chkField=t[0].field,this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount,sf.base.isNullOrUndefined(this.totalRecordsCount)&&(this.totalRecordsCount=this.getCurrentBatchRecordChanges().length),this.isSingleSel()?(e.selectionSettings.type="Multiple",e.dataBind()):this.initPerisistSelection()),e.isCheckBoxSelection||this.isPersisted||(this.chkField=null,this.initPerisistSelection())},t.prototype.initPerisistSelection=function(){var e=this.parent;this.parent.selectionSettings.persistSelection&&this.parent.getPrimaryKeyFieldNames().length>0?(e.isPersistSelection=!0,this.ensureCheckboxFieldSelection()):this.parent.getPrimaryKeyFieldNames().length>0?(e.isPersistSelection=!1,this.ensureCheckboxFieldSelection()):(e.isPersistSelection=!1,this.selectedRowState={})},t.prototype.ensureCheckboxFieldSelection=function(){var e=this.parent;if(this.primaryKey=this.parent.getPrimaryKeyFieldNames()[0],!e.enableVirtualization&&this.chkField&&(e.isPersistSelection&&0===Object.keys(this.selectedRowState).length||!e.isPersistSelection)){var t=this.parent.getDataModule(),i=(new sf.data.Query).where(this.chkField,"equal",!0);i.params||(i.params=this.parent.query.params);var r=t.getData({},i),n=this;this.parent.showSpinner(),r.then((function(e){n.dataSuccess(e.result),n.refreshPersistSelection(),n.parent.hideSpinner()}))}},t.prototype.dataSuccess=function(e){for(var t=0;t<e.length;t++)sf.base.isNullOrUndefined(this.selectedRowState[e[t][this.primaryKey]])&&e[t][this.chkField]&&(this.selectedRowState[e[t][this.primaryKey]]=e[t][this.chkField]);this.persistSelectedData=e},t.prototype.setRowSelection=function(e){if(!this.parent.getDataModule().isRemote())if(e)if(this.parent.groupSettings.columns.length)for(var t=0,i=this.getData().records;t<i.length;t++){var r=i[t];this.selectedRowState[r[this.primaryKey]]=!0}else for(var n=0,s=this.getData();n<s.length;n++){r=s[n];this.selectedRowState[r[this.primaryKey]]=!0}else this.selectedRowState={}},t.prototype.getData=function(){return this.parent.getDataModule().dataManager.executeLocal(this.parent.getDataModule().generateQuery(!0))},t.prototype.refreshPersistSelection=function(){var e=this.parent.getRows();this.parent.isCheckBoxSelection&&this.parent.isFrozenGrid()&&(this.parent.getMovableContentTbody().querySelector(".e-checkselect")&&(e=this.parent.getMovableRows()),this.parent.getFrozenMode()===ee&&this.parent.getFrozenRightContentTbody().querySelector(".e-checkselect")&&(e=this.parent.getFrozenRightRows()));if(this.totalRecordsCount=this.parent.getCurrentViewRecords().length,this.parent.allowPaging&&(this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount),null!==e&&e.length>0&&(this.parent.isPersistSelection||this.chkField)){for(var t=[],i=0;i<e.length;i++){var r=this.getRowObj(e[i]),n=r&&r.data?r.data[this.primaryKey]:null;if(null===n)return;var s=void 0,o=e[i].querySelector(".e-checkselect");this.selectedRowState[n]||"Check"===this.parent.checkAllRows&&this.totalRecordsCount===Object.keys(this.selectedRowState).length&&this.chkAllCollec.indexOf(n)<0||"Uncheck"===this.parent.checkAllRows&&this.chkAllCollec.indexOf(n)>0||"Intermediate"===this.parent.checkAllRows&&!sf.base.isNullOrUndefined(this.chkField)&&r.data[this.chkField]?(t.push(parseInt(e[i].getAttribute(ne),10)),s=!0):(s=!1,this.checkedTarget!==o&&this.parent.isCheckBoxSelection&&Wi(o.nextElementSibling,s)),this.updatePersistCollection(e[i],s)}this.isSingleSel()&&t.length>0?this.selectRow(t[0],!0):this.selectRows(t)}this.parent.isCheckBoxSelection&&this.getCurrentBatchRecordChanges().length>0&&this.setCheckAllState()},t.prototype.actionBegin=function(e){if("save"===e.requestType&&this.parent.isPersistSelection){var t=this.parent.element.querySelector(".e-edit-checkselect");if(!sf.base.isNullOrUndefined(t)){var i=sf.base.closest(t,"."+Z);if(i){"Dialog"===this.parent.editSettings.mode&&(i=this.parent.element.querySelector(".e-dlgeditrow"));var r=this.getRowObj(i);if(!r)return;this.selectedRowState[r.data[this.primaryKey]]=r.isSelected=t.checked}else this.isCheckedOnAdd=t.checked}}},t.prototype.actionComplete=function(e){if("save"===e.requestType&&this.parent.isPersistSelection){if("add"===e.action&&this.isCheckedOnAdd){var t=this.parent.getRowObjectFromUID(this.parent.getRows()[e.selectedRow].getAttribute("data-uid"));this.selectedRowState[t.data[this.primaryKey]]=t.isSelected=this.isCheckedOnAdd}this.refreshPersistSelection()}if("delete"===e.requestType&&this.parent.isPersistSelection){for(var i=e.data.slice(),r=0;r<i.length;r++)sf.base.isNullOrUndefined(i[r][this.primaryKey])||this.updatePersistDelete(i[r][this.primaryKey]);this.setCheckAllState(),this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount}"paging"===e.requestType&&(this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevECIdxs=void 0)},t.prototype.onDataBound=function(){if(!this.parent.enableVirtualization&&this.parent.isPersistSelection&&(this.selectedRecords.length&&(this.isPrevRowSelection=!0),this.refreshPersistSelection()),this.parent.enableVirtualization&&this.setCheckAllState(),this.initialRowSelection=!!(this.isRowType()&&this.parent.element.querySelectorAll(".e-selectionbackground")&&this.parent.getSelectedRows().length),this.parent.isCheckBoxSelection&&!this.initialRowSelection){for(var e=this.parent.getRowsObject(),t=[],i=0;i<e.length;i++)e[i].isSelected&&t.push(i);t.length&&this.selectRows(t),this.initialRowSelection=!0}},t.prototype.updatePersistSelectedData=function(e){if(this.parent.isPersistSelection){for(var t=this.parent.getRows(),i=0;i<t.length;i++)this.updatePersistCollection(t[i],e);"Uncheck"===this.parent.checkAllRows?(this.setRowSelection(!1),this.persistSelectedData=this.parent.getDataModule().isRemote()?this.persistSelectedData:[]):"Check"===this.parent.checkAllRows&&(this.setRowSelection(!0),this.persistSelectedData=this.parent.getDataModule().isRemote()?this.persistSelectedData:this.parent.groupSettings.columns.length?this.getData().records.slice():this.getData().slice())}},t.prototype.checkSelectAllAction=function(e){var t=this.getRenderer(),i=this.parent.element.querySelector(".e-gridform");if(this.checkedTarget=this.getCheckAllBox(),e&&this.getCurrentBatchRecordChanges().length?(this.parent.checkAllRows="Check",this.updatePersistSelectedData(e),this.selectRowsByRange(t.getVirtualRowIndex(0),t.getVirtualRowIndex(this.getCurrentBatchRecordChanges().length-1))):(this.parent.checkAllRows="Uncheck",this.updatePersistSelectedData(e),this.clearSelection()),this.chkAllCollec=[],!sf.base.isNullOrUndefined(i)){var r=i.querySelector(".e-edit-checkselect");sf.base.isNullOrUndefined(r)||Wi(r.nextElementSibling,e)}},t.prototype.checkSelectAll=function(e){var t=this,i=this.getCheckAllStatus(e),r="Check"===i;this.isHeaderCheckboxClicked=!0,"Intermediate"===i&&(r=this.getCurrentBatchRecordChanges().some((function(e){return e[t.primaryKey]in t.selectedRowState}))),this.parent.isPersistSelection&&this.parent.allowPaging&&(this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount),this.checkSelectAllAction(!r),this.target=null,this.getCurrentBatchRecordChanges().length>0&&this.setCheckAllState(),this.triggerChkChangeEvent(e,!r)},t.prototype.getCheckAllStatus=function(e){var t=e?e.nextElementSibling.classList:this.getCheckAllBox().nextElementSibling.classList;return t.contains("e-check")?"Check":t.contains("e-uncheck")?"Uncheck":t.contains("e-stop")?"Intermediate":"None"},t.prototype.checkSelect=function(e){var t=sf.base.closest(this.checkedTarget,"."+q),i=this.parent;this.isMultiCtrlRequest=!0;var r=0;if(this.isHeaderCheckboxClicked=!1,Zi(i)){var n=t.parentElement.getAttribute("data-uid");r=i.getRows().map((function(e){return e.getAttribute("data-uid")})).indexOf(n)}else r=parseInt(t.parentElement.getAttribute(ne),10);this.parent.isPersistSelection&&this.parent.element.getElementsByClassName($).length>0&&"Top"===this.parent.editSettings.newRowPosition&&++r,this.rowCellSelectionHandler(r,parseInt(t.getAttribute(re),10)),this.moveIntoUncheckCollection(sf.base.closest(t,"."+Y)),this.setCheckAllState(),this.isMultiCtrlRequest=!1,this.triggerChkChangeEvent(e,e.nextElementSibling.classList.contains("e-check"))},t.prototype.moveIntoUncheckCollection=function(e){if("Check"===this.parent.checkAllRows||"Uncheck"===this.parent.checkAllRows){var t=this.getRowObj(e),i=t&&t.data?t.data[this.primaryKey]:null;if(!i)return;this.chkAllCollec.indexOf(i)<0?this.chkAllCollec.push(i):this.chkAllCollec.splice(this.chkAllCollec.indexOf(i),1)}},t.prototype.triggerChkChangeEvent=function(e,t){this.parent.trigger("checkBoxChange",{checked:t,selectedRowIndexes:this.parent.getSelectedRowIndexes(),target:e}),this.parent.isEdit||(this.checkedTarget=null)},t.prototype.updateSelectedRowIndex=function(e){if(this.parent.isCheckBoxSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&!this.parent.getDataModule().isRemote())if("Check"===this.parent.checkAllRows){this.selectedRowIndexes=[];for(var t=this.getData().length,i=0;i<t;i++)this.selectedRowIndexes.push(i)}else if("Uncheck"===this.parent.checkAllRows)this.selectedRowIndexes=[];else{var r=this.parent.getRowByIndex(e);if(e&&r&&"false"===r.getAttribute("aria-selected")){var n=this.selectedRowIndexes.indexOf(e);this.selectedRowIndexes.splice(n,1)}}},t.prototype.setCheckAllState=function(e,t){if(this.parent.isCheckBoxSelection||"ResetOnRowClick"===this.parent.selectionSettings.checkboxMode){var i=Object.keys(this.selectedRowState).length;this.parent.isPersistSelection||(i=this.selectedRowIndexes.length,this.totalRecordsCount=this.getCurrentBatchRecordChanges().length);var r=this.getCheckAllBox();if(r){var n=r.nextElementSibling;sf.base.removeClass([n],["e-check","e-stop","e-uncheck"]),Gi(r,!1),r.indeterminate=!1,i===this.totalRecordsCount&&this.totalRecordsCount||(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&!this.parent.allowPaging&&!this.parent.getDataModule().isRemote()&&this.getData().length&&i===this.getData().length?(sf.base.addClass([n],["e-check"]),Gi(r,!0),t&&this.getRenderer().setSelection(null,!0,!0),this.parent.checkAllRows="Check"):!this.selectedRowIndexes.length||0===i&&0===this.getCurrentBatchRecordChanges().length?(sf.base.addClass([n],["e-uncheck"]),t&&this.getRenderer().setSelection(null,!1,!0),this.parent.checkAllRows="Uncheck",0===i&&0===this.getCurrentBatchRecordChanges().length?sf.base.addClass([n.parentElement],["e-checkbox-disabled"]):sf.base.removeClass([n.parentElement],["e-checkbox-disabled"])):(sf.base.addClass([n],["e-stop"]),this.parent.checkAllRows="Intermediate",r.indeterminate=!0),!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling||this.parent.allowPaging||this.parent.getDataModule().isRemote()||this.updateSelectedRowIndex(e)}}},t.prototype.keyDownHandler=function(e){(("chrome"===sf.base.Browser.info.name||"safari"===sf.base.Browser.info.name)&&(91===e.keyCode||93===e.keyCode)||"opera"===sf.base.Browser.info.name&&17===e.keyCode||"mozilla"===sf.base.Browser.info.name&&224===e.keyCode)&&(this.cmdKeyPressed=!0)},t.prototype.keyUpHandler=function(e){(("chrome"===sf.base.Browser.info.name||"safari"===sf.base.Browser.info.name)&&(91===e.keyCode||93===e.keyCode)||"opera"===sf.base.Browser.info.name&&17===e.keyCode||"mozilla"===sf.base.Browser.info.name&&224===e.keyCode)&&(this.cmdKeyPressed=!1)},t.prototype.clickHandler=function(e){var t=e.target;this.actualTarget=t,this.selectionSettings.persistSelection&&(this.deSelectedData=hi(this.persistSelectedData)),(yi(t,Y)||yi(t,"e-headerchkcelldiv")||this.selectionSettings.allowColumnSelection&&t.classList.contains("e-headercell"))&&(this.isInteracted=!0),this.isMultiCtrlRequest=e.ctrlKey||this.enableSelectMultiTouch||this.isMacOS&&this.cmdKeyPressed,this.isMultiShiftRequest=e.shiftKey,this.popUpClickHandler(e);var i,r=!1;this.preventFocus=!0;var n=yi(t,"e-checkbox-wrapper");if(this.checkSelectAllClicked=!!(n&&n.getElementsByClassName("e-checkselectall")||this.selectionSettings.persistSelection&&yi(t,Y)),n&&n.querySelectorAll(".e-checkselect,.e-checkselectall").length>0&&(i=n.querySelector('input[type="checkbox"]'),r=!0),this.drawBorders(),this.updateAutoFillPosition(),((t=yi(t,q))&&t.parentElement.classList.contains(Y)&&!this.parent.selectionSettings.checkboxOnly||r)&&!this.isRowDragSelected){if(this.parent.isCheckBoxSelection&&(this.isMultiCtrlRequest=!0),this.target=t,sf.base.isNullOrUndefined(i)){var s=this.parent,o=0;if(Zi(s)){var a=t.parentElement.getAttribute("data-uid");o=s.getRows().map((function(e){return e.getAttribute("data-uid")})).indexOf(a)}else o=parseInt(t.parentElement.getAttribute(ne),10);this.parent.isPersistSelection&&this.parent.element.getElementsByClassName($).length>0&&++o,this.mUPTarget&&this.mUPTarget.isEqualNode(t)||this.rowCellSelectionHandler(o,parseInt(t.getAttribute(re),10)),this.parent.hoverFrozenRows(e),this.parent.isCheckBoxSelection&&(this.moveIntoUncheckCollection(sf.base.closest(t,"."+Y)),this.setCheckAllState())}else this.checkedTarget=i,i.classList.contains("e-checkselectall")?this.checkSelectAll(i):this.checkSelect(i);this.parent.isCheckBoxSelection||!sf.base.Browser.isDevice||this.isSingleSel()||this.showPopup(e)}else if(e.target.classList.contains("e-headercell")&&!e.target.classList.contains("e-stackedheadercell")){a=e.target.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");this.headerSelectionHandler(this.parent.getColumnIndexByUid(a))}this.isMultiCtrlRequest=!1,this.isMultiShiftRequest=!1,sf.base.isNullOrUndefined(sf.base.closest(e.target,".e-unboundcell"))&&(this.preventFocus=!1)},t.prototype.popUpClickHandler=function(e){var t=e.target;sf.base.closest(t,".e-headercell")||e.target.classList.contains(q)||sf.base.closest(t,".e-gridpopup")?t.classList.contains("e-rowselect")&&(t.classList.contains("e-spanclicked")?(t.classList.remove("e-spanclicked"),this.enableSelectMultiTouch=!1,this.parent.element.querySelector(".e-gridpopup").style.display="none"):(t.classList.add("e-spanclicked"),this.enableSelectMultiTouch=!0)):this.parent.element.querySelector(".e-gridpopup").style.display="none"},t.prototype.showPopup=function(e){this.selectionSettings.enableSimpleMultiRowSelection||gi(this.parent.element.querySelector(".e-gridpopup"),e,"e-rowselect e-icons e-icon-rowselect"+(!this.isSingleSel()&&(this.selectedRecords.length>(this.parent.getFrozenColumns()?2:1)||this.selectedRowCellIndexes.length>1)?" e-spanclicked":""))},t.prototype.rowCellSelectionHandler=function(e,t){!this.isMultiCtrlRequest&&!this.isMultiShiftRequest||this.isSingleSel()?(this.isDragged||this.selectRow(e,this.selectionSettings.enableToggle),this.selectCell({rowIndex:e,cellIndex:t},this.selectionSettings.enableToggle),this.selectedRowCellIndexes.length&&this.updateAutoFillPosition(),this.drawBorders()):this.isMultiShiftRequest?(this.parent.isCheckBoxSelection||!this.parent.isCheckBoxSelection&&!sf.base.closest(this.target,"."+q).classList.contains(J)?this.selectRowsByRange(sf.base.isUndefined(this.prevRowIndex)?e:this.prevRowIndex,e):this.addRowsToSelection([e]),this.selectCellsByRange(sf.base.isUndefined(this.prevCIdxs)?{rowIndex:e,cellIndex:t}:this.prevCIdxs,{rowIndex:e,cellIndex:t}),this.updateAutoFillPosition(),this.drawBorders()):(this.addRowsToSelection([e]),this.addCellsToSelection([{rowIndex:e,cellIndex:t}]),this.showHideBorders("none")),this.isDragged=!1},t.prototype.onCellFocused=function(e){if(this.parent.frozenRows&&e.container.isHeader&&e.byKey)if("upArrow"===e.keyArgs.action)this.parent.allowFiltering?e.isJump="INPUT"===e.element.tagName:e.isJump="TH"===e.element.tagName;else if("downArrow"===e.keyArgs.action){var t=Number(e.element.parentElement.getAttribute(ne));e.isJump=0===t}else"ctrlHome"===e.keyArgs.action&&(e.isJump=!0);var i=this.parent.isFrozenGrid()?(e.container.isHeader&&"TD"!==e.element.tagName&&e.isJump&&!this.selectionSettings.allowColumnSelection||(e.container.isContent||"TD"===e.element.tagName)&&!(e.container.isSelectable||"TD"===e.element.tagName))&&!(e.byKey&&"space"===e.keyArgs.action):(e.container.isHeader&&e.isJump||e.container.isContent&&!e.container.isSelectable)&&!(e.byKey&&"space"===e.keyArgs.action)&&!(e.element.classList.contains("e-detailrowexpand")||e.element.classList.contains("e-detailrowcollapse")),r=e.container.isHeader&&"TD"!==e.element.tagName&&!sf.base.closest(e.element,"."+q)&&!(e.byKey&&"space"===e.keyArgs.action);if(e.byKey&&!i){var n=e.container.isContent?e.container.indexes:e.indexes,s=n[0],o=n[1],a=this.focus.getPrevIndexes();if(this.parent.frozenRows)if(e.container.isHeader&&("TD"===e.element.tagName||sf.base.closest(e.element,"."+q))){var l=this.parent.getHeaderTable().querySelector("thead").childElementCount;s-=l,a.rowIndex=sf.base.isNullOrUndefined(a.rowIndex)?null:a.rowIndex-l}else s+=this.parent.frozenRows,a.rowIndex=0!==a.rowIndex&&sf.base.isNullOrUndefined(a.rowIndex)?null:a.rowIndex+this.parent.frozenRows;if(this.parent.isFrozenGrid()){var h=Number(e.element.getAttribute(re)),d=this.parent.getSelectedRowCellIndexes();d.length&&0===a.cellIndex&&(a.cellIndex=d[d.length-1].cellIndexes[0]),a.cellIndex=sf.base.isNullOrUndefined(a.cellIndex)?null:a.cellIndex===o?h:h-1,o=h}if(this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache&&(s=parseInt(e.element.parentElement.getAttribute("aria-rowindex"),10)),!(r||-1===["ctrlPlusA","escape"].indexOf(e.keyArgs.action)&&"space"!==e.keyArgs.action&&s===a.rowIndex&&o===a.cellIndex)||this.selectionSettings.allowColumnSelection){this.preventFocus=!0;var p=this.getKeyColIndex(e);switch(this.needColumnSelection&&(o=p),e.keyArgs.action){case"downArrow":case"upArrow":case"enter":case"shiftEnter":this.target=e.element,this.isKeyAction=!0,this.applyDownUpKey(s,o);break;case"rightArrow":case"leftArrow":this.applyRightLeftKey(s,o);break;case"shiftDown":case"shiftUp":this.shiftDownKey(s,o);break;case"shiftLeft":case"shiftRight":this.applyShiftLeftRightKey(s,o);break;case"home":case"end":o="end"===e.keyArgs.action?this.getLastColIndex(s):0,this.applyHomeEndKey(s,o);break;case"ctrlHome":case"ctrlEnd":this.applyCtrlHomeEndKey(s,o);break;case"escape":this.clearSelection();break;case"ctrlPlusA":this.ctrlPlusA();break;case"space":this.applySpaceSelection(e.element);break;case"tab":this.parent.editSettings.allowNextRowEdit&&this.selectRow(s)}this.needColumnSelection=!1,this.preventFocus=!1,this.positionBorders(),this.updateAutoFillPosition()}}else i&&!this.parent.isCheckBoxSelection&&this.clearSelection()},t.prototype.getKeyColIndex=function(e){var t,i=null,r=e.element.querySelector(".e-stackedheadercelldiv");if(this.selectionSettings.allowColumnSelection&&yi(e.element,"e-columnheader"))if(this.needColumnSelection=!!e.container.isHeader,r){if("rightArrow"===e.keyArgs.action||"leftArrow"===e.keyArgs.action)return i;t=r.getAttribute("e-mappinguid");var n=this.getstackedColumns(this.parent.getColumnByUid(t).columns),s=this.parent.getColumnIndexByUid(n[n.length-1].uid),o=this.parent.getColumnIndexByUid(n[0].uid);i=this.prevColIndex>=s?o:s}else i=this.parent.getColumnIndexByUid(e.element.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));return i},t.prototype.ctrlPlusA=function(){this.isRowType()&&!this.isSingleSel()&&this.selectRowsByRange(0,this.getCurrentBatchRecordChanges().length-1),this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange({rowIndex:0,cellIndex:0},{rowIndex:this.parent.getRows().length-1,cellIndex:this.parent.getColumns().length-1})},t.prototype.applySpaceSelection=function(e){e.classList.contains("e-checkselectall")?(this.checkedTarget=e,this.checkSelectAll(this.checkedTarget)):e.classList.contains("e-checkselect")&&(this.checkedTarget=e,this.checkSelect(this.checkedTarget))},t.prototype.applyDownUpKey=function(e,t){var i=this.parent;this.parent.isCheckBoxSelection&&"Check"===this.parent.checkAllRows&&!this.selectionSettings.persistSelection&&(this.checkSelectAllAction(!1),this.checkedTarget=null),this.isRowType()&&(this.parent.frozenRows,this.selectRow(e,!0),this.applyUpDown(i.selectedRowIndex)),this.isCellType()&&this.selectCell({rowIndex:e,cellIndex:t},!0),this.selectionSettings.allowColumnSelection&&this.needColumnSelection&&this.selectColumn(t)},t.prototype.applyUpDown=function(e){if(!(e<0)){this.target||(this.target=this.parent.getRows()[0].children[this.parent.groupSettings.columns.length||0]);var t=parseInt(this.target.getAttribute(re),10),i=this.parent.getFrozenColumns();if(i)this.target=t>=i?this.contentRenderer.getMovableRowByIndex(e).getElementsByClassName(q)[t-i]:this.contentRenderer.getRowByIndex(e).getElementsByClassName(q)[t];else{var r=this.contentRenderer.getRowByIndex(e);r&&(this.target=r.getElementsByClassName(q)[t])}this.addAttribute(this.target)}},t.prototype.applyRightLeftKey=function(e,t){this.selectionSettings.allowColumnSelection&&this.needColumnSelection?this.selectColumn(t):this.isCellType()&&(this.selectCell({rowIndex:e,cellIndex:t},!0),this.addAttribute(this.target))},t.prototype.applyHomeEndKey=function(e,t){this.isCellType()?this.selectCell({rowIndex:e,cellIndex:t},!0):this.addAttribute(this.parent.getCellFromIndex(e,t))},t.prototype.shiftDownKey=function(e,t){this.isMultiShiftRequest=!0,this.isRowType()&&!this.isSingleSel()&&(sf.base.isUndefined(this.prevRowIndex)?this.selectRow(0,!0):(this.selectRowsByRange(this.prevRowIndex,e),this.applyUpDown(e))),this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange(this.prevCIdxs||{rowIndex:0,cellIndex:0},{rowIndex:e,cellIndex:t}),this.isMultiShiftRequest=!1},t.prototype.applyShiftLeftRightKey=function(e,t){this.isMultiShiftRequest=!0,this.selectionSettings.allowColumnSelection&&this.needColumnSelection?this.selectColumnsByRange(this.prevColIndex,t):this.selectCellsByRange(this.prevCIdxs,{rowIndex:e,cellIndex:t}),this.isMultiShiftRequest=!1},t.prototype.getstackedColumns=function(e){for(var t=[],i=0,r=e.length;i<r;i++)e[i].columns?this.getstackedColumns(e[i].columns):t.push(e[i]);return t},t.prototype.applyCtrlHomeEndKey=function(e,t){this.isRowType()&&(this.selectRow(e,!0),this.addAttribute(this.parent.getCellFromIndex(e,t))),this.isCellType()&&this.selectCell({rowIndex:e,cellIndex:t},!0)},t.prototype.addRemoveClassesForRow=function(e,t,i){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];if(e){var s=[].slice.call(e.getElementsByClassName(q)),o=e.querySelector(".e-detailrowcollapse")||e.querySelector(".e-detailrowexpand"),a=e.querySelector(".e-rowdragdrop");o&&s.push(o),a&&s.push(a),qi.apply(void 0,[s,t].concat(r))}this.getRenderer().setSelection(e?e.getAttribute("data-uid"):null,t,i)},t.prototype.isRowType=function(){return"Row"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode},t.prototype.isCellType=function(){return"Cell"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode},t.prototype.isSingleSel=function(){return"Single"===this.selectionSettings.type},t.prototype.getRenderer=function(){return sf.base.isNullOrUndefined(this.contentRenderer)&&(this.contentRenderer=this.factory.getRenderer(e.RenderType.Content)),this.contentRenderer},t.prototype.getSelectedRecords=function(){return this.selectionSettings.persistSelection?this.persistSelectedData:this.parent.getRowsObject().filter((function(e){return e.isSelected})).map((function(e){return e.data}))},t.prototype.selectColumn=function(e){var t=this.parent;if(!sf.base.isNullOrUndefined(t.getColumns()[e])){var i=t.getColumnByIndex(e),r=t.getColumnHeaderByUid(i.uid),n=r.classList.contains("e-columnselection");if(t.selectionSettings.allowColumnSelection){var s=this.selectedColumnsIndexes.length>1&&this.selectedColumnsIndexes.indexOf(e)>-1;if(this.clearColDependency(),!n||!this.selectionSettings.enableToggle||s){var o={columnIndex:e,headerCell:r,column:i,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};if(this.onActionBegin(o,"columnSelecting"),o.cancel)return void this.disableInteracted();t.selectionSettings.enableToggle&&e===this.prevColIndex&&n&&!s||this.updateColSelection(r,e);var a={columnIndex:e,headerCell:r,column:i,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(a,"columnSelected")}this.updateColProps(e)}}},t.prototype.selectColumnsByRange=function(e,t){var i=this.parent;if(!sf.base.isNullOrUndefined(i.getColumns()[e])){var r=[];if("Single"===i.selectionSettings.type||sf.base.isNullOrUndefined(t))r[0]=e;else for(var n=e<t,s=e;n?s<=t:s>=t;n?s++:s--)r.push(s);this.selectColumns(r)}},t.prototype.selectColumns=function(e){var t=this.parent,i=this.getselectedCols();if("Single"===t.selectionSettings.type&&(e=[e[0]]),t.selectionSettings.allowColumnSelection){this.clearColDependency();var r={columnIndex:e[0],headerCell:i,columnIndexes:e,column:t.getColumnByIndex(e[0]),cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};if(this.onActionBegin(r,"columnSelecting"),r.cancel)this.disableInteracted();else{for(var n=0,s=e.length;n<s;n++)this.updateColSelection(t.getColumnHeaderByUid(t.getColumnByIndex(e[n]).uid),e[n]);i=this.getselectedCols();var o={columnIndex:e[0],headerCell:i,columnIndexes:e,column:t.getColumnByIndex(e[0]),target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(o,"columnSelected"),this.updateColProps(e[0])}}},t.prototype.selectColumnWithExisting=function(e){var t=this.parent;if(!sf.base.isNullOrUndefined(t.getColumns()[e])){var i=t.getColumnHeaderByUid(t.getColumnByIndex(e).uid),r=this.getselectedCols();if("Single"===t.selectionSettings.type&&this.clearColDependency(),t.selectionSettings.allowColumnSelection){if(this.selectedColumnsIndexes.indexOf(e)>-1)this.clearColumnSelection(e);else{var n={columnIndex:e,headerCell:r,columnIndexes:this.selectedColumnsIndexes,column:t.getColumnByIndex(e),cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest};if(this.onActionBegin(n,"columnSelecting"),n.cancel)return void this.disableInteracted();this.updateColSelection(i,e);var s={columnIndex:e,headerCell:r=this.getselectedCols(),column:t.getColumnByIndex(e),columnIndexes:this.selectedColumnsIndexes,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(s,"columnSelected")}this.updateColProps(e)}}},t.prototype.clearColumnSelection=function(e){if(this.isColumnSelected){var t=this.parent;if(!sf.base.isNullOrUndefined(e)&&-1===this.selectedColumnsIndexes.indexOf(e))return;var i=sf.base.isNullOrUndefined(e)?this.selectedColumnsIndexes[this.selectedColumnsIndexes.length-1]:e,r=t.getColumnByIndex(i),n=void 0,s=t.getColumnByIndex(i),o={columnIndex:i,headerCell:n=r.getFreezeTableName()===te?t.getFrozenRightColumnHeaderByIndex(i):"movable"===r.getFreezeTableName()?t.getMovableColumnHeaderByIndex(i):t.getColumnHeaderByUid(s.uid),columnIndexes:this.selectedColumnsIndexes,column:s,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted};if(this.columnDeselect(o,"columnDeselecting"))return void this.disableInteracted();for(var a=sf.base.isNullOrUndefined(e)?[].slice.call(t.getHeaderContent().getElementsByClassName("e-columnselection")):[n],l=this.getSelectedColumnCells(e),h=0,d=a.length;h<d;h++)qi([a[h]],!1,"e-columnselection");for(h=0,d=l.length;h<d;h++)qi([l[h]],!1,"e-columnselection");sf.base.isNullOrUndefined(e)?(this.columnDeselect(o,"columnDeselected"),this.selectedColumnsIndexes=[],this.isColumnSelected=!1,this.parent.getColumns().filter((function(e){return e.isSelected=!1}))):(this.selectedColumnsIndexes.splice(this.selectedColumnsIndexes.indexOf(e),1),this.parent.getColumns()[e].isSelected=!1)}},t.prototype.getselectedCols=function(){var e,t=this.parent;if(this.selectedColumnsIndexes.length>1){e=[];for(var i=0;i<this.selectedColumnsIndexes.length;i++)e.push(t.getColumnHeaderByUid(t.getColumnByIndex(this.selectedColumnsIndexes[i]).uid))}else e=t.getColumnHeaderByUid(t.getColumnByIndex(this.selectedColumnsIndexes[0]).uid);return e},t.prototype.getSelectedColumnCells=function(e){var t,i,r=this.parent,n=!sf.base.isNullOrUndefined(this.parent.rowTemplate),s=n?r.getRows():r.getDataRows();r.isFrozenGrid()&&r.getContent().querySelector("."+G)&&(t=n?r.getMovableRows():r.getMovableDataRows(),s=r.addMovableRows(s,t),r.getFrozenMode()===ee&&(i=n?r.getFrozenRightRows():r.getFrozenRightDataRows(),s=r.addMovableRows(s,i)));for(var o=[],a=sf.base.isNullOrUndefined(e)?".e-columnselection":'[aria-colindex="'+e+'"]',l=0,h=s.length;l<h;l++)o=o.concat([].slice.call(s[l].querySelectorAll(a)));return o},t.prototype.columnDeselect=function(e,t){return"columnDeselected"===t&&delete e.cancel,this.onActionComplete(e,t),e.cancel},t.prototype.updateColProps=function(e){this.prevColIndex=e,this.isColumnSelected=this.selectedColumnsIndexes.length&&!0},t.prototype.clearColDependency=function(){this.clearColumnSelection(),this.selectedColumnsIndexes=[]},t.prototype.updateColSelection=function(e,t){if(!sf.base.isNullOrUndefined(this.parent.getColumns()[t])){var i,r=this.parent.getFrozenLeftCount(),n=this.parent.getMovableColumnsCount(),s=this.parent.getColumnByIndex(t),o=!sf.base.isNullOrUndefined(this.parent.rowTemplate);this.selectedColumnsIndexes.push(t),this.parent.getColumns()[t].isSelected=!0,s.getFreezeTableName()===te?(t-=r+n,i=o?this.parent.getFrozenRightRows():this.parent.getFrozenRightDataRows()):"movable"===s.getFreezeTableName()?(t-=r,i=o?this.parent.getMovableRows():this.parent.getMovableDataRows()):(t+=this.parent.getIndentCount(),i=o?this.parent.getRows():this.parent.getDataRows()),qi([e],!0,"e-columnselection");for(var a=0,l=i.length;a<l;a++)i[a].classList.contains(Y)&&(!i[a].classList.contains(Z)&&!i[a].classList.contains($)||"Normal"!==this.parent.editSettings.mode||sf.base.isNullOrUndefined(i[a].querySelector("tr").childNodes[t])?sf.base.isNullOrUndefined(i[a].childNodes[t])||qi([i[a].childNodes[t]],!0,"e-columnselection"):qi([i[a].querySelector("tr").childNodes[t]],!0,"e-columnselection"))}},t.prototype.headerSelectionHandler=function(e){!this.isMultiCtrlRequest&&!this.isMultiShiftRequest||this.isSingleSel()?this.selectColumn(e):this.isMultiShiftRequest?this.selectColumnsByRange(sf.base.isUndefined(this.prevColIndex)?e:this.prevColIndex,e):this.selectColumnWithExisting(e)},t.prototype.addEventListener_checkbox=function(){var e=this;this.parent.on(m,this.dataReady,this),this.onDataBoundFunction=this.onDataBound.bind(this),this.parent.addEventListener(u,this.onDataBoundFunction),this.parent.on("refresh-infinite-persist-selection",this.onDataBoundFunction),this.parent.on(y,this.checkBoxSelectionChanged,this),this.parent.on("before-refresh-on-data-change",this.initPerisistSelection,this),this.parent.on(b,this.setCheckAllForEmptyGrid,this),this.actionCompleteFunc=this.actionCompleteHandler.bind(this),this.parent.addEventListener(c,this.actionCompleteFunc),this.parent.on(R,this.clickHandler,this),this.resizeEndFn=function(){e.updateAutoFillPosition(),e.drawBorders()},this.resizeEndFn.bind(this),this.parent.addEventListener("resizeStop",this.resizeEndFn)},t.prototype.removeEventListener_checkbox=function(){this.parent.off(m,this.dataReady),this.parent.removeEventListener(u,this.onDataBoundFunction),this.parent.removeEventListener(c,this.actionCompleteFunc),this.parent.off("refresh-infinite-persist-selection",this.onDataBoundFunction),this.parent.off(b,this.setCheckAllForEmptyGrid),this.parent.off(R,this.clickHandler),this.parent.off("before-refresh-on-data-change",this.initPerisistSelection)},t.prototype.setCheckAllForEmptyGrid=function(){var e=this.getCheckAllBox();if(e){this.parent.isCheckBoxSelection=!0;var t=e.nextElementSibling;sf.base.removeClass([t],["e-check","e-stop","e-uncheck"])}},t.prototype.dataReady=function(e){this.isHeaderCheckboxClicked=!1;var t=this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.requestType;"virtualscroll"===e.requestType||this.parent.isPersistSelection||t||(this.disableUI=!this.parent.enableImmutableMode,this.clearSelection(),this.setCheckAllState(),this.disableUI=!1)},t.prototype.actionCompleteHandler=function(e){"save"===e.requestType&&this.parent.isPersistSelection&&this.refreshPersistSelection()},t.prototype.selectRowIndex=function(e){this.parent.isSelectedRowIndexUpdating=!0,this.parent.selectedRowIndex=e},t.prototype.disableInteracted=function(){this.isInteracted=!1},t.prototype.activeTarget=function(){this.actualTarget=this.isInteracted?this.actualTarget:null},t}(),Tt=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.search=function(e){var t=this.parent;e=sf.base.isNullOrUndefined(e)?"":e,Ni(t)?t.notify(I,{instance:this,handler:this.search,arg1:e}):e!==t.searchSettings.key?(t.searchSettings.key=e.toString(),t.dataBind()):this.refreshSearch&&t.refresh()},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(C,this.onPropertyChanged,this),this.parent.on("searching-complete",this.onSearchComplete,this),this.parent.on(F,this.destroy,this),this.actionCompleteFunc=this.onActionComplete.bind(this),this.parent.addEventListener(c,this.actionCompleteFunc),this.parent.on("cancel-Begin",this.cancelBeginEvent,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(C,this.onPropertyChanged),this.parent.off("searching-complete",this.onSearchComplete),this.parent.off(F,this.destroy),this.parent.removeEventListener(c,this.actionCompleteFunc),this.parent.off("cancel-Begin",this.cancelBeginEvent))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.onPropertyChanged=function(e){e.module===this.getModuleName()&&(sf.base.isNullOrUndefined(e.properties.key)?this.parent.notify(w,{requestType:"searching",type:p}):this.parent.notify(w,{requestType:"searching",type:p,searchString:this.parent.searchSettings.key}))},e.prototype.onSearchComplete=function(e){this.parent.trigger(c,sf.base.extend(e,{searchString:this.parent.searchSettings.key,requestType:"searching",type:c}))},e.prototype.onActionComplete=function(e){this.refreshSearch="searching"!==e.requestType},e.prototype.cancelBeginEvent=function(e){"searching"===e.requestType&&this.parent.setProperties({searchSettings:{key:""}},!0)},e.prototype.getModuleName=function(){return"search"},e}(),zt=function(){function e(e){this.parent=e}return e.prototype.show=function(e,t){var i=this.getToggleFields(e),r=this.getColumns(i,t);this.parent.notify("tooltip-destroy",{module:"edit"});for(var n=0;n<r.length;n++)r[n].visible=!0;this.setVisible(r)},e.prototype.hide=function(e,t){var i=this.getToggleFields(e),r=this.getColumns(i,t);this.parent.notify("tooltip-destroy",{module:"edit"});for(var n=0;n<r.length;n++)r[n].visible=!1;this.setVisible(r)},e.prototype.getToggleFields=function(e){return"string"==typeof e?[e]:e},e.prototype.getColumns=function(e,t){var i=this;return li(e,(function(e){return li(i.parent.columnModel,(function(i){if(i[t]===e)return i}))[0]}))},e.prototype.setVisible=function(e,t){var i=this;void 0===t&&(t=[]);var r={requestType:"columnstate",cancel:!1,columns:t=t.length>0?t:e};this.parent.trigger(p,r,(function(r){var n=i.parent.getColumns();if(e=sf.base.isNullOrUndefined(e)?n:e,r.cancel)return i.parent.notify("reset-columns",{showHideArgs:r}),void(e.length>0&&(e[0].visible=!0));(Zi(i.parent)&&i.parent.contentModule.emptyVcRows(),i.parent.allowSelection&&i.parent.getSelectedRecords().length&&!i.parent.selectionSettings.persistSelection&&i.parent.clearSelection(),i.parent.enableColumnVirtualization)?e.filter((function(e){return n.some((function(t){return e.field===t.field}))})).length&&i.parent.notify("column-visible-changed",e):i.parent.notify("column-visible-changed",e);var s={requestType:"columnstate",columns:t};i.parent.trigger(c,s),"All"!==i.parent.columnQueryMode&&i.parent.refresh()}))},e}(),Dt=function(){function e(e){this.previousValues={top:0,left:0},this.oneTimeReady=!0,this.parent=e,this.widthService=new ht(e),this.addEventListener()}return e.prototype.getModuleName=function(){return"scroll"},e.prototype.setWidth=function(e){this.parent.element.style.width=sf.base.formatUnit(this.parent.width),e&&this.widthService.setWidthToColumns(),this.parent.toolbarModule&&this.parent.toolbarModule.toolbar&&this.parent.toolbarModule.toolbar.element&&this.parent.toolbarModule.toolbar.refreshOverflow()},e.prototype.setHeight=function(){var t=0,i=this.parent.getContent().querySelector("."+Q),r=this.parent.height;if(this.parent.isFrozenGrid()&&"auto"!==this.parent.height&&this.parent.height.toString().indexOf("%")<0&&(r=parseInt(r,10)-e.getScrollBarWidth()),!this.parent.enableVirtualization&&this.parent.frozenRows&&"auto"!==this.parent.height){var n=this.parent.getHeaderContent().querySelector(se);if(t=n?n.offsetHeight:0,n&&t)t-=n.getElementsByClassName($).length*this.parent.getRowHeight();i.style.height=sf.base.formatUnit(r-t)}else i.style.height=sf.base.formatUnit(r);this.ensureOverflow(i),this.parent.isFrozenGrid()&&this.refresh()},e.prototype.setPadding=function(){var t=this.parent.getHeaderContent(),i=e.getScrollBarWidth()-this.getThreshold(),r=this.getCssProperties(),n="Right"===this.parent.getFrozenMode()||this.parent.getFrozenMode()===ee?"0.5px":"1px";t.querySelector("."+V).style[r.border]=i>0?n:"0px",t.style[r.padding]=i>0?i+"px":"0px"},e.prototype.removePadding=function(e){var t=this.getCssProperties(e),i=this.parent.getHeaderContent().querySelector("."+V);i.style[t.border]="",i.parentElement.style[t.padding]="";var r=this.parent.getFooterContent();r&&r.classList.contains("e-footerpadding")&&r.classList.remove("e-footerpadding")},e.prototype.refresh=function(){if("100%"===this.parent.height){var e=this.parent.getContent();this.parent.element.style.height="100%";var t=this.widthService.getSiblingsHeight(e);e.style.height="calc(100% - "+t+"px)",this.parent.isFrozenGrid()&&(e.firstElementChild.style.height="calc(100% - "+Di()+"px)")}},e.prototype.getThreshold=function(){return"mozilla"===sf.base.Browser.info.name?.5:1},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(b,this.wireEvents,this),this.parent.on(y,this.wireEvents,this),this.parent.on(v,this.onPropertyChanged,this),this.parent.on("textWrapRefresh",this.wireEvents,this),this.parent.on(S,this.setScrollLeft,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(b,this.wireEvents),this.parent.off(y,this.wireEvents),this.parent.off(v,this.onPropertyChanged),this.parent.off("textWrapRefresh",this.wireEvents),this.parent.off(S,this.setScrollLeft))},e.prototype.setScrollLeft=function(){this.parent.isFrozenGrid()?this.parent.headerModule.getMovableHeader().scrollLeft=this.previousValues.left:this.parent.getHeaderContent().querySelector("."+V).scrollLeft=this.previousValues.left},e.prototype.onFrozenContentScroll=function(){var e=this;return function(t){null===e.content.querySelector(se)||e.parent.isPreventScrollEvent||(!sf.base.isNullOrUndefined(e.parent.infiniteScrollModule)&&e.parent.enableInfiniteScrolling&&e.parent.notify("infinite-scroll-handler",t),e.previousValues.top=t.target.scrollTop)}},e.prototype.onContentScroll=function(e){var t=this,i=e,r=i.classList.contains(V);return function(e){if(null!==t.content.querySelector(se)&&!t.parent.isPreventScrollEvent){var n=e.target,s=n.scrollLeft;if(!sf.base.isNullOrUndefined(t.parent.infiniteScrollModule)&&t.parent.enableInfiniteScrolling&&t.parent.notify("infinite-scroll-handler",{target:e.target,isLeft:t.previousValues.left!==s}),t.parent.groupSettings.columns.length&&t.parent.groupSettings.enableLazyLoading){var o=t.previousValues.top<t.parent.getContent().firstElementChild.scrollTop;t.parent.notify("lazy-load-scroll-handler",{scrollDown:o})}t.parent.notify("virtual-scroll-edit",{});var a=n.classList.contains("e-summarycontent");t.previousValues.left!==s?(t.parent.notify("close-filter-dialog",e),i.scrollLeft=s,a&&(t.header.scrollLeft=s),t.previousValues.left=s,t.parent.notify("scroll",{left:s})):t.previousValues.top=r?n.scrollTop:t.previousValues.top}}},e.prototype.onCustomScrollbarScroll=function(e,t){var i=this,r=e,n=t;return function(e){if(null!==i.content.querySelector(se)){var t=e.target.scrollLeft;i.previousValues.left!==t&&(r.scrollLeft=t,n.scrollLeft=t,i.previousValues.left=t,i.parent.notify("scroll",{left:t}),i.parent.isDestroyed)}}},e.prototype.onTouchScroll=function(e){var t=this,i=e;return function(e){if("mouse"!==e.pointerType){var r=t.parent.isFrozenGrid(),n=t.getPointXY(e),s=i.scrollLeft+(t.pageXY.x-n.x),o=r?t.parent.getHeaderContent().querySelector("."+_):t.parent.getHeaderContent().querySelector("."+V),a=r?t.parent.getContent().querySelector("."+G):t.parent.getContent().querySelector("."+Q);if(!(t.previousValues.left===s||s<0||o.scrollWidth-o.clientWidth<s)){if(e.preventDefault(),o.scrollLeft=s,a.scrollLeft=s,r)t.parent.getContent().querySelector(".e-movablescrollbar").scrollLeft=s;t.pageXY.x=n.x,t.previousValues.left=s}}}},e.prototype.setPageXY=function(){var e=this;return function(t){"mouse"!==t.pointerType&&(e.pageXY=e.getPointXY(t))}},e.prototype.getPointXY=function(e){var t={x:0,y:0};return e.touches&&e.touches.length?(t.x=e.touches[0].pageX,t.y=e.touches[0].pageY):(t.x=e.pageX,t.y=e.pageY),t},e.prototype.getScrollbleParent=function(e){if(null===e)return null;var t=sf.base.isNullOrUndefined(e.tagName)?e.scrollingElement:e,i=document.defaultView.getComputedStyle(t,null).overflowY;return t.scrollHeight>t.clientHeight&&"hidden"!==i&&"visible"!==i||"HTML"===e.tagName||"BODY"===e.tagName?e:this.getScrollbleParent(e.parentNode)},e.prototype.addStickyListener=function(e){e?(this.parentElement=this.getScrollbleParent(this.parent.element.parentElement),this.parentElement&&sf.base.EventHandler.add("HTML"===this.parentElement.tagName||"BODY"===this.parentElement.tagName?document:this.parentElement,"scroll",this.makeStickyHeader,this)):sf.base.EventHandler.remove(this.parentElement,"scroll",this.makeStickyHeader)},e.prototype.wireEvents=function(){var e=this;if(this.oneTimeReady){var t=this.parent.isFrozenGrid();this.content=this.parent.getContent().querySelector("."+Q),this.header=this.parent.getHeaderContent().querySelector("."+V);var i=this.content.querySelector("."+G),r=this.header.querySelector("."+_),n=this.parent.getContent().querySelector(".e-movablescrollbar");this.parent.frozenRows&&(sf.base.EventHandler.add(t?r:this.header,"touchstart pointerdown",this.setPageXY(),this),sf.base.EventHandler.add(t?r:this.header,"touchmove pointermove",this.onTouchScroll(t?i:this.content),this)),this.parent.isFrozenGrid()?(sf.base.EventHandler.add(n,"scroll",this.onCustomScrollbarScroll(i,r),this),sf.base.EventHandler.add(i,"scroll",this.onCustomScrollbarScroll(n,r),this),sf.base.EventHandler.add(r,"scroll",this.onCustomScrollbarScroll(n,i),this),sf.base.EventHandler.add(this.content,"scroll",this.onFrozenContentScroll(),this),sf.base.EventHandler.add(r,"touchstart pointerdown",this.setPageXY(),this),sf.base.EventHandler.add(r,"touchmove pointermove",this.onTouchScroll(i),this),sf.base.EventHandler.add(i,"touchstart pointerdown",this.setPageXY(),this),sf.base.EventHandler.add(i,"touchmove pointermove",this.onTouchScroll(r),this)):(sf.base.EventHandler.add(this.content,"scroll",this.onContentScroll(this.header),this),sf.base.EventHandler.add(this.header,"scroll",this.onContentScroll(this.content),this)),this.parent.aggregates.length&&sf.base.EventHandler.add(this.parent.getFooterContent().firstChild,"scroll",this.onContentScroll(this.content),this),this.parent.enableStickyHeader&&this.addStickyListener(!0),this.refresh(),this.oneTimeReady=!1}var s,o,a,l=this.parent.getContentTable();ti((function(){s=e.header.scrollLeft,o=l.scrollHeight,a=e.parent.getContent().clientHeight}),(function(){var t={cancel:!1};e.parent.notify("check-scroll-reset",t),e.parent.enableVirtualization||e.parent.enableInfiniteScrolling||(o<a&&(sf.base.addClass(l.querySelectorAll("tr:last-child td"),"e-lastrowcell"),e.parent.isFrozenGrid()&&sf.base.addClass(e.parent.getContent().querySelector("."+G).querySelectorAll("tr:last-child td"),"e-lastrowcell")),t.cancel||((e.parent.frozenRows>0||e.parent.isFrozenGrid())&&e.header.querySelector("."+_)?e.header.querySelector("."+_).scrollLeft=e.previousValues.left:e.header.scrollLeft=e.previousValues.left,e.content.scrollLeft=e.previousValues.left,e.content.scrollTop=e.previousValues.top)),e.parent.enableColumnVirtualization||(e.content.scrollLeft=s),e.parent.isFrozenGrid()&&e.header.querySelector("."+_)&&(e.header.querySelector("."+_).scrollLeft=e.content.querySelector("."+G).scrollLeft)})),this.parent.isPreventScrollEvent=!1},e.prototype.getCssProperties=function(e){var t={},i=sf.base.isNullOrUndefined(e)?this.parent.enableRtl:e;return t.border=i?"borderLeftWidth":"borderRightWidth",t.padding=i?"paddingLeft":"paddingRight",t},e.prototype.ensureOverflow=function(e){e.style.overflowY="auto"===this.parent.height?"auto":"scroll"},e.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName()){this.setPadding(),this.oneTimeReady=!0,"auto"===this.parent.height&&this.removePadding(),this.wireEvents(),this.setHeight();this.setWidth(!sf.base.isNullOrUndefined(e.properties.width))}},e.prototype.makeStickyHeader=function(){if(this.parent.enableStickyHeader&&this.parent.element&&this.parent.getContent()){var e=this.parent.getContent().getClientRects()[0];if(e){var t=this.parent.getHeaderContent(),i=this.parent.element.querySelector(".e-toolbar"),r=this.parent.element.querySelector(".e-groupdroparea"),n=t.offsetHeight+(i?i.offsetHeight:0)+(r?r.offsetHeight:0),s=this.parentElement.getClientRects()[0].top,o=e.top-(s<0?0:s),a=e.left;if(o<n&&e.bottom>0){t.classList.add("e-sticky");var l=0;r&&(this.setSticky(r,l,e.width,a,!0),l+=r.getClientRects()[0].height),i&&(this.setSticky(i,l,e.width,a,!0),l+=i.getClientRects()[0].height),this.setSticky(t,l,e.width,a,!0)}else if(t.classList.contains("e-sticky")){this.setSticky(t,null,null,null,!1),i&&this.setSticky(i,null,null,null,!1),r&&this.setSticky(r,null,null,null,!1);var h=this.parent.element.querySelector(".e-ccdlg");h&&h.classList.remove("e-sticky")}this.parent.notify("sticky-scroll-complete",{})}}},e.prototype.setSticky=function(e,t,i,r,n){n?(e.style.width=i+"px",e.classList.add("e-sticky")):e.classList.remove("e-sticky"),e.style.top=null!=t?t+"px":"",e.style.left=null!==r?parseInt(e.style.left,10)!==r?r+"px":e.style.left:""},e.prototype.destroy=function(){var e=this.parent.element;if(e&&(e.querySelector("."+H)||e.querySelector("."+U))){this.removeEventListener(),this.removePadding();var t=this.parent.getContent().querySelector("."+Q);sf.base.removeClass([this.parent.getHeaderContent().querySelector("."+V)],V),sf.base.removeClass([t],Q),t.style.height="",this.parent.element.style.width="",sf.base.EventHandler.remove(t,"scroll",this.onContentScroll),this.parent.enableStickyHeader&&this.addStickyListener(!1)}},e.getScrollBarWidth=function(){return Di()},e}(),Mt=(Ae=function(e,t){return(Ae=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ae(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ot=function(e,t,r,n){var s,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(a=(o<3?s(a):o>3?s(t,r,a):s(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},kt=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateFn={},e}return Mt(i,t),i.prototype.setFormatter=function(e){this.formatFn=e},i.prototype.getFormatter=function(){return this.formatFn},i.prototype.setTemplate=function(t){void 0===t&&(t={}),void 0!==this.footerTemplate&&(this.templateFn[sf.base.getEnumValue(e.CellType,e.CellType.Summary)]={fn:sf.base.compile(this.footerTemplate,t),property:"footerTemplate"}),void 0!==this.groupFooterTemplate&&(this.templateFn[sf.base.getEnumValue(e.CellType,e.CellType.GroupSummary)]={fn:sf.base.compile(this.groupFooterTemplate,t),property:"groupFooterTemplate"}),void 0!==this.groupCaptionTemplate&&(this.templateFn[sf.base.getEnumValue(e.CellType,e.CellType.CaptionSummary)]={fn:sf.base.compile(this.groupCaptionTemplate,t),property:"groupCaptionTemplate"})},i.prototype.getTemplate=function(t){return this.templateFn[sf.base.getEnumValue(e.CellType,t)]},i.prototype.setPropertiesSilent=function(e){this.setProperties(e,!0)},Ot([sf.base.Property()],i.prototype,"type",void 0),Ot([sf.base.Property()],i.prototype,"field",void 0),Ot([sf.base.Property()],i.prototype,"columnName",void 0),Ot([sf.base.Property()],i.prototype,"format",void 0),Ot([sf.base.Property()],i.prototype,"footerTemplate",void 0),Ot([sf.base.Property()],i.prototype,"groupFooterTemplate",void 0),Ot([sf.base.Property()],i.prototype,"groupCaptionTemplate",void 0),Ot([sf.base.Property()],i.prototype,"customAggregate",void 0),i}(sf.base.ChildProperty),At=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Mt(t,e),Ot([sf.base.Collection([],kt)],t.prototype,"columns",void 0),t}(sf.base.ChildProperty),Bt=function(){function e(e){this.copyContent="",this.isSelect=!1,this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(y,this.initialEnd,this),this.parent.on(x,this.keyDownHandler,this),this.parent.on(R,this.clickHandler,this),sf.base.EventHandler.add(this.parent.element,"keydown",this.pasteHandler,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(x,this.keyDownHandler),this.parent.off(y,this.initialEnd),this.parent.off(R,this.clickHandler),sf.base.EventHandler.remove(this.parent.element,"keydown",this.pasteHandler))},e.prototype.clickHandler=function(e){var t=e.target;t=yi(t,"e-rowcell")},e.prototype.pasteHandler=function(e){var t=this,i=this.parent,r=/(Mac)/i.test(navigator.platform);if(67===e.keyCode&&r&&e.metaKey&&!i.isEdit&&this.copy(),86===e.keyCode&&(e.ctrlKey||r&&e.metaKey)&&!i.isEdit){if(!sf.base.closest(document.activeElement,"."+q)||!i.editSettings.allowEditing||"Batch"!==i.editSettings.mode||"Cell"!==i.selectionSettings.mode||"Flow"===i.selectionSettings.cellSelectionMode)return;this.activeElement=document.activeElement,this.clipBoardTextArea.value="";var n=window.scrollX,s=window.scrollY;this.clipBoardTextArea.focus(),setTimeout((function(){t.activeElement.focus(),window.scrollTo(n,s),t.paste(t.clipBoardTextArea.value,t.parent.getSelectedRowCellIndexes()[0].rowIndex,t.parent.getSelectedRowCellIndexes()[0].cellIndexes[0])}),10)}},e.prototype.paste=function(e,t,i){var r,n,s,o=this.parent,a=i,l=t;if(o.editSettings.allowEditing&&"Batch"===o.editSettings.mode&&"Cell"===o.selectionSettings.mode&&"Flow"!==o.selectionSettings.cellSelectionMode){var h,d,p,c=e.split("\n"),u=o.getDataRows(),f=this.parent.isFrozenGrid();f&&(d=o.getMovableDataRows(),o.getFrozenRightColumnsCount()&&(p=o.getFrozenRightDataRows()));for(var g=0;g<c.length;g++){if(h=c[g].split("\t"),a=i,g===c.length-1&&""===c[g]||sf.base.isUndefined(o.getRowByIndex(l))){a++;break}for(var m=0;m<h.length;m++){if(s=o.getCellFromIndex(l,a),f){var y=u[l],v=d[l];if(s=!!y.querySelector('[aria-colindex="'+a+'"]')||v.querySelector('[aria-colindex="'+a+'"]'),p&&!s)s=p[l].querySelector('[aria-colindex="'+a+'"]')}if(!s){a++;break}if(n=(r=o.getColumnByIndex(a)).getParser()?r.getParser()(h[m]):h[m],r.allowEditing&&!r.isPrimaryKey&&!r.template){var b={column:r,data:n,rowIndex:l};this.parent.trigger("beforePaste",b),l=b.rowIndex,b.cancel||o.editModule&&("number"===r.type?this.parent.editModule.updateCell(l,r.field,parseFloat(b.data)):o.editModule.updateCell(l,r.field,b.data))}a++}l++}o.selectionModule.selectCellsByRange({rowIndex:t,cellIndex:i},{rowIndex:l-1,cellIndex:a-1});var C=this.parent.getCellFromIndex(l-1,a-1);C&&sf.base.classList(C,["e-focus","e-focused"],[])}},e.prototype.initialEnd=function(){this.parent.off(y,this.initialEnd),this.clipBoardTextArea=this.parent.createElement("textarea",{className:"e-clipboard",styles:"opacity: 0",attrs:{tabindex:"-1","aria-label":"clipboard"}}),this.parent.element.appendChild(this.clipBoardTextArea)},e.prototype.keyDownHandler=function(e){"ctrlPlusC"===e.action?this.copy():"ctrlShiftPlusH"===e.action&&this.copy(!0)},e.prototype.setCopyData=function(e){if(""===window.getSelection().toString()){var t=this.parent.isFrozenGrid();this.clipBoardTextArea.value=this.copyContent="";var i=void 0,r=void 0,n=this.parent.getRows();if(t&&(i=this.parent.getMovableDataRows(),this.parent.getFrozenMode()===ee&&(r=this.parent.getFrozenRightRows())),"Cell"!==this.parent.selectionSettings.mode){var s=this.parent.getSelectedRowIndexes().sort((function(e,t){return e-t}));if(e){for(var o=[],a=0;a<this.parent.getVisibleColumns().length;a++)o[a]=this.parent.getVisibleColumns()[a].headerText;this.getCopyData(o,!1,"\t",e),this.copyContent+="\n"}for(a=0;a<s.length;a++){a>0&&(this.copyContent+="\n");var l=[].slice.call(n[s[a]].querySelectorAll(".e-rowcell:not(.e-hide)"));t&&(l.push.apply(l,[].slice.call(i[s[a]].querySelectorAll(".e-rowcell:not(.e-hide)"))),r&&l.push.apply(l,[].slice.call(r[s[a]].querySelectorAll(".e-rowcell:not(.e-hide)")))),this.getCopyData(l,!1,"\t",e)}}else{var h=this.checkBoxSelection();if(h.status){if(e){var d=[];for(a=0;a<h.colIndexes.length;a++)d.push(this.parent.getColumnHeaderByIndex(h.colIndexes[a]));this.getCopyData(d,!1,"\t",e),this.copyContent+="\n"}for(a=0;a<h.rowIndexes.length;a++){a>0&&(this.copyContent+="\n");l=[].slice.call(n[h.rowIndexes[a]].getElementsByClassName("e-cellselectionbackground"));t&&(l.push.apply(l,[].slice.call(i[h.rowIndexes[a]].getElementsByClassName("e-cellselectionbackground"))),r&&l.push.apply(l,[].slice.call(r[h.rowIndexes[a]].getElementsByClassName("e-cellselectionbackground")))),this.getCopyData(l,!1,"\t",e)}}else this.getCopyData([].slice.call(this.parent.element.getElementsByClassName("e-cellselectionbackground")),!0,"\n",e)}var p={data:this.copyContent,cancel:!1};if(this.parent.trigger("beforeCopy",p),p.cancel)return;this.clipBoardTextArea.value=this.copyContent=p.data,sf.base.Browser.userAgent.match(/ipad|ipod|iphone/i)?this.clipBoardTextArea.setSelectionRange(0,this.clipBoardTextArea.value.length):this.clipBoardTextArea.select(),this.isSelect=!0}},e.prototype.getCopyData=function(e,t,i,r){for(var n="string"!=typeof e[0],s=0;s<e.length;s++){if(r&&t){var o=parseInt(e[s].getAttribute(re),10);this.copyContent+=this.parent.getColumns()[o].headerText+"\n"}n?e[s].classList.contains("e-hide")||(this.copyContent+=e[s].innerText):this.copyContent+=e[s],s<e.length-1&&(this.copyContent+=i)}},e.prototype.copy=function(e){document.queryCommandSupported("copy")&&(this.setCopyData(e),document.execCommand("copy"),this.clipBoardTextArea.blur()),this.isSelect&&(window.getSelection().removeAllRanges(),this.isSelect=!1)},e.prototype.getModuleName=function(){return"clipboard"},e.prototype.destroy=function(){this.removeEventListener(),this.clipBoardTextArea&&sf.base.remove(this.clipBoardTextArea)},e.prototype.checkBoxSelection=function(){var e=this.parent,t={status:!1};if("Cell"===e.selectionSettings.mode){var i=e.getSelectedRowCellIndexes(),r=void 0,n=[],s=void 0;for(s=0;s<i.length&&(i[s].cellIndexes.length&&n.push(i[s].rowIndex),!i[s].cellIndexes.length||(r||(r=JSON.stringify(i[s].cellIndexes.sort())),r===JSON.stringify(i[s].cellIndexes.sort())));s++);n.sort((function(e,t){return e-t})),s===i.length&&n[n.length-1]-n[0]==n.length-1&&(t={status:!0,rowIndexes:n,colIndexes:i[0].cellIndexes})}return t},e}(),Nt=(Be=function(e,t){return(Be=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Be(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Pt=function(e,t,r,n){var s,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(a=(o<3?s(a):o>3?s(t,r,a):s(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Lt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),Pt([sf.base.Property()],t.prototype,"field",void 0),Pt([sf.base.Property()],t.prototype,"direction",void 0),Pt([sf.base.Property(!1)],t.prototype,"isFromGroup",void 0),t}(sf.base.ChildProperty),qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),Pt([sf.base.Collection([],Lt)],t.prototype,"columns",void 0),Pt([sf.base.Property(!0)],t.prototype,"allowUnsort",void 0),t}(sf.base.ChildProperty),Ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),Pt([sf.base.Property()],t.prototype,"field",void 0),Pt([sf.base.Property()],t.prototype,"operator",void 0),Pt([sf.base.Property()],t.prototype,"value",void 0),Pt([sf.base.Property()],t.prototype,"matchCase",void 0),Pt([sf.base.Property(!1)],t.prototype,"ignoreAccent",void 0),Pt([sf.base.Property()],t.prototype,"predicate",void 0),Pt([sf.base.Property({})],t.prototype,"actualFilterValue",void 0),Pt([sf.base.Property({})],t.prototype,"actualOperator",void 0),Pt([sf.base.Property()],t.prototype,"type",void 0),Pt([sf.base.Property()],t.prototype,"ejpredicate",void 0),Pt([sf.base.Property()],t.prototype,"uid",void 0),Pt([sf.base.Property()],t.prototype,"isForeignKey",void 0),t}(sf.base.ChildProperty),Ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),Pt([sf.base.Property(!1)],t.prototype,"enableCache",void 0),Pt([sf.base.Property(3)],t.prototype,"maxBlocks",void 0),Pt([sf.base.Property(3)],t.prototype,"initialBlocks",void 0),t}(sf.base.ChildProperty),jt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),Pt([sf.base.Collection([],Ht)],t.prototype,"columns",void 0),Pt([sf.base.Property("FilterBar")],t.prototype,"type",void 0),Pt([sf.base.Property()],t.prototype,"mode",void 0),Pt([sf.base.Property(!0)],t.prototype,"showFilterBarStatus",void 0),Pt([sf.base.Property(1500)],t.prototype,"immediateModeDelay",void 0),Pt([sf.base.Property()],t.prototype,"operators",void 0),Pt([sf.base.Property(!1)],t.prototype,"ignoreAccent",void 0),Pt([sf.base.Property(!1)],t.prototype,"enableCaseSensitivity",void 0),Pt([sf.base.Property(!1)],t.prototype,"showFilterBarOperator",void 0),t}(sf.base.ChildProperty),Vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),Pt([sf.base.Property("Row")],t.prototype,"mode",void 0),Pt([sf.base.Property("Flow")],t.prototype,"cellSelectionMode",void 0),Pt([sf.base.Property("Single")],t.prototype,"type",void 0),Pt([sf.base.Property(!1)],t.prototype,"checkboxOnly",void 0),Pt([sf.base.Property(!1)],t.prototype,"persistSelection",void 0),Pt([sf.base.Property("Default")],t.prototype,"checkboxMode",void 0),Pt([sf.base.Property(!1)],t.prototype,"enableSimpleMultiRowSelection",void 0),Pt([sf.base.Property(!0)],t.prototype,"enableToggle",void 0),Pt([sf.base.Property(!1)],t.prototype,"allowColumnSelection",void 0),t}(sf.base.ChildProperty),Gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),Pt([sf.base.Property([])],t.prototype,"fields",void 0),Pt([sf.base.Property("")],t.prototype,"key",void 0),Pt([sf.base.Property("contains")],t.prototype,"operator",void 0),Pt([sf.base.Property(!0)],t.prototype,"ignoreCase",void 0),Pt([sf.base.Property(!1)],t.prototype,"ignoreAccent",void 0),t}(sf.base.ChildProperty),_t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),Pt([sf.base.Property()],t.prototype,"targetID",void 0),t}(sf.base.ChildProperty),Wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),Pt([sf.base.Property("Both")],t.prototype,"wrapMode",void 0),t}(sf.base.ChildProperty),Kt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),Pt([sf.base.Property("Normal")],t.prototype,"mode",void 0),t}(sf.base.ChildProperty),Qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),Pt([sf.base.Property(!0)],t.prototype,"showDropArea",void 0),Pt([sf.base.Property(!1)],t.prototype,"allowReordering",void 0),Pt([sf.base.Property(!1)],t.prototype,"showToggleButton",void 0),Pt([sf.base.Property(!1)],t.prototype,"showGroupedColumn",void 0),Pt([sf.base.Property(!0)],t.prototype,"showUngroupButton",void 0),Pt([sf.base.Property(!1)],t.prototype,"disablePageWiseAggregates",void 0),Pt([sf.base.Property([])],t.prototype,"columns",void 0),Pt([sf.base.Property()],t.prototype,"captionTemplate",void 0),Pt([sf.base.Property(!1)],t.prototype,"enableLazyLoading",void 0),t}(sf.base.ChildProperty),Xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Nt(t,e),Pt([sf.base.Property(!1)],t.prototype,"allowAdding",void 0),Pt([sf.base.Property(!1)],t.prototype,"allowEditing",void 0),Pt([sf.base.Property(!1)],t.prototype,"allowDeleting",void 0),Pt([sf.base.Property("Normal")],t.prototype,"mode",void 0),Pt([sf.base.Property(!0)],t.prototype,"allowEditOnDblClick",void 0),Pt([sf.base.Property(!0)],t.prototype,"showConfirmDialog",void 0),Pt([sf.base.Property(!1)],t.prototype,"showDeleteConfirmDialog",void 0),Pt([sf.base.Property("")],t.prototype,"template",void 0),Pt([sf.base.Property("")],t.prototype,"headerTemplate",void 0),Pt([sf.base.Property("")],t.prototype,"footerTemplate",void 0),Pt([sf.base.Property("Top")],t.prototype,"newRowPosition",void 0),Pt([sf.base.Property({})],t.prototype,"dialog",void 0),Pt([sf.base.Property(!1)],t.prototype,"allowNextRowEdit",void 0),t}(sf.base.ChildProperty),Yt=function(t){function r(e,i){var r=t.call(this,e,i)||this;return r.isPreventScrollEvent=!1,r.inViewIndexes=[],r.keyA=!1,r.frozenRightCount=0,r.frozenLeftCount=0,r.tablesCount=1,r.movableCount=0,r.visibleFrozenLeft=0,r.visibleFrozenRight=0,r.visibleMovable=0,r.frozenLeftColumns=[],r.frozenRightColumns=[],r.movableColumns=[],r.media={},r.isFreezeRefresh=!1,r.tableIndex=0,r.componentRefresh=sf.base.Component.prototype.refresh,r.isVirtualAdaptive=!1,r.vRows=[],r.vcRows=[],r.vGroupOffsets={},r.rowUid=0,r.currentViewData=[],r.isManualRefresh=!1,r.enableDeepCompare=!1,r.lockcolPositionCount=0,r.prevPageMoving=!1,r.pageTemplateChange=!1,r.isAutoGen=!1,r.mediaBindInstance={},r.commandDelIndex=void 0,r.asyncTimeOut=50,r.isExportGrid=!1,r.enableLogger=!0,r.needsID=!0,n.Inject(It),sf.base.setValue("mergePersistData",r.mergePersistGridData,r),r}var n;return Nt(r,t),n=r,r.prototype.getPersistData=function(){for(var e=["pageSettings","sortSettings","filterSettings","groupSettings","columns","searchSettings","selectedRowIndex","scrollPosition"],t={pageSettings:["template","pageSizes","enableQueryString","totalRecordsCount","pageCount"],filterSettings:["type","mode","showFilterBarStatus","immediateModeDelay","ignoreAccent"],groupSettings:["showDropArea","showToggleButton","showGroupedColumn","showUngroupButton","disablePageWiseAggregates","hideCaptionCount"],searchSettings:["fields","operator","ignoreCase"],sortSettings:[],columns:[],selectedRowIndex:[],scrollPosition:[]},i=0;i<e.length;i++)for(var r=this[e[i]],n=0,s=t[e[i]];n<s.length;n++){delete r[s[n]]}var o=this.pageSettings.template,a=Object.assign({template:void 0},this.pageSettings);this.setProperties({pageSettings:a},!0),this.isAngular&&delete this.groupSettings.properties.captionTemplate,this.pageTemplateChange=!sf.base.isNullOrUndefined(this.pagerTemplate);var l=this.addOnPersist(e);return a.template=o,this.setProperties({pageSettings:a},!0),l},r.prototype.requiredModules=function(){this.setFrozenCount(),this.enableInfiniteAggrgate();var e=[];return this.isDestroyed||(this.allowFiltering&&e.push({member:"filter",args:[this,this.filterSettings,this.serviceLocator]}),this.allowExcelExport&&e.push({member:"ExcelExport",args:[this,this.serviceLocator]}),this.allowPdfExport&&e.push({member:"PdfExport",args:[this]}),this.allowSorting&&e.push({member:"sort",args:[this,this.sortSettings,this.sortedColumns,this.serviceLocator]}),this.allowPaging&&e.push({member:"pager",args:[this,this.pageSettings]}),this.allowSelection&&e.push({member:"selection",args:[this,this.selectionSettings,this.serviceLocator]}),e.push({member:"resize",args:[this]}),this.allowReordering&&e.push({member:"reorder",args:[this]}),this.allowRowDragAndDrop&&e.push({member:"rowDragAndDrop",args:[this]}),this.allowGrouping&&e.push({member:"group",args:[this,this.groupSettings,this.sortedColumns,this.serviceLocator]}),this.aggregates.length&&e.push({member:"aggregate",args:[this,this.serviceLocator]}),this.isDetail()&&e.push({member:"detailRow",args:[this,this.serviceLocator]}),(this.toolbar||this.toolbarTemplate)&&e.push({member:"toolbar",args:[this,this.serviceLocator]}),(this.enableVirtualization||this.enableColumnVirtualization)&&e.push({member:"virtualscroll",args:[this,this.serviceLocator]}),(this.getFrozenColumns()||this.frozenRows||this.frozenRightCount||this.frozenLeftCount)&&e.push({member:"freeze",args:[this,this.serviceLocator]}),this.isCommandColumn(this.columns)&&e.push({member:"commandColumn",args:[this,this.serviceLocator]}),(this.editSettings.allowAdding||this.editSettings.allowDeleting||this.editSettings.allowEditing)&&e.push({member:"edit",args:[this,this.serviceLocator]}),this.extendRequiredModules(e)),e},r.prototype.extendRequiredModules=function(e){this.enableInfiniteScrolling&&e.push({member:"infiniteScroll",args:[this,this.serviceLocator]}),this.groupSettings.enableLazyLoading&&e.push({member:"lazyLoadGroup",args:[this,this.serviceLocator]}),this.contextMenuItems&&e.push({member:"contextMenu",args:[this,this.serviceLocator]}),this.showColumnMenu&&e.push({member:"columnMenu",args:[this,this.serviceLocator]}),this.showColumnChooser&&e.push({member:"columnChooser",args:[this,this.serviceLocator]}),this.isForeignKeyEnabled(this.columns)&&e.push({member:"foreignKey",args:[this,this.serviceLocator]}),this.enableLogger&&e.push({member:"logger",args:[this]})},r.prototype.preRender=function(){this.serviceLocator=new at,this.initProperties(),this.initializeServices()},r.prototype.initProperties=function(){this.isInitial=!0,this.sortedColumns=[],this.inViewIndexes=[],this.mediaCol=[],this.isInitialLoad=!1,this.allowServerDataBinding=!1,this.ignoreCollectionWatch=!0,this.mergeCells={},this.isEdit=!1,this.checkAllRows="None",this.isCheckBoxSelection=!1,this.isPersistSelection=!1,this.componentRefresh=sf.base.Component.prototype.refresh,this.filterOperators={contains:"contains",endsWith:"endswith",equal:"equal",greaterThan:"greaterthan",greaterThanOrEqual:"greaterthanorequal",lessThan:"lessthan",lessThanOrEqual:"lessthanorequal",notEqual:"notequal",startsWith:"startswith"},this.defaultLocale={EmptyRecord:"No records to display",True:"true",False:"false",InvalidFilterMessage:"Invalid Filter Data",GroupDropArea:"Drag a column header here to group its column",UnGroup:"Click here to ungroup",UnGroupButton:"Click here to ungroup",GroupDisable:"Grouping is disabled for this column",FilterbarTitle:"'s filter bar cell",EmptyDataSourceError:"DataSource must not be empty at initial load since columns are generated from dataSource in AutoGenerate Column Grid",Add:"Add",Edit:"Edit",Cancel:"Cancel",Update:"Update",Delete:"Delete",Print:"Print",Pdfexport:"PDF Export",Excelexport:"Excel Export",Wordexport:"Word Export",Csvexport:"CSV Export",Search:"Search",Columnchooser:"Columns",Save:"Save",Item:"item",Items:"items",EditOperationAlert:"No records selected for edit operation",DeleteOperationAlert:"No records selected for delete operation",SaveButton:"Save",OKButton:"OK",CancelButton:"Cancel",EditFormTitle:"Details of ",AddFormTitle:"Add New Record",BatchSaveConfirm:"Are you sure you want to save changes?",BatchSaveLostChanges:"Unsaved changes will be lost. Are you sure you want to continue?",ConfirmDelete:"Are you sure you want to Delete Record?",CancelEdit:"Are you sure you want to Cancel the changes?",ChooseColumns:"Choose Column",SearchColumns:"search columns",Matchs:"No matches found",FilterButton:"Filter",ClearButton:"Clear",StartsWith:"Starts With",EndsWith:"Ends With",Contains:"Contains",Equal:"Equal",NotEqual:"Not Equal",LessThan:"Less Than",LessThanOrEqual:"Less Than Or Equal",GreaterThan:"Greater Than",GreaterThanOrEqual:"Greater Than Or Equal",ChooseDate:"Choose a Date",EnterValue:"Enter the value",Copy:"Copy",Group:"Group by this column",Ungroup:"Ungroup by this column",autoFitAll:"Autofit all columns",autoFit:"Autofit this column",AutoFitAll:"Autofit all columns",AutoFit:"Autofit this column",Export:"Export",FirstPage:"First Page",LastPage:"Last Page",PreviousPage:"Previous Page",NextPage:"Next Page",SortAscending:"Sort Ascending",SortDescending:"Sort Descending",EditRecord:"Edit Record",DeleteRecord:"Delete Record",FilterMenu:"Filter",SelectAll:"Select All",Blanks:"Blanks",FilterTrue:"True",FilterFalse:"False",NoResult:"No matches found",ClearFilter:"Clear Filter",Clear:"Clear",NumberFilter:"Number Filters",TextFilter:"Text Filters",DateFilter:"Date Filters",DateTimeFilter:"DateTime Filters",MatchCase:"Match Case",Between:"Between",CustomFilter:"Custom Filter",CustomFilterPlaceHolder:"Enter the value",CustomFilterDatePlaceHolder:"Choose a date",AND:"AND",OR:"OR",ShowRowsWhere:"Show rows where:",FilterMenuDialogARIA:"Filter menu dialog",ExcelFilterDialogARIA:"Excel filter dialog",DialogEditARIA:"Edit dialog",ColumnChooserDialogARIA:"Column chooser dialog",ColumnMenuDialogARIA:"Column menu dialog",CustomFilterDialogARIA:"Customer filter dialog",SortAtoZ:"Sort A to Z",SortZtoA:"Sort Z to A",SortByOldest:"Sort by Oldest",SortByNewest:"Sort by Newest",SortSmallestToLargest:"Sort Smallest to Largest",SortLargestToSmallest:"Sort Largest to Smallest",Sort:"Sort"},this.keyConfigs={downArrow:"downarrow",upArrow:"uparrow",rightArrow:"rightarrow",leftArrow:"leftarrow",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftRight:"shift+rightarrow",shiftLeft:"shift+leftarrow",home:"home",end:"end",escape:"escape",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",pageUp:"pageup",pageDown:"pagedown",ctrlAltPageUp:"ctrl+alt+pageup",ctrlAltPageDown:"ctrl+alt+pagedown",altPageUp:"alt+pageup",altPageDown:"alt+pagedown",altDownArrow:"alt+downarrow",altUpArrow:"alt+uparrow",ctrlDownArrow:"ctrl+downarrow",ctrlUpArrow:"ctrl+uparrow",ctrlPlusA:"ctrl+A",ctrlPlusP:"ctrl+P",insert:"insert",delete:"delete",f2:"f2",enter:"enter",ctrlEnter:"ctrl+enter",shiftEnter:"shift+enter",tab:"tab",shiftTab:"shift+tab",space:"space",ctrlPlusC:"ctrl+C",ctrlShiftPlusH:"ctrl+shift+H",ctrlSpace:"ctrl+space",ctrlLeftArrow:"ctrl+leftarrow",ctrlRightArrow:"ctrl+rightarrow"}},r.prototype.render=function(){this.log(["module_missing","promise_enabled","locale_missing","check_datasource_columns"]),this.ariaService.setOptions(this.element,{role:"grid"}),sf.popups.createSpinner({target:this.element},this.createElement),this.renderModule=new nt(this,this.serviceLocator),this.searchModule=new Tt(this),this.scrollModule=new Dt(this),this.notify(f,{}),!0!==this.getDataModule().dataManager.dataSource.offline&&void 0!==this.getDataModule().dataManager.dataSource.url||(this.isVirtualAdaptive=!0),this.trigger("load"),fi(this.columns,this.enableColumnVirtualization,this),this.enablePersistence&&this.notify("columns-prepared",{}),this.getMediaColumns(),ui(this.columns),this.checkLockColumns(this.columns),this.getColumns(),this.processModel(),this.gridRender(),this.wireEvents(),this.addListener(),this.updateDefaultCursor(),this.updateStackedFilter(),this.showSpinner(),this.notify(g,{})},r.prototype.showSpinner=function(){this.isExportGrid||sf.popups.showSpinner(this.element)},r.prototype.hideSpinner=function(){this.isExportGrid||sf.popups.hideSpinner(this.element)},r.prototype.updateStackedFilter=function(){this.allowFiltering&&"FilterBar"===this.filterSettings.type&&this.getHeaderContent().getElementsByClassName("e-stackedheadercell").length?this.getHeaderContent().classList.add("e-stackedfilter"):this.getHeaderContent().classList.remove("e-stackedfilter")},r.prototype.getMediaColumns=function(){if(!this.enableColumnVirtualization){var e=this.getColumns();if(this.getShowHideService=this.serviceLocator.getService("showHideService"),!sf.base.isNullOrUndefined(e))for(var t=0;t<e.length;t++)sf.base.isNullOrUndefined(e[t].hideAtMedia)||!sf.base.isNullOrUndefined(e[t].visible)&&!e[t].visible||this.pushMediaColumn(e[t],t)}},r.prototype.pushMediaColumn=function(e,t){this.mediaCol.push(e),this.media[e.uid]=window.matchMedia(e.hideAtMedia),this.mediaQueryUpdate(t,this.media[e.uid]),this.mediaBindInstance[t]=this.mediaQueryUpdate.bind(this,t),this.media[e.uid].addListener(this.mediaBindInstance[t])},r.prototype.updateMediaColumns=function(e){if(!this.enableColumnVirtualization){for(var t=this.getColumnIndexByUid(e.uid),i=0;i<this.mediaCol.length;i++)if(e.uid===this.mediaCol[i].uid)return void this.mediaCol.splice(i,1);this.pushMediaColumn(e,t)}},r.prototype.mediaQueryUpdate=function(e,t){var i=this.getColumns()[e];this.mediaCol.some((function(e){return e.uid===i.uid}))&&(i.visible=t.matches,this.isInitialLoad&&(this.invokedFromMedia=!0,i.visible?this.showHider.show(i.headerText,"headerText"):this.showHider.hide(i.headerText,"headerText")))},r.prototype.refreshMediaCol=function(){this.isInitialLoad=!0;var e=this.element.querySelector("."+j);this.aggregates.length&&this.element.scrollHeight>this.height&&e&&sf.base.addClass([e],["e-footerpadding"]),this.getColumns().filter((function(e){return"checkbox"===e.type})).length&&"ResetOnRowClick"===this.selectionSettings.checkboxMode&&(this.isCheckBoxSelection=!1),"Vertical"===this.rowRenderingMode&&this.enableHover&&(this.setProperties({enableAdaptiveUI:!0,enableHover:!1},!0),sf.base.removeClass([this.element],"e-gridhover")),this.enableAdaptiveUI&&this.scrollModule&&this.scrollModule.refresh()},r.prototype.removeMediaListener=function(){for(var e=0;e<this.mediaCol.length;e++)this.media[this.mediaCol[e].uid].removeListener(this.mediaBindInstance[this.mediaCol[e].index])},r.prototype.eventInitializer=function(){},r.prototype.destroy=function(){var e=this.element;if(e){var i=!(!e.querySelector("."+H)||!e.querySelector("."+U));i&&this.unwireEvents(),this.removeListener(),this.removeMediaListener(),this.notify(F,{}),this.destroyDependentModules(),i&&t.prototype.destroy.call(this),this.toolTipObj.destroy();for(var r=["renderModule","headerModule","contentModule","valueFormatterService","serviceLocator","ariaService","keyboardModule","widthService","searchModule","showHider","scrollModule","printModule","clipboardModule","focusModule"],n=0;n<r.length;n++)this[r[n]]&&(this[r[n]]=null);this.element.innerHTML="",sf.base.classList(this.element,[],["e-rtl","e-gridhover","e-responsive","e-default","e-device","e-grid-min-height"]),this.isFreezeRefresh=!1}},r.prototype.destroyDependentModules=function(){var e=this.element;e&&(e.querySelector("."+H)||e.querySelector("."+U))&&(this.scrollModule.destroy(),this.keyboardModule.destroy(),this.focusModule.destroy(),this.clipboardModule.destroy(),this.printModule.destroy())},r.prototype.getModuleName=function(){return"grid"},r.prototype.enableBoxSelection=function(){this.enableAutoFill?(this.selectionSettings.cellSelectionMode="BoxWithBorder",this.element.classList.add("e-afenabled")):this.element.classList.remove("e-afenabled")},r.prototype.onPropertyChanged=function(e,t){var i,r=!1,n=!1,s=!1;if(!this.isDestroyed){this.log("module_missing"),this.isEllipsisTooltip()&&this.toolTipObj.close();var o=Object.keys(e);o.indexOf("columns")>-1&&(this.updateColumnObject(),n=!0);for(var a=0,l=o;a<l.length;a++){var h=l[a];switch(h){case"allowPaging":this.notify(v,{module:"pager",enable:this.allowPaging}),r=!0;break;case"pageSettings":if(this.pageTemplateChange){this.pageTemplateChange=!1,this.notify(C,{module:"pager",properties:e.pageSettings});break}this.notify(C,{module:"pager",properties:e.pageSettings}),(sf.base.isNullOrUndefined(e.pageSettings.currentPage)&&sf.base.isNullOrUndefined(e.pageSettings.pageSize)&&sf.base.isNullOrUndefined(e.pageSettings.totalRecordsCount)||!sf.base.isNullOrUndefined(t.pageSettings)&&e.pageSettings.currentPage!==t.pageSettings.currentPage&&!this.enableColumnVirtualization&&!this.enableVirtualization&&this.pageSettings.totalRecordsCount<=this.pageSettings.pageSize)&&(r=!0);break;case"allowSorting":this.notify(v,{module:"sort",enable:this.allowSorting}),r=!0,i=!0;break;case"allowFiltering":this.updateStackedFilter(),this.notify(v,{module:"filter",enable:this.allowFiltering}),r=!0,"FilterBar"!==this.filterSettings.type&&this.refreshHeader();break;case"height":case"width":this.notify(v,{module:"scroll",properties:{width:e.width,height:e.height}});break;case"allowReordering":this.headerModule.refreshUI(),i=!0;break;case"allowRowDragAndDrop":this.notify(v,{module:"rowDragAndDrop",enable:this.allowRowDragAndDrop}),this.renderModule.refresh(),this.headerModule.refreshUI();break;case"allowSelection":this.notify(v,{module:"selection",enable:this.allowSelection});break;case"enableAutoFill":this.selectionModule&&(this.enableBoxSelection(),this.selectionModule.updateAutoFillPosition());break;case"rowTemplate":this.rowTemplateFn=di(this.rowTemplate),r=!0;break;case"detailTemplate":this.detailTemplateFn=di(this.detailTemplate),r=!0;break;case"allowGrouping":this.notify(v,{module:"group",enable:this.allowGrouping}),this.headerModule.refreshUI(),r=!0,i=!0;break;case"enableInfiniteScrolling":case"childGrid":r=!0;break;case"toolbar":this.notify(v,{module:"toolbar"});break;case"groupSettings":this.notify(C,{module:"group",properties:e.groupSettings,oldProperties:t.groupSettings});break;case"aggregates":!this.aggregates.length&&this.allowGrouping&&this.groupSettings.columns.length&&(r=!0),this.notify(v,{module:"aggregate",properties:e});break;case"frozenColumns":case"frozenRows":case"enableVirtualization":case"currencyCode":case"locale":this.log("frozen_rows_columns"),s=!0,n=!0;break;case"query":this.getDataModule().isQueryInvokedFromData||(r=!0),this.getDataModule().isQueryInvokedFromData=!1;break;default:this.extendedPropertyChange(h,e,n)}}i&&this.updateDefaultCursor(),n?s||this.getFrozenColumns()||this.frozenRows?this.freezeRefresh():this.refresh():r&&(this.notify(w,{requestType:"refresh"}),r=!1,this.maintainSelection(e.selectedRowIndex))}},r.prototype.extendedPropertyChange=function(e,t,i){switch(e){case"enableRtl":this.updateRTL(),this.allowPaging&&(this.element.querySelector(".e-gridpager").ej2_instances[0].enableRtl=t.enableRtl,this.element.querySelector(".e-gridpager").ej2_instances[0].dataBind()),"auto"!==this.height&&(this.scrollModule.removePadding(!t.enableRtl),this.scrollModule.setPadding()),this.toolbar&&this.toolbarModule&&(this.toolbarModule.getToolbar().ej2_instances[0].enableRtl=t.enableRtl,this.toolbarModule.getToolbar().ej2_instances[0].dataBind()),this.contextMenuItems&&this.contextMenuModule&&(this.contextMenuModule.getContextMenu().ej2_instances[0].enableRtl=t.enableRtl,this.contextMenuModule.getContextMenu().ej2_instances[0].dataBind()),this.showColumnMenu&&this.columnMenuModule&&(this.columnMenuModule.getColumnMenu().ej2_instances[0].enableRtl=t.enableRtl,this.columnMenuModule.getColumnMenu().ej2_instances[0].dataBind()),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&this.refreshHeader(),this.notify("rtl-updated",{});break;case"enableAltRow":this.renderModule.refresh();break;case"allowResizing":this.headerModule.refreshUI(),this.updateResizeLines();break;case"rowHeight":this.rowHeight?sf.base.addClass([this.element],"e-grid-min-height"):sf.base.removeClass([this.element],"e-grid-min-height"),this.renderModule.refresh(),this.headerModule.refreshUI();break;case"gridLines":this.updateGridLines();break;case"showColumnMenu":this.headerModule.refreshUI(),this.notify(v,{module:"columnMenu",enable:!0});break;case"columnMenuItems":this.notify(v,{module:"columnMenu",enable:this.columnMenuItems});break;case"contextMenuItems":this.notify(v,{module:"contextMenu",enable:this.contextMenuItems});break;case"showColumnChooser":this.notify(v,{module:"columnChooser",enable:this.showColumnChooser});break;case"filterSettings":this.updateStackedFilter(),this.notify(C,{module:"filter",properties:t.filterSettings});break;case"searchSettings":this.notify(C,{module:"search",properties:t.searchSettings});break;case"sortSettings":this.notify(C,{module:"sort"});break;case"selectionSettings":this.notify(C,{module:"selection",properties:t.selectionSettings});break;case"editSettings":this.notify(C,{module:"edit",properties:t.editSettings});break;case"allowTextWrap":case"textWrapSettings":this.allowTextWrap?this.applyTextWrap():this.removeTextWrap(),this.notify("freezerender",{case:"textwrap",isModeChg:"textWrapSettings"===e});break;case"dataSource":var r=this.getDataModule().getState();if(Object.getPrototypeOf(t).deepWatch)for(var n=this.getPrimaryKeyFieldNames()[0],s=0,o=Object.keys(t.dataSource);s<o.length;s++)this.setRowData(sf.base.getValue(n,this.dataSource[o[s]]),this.dataSource[o[s]]);else if(r.isPending){var a=sf.base.isNullOrUndefined(this.dataSource)?[]:this.dataSource.result,l=r.group||[];for(s=0;s<l.length;s++)a=sf.data.DataUtil.group(a,l[s],r.aggregates||[]);this.dataSource={result:a,count:this.dataSource.count,aggregates:this.dataSource.aggregates},this.getDataModule().setState({}),r.resolver(this.dataSource)}else this.getDataModule().setState({isDataChanged:!1}),this.notify("datasource-modified",{}),i||(this.renderModule.refresh(),this.isCheckBoxSelection&&this.notify("before-refresh-on-data-change",{}));this.scrollRefresh();break;case"enableHover":(t.enableHover?sf.base.addClass:sf.base.removeClass)([this.element],"e-gridhover");break;case"selectedRowIndex":this.isSelectedRowIndexUpdating||this.selectRow(t.selectedRowIndex),this.isSelectedRowIndexUpdating=!1;break;case"resizeSettings":this.widthService.setWidthToTable();break;case"enableAdaptiveUI":this.notify("set-fullscreen-dialog",{});break;case"rowRenderingMode":this.enableVerticalRendering(),this.notify("row-mode-change",{}),this.refresh();break;case"enableStickyHeader":this.scrollModule.addStickyListener(t.enableStickyHeader)}},r.prototype.maintainSelection=function(e){var t=this;if(-1!==e){this.on(y,(function i(){t.selectRow(e),t.off(y,i)}),this)}},r.prototype.setProperties=function(e,i){t.prototype.setProperties.call(this,e,i);e.filterSettings&&this.filterModule&&i&&this.filterModule.refreshFilter()},r.prototype.setTablesCount=function(){var e=this.getFrozenColumns(),t=this.getFrozenLeftColumnsCount(),i=this.getFrozenRightColumnsCount();!e||t||i?e||!t&&!i||(t&&!i||i&&!t?this.tablesCount=2:t&&i&&(this.tablesCount=3)):this.tablesCount=2},r.prototype.getTablesCount=function(){return this.tablesCount},r.prototype.updateDefaultCursor=function(){var e=[].slice.call(this.getHeaderContent().querySelectorAll(".e-headercell:not(.e-stackedheadercell)")),t=[].slice.call(this.getHeaderContent().getElementsByClassName("e-stackedheadercell")),i=this.getColumns();if(this.enableColumnVirtualization&&this.getFrozenColumns()){var r=this.contentModule.getHeaderCells();e=r.length?r:e}for(var n=0;n<e.length;n++){var s=e[n];(this.allowGrouping||this.allowReordering||this.allowSorting)&&(i[n].allowReordering&&i[n].allowSorting&&i[n].allowGrouping?s.classList.add("e-mousepointer"):s.classList.add("e-defaultcursor"))}for(var o=0;o<t.length;o++)this.allowReordering&&t[o].classList.add("e-mousepointer")},r.prototype.updateColumnModel=function(e){for(var t=0,i=e.length;t<i;t++)e[t].columns?this.updateColumnModel(e[t].columns):this.columnModel.push(e[t]);this.updateColumnLevelFrozen(),this.updateFrozenColumns(),this.updateLockableColumns()},r.prototype.updateColumnLevelFrozen=function(){var e=this.columnModel,t=[],i=[],r=[];if(this.frozenLeftCount||this.frozenRightCount){for(var n=0,s=e.length;n<s;n++){var o=e[n];"Left"===o.freeze?(o.freezeTable=ie,t.push(o)):"Right"===o.freeze?(o.freezeTable=te,i.push(o)):(o.freezeTable="movable",r.push(o))}this.columnModel=t.concat(r).concat(i)}},r.prototype.updateFrozenColumns=function(){if(!this.frozenLeftCount&&!this.frozenRightCount)for(var e=this.columnModel,t=this.frozenColumns,i=this.getFrozenColumns(),r=0,n=0,s=e.length;n<s;n++){var o=e[n];t&&(o.freezeTable=n<t?ie:"movable"),o.isFrozen&&n>=t?(o.freezeTable=ie,e.splice(this.frozenColumns+r,0,e.splice(n,1)[0]),r++):i&&!t&&(o.freezeTable="movable")}},r.prototype.getFrozenLeftCount=function(){return this.getFrozenColumns()||this.getFrozenLeftColumnsCount()},r.prototype.isFrozenGrid=function(){return 0!==this.getFrozenColumns()||0!==this.getFrozenLeftColumnsCount()||0!==this.getFrozenRightColumnsCount()},r.prototype.getFrozenMode=function(){return this.frozenName},r.prototype.updateLockableColumns=function(){for(var e=this.columnModel,t=0,i=0,r=this.getFrozenColumns(),n=0;n<e.length;n++)e[n].lockColumn&&(n<r?(e.splice(t,0,e.splice(n,1)[0]),t++):(e.splice(r+i,0,e.splice(n,1)[0]),i++))},r.prototype.checkLockColumns=function(e){for(var t=0;t<e.length;t++)e[t].columns?this.checkLockColumns(e[t].columns):e[t].lockColumn&&this.lockcolPositionCount++},r.prototype.getColumns=function(e){var t=this,i=this.inViewIndexes.map((function(e){return e-t.groupSettings.columns.length})).filter((function(e){return e>-1})),r=i.length;(!this.enableColumnVirtualization||sf.base.isNullOrUndefined(this.columnModel)||0===this.columnModel.length||e)&&(this.columnModel=[],this.updateColumnModel(this.columns));var n=0===r?this.columnModel:this.columnModel.slice(i[0],i[r-1]+1);this.contentModule&&this.enableColumnVirtualization&&this.isFrozenGrid()&&i.length&&i[0]>0&&(n=this.contentModule.ensureFrozenCols(n));return n},r.prototype.getStackedHeaderColumnByHeaderText=function(e,t){for(var i=0;i<t.length;i++){var r=t[i];if(r.field===e||r.headerText===e){this.stackedColumn=r;break}r.columns&&this.getStackedHeaderColumnByHeaderText(e,r.columns)}return this.stackedColumn},r.prototype.getColumnIndexesInView=function(){return this.inViewIndexes},r.prototype.getQuery=function(){return this.query},r.prototype.getLocaleConstants=function(){return this.defaultLocale},r.prototype.setColumnIndexesInView=function(e){this.inViewIndexes=e},r.prototype.getVisibleColumns=function(){return this.getCurrentVisibleColumns()},r.prototype.getHeaderContent=function(){return this.headerModule.getPanel()},r.prototype.setGridHeaderContent=function(e){this.headerModule.setPanel(e)},r.prototype.getContentTable=function(){return this.contentModule.getTable()},r.prototype.setGridContentTable=function(e){this.contentModule.setTable(e)},r.prototype.getContent=function(){return this.contentModule.getPanel()},r.prototype.setGridContent=function(e){this.contentModule.setPanel(e)},r.prototype.getHeaderTable=function(){return this.headerModule.getTable()},r.prototype.setGridHeaderTable=function(e){this.headerModule.setTable(e)},r.prototype.getFooterContent=function(){return this.footerElement=this.element.getElementsByClassName(j)[0],this.footerElement},r.prototype.getFooterContentTable=function(){return this.footerElement=this.element.getElementsByClassName(j)[0],this.footerElement.firstChild.firstChild},r.prototype.getPager=function(){return this.gridPager},r.prototype.setGridPager=function(e){this.gridPager=e},r.prototype.getRowByIndex=function(e){return this.contentModule.getRowByIndex(e)},r.prototype.getMovableRowByIndex=function(e){return this.contentModule.getMovableRowByIndex(e)},r.prototype.getFrozenRowByIndex=function(e){return this.getFrozenDataRows()[e]},r.prototype.getRows=function(){return this.contentModule.getRowElements()},r.prototype.getFrozenRightRowByIndex=function(e){return this.contentModule.getFrozenRightRowByIndex(e)},r.prototype.getRowInfo=function(e){var t=e,i={target:e};if(!sf.base.isNullOrUndefined(e)&&sf.base.isNullOrUndefined(yi(t,"e-detailrowcollapse")&&sf.base.isNullOrUndefined(yi(t,"e-recordplusexpand")))){var r=sf.base.closest(t,"."+q);if(!r){var n=sf.base.closest(t,"."+Y);if(!sf.base.isNullOrUndefined(n)&&!n.classList.contains("e-addedrow")){var s=this.getRowObjectFromUID(n.getAttribute("data-uid")),o=parseInt(n.getAttribute(ne),10);i={row:n,rowData:s.data,rowIndex:o}}return i}var a=parseInt(r.getAttribute(re),10);if(!sf.base.isNullOrUndefined(r)&&!isNaN(a)){var l=sf.base.closest(r,"."+Y),h=(o=parseInt(l.getAttribute(ne),10),this.getFrozenColumns()),d=this.columnModel[a].getFreezeTableName(),p=this.contentModule.getRows(),c=a+this.getIndentCount();this.isFrozenGrid()&&(d===ie?p=this.contentModule.getRows():"movable"===d?(c=a-h-this.frozenLeftCount,p=this.contentModule.getMovableRows()):d===te&&(c=a-(this.frozenLeftCount+this.movableCount),p=this.contentModule.getFrozenRightRows()));var u=p.filter((function(e){return e.uid===l.getAttribute("data-uid")})),f={},g=void 0;Object.keys(u).length&&(f=u[0].data,g=u[0].cells[c].column),i={cell:r,cellIndex:a,row:l,rowIndex:o,rowData:f,column:g,target:e}}}return i},r.prototype.getMovableRows=function(){return this.contentModule.getMovableRowElements()},r.prototype.getFrozenRightRows=function(){return this.contentModule.getFrozenRightRowElements()},r.prototype.getDataRows=function(){return this.getAllDataRows()},r.prototype.getAllDataRows=function(e){if(sf.base.isNullOrUndefined(this.getContentTable().querySelector(se)))return[];var t=this.isFrozenGrid()?this.getFrozenLeftContentTbody():this.getContentTable().querySelector(se),i=[].slice.call(t.children);if(this.frozenRows){var r=this.isFrozenGrid()?this.getHeaderContent().querySelector("."+K).querySelector(se):this.getHeaderTable().querySelector(se),n=[].slice.call(r.children);i=this.addMovableRows(n,i)}return this.generateDataRows(i,e)},r.prototype.addMovableRows=function(e,t){for(var i=0,r=t.length;i<r;i++)e.push(t[i]);return e},r.prototype.generateDataRows=function(e,t){for(var i=[],r=0,n=e.length;r<n;r++)!e[r].classList.contains(Y)||e[r].classList.contains("e-hiddenrow")&&!t||(this.isCollapseStateEnabled()?i[parseInt(e[r].getAttribute("aria-rowindex"),10)]=e[r]:i.push(e[r]));return i},r.prototype.getMovableDataRows=function(){return this.getAllMovableDataRows()},r.prototype.getAllMovableDataRows=function(e){if(!this.isFrozenGrid())return[];var t=[].slice.call(this.getContent().querySelector("."+G).querySelector(se).children);if(this.frozenRows){var i=[].slice.call(this.getHeaderContent().querySelector("."+_).querySelector(se).children);t=this.addMovableRows(i,t)}return this.generateDataRows(t,e)},r.prototype.getFrozenDataRows=function(){return this.getAllFrozenDataRows()},r.prototype.getAllFrozenDataRows=function(e){var t=[].slice.call(this.getContent().querySelector("."+W).querySelector(se).children);if(this.frozenRows){var i=[].slice.call(this.getHeaderContent().querySelector("."+K).querySelector(se).children);t=this.addMovableRows(i,t)}return this.generateDataRows(t,e)},r.prototype.getFrozenRightDataRows=function(){return this.getAllFrozenRightDataRows()},r.prototype.getAllFrozenRightDataRows=function(e){if("Right"!==this.getFrozenMode()&&"Left-Right"!==this.getFrozenMode())return[];var t=[].slice.call(this.getContent().querySelector(".e-frozen-right-content").querySelector(se).children);if(this.frozenRows){var i=[].slice.call(this.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(se).children);t=this.addMovableRows(i,t)}return this.generateDataRows(t,e)},r.prototype.setCellValue=function(e,t,i){var r="Right"===this.getFrozenMode(),n=this.getPrimaryKeyFieldNames()[0],s=new ve(this,this.serviceLocator),o=this.getColumnIndexByField(t),a=this.getColumnByField(t),l=("movable"===a.getFreezeTableName()?this.contentModule.getMovableRows():"frozen-right"===a.getFreezeTableName()?this.getFrozenRightRowsObject():this.contentModule.getRows()).filter((function(t){return sf.base.getValue(n,t.data)===e}))[0],h=l?this.element.querySelector("[data-uid="+l.uid+"]"):null;if(!sf.base.isNullOrUndefined(h)){sf.base.setValue(t,i,l.data);var d=this.getFrozenLeftColumnsCount()||this.getFrozenColumns(),p=this.getMovableColumnsCount();this.isRowDragable()&&!r&&d++;var c=d+p,u=this.getCellFromIndex(l.index,o);if(!sf.base.isNullOrUndefined(u)){var f="movable"===a.getFreezeTableName()?d:"frozen-right"===a.getFreezeTableName()?c:0;this.groupSettings.columns.length&&(o+=this.groupSettings.columns.length),(this.childGrid||this.detailTemplate)&&o++,this.isRowDragable()&&!r&&o++;var g=l.cells[o-f];s.refreshTD(u,g,l.data,{index:l.index}),this.aggregates.length>0&&(this.notify("refresh-footer-rendered",{}),this.groupSettings.columns.length>0&&this.notify("group-aggregates",{})),sf.base.isNullOrUndefined(l)||sf.base.isNullOrUndefined(l.changes)||(l.changes[t]=i),this.trigger("queryCellInfo",{cell:u,column:a,data:l.data})}}},r.prototype.refreshReactColumnTemplateByUid=function(e){var t=this;this.isReact&&this.clearTemplate(["columnTemplate"],void 0,(function(){for(var i=t.getRowsObject(),r=t.getIndentCount(),n=t.getNormalizedColumnIndex(e),s=0;s<i.length;s++)if(i[s].isDataRow&&!sf.base.isNullOrUndefined(i[s].index)){var o=i[s].cells[n],a=new ve(t,t.serviceLocator),l=t.getCellFromIndex(i[s].index,n-r);a.refreshTD(l,o,i[s].data,{index:i[s].index})}}))},r.prototype.setRowData=function(e,t){var i=this.contentModule.getRows(),r=this.getPrimaryKeyFieldNames()[0],n=new le(this.serviceLocator,null,this);this.groupSettings.columns.length>0&&this.aggregates.length>0&&(i=i.filter((function(e){return e.isDataRow})));var s=i.filter((function(t){return sf.base.getValue(r,t.data)===e}))[0];!sf.base.isNullOrUndefined(s)&&this.element.querySelectorAll("[data-uid="+s.uid+"]").length&&(s.changes=t,Ki(s,this.getForeignKeyColumns(),s.changes),n.refresh(s,this.getColumns(),!0),this.aggregates.length>0&&(this.notify("refresh-footer-rendered",{}),this.groupSettings.columns.length>0&&this.notify("group-aggregates",{})))},r.prototype.getCellFromIndex=function(e,t){return Ir(this,this.getColumnByIndex(t),e,t)},r.prototype.getMovableCellFromIndex=function(e,t){if(!("Left-Right"===this.frozenName&&t>=this.movableCount)){var i=this.getFrozenColumns()||this.getFrozenLeftColumnsCount();return this.getMovableDataRows()[e]&&this.getMovableDataRows()[e].getElementsByClassName(q)[t-i]}},r.prototype.getFrozenRightCellFromIndex=function(e,t){var i=this.getFrozenLeftColumnsCount()+this.getMovableColumnsCount(),r=this.getFrozenRightDataRows();return r[e]&&r[e].getElementsByClassName(q)[t-i]},r.prototype.getColumnHeaderByIndex=function(e){return this.getHeaderTable().getElementsByClassName("e-headercell")[e]},r.prototype.getMovableColumnHeaderByIndex=function(e){var t=this.getFrozenColumns()||this.getFrozenLeftColumnsCount();return this.getMovableVirtualHeader().getElementsByClassName("e-headercell")[e-t]},r.prototype.getFrozenRightColumnHeaderByIndex=function(e){var t=this.getFrozenLeftColumnsCount()+this.getMovableColumnsCount();return this.getFrozenRightHeader().getElementsByClassName("e-headercell")[e-t]},r.prototype.getFrozenLeftColumnHeaderByIndex=function(e){return this.getFrozenVirtualHeader().getElementsByClassName("e-headercell")[e]},r.prototype.getRowObjectFromUID=function(e,t,i){var r=this.contentModule.getRows(),n=this.rowObject(r,e);return this.isFrozenGrid()&&(!n||t||i)?((!(n=this.rowObject(this.contentModule.getMovableRows(),e))&&"Left-Right"===this.getFrozenMode()||i)&&(n=this.rowObject(this.contentModule.getFrozenRightRows(),e)),n):sf.base.isNullOrUndefined(n)&&this.enableVirtualization&&this.groupSettings.columns.length>0?n=this.rowObject(this.vRows,e):n},r.prototype.rowObject=function(e,t){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(n.uid===t)return n}return null},r.prototype.getRowsObject=function(){return this.contentModule.getRows()},r.prototype.getMovableRowsObject=function(){var e=[];return this.isFrozenGrid()&&(e=this.contentModule.getMovableRows()),e},r.prototype.getFrozenRightRowsObject=function(){var e=[];return"Right"!==this.getFrozenMode()&&"Left-Right"!==this.getFrozenMode()||(e=this.contentModule.getFrozenRightRows()),e},r.prototype.getColumnHeaderByField=function(e){var t=this.getColumnByField(e);return t?this.getColumnHeaderByUid(t.uid):void 0},r.prototype.getColumnHeaderByUid=function(e){var t=this.getHeaderContent().querySelector("[e-mappinguid="+e+"]");return t?t.parentElement:void 0},r.prototype.getColumnByIndex=function(e){var t;return this.getColumns().some((function(i,r){return t=i,r===e})),t},r.prototype.getColumnByField=function(e){return li(this.getColumns(),(function(t){if(t.field===e)return t}))[0]},r.prototype.getColumnIndexByField=function(e){for(var t=this.getColumns(),i=0;i<t.length;i++)if(t[i].field===e)return i;return-1},r.prototype.getColumnByUid=function(e){return li(this.getColumns().concat(this.getStackedColumns(this.columns)),(function(t){if(t.uid===e)return t}))[0]},r.prototype.getStackedColumns=function(e,t){void 0===t&&(t=[]);for(var i=0,r=e;i<r.length;i++){var n=r[i];n.columns&&(t.push(n),this.getStackedColumns(n.columns,t))}return t},r.prototype.getColumnIndexByUid=function(e){var t=li(this.getColumns(),(function(t,i){if(t.uid===e)return i}))[0];return sf.base.isNullOrUndefined(t)?-1:t},r.prototype.getUidByColumnField=function(e){return li(this.getColumns(),(function(t){if(t.field===e)return t.uid}))[0]},r.prototype.getNormalizedColumnIndex=function(e){return this.getColumnIndexByUid(e)+this.getIndentCount()},r.prototype.getIndentCount=function(){var e=0;return this.allowGrouping&&(e+=this.groupSettings.columns.length),this.isDetail()&&e++,this.isRowDragable()&&sf.base.isNullOrUndefined(this.rowDropSettings.targetID)&&e++,e},r.prototype.getColumnFieldNames=function(){for(var e,t=[],i=0,r=this.getColumns().length;i<r;i++)(e=this.getColumns()[i]).visible&&t.push(e.field);return t},r.prototype.getRowTemplate=function(){return this.rowTemplateFn},r.prototype.getDetailTemplate=function(){return this.detailTemplateFn},r.prototype.getEditTemplate=function(){return this.editTemplateFn},r.prototype.getEditHeaderTemplate=function(){return this.editHeaderTemplateFn},r.prototype.getEditFooterTemplate=function(){return this.editFooterTemplateFn},r.prototype.getPrimaryKeyFieldNames=function(){for(var e=[],t=0;t<this.columnModel.length;t++)this.columnModel[t].isPrimaryKey&&e.push(this.columnModel[t].field);return e},r.prototype.refresh=function(){this.isDestroyed||(this.isManualRefresh=!0,this.headerModule.refreshUI(),this.updateStackedFilter(),this.renderModule.refresh())},r.prototype.refreshHeader=function(){this.headerModule.refreshUI()},r.prototype.getSelectedRows=function(){return this.selectionModule?this.selectionModule.selectedRecords:[]},r.prototype.getSelectedRowIndexes=function(){return this.selectionModule?this.selectionModule.selectedRowIndexes:[]},r.prototype.getSelectedRowCellIndexes=function(){return this.selectionModule?this.selectionModule.selectedRowCellIndexes:[]},r.prototype.getSelectedRecords=function(){return this.selectionModule?this.selectionModule.getSelectedRecords():[]},r.prototype.getSelectedColumnsUid=function(){var e=this,t=[];return this.selectionModule&&this.selectionModule.selectedColumnsIndexes.filter((function(i){return t.push(e.getColumns()[i].uid)})),t},r.prototype.getDataModule=function(){return this.renderModule.data},r.prototype.showColumns=function(e,t){t=t||"headerText",this.showHider.show(e,t)},r.prototype.hideColumns=function(e,t){t=t||"headerText",this.showHider.hide(e,t)},r.prototype.getFrozenColumns=function(){return this.frozenColumns+this.getFrozenCount(this.columns,0,0)},r.prototype.getFrozenRightColumnsCount=function(){return this.frozenRightCount},r.prototype.getFrozenLeftColumnsCount=function(){return this.frozenLeftCount},r.prototype.getMovableColumnsCount=function(){return this.movableCount},r.prototype.setFrozenCount=function(){this.frozenLeftCount=this.frozenRightCount=this.movableCount=0,this.visibleFrozenLeft=this.visibleFrozenRight=this.visibleMovable=0,this.frozenLeftColumns=[],this.frozenRightColumns=[],this.movableColumns=[],this.splitFrozenCount(this.columns),this.frozenColumns&&(this.frozenLeftCount||this.frozenRightCount)&&this.setProperties({frozenColumns:0},!0),this.setTablesCount(),this.frozenLeftCount&&!this.frozenRightCount?this.frozenName="Left":this.frozenRightCount&&!this.frozenLeftCount?this.frozenName="Right":this.frozenLeftCount&&this.frozenRightCount&&(this.frozenName="Left-Right")},r.prototype.getVisibleFrozenLeftCount=function(){return this.visibleFrozenLeft},r.prototype.getVisibleFrozenRightCount=function(){return this.visibleFrozenRight},r.prototype.getVisibleMovableCount=function(){return this.visibleMovable},r.prototype.getFrozenRightColumns=function(){return this.frozenRightColumns},r.prototype.getFrozenLeftColumns=function(){return this.frozenLeftColumns},r.prototype.getMovableColumns=function(){return this.movableColumns},r.prototype.splitFrozenCount=function(e){for(var t=0;t<e.length;t++)e[t].columns?this.splitFrozenCount(e[t].columns):"Right"===e[t].freeze?(!1!==e[t].visible&&this.visibleFrozenRight++,this.frozenRightColumns.push(e[t]),this.frozenRightCount++):"Left"===e[t].freeze?(!1!==e[t].visible&&this.visibleFrozenLeft++,this.frozenLeftColumns.push(e[t]),this.frozenLeftCount++):(!1!==e[t].visible&&this.visibleMovable++,this.movableColumns.push(e[t]),this.movableCount++)},r.prototype.getVisibleFrozenColumns=function(){return this.getVisibleFrozenColumnsCount()+this.getVisibleFrozenCount(this.columns,0)},r.prototype.getFilterUIInfo=function(){return this.filterModule?this.filterModule.getFilterUIInfo():{}},r.prototype.getVisibleFrozenColumnsCount=function(){for(var e=0,t=this.columnModel,i=0;i<this.frozenColumns;i++)t[i].visible&&e++;if(this.frozenLeftCount||this.frozenRightCount)for(i=0;i<t.length;i++)!t[i].visible||"Left"!==t[i].freeze&&"Right"!==t[i].freeze||e++;return e},r.prototype.getVisibleFrozenCount=function(e,t){if(!this.frozenLeftCount&&!this.frozenRightCount)for(var i=0,r=e.length;i<r;i++)e[i].columns?t=this.getVisibleFrozenCount(e[i].columns,t):e[i].isFrozen&&e[i].visible&&t++;return t},r.prototype.getFrozenCount=function(e,t,i){for(var r=0,n=e.length;r<n;r++)e[r].columns?t=this.getFrozenCount(e[r].columns,t,i):(e[r].isFrozen&&i>this.frozenColumns-1&&t++,i++);return t},r.prototype.goToPage=function(e){this.pagerModule&&this.pagerModule.goToPage(e)},r.prototype.updateExternalMessage=function(e){this.pagerModule&&this.pagerModule.updateExternalMessage(e)},r.prototype.sortColumn=function(e,t,i){this.sortModule&&this.sortModule.sortColumn(e,t,i)},r.prototype.clearSorting=function(){this.sortModule&&this.sortModule.clearSorting()},r.prototype.removeSortColumn=function(e){this.sortModule&&this.sortModule.removeSortColumn(e)},r.prototype.filterByColumn=function(e,t,i,r,n,s,o,a){this.filterModule&&this.filterModule.filterByColumn(e,t,i,r,n,s,o,a)},r.prototype.clearFiltering=function(e){this.filterModule&&this.filterModule.clearFiltering(e)},r.prototype.removeFilteredColsByField=function(e,t){this.filterModule&&this.filterModule.removeFilteredColsByField(e,t)},r.prototype.selectRow=function(e,t){this.selectionModule&&this.selectionModule.selectRow(e,t)},r.prototype.selectRows=function(e){this.selectionModule&&this.selectionModule.selectRows(e)},r.prototype.clearSelection=function(){this.selectionModule&&this.selectionModule.clearSelection()},r.prototype.selectCell=function(e,t){this.selectionModule&&this.selectionModule.selectCell(e,t)},r.prototype.selectCellsByRange=function(e,t){this.selectionModule.selectCellsByRange(e,t)},r.prototype.search=function(e){this.searchModule&&this.searchModule.search(e)},r.prototype.print=function(){this.printModule&&this.printModule.print()},r.prototype.deleteRecord=function(e,t){this.editModule&&this.editModule.deleteRecord(e,t)},r.prototype.startEdit=function(){this.editModule&&this.editModule.startEdit()},r.prototype.endEdit=function(){this.editModule&&this.editModule.endEdit()},r.prototype.closeEdit=function(){this.editModule&&this.editModule.closeEdit()},r.prototype.addRecord=function(e,t){this.editModule&&this.editModule.addRecord(e,t)},r.prototype.deleteRow=function(e){this.editModule&&this.editModule.deleteRow(e)},r.prototype.editCell=function(e,t){this.editModule&&this.editModule.editCell(e,t)},r.prototype.saveCell=function(){this.editModule&&this.editModule.saveCell()},r.prototype.updateCell=function(e,t,i){this.editModule&&this.editModule.updateCell(e,t,i)},r.prototype.updateRow=function(e,t){this.editModule&&this.editModule.updateRow(e,t)},r.prototype.getBatchChanges=function(){return this.editModule?this.editModule.getBatchChanges():{}},r.prototype.enableToolbarItems=function(e,t){this.toolbarModule&&this.toolbarModule.enableItems(e,t)},r.prototype.copy=function(e){this.clipboardModule&&this.clipboardModule.copy(e)},r.prototype.recalcIndentWidth=function(){var e=this;if(this.getHeaderTable().querySelector(".e-emptycell")&&(this.groupSettings.columns.length||this.isDetail()||this.isRowDragable())&&!this.getHeaderTable().querySelector(".e-emptycell").getAttribute("indentRefreshed")&&this.getContentTable()){var t=this.getHeaderTable().querySelector(".e-emptycell").parentElement.offsetWidth,i=[].slice.call(this.getHeaderTable().querySelector(oe).childNodes),r=[].slice.call(this.getContentTable().querySelector(oe).childNodes),n=t/30,s="Right"===this.getFrozenMode()?this.frozenRightCount:0,o=this.element.offsetWidth,a=function(t,n){if(yr(e)){var s=(n/o*100).toFixed(1)+"%";i[t].style.width=s,r[t].style.width=s}else i[t].style.width=n+"px",r[t].style.width=n+"px";e.notify("column-width-changed",{index:t,width:n})};for(n>=1&&(t=30/n),t<1&&(t=1),(this.enableColumnVirtualization||this.isAutoGen)&&(t=30);s<this.groupSettings.columns.length;)a(s,t),s++;this.isDetail()&&(a(s,t),s++),this.isRowDragable()&&a(s,t),this.isAutoGen=!1,this.getHeaderTable().querySelector(".e-emptycell").setAttribute("indentRefreshed","true")}},r.prototype.resetIndentWidth=function(){if(yr(this)&&(this.getHeaderTable().querySelector(".e-emptycell").removeAttribute("indentRefreshed"),this.widthService.setWidthToColumns(),this.recalcIndentWidth()),("auto"===this.width||"string"==typeof this.width&&-1!==this.width.indexOf("%"))&&this.getColumns().filter((function(e){return(!e.width||"auto"===e.width)&&e.minWidth})).length>0){var e=this.widthService.getTableWidth(this.getColumns());this.widthService.setMinwidthBycalculation(e)}this.isFrozenGrid()&&this.widthService&&this.widthService.refreshFrozenScrollbar(),this.allowTextWrap&&"Content"!==this.textWrapSettings.wrapMode&&this.notify(O,{})},r.prototype.isRowDragable=function(){return this.allowRowDragAndDrop&&!this.rowDropSettings.targetID},r.prototype.reorderColumns=function(e,t){this.reorderModule&&this.reorderModule.reorderColumns(e,t)},r.prototype.reorderColumnByIndex=function(e,t){this.reorderModule&&this.reorderModule.reorderColumnByIndex(e,t)},r.prototype.reorderColumnByTargetIndex=function(e,t){this.reorderModule&&this.reorderModule.reorderColumnByTargetIndex(e,t)},r.prototype.reorderRows=function(e,t){this.rowDragAndDropModule&&this.rowDragAndDropModule.reorderRows(e,t)},r.prototype.refreshDataSource=function(e){this.notify("refreshdataSource",e)},r.prototype.disableRowDD=function(e){var t=this.getHeaderTable(),i=this.getContentTable(),r=t.querySelectorAll("th.e-rowdragheader, th.e-mastercell"),n=this.getRows(),s=e?"none":"";sf.base.setStyleAttribute(t.querySelector(oe).childNodes[0],{display:s}),sf.base.setStyleAttribute(i.querySelector(oe).childNodes[0],{display:s});for(var o=0;o<this.getRows().length;o++){var a=n[o].firstElementChild;e?sf.base.addClass([a],"e-hide"):sf.base.removeClass([a],["e-hide"])}for(var l=0;l<t.querySelectorAll("th.e-rowdragheader, th.e-mastercell").length;l++){a=r[l];e?sf.base.addClass([a],"e-hide"):sf.base.removeClass([a],["e-hide"])}},r.prototype.autoFitColumns=function(e){this.resizeModule&&this.resizeModule.autoFitColumns(e)},r.prototype.createColumnchooser=function(e,t,i){this.columnChooserModule&&this.columnChooserModule.renderColumnChooser(e,t,i)},r.prototype.initializeServices=function(){this.serviceLocator.register("widthService",this.widthService=new ht(this)),this.serviceLocator.register("cellRendererFactory",new st),this.serviceLocator.register("rendererFactory",new lt),this.serviceLocator.register("localization",this.localeObj=new sf.base.L10n(this.getModuleName(),this.defaultLocale,this.locale)),this.serviceLocator.register("valueFormatter",this.valueFormatterService=new a(this.locale)),this.serviceLocator.register("showHideService",this.showHider=new zt(this)),this.serviceLocator.register("ariaService",this.ariaService=new be),this.serviceLocator.register("focus",this.focusModule=new pt(this))},r.prototype.processModel=function(){var e,t,i=this.groupSettings.columns,r=this.sortSettings.columns;if(this.allowGrouping)for(var n=function(n,o){t=0;for(var a=r.length;t<a;t++)if(r[t].field===i[n]){e=!0;break}if(e?s.allowSorting?s.sortedColumns.push(r[t].field):r[t].direction="Ascending":r.push({field:i[n],direction:"Ascending",isFromGroup:!0}),!s.groupSettings.showGroupedColumn){var l=s.enableColumnVirtualization?s.columns.filter((function(e){return e.field===i[n]}))[0]:s.getColumnByField(i[n]);l?l.visible=!1:s.log("initial_action",{moduleName:"group",columnName:i[n]})}},s=this,o=0,a=i.length;o<a;o++)n(o);if(!i.length)for(o=0;o<r.length;o++)this.sortedColumns.push(r[o].field);if(this.rowTemplateFn=di(this.rowTemplate),this.detailTemplateFn=di(this.detailTemplate),this.editTemplateFn=di(this.editSettings.template),this.editHeaderTemplateFn=di(this.editSettings.headerTemplate),this.editFooterTemplateFn=di(this.editSettings.footerTemplate),!sf.base.isNullOrUndefined(this.parentDetails)){var l=sf.base.isNullOrUndefined(this.parentDetails.parentKeyFieldValue)?"undefined":this.parentDetails.parentKeyFieldValue;this.query.where(this.queryString,"equal",l,!0)}this.initForeignColumn()},r.prototype.initForeignColumn=function(){this.isForeignKeyEnabled(this.getColumns())&&this.notify("initForeignKeyColumn",this.getForeignKeyColumns())},r.prototype.enableVerticalRendering=function(){"Vertical"===this.rowRenderingMode?this.element.classList.add("e-row-responsive"):this.element.classList.remove("e-row-responsive")},r.prototype.gridRender=function(){this.updateRTL(),"Vertical"===this.rowRenderingMode&&this.element.classList.add("e-row-responsive"),this.enableHover&&this.element.classList.add("e-gridhover"),sf.base.Browser.isDevice&&this.element.classList.add("e-device"),this.rowHeight&&this.element.classList.add("e-grid-min-height"),sf.base.classList(this.element,["e-responsive","e-default"],[]);var t=this.serviceLocator.getService("rendererFactory");this.headerModule=t.getRenderer(e.RenderType.Header),this.contentModule=t.getRenderer(e.RenderType.Content),this.printModule=new Zt(this,this.scrollModule),this.clipboardModule=new Bt(this),this.renderModule.render(),this.eventInitializer(),this.createGridPopUpElement(),this.widthService.setWidthToColumns(),this.updateGridLines(),this.applyTextWrap(),this.createTooltip(),this.enableBoxSelection()},r.prototype.dataReady=function(){this.scrollModule.setWidth(),this.scrollModule.setHeight(),"auto"!==this.height&&this.scrollModule.setPadding()},r.prototype.updateRTL=function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")},r.prototype.createGridPopUpElement=function(){var e=this.createElement("div",{className:"e-gridpopup",styles:"display:none;"}),t=this.createElement("div",{className:Q,attrs:{tabIndex:"-1"}});sf.base.append([t,this.createElement("div",{className:"e-uptail e-tail"})],e),t.appendChild(this.createElement("span")),sf.base.append([t,this.createElement("div",{className:"e-downtail e-tail"})],e),this.element.appendChild(e)},r.prototype.updateGridLines=function(){switch(sf.base.classList(this.element,[],["e-verticallines","e-horizontallines","e-hidelines","e-bothlines"]),this.gridLines){case"Horizontal":this.element.classList.add("e-horizontallines");break;case"Vertical":this.element.classList.add("e-verticallines");break;case"None":this.element.classList.add("e-hidelines");break;case"Both":this.element.classList.add("e-bothlines")}this.updateResizeLines()},r.prototype.updateResizeLines=function(){this.allowResizing&&"Vertical"!==this.gridLines&&"Both"!==this.gridLines?this.element.classList.add("e-resize-lines"):this.element.classList.remove("e-resize-lines")},r.prototype.applyTextWrap=function(){if(this.allowTextWrap){var e=[].slice.call(this.element.getElementsByClassName("e-columnheader"));switch(this.textWrapSettings.wrapMode){case"Header":Pi(this.element,!1),Pi(this.getContent(),!1),Pi(e,!0);break;case"Content":Pi(this.getContent(),!0),Pi(this.element,!1),Pi(e,!1);break;default:Pi(this.element,!0),Pi(this.getContent(),!1),Pi(e,!1)}"Content"!==this.textWrapSettings.wrapMode&&this.notify(O,{})}},r.prototype.removeTextWrap=function(){Pi(this.element,!1),Pi([].slice.call(this.element.getElementsByClassName("e-columnheader")),!1),Pi(this.getContent(),!1),"Content"!==this.textWrapSettings.wrapMode&&this.notify(O,{})},r.prototype.createTooltip=function(){this.toolTipObj=new sf.popups.Tooltip({opensOn:"custom",content:""},this.element)},r.prototype.freezeRefresh=function(){this.isFreezeRefresh=!0,this.enableVirtualization&&(this.pageSettings.currentPage=1),this.componentRefresh()},r.prototype.getTooltipStatus=function(e){var t=this.getHeaderTable(),i=this.createTable(t,"e-gridheader","header"),r=this.createTable(t,"e-gridheader","content"),n=e.classList.contains("e-headercell")?i:r,s=e.classList.contains("e-headercell")?"th":"tr";n.querySelector(s).className=e.className,n.querySelector(s).innerHTML=e.innerHTML;var o=n.querySelector(s).getBoundingClientRect().width;return document.body.removeChild(i),document.body.removeChild(r),o>e.getBoundingClientRect().width},r.prototype.mouseMoveHandler=function(e){if(this.isEllipsisTooltip()){var t=yi(e.target,"e-ellipsistooltip");this.prevElement===t&&"mouseout"!==e.type||this.toolTipObj.close();var i=e.target.tagName;if(t&&"mouseout"!==e.type&&(!sf.base.Browser.isDevice||-1===["A","BUTTON","INPUT"].indexOf(i))){if(t.getAttribute("aria-describedby"))return;this.getTooltipStatus(t)&&(t.getElementsByClassName("e-headertext").length?this.toolTipObj.content=t.getElementsByClassName("e-headertext")[0].innerText:this.toolTipObj.content=t.innerText,this.prevElement=t,this.toolTipObj.open(t))}}this.hoverFrozenRows(e)},r.prototype.hoverFrozenRows=function(e){if(this.isFrozenGrid()){var t=yi(e.target,Y);if([].slice.call(this.element.getElementsByClassName("e-frozenhover")).length&&"mouseout"===e.type)for(var i=[].slice.call(this.element.getElementsByClassName("e-frozenhover")),r=0;r<i.length;r++)i[r].classList.remove("e-frozenhover");else if(t){(i=[].slice.call(this.element.querySelectorAll('tr[aria-rowindex="'+t.getAttribute(ne)+'"]'))).splice(i.indexOf(t),1);for(r=0;r<i.length;r++)"true"!==t.getAttribute("aria-selected")&&i[r]?i[r].classList.add("e-frozenhover"):i[r]&&i[r].classList.remove("e-frozenhover")}}},r.prototype.isEllipsisTooltip=function(){var e=this.getColumns();if("EllipsisWithTooltip"===this.clipMode)return!0;for(var t=0;t<e.length;t++)if("EllipsisWithTooltip"===e[t].clipMode)return!0;return!1},r.prototype.scrollHandler=function(){this.isEllipsisTooltip()&&this.toolTipObj.close()},r.prototype.createTable=function(e,t,i){var r=this.createElement("div");r.className=this.element.className,r.style.cssText="display: inline-block;visibility:hidden;position:absolute";var n=this.createElement("div");n.className=t;var s=this.createElement("table");s.className=e.className,s.style.cssText="table-layout: auto;width: auto";var o="header"===i?"th":"td",a=this.createElement("tr"),l=this.createElement(o);return a.appendChild(l),s.appendChild(a),n.appendChild(s),r.appendChild(n),document.body.appendChild(r),r},r.prototype.onKeyPressed=function(e){"tab"!==e.action&&"shiftTab"!==e.action||this.toolTipObj.close()},r.prototype.wireEvents=function(){sf.base.EventHandler.add(this.element,"click",this.mouseClickHandler,this),sf.base.EventHandler.add(this.element,"touchend",this.mouseClickHandler,this),sf.base.EventHandler.add(this.element,"focusout",this.focusOutHandler,this),sf.base.EventHandler.add(this.element,"dblclick",this.dblClickHandler,this),sf.base.EventHandler.add(this.element,"keydown",this.keyPressHandler,this),sf.base.EventHandler.add(window,"resize",this.resetIndentWidth,this),this.allowKeyboard&&(this.element.tabIndex=-1===this.element.tabIndex?0:this.element.tabIndex),this.keyboardModule=new sf.base.KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),sf.base.EventHandler.add(this.getContent().firstElementChild,"scroll",this.scrollHandler,this),sf.base.EventHandler.add(this.element,"mousemove",this.mouseMoveHandler,this),sf.base.EventHandler.add(this.element,"mouseout",this.mouseMoveHandler,this),sf.base.EventHandler.add(this.getContent(),"touchstart",this.tapEvent,this),sf.base.EventHandler.add(document.body,"keydown",this.keyDownHandler,this)},r.prototype.unwireEvents=function(){sf.base.EventHandler.remove(this.element,"click",this.mouseClickHandler),sf.base.EventHandler.remove(this.element,"touchend",this.mouseClickHandler),sf.base.EventHandler.remove(this.element,"focusout",this.focusOutHandler),sf.base.EventHandler.remove(this.element,"dblclick",this.dblClickHandler),sf.base.EventHandler.remove(this.getContent().firstElementChild,"scroll",this.scrollHandler),sf.base.EventHandler.remove(this.element,"mousemove",this.mouseMoveHandler),sf.base.EventHandler.remove(this.element,"mouseout",this.mouseMoveHandler),sf.base.EventHandler.remove(this.element,"keydown",this.keyPressHandler),sf.base.EventHandler.remove(this.getContent(),"touchstart",this.tapEvent),sf.base.EventHandler.remove(document.body,"keydown",this.keyDownHandler),sf.base.EventHandler.remove(window,"resize",this.resetIndentWidth)},r.prototype.addListener=function(){this.isDestroyed||(this.on(m,this.dataReady,this),this.on(y,this.recalcIndentWidth,this),this.on(S,this.recalcIndentWidth,this),this.dataBoundFunction=this.refreshMediaCol.bind(this),this.addEventListener(u,this.dataBoundFunction),this.on(x,this.onKeyPressed,this))},r.prototype.removeListener=function(){this.isDestroyed||(this.off(m,this.dataReady),this.off(y,this.recalcIndentWidth),this.off(S,this.recalcIndentWidth),this.removeEventListener(u,this.dataBoundFunction),this.off(x,this.onKeyPressed))},r.prototype.getCurrentViewRecords=function(){return Zi(this)?sf.base.isNullOrUndefined(this.currentViewData.records)?this.currentViewData:this.currentViewData.records:this.groupSettings.enableLazyLoading?this.currentViewData:this.allowGrouping&&this.groupSettings.columns.length&&this.currentViewData.length&&this.currentViewData.records?this.currentViewData.records:this.currentViewData},r.prototype.mouseClickHandler=function(e){if(!(this.isChildGrid(e)||yi(e.target,"e-gridpopup")&&e.touches||this.element.getElementsByClassName("e-cloneproperties").length||this.checkEdit(e))&&((this.allowRowDragAndDrop||!yi(e.target,U)&&"TD"!==e.target.tagName)&&(this.allowGrouping||this.allowReordering||!yi(e.target,"e-gridheader"))||!e.touches)){yi(e.target,"e-gridheader")&&this.allowRowDragAndDrop&&!yi(e.target,"e-filterbarcell")&&e.preventDefault();var t=this.getRowInfo(e.target);t.cancel=!1;var i=!1,r=sf.base.closest(e.target,"tr");if(r&&r.getAttribute("data-uid")){var n=this.getRowObjectFromUID(r.getAttribute("data-uid"));i=!!n&&n.isDataRow}i&&this.trigger("recordClick",t),this.notify(R,e)}},r.prototype.checkEdit=function(e){var t=yi(e.target,Y),i="Batch"!==this.editSettings.mode&&this.isEdit&&t&&(t.classList.contains(Z)||t.classList.contains($));return!yi(e.target,"e-unboundcelldiv")&&(i||yi(e.target,q)&&yi(e.target,q).classList.contains("e-editedbatchcell"))},r.prototype.dblClickHandler=function(e){var t=yi(e.target,"e-grid");if(!sf.base.isNullOrUndefined(t)&&t.id===this.element.id&&!sf.base.closest(e.target,".e-unboundcelldiv")){var i=!1,r=sf.base.closest(e.target,"tr");if(r&&r.getAttribute("data-uid")){var n=this.getRowObjectFromUID(r.getAttribute("data-uid"));i=!!n&&n.isDataRow}var s=this.getRowInfo(e.target);s.target=e.target,i&&this.trigger("recordDoubleClick",s),this.notify("dblclick",e)}},r.prototype.focusOutHandler=function(e){if(!this.isChildGrid(e)){yi(e.target,"e-grid")||(this.element.querySelector(".e-gridpopup").style.display="None");var t=this.element.querySelector(".e-cancel:not(.e-hide)");t&&t.classList.add("e-hide");var i=e.relatedTarget,r=i?i.getAttribute("aria-owns"):null;i&&(yi(i,"e-grid")||(!sf.base.isNullOrUndefined(r)&&r)===e.target.getAttribute("aria-owns"))||this.keyPress||!this.isEdit||sf.base.Browser.isDevice||("Batch"===this.editSettings.mode&&(this.editModule.saveCell(),this.notify("editNextValCell",{})),"Normal"===this.editSettings.mode&&this.editModule.editFormValidate()),this.keyPress=!1}},r.prototype.isChildGrid=function(e){var t=yi(e.target,"e-grid");return!(!t||t.id===this.element.id)},r.prototype.mergePersistGridData=function(e){var t=this.getLocalData();if(!sf.base.isNullOrUndefined(t)&&""!==t||!sf.base.isNullOrUndefined(e)){var r=sf.base.isNullOrUndefined(e)?JSON.parse(t):e;this.enableVirtualization&&(r.pageSettings.currentPage=1);var n=Object.keys(r);this.isProtectedOnChange=!0;for(var s=0,o=n;s<o.length;s++){var a=o[s];"object"!==i(this[a])||sf.base.isNullOrUndefined(this[a])?this[a]=r[a]:Array.isArray(this[a])&&"columns"===a?(ui(this[a]),this.mergeColumns(r[a],this[a]),this[a]=r[a]):sf.base.extend(this[a],r[a])}this.isProtectedOnChange=!1}},r.prototype.mergeColumns=function(e,t){for(var i=e,r=function(e){var r=t.filter((function(t){return t.index===i[e].index}))[0];sf.base.isNullOrUndefined(r)||(r.columns&&r.columns.length?(n.mergeColumns(i[e].columns,r.columns),i[e]=sf.base.extend(r,i[e],{},!0)):i[e]=sf.base.extend(r,i[e],{},!0))},n=this,s=0;s<i.length;s++)r(s)},r.prototype.isDetail=function(){return!sf.base.isNullOrUndefined(this.detailTemplate)||!sf.base.isNullOrUndefined(this.childGrid)},r.prototype.isCommandColumn=function(e){var t=this;return e.some((function(e){return e.columns?t.isCommandColumn(e.columns):!(!e.commands&&!e.commandsTemplate)}))},r.prototype.isForeignKeyEnabled=function(e){var t=this;return e.some((function(e){return e.columns?t.isForeignKeyEnabled(e.columns):!(!e.dataSource||!e.foreignKeyValue)}))},r.prototype.keyPressHandler=function(e){var t=sf.base.extend(e,{cancel:!1});this.trigger("keyPressed",t),!0===t.cancel&&e.stopImmediatePropagation()},r.prototype.keyDownHandler=function(e){e.altKey&&(74===e.keyCode&&(this.keyA?(this.notify("group-collapse",{target:e.target,collapse:!1}),this.keyA=!1):(this.focusModule.focusHeader(),this.focusModule.addOutline())),87===e.keyCode&&(this.focusModule.focusContent(),this.focusModule.addOutline()),65===e.keyCode&&(this.keyA=!0),72===e.keyCode&&this.keyA&&(this.notify("group-collapse",{target:e.target,collapse:!0}),this.keyA=!1)),13===e.keyCode&&this.notify("enter-key-handler",e)},r.prototype.keyActionHandler=function(e){this.isChildGrid(e)||this.isEdit&&"escape"!==e.action&&"enter"!==e.action&&"shiftEnter"!==e.action&&"tab"!==e.action&&"shiftTab"!==e.action||(this.keyPress=!0,this.allowKeyboard&&("ctrlPlusP"===e.action&&(e.preventDefault(),this.print()),this.notify(x,e)))},r.prototype.setInjectedModules=function(e){this.injectedModules=e},r.prototype.updateColumnObject=function(){fi(this.columns,this.enableColumnVirtualization,this),ui(this.columns),this.initForeignColumn(),this.notify(E,{})},r.prototype.getForeignKeyColumns=function(){return this.getColumns().filter((function(e){return e.isForeignColumn()}))},r.prototype.getRowHeight=function(){return this.rowHeight?this.rowHeight:Mi(this.element)},r.prototype.refreshColumns=function(){this.setFrozenCount();var e=this.getContent().querySelector(".e-frozen-left-content"),t=this.getContent().querySelector(".e-frozen-right-content"),i=!this.frozenRightCount&&!this.frozenLeftCount;if(!(0!==this.getFrozenColumns())&&(!e&&this.frozenLeftCount||!t&&this.frozenRightCount||e&&!this.frozenLeftCount||t&&!this.frozenRightCount))this.tableIndex=0,this.tablesCount=1,this.enableColumnVirtualization&&(this.columnModel=[],this.updateColumnModel(this.columns)),this.freezeRefresh();else if(i&&(1===this.getFrozenColumns()&&!e||0===this.getFrozenColumns()&&e))this.tableIndex=0,this.tablesCount=1,this.enableColumnVirtualization&&(this.columnModel=[],this.updateColumnModel(this.columns)),this.freezeRefresh();else if(this.isPreventScrollEvent=!0,this.updateColumnObject(),this.checkLockColumns(this.getColumns()),this.refresh(),this.isFrozenGrid()){var r=this.contentModule.getMovableContent().querySelector("."+X);sf.base.remove(r.querySelector(oe));var n=this.getHeaderContent().querySelector("."+_).querySelector(oe).cloneNode(!0);if(r.insertBefore(n,r.querySelector(se)),"Left-Right"===this.getFrozenMode()){var s=this.contentModule.getFrozenRightContent().querySelector("."+X);sf.base.remove(s.querySelector(oe));var o=this.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(oe).cloneNode(!0);s.insertBefore(o,s.querySelector(se))}}if(this.isFrozenGrid()){var a=this.getContent().querySelector(".e-movablescrollbar").scrollLeft;this.headerModule.getMovableHeader().scrollLeft=a,this.contentModule.getMovableContent().scrollLeft=a}},r.prototype.excelExport=function(e,t,i,r){return this.excelExportModule?this.excelExportModule.Map(this,e,t,i,!1,r):null},r.prototype.csvExport=function(e,t,i,r){return this.excelExportModule?this.excelExportModule.Map(this,e,t,i,!0,r):null},r.prototype.pdfExport=function(e,t,i,r){return this.pdfExportModule?this.pdfExportModule.Map(this,e,t,i,r):null},r.prototype.groupColumn=function(e){this.groupModule&&this.groupModule.groupColumn(e)},r.prototype.groupExpandAll=function(){this.groupModule&&this.groupModule.expandAll()},r.prototype.groupCollapseAll=function(){this.groupModule&&this.groupModule.collapseAll()},r.prototype.clearGrouping=function(){this.groupModule&&this.groupModule.clearGrouping()},r.prototype.ungroupColumn=function(e){this.groupModule&&this.groupModule.ungroupColumn(e)},r.prototype.openColumnChooser=function(e,t){this.columnChooserModule&&this.columnChooserModule.openColumnChooser(e,t)},r.prototype.scrollRefresh=function(){var e=this;this.on(y,(function t(){e.scrollModule.refresh(),e.off(y,t)}),this)},r.prototype.detailCollapseAll=function(){this.detailRowModule&&this.detailRowModule.collapseAll()},r.prototype.detailExpandAll=function(){this.detailRowModule&&this.detailRowModule.expandAll()},r.prototype.clearCellSelection=function(){this.selectionModule&&this.selectionModule.clearCellSelection()},r.prototype.clearRowSelection=function(){this.selectionModule&&this.selectionModule.clearRowSelection()},r.prototype.selectCells=function(e){this.selectionModule&&this.selectionModule.selectCells(e)},r.prototype.selectRowsByRange=function(e,t){this.selectionModule&&this.selectionModule.selectRowsByRange(e,t)},r.prototype.isContextMenuOpen=function(){return this.contextMenuModule&&this.contextMenuModule.isOpen},r.prototype.ensureModuleInjected=function(e){return this.getInjectedModules().indexOf(e)>=0},r.prototype.destroyTemplate=function(e,t){this.clearTemplate(e,t)},r.prototype.log=function(e,t){this.loggerModule&&this.loggerModule.log(e,t)},r.prototype.applyBiggerTheme=function(e){this.element.classList.contains("e-bigger")&&e.classList.add("e-bigger")},r.prototype.getPreviousRowData=function(){return this.getRowsObject()[this.getRows().length-1].data},r.prototype.hideScroll=function(){var e=this.getContent().querySelector("."+Q),t=this.getContent().querySelector(".e-scrollbar");if(e.scrollHeight<=e.clientHeight&&(this.scrollModule.removePadding(),e.style.overflowY="auto"),this.isFrozenGrid()&&t){var i=this.getContent().querySelector(".e-movablescrollbar"),r=this.getContent().querySelector(".e-movablechild");t.style.display="flex",i.offsetWidth>=r.offsetWidth&&(t.style.display="none",this.notify("frozenHeight",0))}},r.prototype.getRowIndexByPrimaryKey=function(e){var t=this.getPrimaryKeyFieldNames()[0];e="object"===i(e)?e[t]:e;for(var r=this.getRowsObject(),n=0;n<r.length;n++)if(!r[n].isDetailRow&&!r[n].isCaptionRow){var s=r[n].data[t];if(t.split(".").length>1&&(s=Ar(t,r[n].data)),s===e)return r[n].index}return-1},r.prototype.grabColumnByFieldFromAllCols=function(e){var t;this.columnModel=[],this.updateColumnModel(this.columns);for(var i=this.columnModel,r=0;r<i.length;r++)e===i[r].field&&(t=i[r]);return t},r.prototype.grabColumnByUidFromAllCols=function(e){var t;this.columnModel=[],this.updateColumnModel(this.columns);for(var i=this.columnModel,r=0;r<i.length;r++)e===i[r].uid&&(t=i[r]);return t},r.prototype.getFilteredRecords=function(){if(this.allowFiltering&&this.filterSettings.columns.length){var e=this.renderModule.data.generateQuery(!0);return this.dataSource&&this.renderModule.data.isRemote()&&this.dataSource instanceof sf.data.DataManager?this.renderModule.data.getData(this.dataSource,e):this.dataSource instanceof sf.data.DataManager?this.dataSource.executeLocal(e):new sf.data.DataManager(this.dataSource,e).executeLocal(e)}return[]},r.prototype.getUserAgent=function(){var e=sf.base.Browser.userAgent.toLowerCase();return/iphone|ipod|ipad/.test(e)},r.prototype.tapEvent=function(t){this.getUserAgent()&&(e.Global.timer?(clearTimeout(e.Global.timer),e.Global.timer=null,this.dblClickHandler(t),this.notify("double-tap",t)):e.Global.timer=setTimeout((function(){e.Global.timer=null}),300))},r.prototype.getRowUid=function(e){return""+e+this.rowUid++},r.prototype.getMovableVirtualContent=function(){return this.getContent().querySelector("."+G)},r.prototype.getFrozenVirtualContent=function(){return this.getContent().querySelector("."+W)},r.prototype.getMovableVirtualHeader=function(){return this.getHeaderContent().querySelector("."+_)},r.prototype.getFrozenVirtualHeader=function(){return this.getHeaderContent().querySelector("."+K)},r.prototype.getRowElementByUID=function(e){var t,i=[];if(this.isFrozenGrid()){var r=[].slice.call(this.getFrozenVirtualContent().querySelector(se).children),n=[].slice.call(this.getMovableVirtualContent().querySelector(se).children),s=[];if(3===this.tablesCount&&(s=[].slice.call(this.getContent().querySelector(".e-frozen-right-content").querySelector(se).children)),this.frozenRows){if(i=(i=[].slice.call(this.getFrozenVirtualHeader().querySelector(se).children)).concat([].slice.call(this.getMovableVirtualHeader().querySelector(se).children)),3===this.tablesCount){var o=this.getHeaderContent().querySelector(".e-frozen-right-header");i=i.concat([].slice.call(o.querySelector(se).children)).concat(s)}i=i.concat(r).concat(n)}else i=r.concat(n).concat(s)}else{var a=[].slice.call(this.getContent().querySelector(se).children);i=this.frozenRows?(i=[].slice.call(this.getHeaderContent().querySelector(se).children)).concat(a):a}for(var l=0,h=i;l<h.length;l++){var d=h[l];if(d.getAttribute("data-uid")===e){t=d;break}}return t},r.prototype.getHiddenColumns=function(){for(var e=[],t=0,i=this.columnModel;t<i.length;t++){var r=i[t];!1===r.visible&&e.push(r)}return e},r.prototype.calculatePageSizeByParentHeight=function(e){if(this.allowPaging&&(this.allowTextWrap&&"Header"===this.textWrapSettings.wrapMode||!this.allowTextWrap)){var t=0;if(-1!==e.indexOf("%")&&(e=parseInt(e,10)/100*this.element.clientHeight),e>this.getNoncontentHeight()+this.getRowHeight()){t=(e-this.getNoncontentHeight())/this.getRowHeight()}if(t>0)return Math.floor(t)}return 0},r.prototype.getNoncontentHeight=function(){var e=0;if(sf.base.isNullOrUndefined(this.getHeaderContent().clientHeight)||(e+=this.getHeaderContent().clientHeight),this.toolbar&&!sf.base.isNullOrUndefined(this.element.querySelector(".e-toolbar").clientHeight)&&(e+=this.element.querySelector(".e-toolbar").clientHeight),this.allowPaging&&!sf.base.isNullOrUndefined(this.element.querySelector(".e-gridpager").clientHeight)&&(e+=this.element.querySelector(".e-gridpager").clientHeight),this.showColumnChooser&&!sf.base.isNullOrUndefined(this.element.querySelector(".e-columnheader").clientHeight)&&(e+=this.element.querySelector(".e-columnheader").clientHeight),this.allowGrouping&&this.groupSettings.showDropArea&&!sf.base.isNullOrUndefined(this.element.querySelector(".e-groupdroparea").clientHeight)&&(e+=this.element.querySelector(".e-groupdroparea").clientHeight),this.aggregates.length>0&&!sf.base.isNullOrUndefined(this.element.querySelector(".e-summaryrow").clientHeight))for(var t=0;t<this.element.getElementsByClassName("e-summaryrow").length;t++)e+=this.element.getElementsByClassName("e-summaryrow")[t].clientHeight;return e},r.prototype.getSummaryValues=function(e,t){return sf.data.DataUtil.aggregates[e.type.toLowerCase()](t,e.field)},r.prototype.serverExcelExport=function(e){this.isExcel=!0,this.exportGrid(e)},r.prototype.serverPdfExport=function(e){this.isExcel=!1,this.exportGrid(e)},r.prototype.serverCsvExport=function(e){this.isExcel=!0,this.exportGrid(e)},r.prototype.exportGrid=function(e){var t=this.getDataModule().generateQuery(!0),i=(new sf.data.UrlAdaptor).processQuery(new sf.data.DataManager({url:""}),t),r=JSON.parse(i.data),n=JSON.parse(this.addOnPersist(["allowGrouping","allowPaging","pageSettings","sortSettings","allowPdfExport","allowExcelExport","aggregates","filterSettings","groupSettings","columns","locale","searchSettings"]));n.filterSettings.columns=r.where,n.searchSettings.fields=r.search&&r.search[0].fields||[],n.sortSettings.columns=r.sorted,n.columns=this.setHeaderText(n.columns,["field","headerText","type","format","visible","foreignKeyValue","foreignKeyField","template","index","width","textAlign","headerTextAlign","columns"]);var s=this.createElement("form",{id:"ExportForm",styles:"display:none;"}),o=this.createElement("input",{id:"gridInput",attrs:{name:"gridModel"}});o.value=JSON.stringify(n),s.method="POST",s.action=e,s.appendChild(o),document.body.appendChild(s),s.submit(),s.remove()},r.prototype.setHeaderText=function(e,t){for(var i=0;i<e.length;i++){var r=this.getColumnByUid(e[i].uid);e[i].headerText=r.headerText,sf.base.isNullOrUndefined(r.template)||(e[i].template="true"),e[i].format&&(e[i].format=Or(this.getFormat(e[i].format),e[i].type,this.isExcel)),e[i].columns&&this.setHeaderText(e[i].columns,t);for(var n=Object.keys(e[i]),s=0;s<n.length;s++)t.indexOf(n[s])<0&&delete e[i][n[s]]}return e},r.prototype.getFormat=function(e){return"object"===i(e)?sf.base.isNullOrUndefined(e.format)?e.skeleton:e.format:e},r.prototype.isCollapseStateEnabled=function(){return!1===this.isExpanded},r.prototype.updateRowValue=function(e,t){var i={requestType:"save",data:t};this.showSpinner(),this.notify("update-data",i),this.refresh()},r.prototype.setForeignKeyData=function(){this.dataBind();var e=this.getDataModule().getForeignKeyDataState();e.isPending?(this.getDataModule().setForeignKeyDataState({}),e.resolver()):(this.getDataModule().setForeignKeyDataState({isDataChanged:!1}),(this.contentModule||this.headerModule)&&this.renderModule.render())},r.prototype.resetFilterDlgPosition=function(e){var t=this.getColumnHeaderByField(e);if(t){var i=t.querySelector(".e-filtermenudiv"),r=this.element.querySelector(".e-filter-popup");if(i&&r){var n=this.element.getBoundingClientRect(),s=i.getBoundingClientRect();r&&(r.style.left=(s.right-n.left).toString()+"px")}}},r.prototype.renderTemplates=function(){this.notify("reactTemplateRender",this.portals),this.renderReactTemplates()},r.prototype.batchUpdate=function(e){this.processRowChanges(e)},r.prototype.batchAsyncUpdate=function(e){this.processBulkRowChanges(e)},r.prototype.processBulkRowChanges=function(e){var t=this;if(this.dataToBeUpdated)for(var i=["addedRecords","changedRecords","deletedRecords"],r=this.getPrimaryKeyFieldNames()[0],n=0;n<i.length;n++)e[i[n]]&&br(this,e,i[n],r);else this.dataToBeUpdated=Object.assign({addedRecords:[],changedRecords:[],deletedRecords:[]},e),setTimeout((function(){t.processRowChanges(t.dataToBeUpdated),t.dataToBeUpdated=null}),this.asyncTimeOut)},r.prototype.processRowChanges=function(e){var t=this,i=this.getPrimaryKeyFieldNames()[0];e=Object.assign({addedRecords:[],changedRecords:[],deletedRecords:[]},e);var r=this.getDataModule().saveChanges(e,i,{},this.getDataModule().generateQuery().requiresCount());this.getDataModule().isRemote()?r.then((function(){t.setNewData()})):this.setNewData()},r.prototype.setNewData=function(){var e=this,t=JSON.parse(JSON.stringify(this.getCurrentViewRecords()));this.getDataModule().getData({},this.getDataModule().generateQuery().requiresCount()).then((function(i){e.bulkRefresh(i.result,t,i.count)}))},r.prototype.deleteRowElement=function(e){var t=this.getRowElementByUID(e.uid),i=parseInt(t.getAttribute(ne),10);if(sf.base.remove(t),this.getFrozenColumns()){var r=this.getMovableRows()[i];sf.base.remove(r)}},r.prototype.bulkRefresh=function(e,t,i){for(var r,n=this,s=this.getRowsObject(),o=this.getPrimaryKeyFieldNames()[0],a=function(t){e.filter((function(e){return e[o]===s[t].data[o]})).length||(l.deleteRowElement(s[t]),s.splice(t,1),t--),r=t},l=this,h=0;h<s.length;h++)a(h),h=r;var d=function(i){var r;t.filter((function(t){t[o]===e[i][o]&&(t!==e[i]&&n.setRowData(e[i][o],e[i]),r=!0)})),r||p.renderRowElement(e[i],i)},p=this;for(h=0;h<e.length;h++)d(h);this.currentViewData=e;var c=[].slice.call(this.getContentTable().getElementsByClassName(Y));vr(this,this.getRowsObject(),c),Cr(this),this.allowPaging&&this.notify(C,{module:"pager",properties:{totalRecordsCount:i}})},r.prototype.renderRowElement=function(e,t){var i,r=new le(this.serviceLocator,null,this),n=new he(this).generateRows([e]),s=r.render(n[0],this.getColumns());this.addRowObject(n[0],t);var o=this.getContentTable().querySelector(se);if(o.querySelector(".e-emptyrow")){var a=o.querySelector(".e-emptyrow");if(a.parentNode.removeChild(a),this.getFrozenColumns()){var l=this.getContent().querySelector("."+G).querySelector(se);l.firstElementChild.parentNode.removeChild(l.firstElementChild)}}this.getFrozenColumns()&&(i=Ji(s,this.getFrozenColumns(),this),(this.frozenRows&&t<this.frozenRows?this.getHeaderContent().querySelector("."+_).querySelector(se):this.getContent().querySelector("."+G).querySelector(se)).appendChild(i),"auto"===this.height&&this.notify("frozenHeight",{})),o=this.frozenRows&&t<this.frozenRows?this.getHeaderContent().querySelector(se):this.getContent().querySelector(se),(o=this.getContent().querySelector(se)).appendChild(s)},r.prototype.addRowObject=function(e,t){var i=this.getFrozenColumns();if(i){var r=this.getMovableRowsObject(),n=e.clone();n.cells=n.cells.slice(i),e.cells=e.cells.slice(0,i),r.splice(t,1,n)}this.getRowsObject().splice(t,1,e)},r.prototype.updateVisibleExpandCollapseRows=function(){for(var e=this.getRowsObject(),t=0,i=e.length;t<i;t++)e[t].isDataRow&&"none"===this.getRowElementByUID(e[t].uid).style.display?e[t].visible=!1:e[t].visible=!0},r.prototype.getHeight=function(e){return e=Number.isInteger(e)||-1===e.indexOf("%")?Number.isInteger(e)||"auto"===this.height?this.height:parseInt(e,10):parseInt(e,10)/100*this.element.clientHeight},r.prototype.getFrozenRightContent=function(){return this.getContent().querySelector(".e-frozen-right-content")},r.prototype.getFrozenRightHeader=function(){return this.getHeaderContent().querySelector(".e-frozen-right-header")},r.prototype.getMovableHeaderTbody=function(){return this.getMovableVirtualHeader().querySelector(se)},r.prototype.getMovableContentTbody=function(){return this.getMovableVirtualContent().querySelector(se)},r.prototype.getFrozenHeaderTbody=function(){return this.getFrozenVirtualHeader().querySelector(se)},r.prototype.getFrozenLeftContentTbody=function(){return this.getFrozenVirtualContent().querySelector(se)},r.prototype.getFrozenRightHeaderTbody=function(){return this.getFrozenRightHeader().querySelector(se)},r.prototype.getFrozenRightContentTbody=function(){var e;return this.getFrozenRightContent()&&(e=this.getFrozenRightContent().querySelector(se)),e},r.prototype.showResponsiveCustomFilter=function(e){this.filterModule&&this.filterModule.showCustomFilter(e||"Vertical"===this.rowRenderingMode)},r.prototype.showResponsiveCustomSort=function(e){this.sortModule&&this.sortModule.showCustomSort(e||"Vertical"===this.rowRenderingMode)},r.prototype.showAdaptiveFilterDialog=function(){this.enableAdaptiveUI&&this.showResponsiveCustomFilter(!0)},r.prototype.showAdaptiveSortDialog=function(){this.enableAdaptiveUI&&this.showResponsiveCustomSort(!0)},r.prototype.getCurrentVisibleColumns=function(e){for(var t=[],i=0,r=e?this.getColumns():this.columnModel;i<r.length;i++){var n=r[i];n.visible&&t.push(n)}return t},r.prototype.enableInfiniteAggrgate=function(){this.enableInfiniteScrolling&&this.allowGrouping&&this.aggregates.length&&this.setProperties({groupSettings:{disablePageWiseAggregates:!0}},!0)},Pt([sf.base.Property()],r.prototype,"parentDetails",void 0),Pt([sf.base.Property([])],r.prototype,"columns",void 0),Pt([sf.base.Property(!0)],r.prototype,"enableAltRow",void 0),Pt([sf.base.Property(!0)],r.prototype,"enableHover",void 0),Pt([sf.base.Property(!1)],r.prototype,"enableAutoFill",void 0),Pt([sf.base.Property(!0)],r.prototype,"allowKeyboard",void 0),Pt([sf.base.Property(!1)],r.prototype,"enableStickyHeader",void 0),Pt([sf.base.Property(!1)],r.prototype,"allowTextWrap",void 0),Pt([sf.base.Complex({},Wt)],r.prototype,"textWrapSettings",void 0),Pt([sf.base.Complex({},Kt)],r.prototype,"resizeSettings",void 0),Pt([sf.base.Property(!1)],r.prototype,"allowPaging",void 0),Pt([sf.base.Complex({},St)],r.prototype,"pageSettings",void 0),Pt([sf.base.Property(!1)],r.prototype,"enableVirtualization",void 0),Pt([sf.base.Property(!1)],r.prototype,"enableColumnVirtualization",void 0),Pt([sf.base.Property(!1)],r.prototype,"enableInfiniteScrolling",void 0),Pt([sf.base.Complex({},Gt)],r.prototype,"searchSettings",void 0),Pt([sf.base.Property(!1)],r.prototype,"allowSorting",void 0),Pt([sf.base.Property("Ellipsis")],r.prototype,"clipMode",void 0),Pt([sf.base.Property(!0)],r.prototype,"allowMultiSorting",void 0),Pt([sf.base.Property(!1)],r.prototype,"allowExcelExport",void 0),Pt([sf.base.Property(!1)],r.prototype,"allowPdfExport",void 0),Pt([sf.base.Complex({},qt)],r.prototype,"sortSettings",void 0),Pt([sf.base.Complex({},Ut)],r.prototype,"infiniteScrollSettings",void 0),Pt([sf.base.Property(!0)],r.prototype,"allowSelection",void 0),Pt([sf.base.Property(-1)],r.prototype,"selectedRowIndex",void 0),Pt([sf.base.Complex({},Vt)],r.prototype,"selectionSettings",void 0),Pt([sf.base.Property(!1)],r.prototype,"allowFiltering",void 0),Pt([sf.base.Property("Horizontal")],r.prototype,"rowRenderingMode",void 0),Pt([sf.base.Property(!1)],r.prototype,"enableAdaptiveUI",void 0),Pt([sf.base.Property(!1)],r.prototype,"allowReordering",void 0),Pt([sf.base.Property(!1)],r.prototype,"allowResizing",void 0),Pt([sf.base.Property(!1)],r.prototype,"allowRowDragAndDrop",void 0),Pt([sf.base.Complex({},_t)],r.prototype,"rowDropSettings",void 0),Pt([sf.base.Complex({},jt)],r.prototype,"filterSettings",void 0),Pt([sf.base.Property(!1)],r.prototype,"allowGrouping",void 0),Pt([sf.base.Property(!1)],r.prototype,"enableImmutableMode",void 0),Pt([sf.base.Property(!1)],r.prototype,"showColumnMenu",void 0),Pt([sf.base.Complex({},Qt)],r.prototype,"groupSettings",void 0),Pt([sf.base.Complex({},Xt)],r.prototype,"editSettings",void 0),Pt([sf.base.Collection([],At)],r.prototype,"aggregates",void 0),Pt([sf.base.Property(!1)],r.prototype,"showColumnChooser",void 0),Pt([sf.base.Complex({},Ft)],r.prototype,"columnChooserSettings",void 0),Pt([sf.base.Property(!1)],r.prototype,"enableHeaderFocus",void 0),Pt([sf.base.Property("auto")],r.prototype,"height",void 0),Pt([sf.base.Property("auto")],r.prototype,"width",void 0),Pt([sf.base.Property("Default")],r.prototype,"gridLines",void 0),Pt([sf.base.Property()],r.prototype,"rowTemplate",void 0),Pt([sf.base.Property()],r.prototype,"detailTemplate",void 0),Pt([sf.base.Property()],r.prototype,"childGrid",void 0),Pt([sf.base.Property()],r.prototype,"queryString",void 0),Pt([sf.base.Property("AllPages")],r.prototype,"printMode",void 0),Pt([sf.base.Property("Expanded")],r.prototype,"hierarchyPrintMode",void 0),Pt([sf.base.Property([])],r.prototype,"dataSource",void 0),Pt([sf.base.Property(null)],r.prototype,"rowHeight",void 0),Pt([sf.base.Property()],r.prototype,"query",void 0),Pt([sf.base.Property("USD")],r.prototype,"currencyCode",void 0),Pt([sf.base.Property()],r.prototype,"toolbar",void 0),Pt([sf.base.Property()],r.prototype,"contextMenuItems",void 0),Pt([sf.base.Property()],r.prototype,"columnMenuItems",void 0),Pt([sf.base.Property()],r.prototype,"toolbarTemplate",void 0),Pt([sf.base.Property()],r.prototype,"pagerTemplate",void 0),Pt([sf.base.Property(0)],r.prototype,"frozenRows",void 0),Pt([sf.base.Property(0)],r.prototype,"frozenColumns",void 0),Pt([sf.base.Property("All")],r.prototype,"columnQueryMode",void 0),Pt([sf.base.Property({})],r.prototype,"currentAction",void 0),Pt([sf.base.Property("default version")],r.prototype,"ej2StatePersistenceVersion",void 0),Pt([sf.base.Event()],r.prototype,"created",void 0),Pt([sf.base.Event()],r.prototype,"destroyed",void 0),Pt([sf.base.Event()],r.prototype,"load",void 0),Pt([sf.base.Event()],r.prototype,"rowDataBound",void 0),Pt([sf.base.Event()],r.prototype,"queryCellInfo",void 0),Pt([sf.base.Event()],r.prototype,"headerCellInfo",void 0),Pt([sf.base.Event()],r.prototype,"actionBegin",void 0),Pt([sf.base.Event()],r.prototype,"actionComplete",void 0),Pt([sf.base.Event()],r.prototype,"actionFailure",void 0),Pt([sf.base.Event()],r.prototype,"dataBound",void 0),Pt([sf.base.Event()],r.prototype,"recordDoubleClick",void 0),Pt([sf.base.Event()],r.prototype,"recordClick",void 0),Pt([sf.base.Event()],r.prototype,"rowSelecting",void 0),Pt([sf.base.Event()],r.prototype,"rowSelected",void 0),Pt([sf.base.Event()],r.prototype,"rowDeselecting",void 0),Pt([sf.base.Event()],r.prototype,"rowDeselected",void 0),Pt([sf.base.Event()],r.prototype,"cellSelecting",void 0),Pt([sf.base.Event()],r.prototype,"cellSelected",void 0),Pt([sf.base.Event()],r.prototype,"cellDeselecting",void 0),Pt([sf.base.Event()],r.prototype,"cellDeselected",void 0),Pt([sf.base.Event()],r.prototype,"columnSelecting",void 0),Pt([sf.base.Event()],r.prototype,"columnSelected",void 0),Pt([sf.base.Event()],r.prototype,"columnDeselecting",void 0),Pt([sf.base.Event()],r.prototype,"columnDeselected",void 0),Pt([sf.base.Event()],r.prototype,"columnDragStart",void 0),Pt([sf.base.Event()],r.prototype,"columnDrag",void 0),Pt([sf.base.Event()],r.prototype,"columnDrop",void 0),Pt([sf.base.Event()],r.prototype,"printComplete",void 0),Pt([sf.base.Event()],r.prototype,"beforePrint",void 0),Pt([sf.base.Event()],r.prototype,"pdfQueryCellInfo",void 0),Pt([sf.base.Event()],r.prototype,"pdfHeaderQueryCellInfo",void 0),Pt([sf.base.Event()],r.prototype,"pdfAggregateQueryCellInfo",void 0),Pt([sf.base.Event()],r.prototype,"excelAggregateQueryCellInfo",void 0),Pt([sf.base.Event()],r.prototype,"exportDetailDataBound",void 0),Pt([sf.base.Event()],r.prototype,"excelQueryCellInfo",void 0),Pt([sf.base.Event()],r.prototype,"excelHeaderQueryCellInfo",void 0),Pt([sf.base.Event()],r.prototype,"beforeExcelExport",void 0),Pt([sf.base.Event()],r.prototype,"excelExportComplete",void 0),Pt([sf.base.Event()],r.prototype,"beforePdfExport",void 0),Pt([sf.base.Event()],r.prototype,"pdfExportComplete",void 0),Pt([sf.base.Event()],r.prototype,"rowDragStartHelper",void 0),Pt([sf.base.Event()],r.prototype,"detailDataBound",void 0),Pt([sf.base.Event()],r.prototype,"rowDragStart",void 0),Pt([sf.base.Event()],r.prototype,"rowDrag",void 0),Pt([sf.base.Event()],r.prototype,"rowDrop",void 0),Pt([sf.base.Event()],r.prototype,"toolbarClick",void 0),Pt([sf.base.Event()],r.prototype,"beforeOpenColumnChooser",void 0),Pt([sf.base.Event()],r.prototype,"beforeOpenAdaptiveDialog",void 0),Pt([sf.base.Event()],r.prototype,"batchAdd",void 0),Pt([sf.base.Event()],r.prototype,"batchDelete",void 0),Pt([sf.base.Event()],r.prototype,"batchCancel",void 0),Pt([sf.base.Event()],r.prototype,"beforeBatchAdd",void 0),Pt([sf.base.Event()],r.prototype,"beforeBatchDelete",void 0),Pt([sf.base.Event()],r.prototype,"beforeBatchSave",void 0),Pt([sf.base.Event()],r.prototype,"beginEdit",void 0),Pt([sf.base.Event()],r.prototype,"commandClick",void 0),Pt([sf.base.Event()],r.prototype,"cellEdit",void 0),Pt([sf.base.Event()],r.prototype,"cellSave",void 0),Pt([sf.base.Event()],r.prototype,"cellSaved",void 0),Pt([sf.base.Event()],r.prototype,"resizeStart",void 0),Pt([sf.base.Event()],r.prototype,"resizing",void 0),Pt([sf.base.Event()],r.prototype,"resizeStop",void 0),Pt([sf.base.Event()],r.prototype,"keyPressed",void 0),Pt([sf.base.Event()],r.prototype,"beforeDataBound",void 0),Pt([sf.base.Event()],r.prototype,"contextMenuOpen",void 0),Pt([sf.base.Event()],r.prototype,"contextMenuClick",void 0),Pt([sf.base.Event()],r.prototype,"columnMenuOpen",void 0),Pt([sf.base.Event()],r.prototype,"columnMenuClick",void 0),Pt([sf.base.Event()],r.prototype,"checkBoxChange",void 0),Pt([sf.base.Event()],r.prototype,"beforeCopy",void 0),Pt([sf.base.Event()],r.prototype,"beforePaste",void 0),Pt([sf.base.Event()],r.prototype,"beforeAutoFill",void 0),Pt([sf.base.Event()],r.prototype,"columnDataStateChange",void 0),Pt([sf.base.Event()],r.prototype,"dataStateChange",void 0),Pt([sf.base.Event()],r.prototype,"dataSourceChanged",void 0),Pt([sf.base.Event()],r.prototype,"exportGroupCaption",void 0),Pt([sf.base.Event()],r.prototype,"lazyLoadGroupExpand",void 0),Pt([sf.base.Event()],r.prototype,"lazyLoadGroupCollapse",void 0),r=n=Pt([sf.base.NotifyPropertyChanges],r)}(sf.base.Component);function Jt(){return["aggregates","allowGrouping","allowFiltering","allowMultiSorting","allowReordering","allowSorting","allowTextWrap","childGrid","columns","currentViewData","dataSource","detailTemplate","enableAltRow","enableColumnVirtualization","filterSettings","gridLines","groupSettings","height","locale","pageSettings","printMode","query","queryString","enableRtl","rowHeight","rowTemplate","sortSettings","textWrapSettings","allowPaging","hierarchyPrintMode","searchSettings","queryCellInfo","beforeDataBound"]}var Zt=function(){function e(e,t){this.isAsyncPrint=!1,this.defered=new sf.data.Deferred,this.parent=e,this.parent.isDestroyed||(this.parent.on(y,this.isContentReady(),this),this.actionBeginFunction=this.actionBegin.bind(this),this.parent.addEventListener(p,this.actionBeginFunction),this.parent.on(b,this.onEmpty.bind(this)),this.parent.on("hierarchyprint",this.hierarchyPrint,this),this.scrollModule=t)}return e.prototype.isContentReady=function(){var e=this;return!this.isPrintGrid()||"None"!==this.parent.hierarchyPrintMode&&this.parent.childGrid?function(){e.defered.promise.then((function(){e.contentReady()})),e.isPrintGrid()&&e.hierarchyPrint()}:this.contentReady},e.prototype.hierarchyPrint=function(){this.removeColGroup(this.parent);var e=window.printGridObj;e&&!e.element.querySelector("[aria-busy=true")&&e.printModule.defered.resolve()},e.prototype.print=function(){this.renderPrintGrid(),this.printWind=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWind.moveTo(0,0),this.printWind.resizeTo(screen.availWidth,screen.availHeight)},e.prototype.onEmpty=function(){this.isPrintGrid()&&this.contentReady()},e.prototype.actionBegin=function(){this.isPrintGrid()&&(this.isAsyncPrint=!0)},e.prototype.renderPrintGrid=function(){var e=this.parent,t=sf.base.createElement("div",{id:this.parent.element.id+"_print",className:e.element.className+" e-print-grid"});t.classList.remove("e-gridhover"),document.body.appendChild(t);var i=new Yt(ir(e,e.hierarchyPrintMode));if(e.isFrozenGrid()&&!e.getFrozenColumns())for(var r=0;r<i.columns.length;r++)i.columns[r]=sf.base.extend({},i.columns[r]),i.columns[r].freeze=void 0;this.parent.isAngular&&(i.viewContainerRef=this.parent.viewContainerRef),i.load=function(){},i.query=e.getQuery().clone(),window.printGridObj=i,i.isPrinting=!0;var n=i.getInjectedModules(),s=e.getInjectedModules();n&&n.length===s.length||i.setInjectedModules(s),e.notify("printGrid-Init",{element:t,printgrid:i}),this.parent.log("exporting_begin",this.getModuleName()),i.registeredTemplate=this.parent.registeredTemplate,i.appendTo(t),i.trigger=e.trigger},e.prototype.contentReady=function(){if(this.isPrintGrid()){var e=this.parent;if(this.isAsyncPrint)return void this.printGrid();var t={requestType:"print",element:e.element,selectedRows:e.getContentTable().querySelectorAll('tr[aria-selected="true"]'),cancel:!1,hierarchyPrintMode:e.hierarchyPrintMode};if(this.isAsyncPrint||e.trigger("beforePrint",t),t.cancel)return void sf.base.detach(e.element);this.isAsyncPrint||this.printGrid()}},e.prototype.printGrid=function(){var e=this.parent;if("auto"!==e.height){var t=this.scrollModule.getCssProperties(),i=e.element.querySelector("."+Q),r=e.element.querySelector("."+H);i.style.height="auto",i.style.overflowY="auto",r.style[t.padding]="",r.firstElementChild.style[t.border]=""}e.allowGrouping&&(e.groupSettings.columns.length?this.removeColGroup(e):e.element.querySelector(".e-groupdroparea").style.display="none");for(var n=0,s=[].slice.call(e.element.getElementsByClassName(Q));n<s.length;n++){(h=s[n]).style.overflowX="hidden"}for(var o=[].slice.call(e.element.getElementsByClassName("e-spin-show")),a=0,l=[].slice.call(o);a<l.length;a++){var h=l[a];sf.base.classList(h,["e-spin-hide"],["e-spin-show"])}this.printGridElement(e),e.isPrinting=!1,delete window.printGridObj;var d={element:e.element};e.trigger("printComplete",d),e.destroy(),this.parent.log("exporting_complete",this.getModuleName())},e.prototype.printGridElement=function(e){sf.base.classList(e.element,["e-print-grid-layout"],["e-print-grid"]),e.isPrinting&&sf.base.detach(e.element),this.printWind=sf.base.print(e.element,this.printWind)},e.prototype.removeColGroup=function(e){var t=e.groupSettings.columns.length,i=e.element,r="#"+e.element.id;if(t){for(var n=sf.base.selectAll(r+"captioncell.e-groupcaption",i),s=n[t-1].getAttribute("colspan"),o=0;o<n.length;o++)n[o].setAttribute("colspan",s);var a=sf.base.selectAll("colgroup"+r+"colGroup",i),l=sf.base.selectAll(".e-content colgroup",i);this.hideColGroup(a,t),this.hideColGroup(l,t)}},e.prototype.hideColGroup=function(e,t){for(var i=0;i<e.length;i++)for(var r=0;r<t;r++)e[i].children[r].style.display="none"},e.prototype.isPrintGrid=function(){return this.parent.element.id.indexOf("_print")>0&&this.parent.isPrinting},e.prototype.destroy=function(){this.parent.isDestroyed||(this.parent.off(y,this.contentReady.bind(this)),this.parent.removeEventListener(p,this.actionBeginFunction),this.parent.off(b,this.onEmpty.bind(this)),this.parent.off("hierarchyprint",this.hierarchyPrint))},e.prototype.getModuleName=function(){return"print"},e.printGridProp=["aggregates","allowGrouping","allowFiltering","allowMultiSorting","allowReordering","allowSorting","allowTextWrap","childGrid","columns","currentViewData","dataSource","detailTemplate","enableAltRow","enableColumnVirtualization","filterSettings","gridLines","groupSettings","height","locale","pageSettings","printMode","query","queryString","enableRtl","rowHeight","rowTemplate","sortSettings","textWrapSettings","allowPaging","hierarchyPrintMode","searchSettings","queryCellInfo","beforeDataBound"].concat(["beforePrint","printComplete","load"]),e}();function $t(e,t){return e.prototype&&t in e.prototype}function ei(e,t,i){return sf.base.isNullOrUndefined(e)||""===e?"":sf.data.DataUtil.getObject(e,t)}function ti(e,t){requestAnimationFrame((function(){try{t(null,e())}catch(e){t(e)}}))}function ii(e){return!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(e.columns)&&e.columns.length>0}function ri(e,t){for(var i=e.columns,r=t.columns,n=0;n<i.length;n++)if(r.length-1>=n)if(r[n].columns)for(var s=0;s<r[n].columns.length;s++)i[n].columns[s].type=r[n].columns[s].type;else i[n].type=r[n].type}function ni(e){for(var t=[],i=e.vRows,r=0;r<i.length;r++)i[r].isDataRow?t.push(i[r]):i[r].isDataRow||(t.push(i[r]),!i[r].isExpand&&i[r].isCaptionRow&&(r+=oi(i[r],e)));e.vcRows=t}var si=0;function oi(e,t){si=0;var i=t.groupSettings.columns.length,r="items",n=e.gSummary,s=0,o="aggregatesCount";if(n===e.data.count)return t.groupSettings.columns.length&&!sf.base.isNullOrUndefined(e[o])&&e[o]?1!==t.groupSettings.columns.length?si+=0!==e.indent&&n<2?e.gSummary*(i-e.indent+(i-e.indent)*e[o]):e.gSummary*(i-e.indent+(i-e.indent-1)*e[o])+e[o]:1===t.groupSettings.columns.length&&(si+=e.gSummary*(i-e.indent)+e[o]):t.groupSettings.columns.length&&(1!==t.groupSettings.columns.length?si+=e.gSummary*(t.groupSettings.columns.length-e.indent):si+=e.gSummary),si;for(var a=0,l=e.data[r].length;a<l;a++){var h=e.data[r][a];si+=h[r].length+(i===t.columns.length||sf.base.isNullOrUndefined(h[r].records)?0:h[r].records.length),s+=sf.base.isNullOrUndefined(h[r].records)||sf.base.isNullOrUndefined(e[o])?h[r].length:h[r].records.length,h[r].GroupGuid&&0!==h[r].childLevels&&ai(h)}return si+=e.data[r].length,sf.base.isNullOrUndefined(e[o])||e[o]&&si&&0!==s&&(si+=(si-s)*e[o]+e[o]),si}function ai(e){for(var t=0,i=e.items.length;t<i;t++){var r=e.items[t];si+=r.count,0!==r.items.childLevels&&ai(r)}}function li(e,t){for(var i=[],r=0,n=e.length;r<n;r++){var s=t(e[r],r);sf.base.isNullOrUndefined(s)||i.push(s)}return i}function hi(e){for(var t=[],i=0;i<e.length;i++)t.push(sf.base.extend({},mi(e[i]),{},!0));return t}function di(e){if(e)try{if(document.querySelectorAll(e).length)return sf.base.compile(document.querySelector(e).innerHTML.trim())}catch(t){return sf.base.compile(e)}}function pi(e,t){var i={},r=["style","class"];sf.base.extend(i,t,{}),"style"in i&&(sf.base.setStyleAttribute(e,i[r[0]]),delete i[r[0]]),"class"in i&&(sf.base.addClass([e],i[r[1]]),delete i[r[1]]),sf.base.attributes(e,i)}function ci(e,t,i,r){for(var n=sf.base.extend(e,t,i),s=Object.keys(n),o=0;o<s.length;o++)r&&-1!==r.indexOf(s[o])&&delete n[s[o]];return n}function ui(e,t){void 0===t&&(t=0);for(var i=0,r=e.length;i<r;i++)e[i].columns?(e[i].index=sf.base.isNullOrUndefined(e[i].index)?t:e[i].index,t++,t=ui(e[i].columns,t)):(e[i].index=sf.base.isNullOrUndefined(e[i].index)?t:e[i].index,t++);return t}function fi(e,t,i){for(var r=0,n=e.length;r<n;r++){var s=void 0;"string"==typeof e[r]?s=new h({field:e[r]},i):e[r]instanceof h&&!e[r].columns?s=e[r]:e[r].columns?(e[r].columns=fi(e[r].columns,null,i),s=new h(e[r],i)):s=new h(e[r],i),s.type&&"checkbox"===s.type.toLowerCase()&&(s.allowReordering=!1),s.headerText=sf.base.isNullOrUndefined(s.headerText)?s.foreignKeyValue||s.field||"":s.headerText,s.foreignKeyField=s.foreignKeyField||s.field,s.valueAccessor=("string"==typeof s.valueAccessor?sf.base.getValue(s.valueAccessor,window):s.valueAccessor)||ei,s.width=t&&sf.base.isNullOrUndefined(s.width)?200:s.width,sf.base.isNullOrUndefined(s.visible)&&(s.visible=!0),e[r]=s}return e}function gi(e,t,i){var r=e.querySelector("span"),n=e.parentElement.getBoundingClientRect(),s=t.target.getBoundingClientRect();r.className=i,e.style.display="";var o=(sf.base.isNullOrUndefined(t.clientY)?t.changedTouches[0].clientY:t.clientY)>e.offsetHeight+10;e.style.top=s.top-n.top+(o?-(e.offsetHeight+10):e.offsetHeight+10)+"px",e.style.left=function(e,t,i,r){var n=e.offsetWidth/2,s=Si(t).x;return s-i.left<n?i.left-r:i.right-s<n?i.right-r-2*n:s-r-n}(e,t,s,n.left)+"px",o?(e.querySelector(".e-downtail").style.display="",e.querySelector(".e-uptail").style.display="none"):(e.querySelector(".e-downtail").style.display="none",e.querySelector(".e-uptail").style.display="")}function mi(e){return e instanceof sf.base.ChildProperty?sf.base.getValue("properties",e):e}function yi(e,t,i){for(var r=e;r&&!(i?r.id===t:r.classList.contains(t));)r=r.parentElement;return r}function vi(e,t){for(var i=-1,r=0,n=t.length;r<n;r++)if(t[r].isEqualNode(e)){i=r;break}return i}function bi(e,t){for(var i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1}function Ci(e){for(var t=[],i=0,r=e.length;i<r;i++)e[i].hasOwnProperty("properties")?t.push(e[i].properties):t.push(e[i]);return t}function wi(e,t){for(var i=[].slice.call(e.querySelectorAll(t)),r=0;r<i.length;r++)sf.base.remove(i[r])}function Si(e){var t={};return t.x=sf.base.isNullOrUndefined(e.clientX)?e.changedTouches[0].clientX:e.clientX,t.y=sf.base.isNullOrUndefined(e.clientY)?e.changedTouches[0].clientY:e.clientY,t}var xi=0;function Ri(e){return e+xi++}function Fi(e,t){for(var i=0,r=t.length;i<r;i++)r===t.length?e.appendChild(t[i]):e.appendChild(t[0]);return e}function Ei(e,t,i){for(var r=e,n=[];r;)(i?r.id===t:r.classList.contains(t))&&n.push(r),r=r.parentElement;return n}function Ii(e,t,i,r){if("Custom"===e){var n=i.customAggregate;return"string"==typeof n&&(n=sf.base.getValue(n,window)),n?n.call(r,t,i):""}return i.field in t||t instanceof Array?sf.data.DataUtil.aggregates[e.toLowerCase()](t,i.field):null}var Ti,zi=null;function Di(){if(null!==zi)return zi;var e,t=document.createElement("div");return t.style.cssText="width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;",document.body.appendChild(t),e=t.offsetWidth-t.clientWidth|0,document.body.removeChild(t),zi=e}function Mi(e){if(void 0!==Ti)return Ti;var t=sf.base.createElement("table",{className:X,styles:"visibility: hidden"});t.innerHTML='<tr><td class="e-rowcell">A<td></tr>',e.appendChild(t);var i=t.querySelector("td").getBoundingClientRect();return e.removeChild(t),Ti=Math.ceil(i.height)}function Oi(e){return e.split(".").length>1}function ki(e){return void 0===e&&(e=""),e.replace(/\./g,"___")}function Ai(e){return void 0===e&&(e=""),e.replace(/___/g,".")}function Bi(e,t,i){var r=yi(i,Y),n=!r||r&&!r.classList.contains("e-insertedrow");return"beginEdit"===t&&n?!(e.isIdentity||e.isPrimaryKey||!e.allowEditing):("add"!==t||!e.isIdentity)&&!(n&&!e.allowEditing&&!e.isIdentity&&!e.isPrimaryKey)}function Ni(e){var t=sf.base.select("#"+e.element.id+"EditConfirm",e.element);return"Batch"===e.editSettings.mode&&sf.base.selectAll(".e-updatedtd",e.element).length&&e.editSettings.showConfirmDialog&&(!t||t.classList.contains("e-popup-close"))}function Pi(e,t){e=e instanceof Array?e:[e];for(var i=0;i<e.length;i++)t?e[i].classList.add("e-wrap"):e[i].classList.remove("e-wrap")}function Li(e,t){var i,r=e.getService("valueFormatter");switch("date"!==t.type&&"datetime"!==t.type||(i={type:t.type,skeleton:t.format},"string"==typeof t.format&&"yMd"!==t.format&&(i.format=t.format)),t.type){case"date":case"datetime":t.setFormatter(r.getFormatFunction(i)),t.setParser(r.getParserFunction(i));break;case"number":t.setFormatter(r.getFormatFunction({format:t.format})),t.setParser(r.getParserFunction({format:t.format}))}}function qi(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];for(var n=0,s=e.length;n<s;n++)t?(sf.base.classList(e[n],i.slice(),[]),e[n].setAttribute("aria-selected","true")):(sf.base.classList(e[n],[],i.slice()),e[n].removeAttribute("aria-selected"))}function Hi(e){for(var t={},i=[],r=0;r<e.length;r++)e[r]in t||(i.push(e[r].toString()),t[e[r]]=1);return i}function Ui(e,t){var i=t.element.style.display;t.element.style.display="block";var r=t.width,n=sf.popups.calculateRelativeBasedPosition(e,t.element);t.element.style.display=i,t.element.style.top=n.top+e.getBoundingClientRect().height-5+"px";var s=n.left-r+e.clientWidth;t.element.style.left=s<1?r+s-16+"px":s+-4+"px"}function ji(e,t){e.popup.element.style.zIndex=(t.zIndex+1).toString()}function Vi(e){var t=e.querySelector(".e-frame"),i=t.previousSibling;t.classList.contains("e-check")?(i.checked=!1,sf.base.classList(t,["e-uncheck"],["e-check"])):(i.checked=!0,sf.base.classList(t,["e-check"],["e-uncheck"]))}function Gi(e,t){e.checked=t}function _i(e,t,i){var r=sf.base.createElement("div",{className:i});return r.appendChild(t),r.setAttribute("uid",e),r}function Wi(e,t){sf.base.removeClass([e],["e-check","e-stop","e-uncheck"]),t?e.classList.add("e-check"):e.classList.add("e-uncheck")}function Ki(e,t,i){for(var r=0;r<t.length;r++)sf.base.setValue(t[r].field,Qi(t[r],i),e.foreignKeyData);var n=e.cells;for(r=0;r<n.length;r++)n[r].isForeignKey&&sf.base.setValue("foreignKeyData",sf.base.getValue(n[r].column.field,e.foreignKeyData),n[r])}function Qi(e,t,i,r){var n=e.foreignKeyField,s=sf.base.isNullOrUndefined(i)?ei(e.field,t):i;s=sf.base.isNullOrUndefined(s)?"":s;var o=new sf.data.Query,a=r||(e.dataSource instanceof sf.data.DataManager&&e.dataSource.dataSource.json.length?e.dataSource.dataSource.json:e.columnData);return s.getDay?o.where(Yi({field:n,operator:"equal",value:s,matchCase:!1})):o.where(n,"==",s,!1),new sf.data.DataManager(a).executeLocal(o)}function Xi(e,t){var i;return t.some((function(t){return i=t,t.foreignKeyValue===e}))&&i}function Yi(e,t){var i,r,n,s=sf.base.extend({},mi(e)),o=sf.base.extend({},mi(e));if(sf.base.isNullOrUndefined(e.value))return i=new sf.data.Predicate(s.field,s.operator,s.value,!1);var a=new Date(e.value);if("equal"===e.operator||"notequal"===e.operator){"datetime"===t?(r=new Date(a.setSeconds(a.getSeconds()-1)),n=new Date(a.setSeconds(a.getSeconds()+2)),e.value=new Date(a.setSeconds(n.getSeconds()-1))):(r=new Date(a.setHours(0)-1),n=new Date(a.setHours(24))),s.value=r,o.value=n,"equal"===e.operator?(s.operator="greaterthan",o.operator="lessthan"):"notequal"===e.operator&&(s.operator="lessthanorequal",o.operator="greaterthanorequal");var l=new sf.data.Predicate(s.field,s.operator,s.value,!1),h=new sf.data.Predicate(o.field,o.operator,o.value,!1);i="equal"===e.operator?l.and(h):l.or(h)}else{"string"==typeof s.value&&(s.value=new Date(s.value)),i=new sf.data.Predicate(s.field,s.operator,s.value,!1)}return e.setProperties?e.setProperties({ejpredicate:i},!0):e.ejpredicate=i,i}function Ji(e,t,i){t=t&&i&&i.isRowDragable()?t+1:t;for(var r=e.cloneNode(!0),n=0;n<t;n++)r.removeChild(r.children[0]);n=t;for(var s=e.childElementCount;n<s;n++)e.removeChild(e.children[e.childElementCount-1]);return r}function Zi(e){return e.enableVirtualization&&e.groupSettings.columns.length>0&&e.isVirtualAdaptive}function $i(e,t){if(void 0===e&&(e=""),e){for(var i=t,r=e.split("."),n=0;n<r.length&&!sf.base.isNullOrUndefined(i);n++)i=i[r[n]];return i}}function er(e,t){var r=new sf.base.Internationalization;return"date"===t?"object"===i(e)?r.getDatePattern({type:e.type?e.type:"date",format:e.format},!1):r.getDatePattern({type:"dateTime",skeleton:e},!1):"object"===i(e)?r.getDatePattern({type:e.type?e.type:"dateTime",format:e.format},!1):r.getDatePattern({type:"dateTime",skeleton:e},!1)}function tr(e,t){for(var i={},r=0,n=e.getRowsObject();r<n.length;r++){var s=n[r];if(s.isExpand&&!s.isDetailRow){var o=e.allowPaging&&"AllPages"===e.printMode?s.index+e.pageSettings.currentPage*e.pageSettings.pageSize-e.pageSettings.pageSize:s.index;i[o]={},i[o].isExpand=!0,i[o].gridModel=ir(s.childGrid,t),i[o].gridModel.query=e.childGrid.query}}return i}function ir(e,t){void 0===t&&(t="Expanded");var i={};if(!e)return i;for(var r=e.isFrozenGrid()&&!e.getFrozenColumns(),n=0,s=Zt.printGridProp;n<s.length;n++){var o=s[n];i[o]="columns"===o?Ci(r?e.getColumns():e[o]):"allowPaging"===o?"CurrentPage"===e.printMode:mi(e[o])}return i.enableHover=!1,e.childGrid&&"None"!==t&&(i.expandedRows=tr(e,t)),i}function rr(e,t,i,r){var n=e||{},s=arguments.length;r&&(s-=1);for(var o=1;o<s;o++)if(arguments[o])for(var a=arguments[o],l=Object.keys(Object.getPrototypeOf(a)).length?Object.keys(a).concat(nr(a)):Object.keys(a),h=0;h<l.length;h++){var d=n[l[h]],p=a[l[h]],c=void 0;r&&(sf.base.isObject(p)||Array.isArray(p))?sf.base.isObject(p)?(c=d||{},n[l[h]]=sf.base.extend({},c,p,r)):(c=d||[],n[l[h]]=sf.base.extend([],c,p,r)):n[l[h]]=p}return n}function nr(e){for(var t=[];Object.getPrototypeOf(e)&&Object.keys(Object.getPrototypeOf(e)).length;)t=t.concat(Object.keys(Object.getPrototypeOf(e))),e=Object.getPrototypeOf(e);return t}function sr(e){for(var t=0,i=0;i<e.length;i++){var r=or(e[i],0);t<r&&(t=r)}return t+1}function or(e,t){var i=t,r=[];if(e.columns){t++;for(var n=0;n<e.columns.length;n++)r[n]=or(e.columns[n],t);for(var s=0;s<r.length;s++)i<r[s]&&(i=r[s]);t=i}return t}function ar(e,t){for(var i=0;i<t.length;i++)t[i].uid=t[i].isForeignKey?Xi(t[i].field,e.getForeignKeyColumns()).uid:e.enableColumnVirtualization?qr(e,t[i].field).uid:e.getColumnByField(t[i].field).uid}function lr(e){var t=document.defaultView.getComputedStyle(e,null).getPropertyValue("transform").replace(/,/g,"");return{width:parseFloat(t.split(" ")[4]),height:parseFloat(t.split(" ")[5])}}function hr(e,t){e.classList.contains("e-bigger")&&t.classList.add("e-bigger")}function dr(e,t){if(e&&t){var i=sf.base.closest(e,"."+Y).getBoundingClientRect().height,r=sf.base.closest(t,"."+Y).getBoundingClientRect().height;i>r?t.style.height=i+"px":e.style.height=r+"px"}}function pr(e,t){var i=t.getContent().firstElementChild.offsetHeight;return e&&e.getBoundingClientRect().top>i}function cr(e,t){return e&&e.getBoundingClientRect().top<t}function ur(e,t){var i=t.getRowHeight(),r=t.getContent().firstElementChild.scrollTop/i;return e<r+t.getContent().firstElementChild.offsetHeight/i&&e>r}function fr(e,t){var i,r=e.getPrimaryKeyFieldNames()[0];return e.getCurrentViewRecords().filter((function(e,n){e[r]===t[r]&&(i=n)})),i}function gr(e,t){var i=mr(t),r=new sf.data.Deferred;return i.dataSource=r.resolve,i.action=e,{state:i,deffered:r}}function mr(e){var t=new sf.data.UrlAdaptor,i=new sf.data.DataManager({url:"",adaptor:new sf.data.UrlAdaptor}),r=t.processQuery(i,e);return JSON.parse(r.data)}function yr(e){for(var t=e.getVisibleColumns(),i=0,r=0,n=0;n<t.length;n++)sf.base.isUndefined(t[n].width)?r++:-1!==t[n].width.toString().indexOf("%")&&i++;return("auto"===e.width||"string"==typeof e.width&&-1!==e.width.indexOf("%"))&&!e.groupSettings.showGroupedColumn&&e.groupSettings.columns.length&&i&&!r}function vr(e,t,i,r){for(var n=r||0,s=0;s<t.length;s++)if(t[s].isDataRow){t[s].index=n,t[s].isAltRow=!!e.enableAltRow&&n%2!=0,i[s].setAttribute(ne,n.toString()),t[s].isAltRow?i[s].classList.add("e-altrow"):i[s].classList.remove("e-altrow");for(var o=0;o<i[s].cells.length;o++)i[s].cells[o].setAttribute("index",n.toString());n++}t.length||e.renderModule.emptyRow(!0)}function br(e,t,i,r){var n=e.dataToBeUpdated[i].concat(t[i]).reduce((function(e,t){return e[t[r]]=void 0===e[t[r]]?t:Object.assign(e[t[r]],t),e}),{});e.dataToBeUpdated[i]=Object.keys(n).map((function(e){return n[e]}))}function Cr(e){if(e.isFrozenGrid()){e.contentModule.rowElements=[].slice.call(e.element.querySelectorAll(".e-movableheader .e-row, .e-movablecontent .e-row"));var t=e.getFrozenMode()===ee?".e-frozen-left-header .e-row, .e-frozen-left-content .e-row":".e-frozenheader .e-row, .e-frozencontent .e-row";e.contentModule.freezeRowElements=[].slice.call(e.element.querySelectorAll(t)),e.getFrozenMode()===ee&&(e.contentModule.frozenRightRowElements=[].slice.call(e.element.querySelectorAll(".e-frozen-right-header .e-row, .e-frozen-right-content .e-row")))}else e.contentModule.rowElements=[].slice.call(e.element.querySelectorAll(".e-row:not(.e-addedrow)"))}function wr(e,t,i){var r=e.getFrozenLeftCount(),n=e.getMovableColumnsCount(),s=e.getFrozenRightColumnsCount(),o=e.getFrozenMode(),a=e.isRowDragable()?1:0,l="Right"===o?r+n:r+n+a,h="Right"===o?r:r+a,d="Right"===o?t.length-s-a:s?t.length-s:t.length;return i===ie?t=t.slice(0,r?r+a:t.length):i===te?t=t.slice(l,t.length):"movable"===i&&(t=t.slice(h,d)),t}function Sr(e,t,i,r,n){(i[0].length||r)&&(n?t(ie,i[0],n[0]):t(ie,i[0])),e.isFrozenGrid()&&(i[1].length||r)&&(n?t("movable",i[1],n[1]):t("movable",i[1])),e.getFrozenMode()!==ee&&"Right"!==e.getFrozenMode()||!i[2].length&&!r||(n?t(te,i[2],n[2]):t(te,i[2]))}function xr(e){return["Right"!==e.getFrozenMode()?e.getRowsObject():[],e.getMovableRowsObject(),e.getFrozenRightRowsObject()]}function Rr(e){return["Right"!==e.getFrozenMode()?e.getAllDataRows(!0):[],e.getAllMovableDataRows(!0),e.getAllFrozenRightDataRows(!0)]}function Fr(e,t,i){for(var r=e.children.length,n=0,s=0;s<r;s++,n++)s>=t&&s<i||(e.removeChild(e.children[n]),n--)}function Er(e,t,i){return"movable"===t.getFreezeTableName()?[].slice.call(e.getMovableDataRows()[i].getElementsByClassName(q)):t.getFreezeTableName()===te?[].slice.call(e.getFrozenRightDataRows()[i].getElementsByClassName(q)):[].slice.call(e.getDataRows()[i].getElementsByClassName(q))}function Ir(e,t,i,r){var n=e.getFrozenLeftCount(),s=e.getMovableColumnsCount();return r="movable"===t.getFreezeTableName()?r-n:t.getFreezeTableName()===te?r-(n+s):r,Er(e,t,i)[r]}function Tr(e,t,i,r,n,s,o){o||e.getFreezeTableName()===ie||!t&&e.getFreezeTableName()===te||1===s?i[ki(e.field)]=e.validationRules:"movable"!==e.getFreezeTableName()&&e.getFreezeTableName()?e.getFreezeTableName()===te&&(n[ki(e.field)]=e.validationRules):r[ki(e.field)]=e.validationRules}function zr(e){var t;return e.isFrozenGrid()&&(t=e.frozenRows&&"Top"===e.editSettings.newRowPosition?e.getMovableHeaderTbody():e.getMovableContentTbody()),t}function Dr(e){var t;return e.getFrozenMode()===ee&&(t=e.frozenRows&&"Top"===e.editSettings.newRowPosition?e.getFrozenRightHeaderTbody():e.getFrozenRightContentTbody()),t}function Mr(e,t,i,r,n,s,o){e&&r&&o(e,r),t&&n&&o(t,n),i&&s&&o(i,s)}function Or(e,t,i){var r,n=new sf.base.Internationalization;if("number"===t)try{r=n.getNumberPattern({format:e,currency:this.currency,useGrouping:!0},!0)}catch(t){r=e}else if("date"===t||"time"===t||"datetime"===t)try{if(r=n.getDatePattern({skeleton:e,type:t},i),sf.base.isNullOrUndefined(r))throw"error"}catch(s){try{r=n.getDatePattern({format:e,type:t},i)}catch(t){r=e}}else r=e;if("number"!==t){var s={G:"",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"};r=r.replace(/G|H|c|'| a|yy|y|EEEE|E/g,(function(e){return s[e]}))}return r}function kr(e){if(e.enableAdaptiveUI)for(var t=document.getElementsByClassName("e-responsive-dialog"),i=0;i<t.length;i++)t[i].classList.add("e-bigger")}function Ar(e,t){for(var i,r=e.split(".").length,n=e.split("."),s=t,o=0;o<r;o++)s=i=s[n[o]];return i}function Br(e,t,i,r,n,s){for(var o=Object.keys(e),a=0;a<o.length;a++){var l=e[o[a]].querySelectorAll("td.e-rowcell")[t];if(e[o[a]].querySelectorAll("td.e-rowcell").length&&l)if(sf.base.setStyleAttribute(e[o[a]].querySelectorAll("td.e-rowcell")[t],{display:i}),e[o[a]].querySelectorAll("td.e-rowcell")[t].classList.contains("e-hide")&&sf.base.removeClass([e[o[a]].querySelectorAll("td.e-rowcell")[t]],["e-hide"]),s&&n.isRowDragable()){var h=n.getFrozenColumns()?t:t+1;r[o[a]].cells[h].visible=""===i}else r[o[a]].cells[t].visible=""===i}}function Nr(e,t,i,r){for(var n=0,s=t;n<s.length;n++){var o=s[n];i?e.on(o.event,o.handler,r):e.off(o.event,o.handler)}}function Pr(e,t,i,r){var n=ki(t.field);return r=Object.assign(r,{id:e.element.id+n,name:n,"e-mappinguid":t.uid}),e.createElement("input",{className:i,attrs:r})}function Lr(e,t){for(var i,r=0,n=e.columnModel;r<n.length;r++){var s=n[r];if(s.uid===t){i=s;break}}return i}function qr(e,t){var i;e.columnModel||e.getColumns();for(var r=0,n=e.columnModel;r<n.length;r++){var s=n[r];if(s.field===t){i=s;break}}return i}function Hr(e,t,i,r){r.eventHandlers[e]={};for(var n=0;n<t.length;n++)r.eventHandlers[e][t[n]]=i[t[n]]}function Ur(e,t,i){for(var r=0;r<t.length&&!e.isDestroyed;r++)e.removeEventListener(t[r],i.eventHandlers[e.element.id][t[r]])}function jr(e,t){e.destroyTemplate(t),e.isReact&&e.renderTemplates()}function Vr(e){return parseInt(e.getAttribute(ne),10)}function Gr(e,t,i){for(var r=[],n=0;n<e.length;n++){var s=i.parent.getColumnByField(e[n]),o="null"===t[n]?null:t[n],a={field:e[n],predicate:"or",uid:s.uid,operator:"equal",type:s.type,matchCase:i.allowCaseSensitive,ignoreAccent:i.parent.filterSettings.ignoreAccent};""===o||sf.base.isNullOrUndefined(o)?r=r.concat($r.generateNullValuePredicates(a)):r.push(ci({},{value:o},a))}return $r.getPredicate(r)}function _r(e){for(var t=[],i=0,r=Object.keys(e);i<r.length;i++){var n=r[i];t.push(e[n])}return t}function Wr(e,t){for(var i=[],r=[],n=e;n>=0&&(!t[n].isCaptionRow||-1!==i.indexOf(t[n].data.field)||!(t[n].indent<t[e].indent||n===e)||(i.push(t[n].data.field),r.push(t[n].data.key),0!==t[n].indent));n--);return{fields:i,keys:r}}(e.Global||(e.Global={})).timer=null;var Kr,Qr,Xr,Yr,Jr,Zr,$r=function(){function e(e){this.existingPredicate={},this.foreignKeyQuery=new sf.data.Query,this.filterState=!0,this.values={},this.renderEmpty=!1,this.parent=e,this.id=this.parent.element.id,this.valueFormatter=new a(this.parent.locale),this.cBoxTrue=sf.buttons.createCheckBox(this.parent.createElement,!1,{checked:!0,label:" "}),this.cBoxFalse=sf.buttons.createCheckBox(this.parent.createElement,!1,{checked:!1,label:" "}),this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxTrue.firstChild),this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxFalse.firstChild),this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck"),this.parent.enableRtl&&sf.base.addClass([this.cBoxTrue,this.cBoxFalse],["e-rtl"])}return e.prototype.destroy=function(){this.closeDialog()},e.prototype.wireEvents=function(){sf.base.EventHandler.add(this.dlg,"click",this.clickHandler,this),sf.base.EventHandler.add(this.dlg,"keyup",this.keyupHandler,this),this.searchHandler=sf.base.debounce(this.searchBoxKeyUp,200);var e=this.dialogObj.element.querySelector(".e-searchinput");e&&sf.base.EventHandler.add(e,"keyup",this.searchHandler,this)},e.prototype.unWireEvents=function(){sf.base.EventHandler.remove(this.dlg,"click",this.clickHandler),sf.base.EventHandler.remove(this.dlg,"keyup",this.keyupHandler);var e=this.dialogObj.element.querySelector(".e-searchinput");e&&sf.base.EventHandler.remove(e,"keyup",this.searchHandler)},e.prototype.foreignKeyFilter=function(e,t,i){var r=this,n={},s=[],o=this.foreignKeyQuery.clone();this.options.column.dataSource.executeQuery(o.where(i)).then((function(i){r.options.column.columnData=i.result,r.parent.notify("generateQuery",{predicate:n,column:r.options.column}),e.ejpredicate=n.predicate.predicates;for(var o=n.predicate.predicates,a=0;a<o.length;a++)s.push({field:o[a].field,predicate:"or",matchCase:o[a].ignoreCase,ignoreAccent:o[a].ignoreAccent,operator:o[a].operator,value:o[a].value,type:r.options.type});e.filterCollection=s.length?s:t.filter((function(e){return e.field=r.options.field})),r.options.handler(e)}))},e.prototype.foreignFilter=function(e,t){var i=this.options.isRemote?"string"===this.options.column.type?"contains":"equal":this.options.column.type?"contains":"equal",r=new sf.data.Predicate(this.options.column.foreignKeyValue,i,t,!0,this.options.ignoreAccent);this.foreignKeyFilter(e,[e.filterCollection],r)},e.prototype.searchBoxClick=function(e){e.target.classList.contains("e-searchclear")&&(this.sInput.value="",this.refreshCheckboxes(),this.updateSearchIcon(),this.sInput.focus())},e.prototype.searchBoxKeyUp=function(e){this.refreshCheckboxes(),this.updateSearchIcon()},e.prototype.updateSearchIcon=function(){this.sInput.value.length?sf.base.classList(this.sIcon,["e-chkcancel-icon"],["e-search-icon"]):sf.base.classList(this.sIcon,["e-search-icon"],["e-chkcancel-icon"])},e.prototype.getLocalizedLabel=function(e){return this.localeObj.getConstant(e)},e.prototype.updateDataSource=function(){var e=this.options.dataSource;if(!(e instanceof sf.data.DataManager))for(var t=0;t<e.length;t++)if("object"!==i(e)){var r={};r[this.options.field]=e[t],e[t]=r}},e.prototype.updateModel=function(e){this.options=e,this.existingPredicate=e.actualPredicate||{},this.options.dataSource=e.dataSource,this.options.dataManager=e.dataManager?e.dataManager:e.dataSource,this.updateDataSource(),this.options.type=e.type,this.options.format=e.format||"",this.options.ignoreAccent=e.ignoreAccent||!1,this.options.filteredColumns=e.filteredColumns||this.parent.filterSettings.columns,this.options.query=e.query||new sf.data.Query,this.options.allowCaseSensitive=e.allowCaseSensitive||!1,this.options.uid=e.column.uid,this.values={},this.localeObj=e.localeObj,this.isFiltered=e.filteredColumns.length},e.prototype.getAndSetChkElem=function(e){if(this.dlg=this.parent.createElement("div",{id:this.id+this.options.type+"_excelDlg",attrs:{uid:this.options.column.uid},className:"e-checkboxfilter e-filter-popup"}),this.sBox=this.parent.createElement("div",{className:"e-searchcontainer"}),!e.hideSearchbox){this.sInput=this.parent.createElement("input",{id:this.id+"_SearchBox",className:"e-searchinput"}),this.sIcon=this.parent.createElement("span",{className:"e-searchclear e-search-icon e-icons e-input-group-icon",attrs:{type:"text",title:this.getLocalizedLabel("Search")}}),this.searchBox=this.parent.createElement("span",{className:"e-searchbox e-fields"}),this.searchBox.appendChild(this.sInput),this.sBox.appendChild(this.searchBox);var t={element:this.sInput,floatLabelType:"Never",properties:{placeholder:this.getLocalizedLabel("Search")}};sf.inputs.Input.createInput(t,this.parent.createElement),this.searchBox.querySelector(".e-input-group").appendChild(this.sIcon)}return this.spinner=this.parent.createElement("div",{className:"e-spinner"}),this.cBox=this.parent.createElement("div",{id:this.id+this.options.type+"_CheckBoxList",className:"e-checkboxlist e-fields"}),this.spinner.appendChild(this.cBox),this.sBox.appendChild(this.spinner),this.sBox},e.prototype.showDialog=function(e){var t={requestType:"filterbeforeopen",columnName:this.options.field,columnType:this.options.type,cancel:!1};if(t.filterModel=this,this.parent.notify("cbox-filter-begin",t),!t.cancel){this.dialogObj=new sf.popups.Dialog({visible:!1,content:this.sBox,close:this.closeDialog.bind(this),enableRtl:this.parent.enableRtl,width:!sf.base.isNullOrUndefined(yi(e.target,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:255,target:this.parent.element,animationSettings:{effect:"None"},buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:"e-flat",content:this.getLocalizedLabel(this.isExcel?"CancelButton":"ClearButton")}}],created:this.dialogCreated.bind(this),open:this.dialogOpen.bind(this)});if(this.dialogObj.isStringTemplate=!0,this.renderResponsiveFilter(e),this.dlg.setAttribute("aria-label",this.getLocalizedLabel("ExcelFilterDialogARIA")),e.isResponsiveFilter)document.querySelector(".e-responsive-dialog > .e-dlg-content > .e-mainfilterdiv").appendChild(this.dlg);else this.parent.element.appendChild(this.dlg);this.dialogObj.appendTo(this.dlg),this.dialogObj.element.style.maxHeight=e.isResponsiveFilter?"none":this.options.height+"px",this.dialogObj.show(),this.dialogObj.element.querySelector(".e-dlg-content").appendChild(this.sBox),this.wireEvents(),sf.popups.createSpinner({target:this.spinner},this.parent.createElement),sf.popups.showSpinner(this.spinner),this.getAllData()}},e.prototype.renderResponsiveFilter=function(e){e.isResponsiveFilter&&(this.dialogObj.buttons=[{}],this.dialogObj.position={X:"",Y:""},this.dialogObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-mainfilterdiv"),this.dialogObj.width="100%")},e.prototype.dialogCreated=function(e){this.options.isResponsiveFilter?this.dialogObj.element.style.left="0px":sf.base.Browser.isDevice?this.dialogObj.position={X:"center",Y:"center"}:Ui(this.options.target,this.dialogObj),this.parent.notify("filterDialogCreated",e)},e.prototype.openDialog=function(e){this.updateModel(e),this.getAndSetChkElem(e),this.showDialog(e)},e.prototype.closeDialog=function(){if(this.dialogObj&&!this.dialogObj.isDestroyed){this.isBlanks=!1;var e=this.options.columns.filter((function(e){return e.getFilterItemTemplate()})),t=this.parent.registeredTemplate;e.length&&!sf.base.isNullOrUndefined(t)&&t.filterItemTemplate&&this.parent.destroyTemplate(["filterItemTemplate"]),(this.parent.isReact||this.parent.isVue)&&void 0!==this.parent.destroyTemplate&&jr(this.parent,["filterItemTemplate"]),this.parent.notify(T,{field:this.options.field}),this.dialogObj.destroy(),this.unWireEvents(),sf.base.remove(this.dlg),this.dlg=null,this.parent.notify("filter-dialog-close",{})}},e.prototype.clearFilter=function(e){var t={instance:this,handler:this.clearFilter,cancel:!1};this.parent.notify(D,t),t.cancel||this.options.handler({action:"clear-filter",field:e?e.field:this.options.field})},e.prototype.btnClick=function(e){if(this.filterState){if("input"===e.target.tagName.toLowerCase()&&e.target.classList.contains("e-searchinput")){var t=e.target.value;"boolean"===this.options.column.type&&(""!==t&&-1!==this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(t.toLowerCase())?t=!0:""!==t&&-1!==this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(t.toLowerCase())&&(t=!1));var i={action:"filtering",filterCollection:{field:this.options.field,operator:this.options.isRemote?"string"===this.options.column.type?"contains":"equal":"date"===this.options.column.type||"datetime"===this.options.column.type||"boolean"===this.options.column.type?"equal":"contains",value:t,matchCase:!1,type:this.options.column.type,ignoreAccent:this.options.ignoreAccent},field:this.options.field};null!=t&&""!==t?this.isBlanks&&t&&"string"==typeof t&&this.getLocalizedLabel("Blanks").toLowerCase().indexOf(t.toLowerCase())>=0?this.fltrBtnHandler():this.isForeignColumn(this.options.column)?this.foreignFilter(i,t):this.options.handler(i):this.closeDialog()}else if(13===e.keyCode)this.fltrBtnHandler();else{var r=e.target.firstChild.textContent.toLowerCase();this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton").toLowerCase()===r?this.fltrBtnHandler():this.getLocalizedLabel("ClearButton").toLowerCase()===r&&this.clearFilter()}this.closeDialog()}else"input"!==e.target.tagName.toLowerCase()&&(this.clearFilter(),this.closeDialog())},e.prototype.fltrBtnHandler=function(){var t,i=[].slice.call(this.cBox.querySelectorAll(".e-check:not(.e-selectall)")),r=i,n="equal",s=this.dialogObj.element.querySelector(".e-dropdownlist");s&&(this.options.operator=n=s.ej2_instances[0].value),this.isMenuNotEqual="notequal"===this.options.operator,this.options.hideSearchbox||(t=this.searchBox.querySelector(".e-searchinput"));var o,a,l,h,d=this.options.allowCaseSensitive,p={field:this.options.field,predicate:this.isMenuNotEqual?"and":"or",uid:this.options.uid,operator:n,type:this.options.type,matchCase:d,ignoreAccent:this.options.ignoreAccent},c=this.itemsCnt!==i.length&&this.itemsCnt-i.length<i.length;c&&t&&""===t.value&&(n=this.isMenuNotEqual?"equal":"notequal",i=[].slice.call(this.cBox.querySelectorAll(".e-uncheck:not(.e-selectall)")),p.predicate=this.isMenuNotEqual?"or":"and",p.operator=n);var u=[];if(i.length!==this.itemsCnt||t&&t.value&&""!==t.value){for(var f=0;f<i.length;f++){o=this.values[yi(i[f],"e-ftrchk").getAttribute("uid")],h=sf.base.extend({},{value:o},p),o&&!o.toString().length&&(h.operator=c?"notequal":"equal"),""===o||sf.base.isNullOrUndefined(o)?u=u.concat(e.generateNullValuePredicates(p)):u.push(h);var g={instance:this,handler:this.fltrBtnHandler,arg1:h.field,arg2:h.predicate,arg3:h.operator,arg4:h.matchCase,arg5:h.ignoreAccent,arg6:h.value,cancel:!1};if(this.parent.notify(D,g),g.cancel)return}"date"!==this.options.type&&"datetime"!==this.options.type||(l=r.length-1,a=this.values[yi(r[l],"e-ftrchk").getAttribute("uid")],sf.base.isNullOrUndefined(a)&&c&&u.push({field:p.field,matchCase:p.matchCase,operator:"equal",predicate:"and",value:null})),this.initiateFilter(u)}else this.clearFilter()},e.generateNullValuePredicates=function(e){var t=[];return"string"===e.type&&t.push({field:e.field,ignoreAccent:e.ignoreAccent,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:""}),t.push({field:e.field,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:null}),t.push({field:e.field,matchCase:e.matchCase,operator:e.operator,predicate:e.predicate,value:void 0}),t},e.prototype.initiateFilter=function(e){var t,i=e[0];if(!sf.base.isNullOrUndefined(i)){t=i.ejpredicate?i.ejpredicate:new sf.data.Predicate(i.field,i.operator,i.value,!i.matchCase,i.ignoreAccent);for(var r=1;r<e.length;r++)t=void 0!==e[r].ejpredicate?t[e[r].predicate](e[r].ejpredicate):t[e[r].predicate](e[r].field,e[r].operator,e[r].value,!e[r].matchCase,e[r].ignoreAccent);var n={action:"filtering",filterCollection:e,field:this.options.field,ejpredicate:sf.data.Predicate.or(t)};this.options.handler(n)}},e.prototype.isForeignColumn=function(e){return!!e.isForeignColumn&&e.isForeignColumn()},e.prototype.refreshCheckboxes=function(){var t=this,i=this.sInput.value,r=this.options.column,n=this.isForeignColumn(r)?this.foreignKeyQuery.clone():this.options.query.clone(),s=this.options.query.clone(),o=n.queries.filter((function(e){return e&&"onWhere"===e.fn}))[0];n.queries=[],s.queries=[];var a="string"!==this.options.type&&parseFloat(i)?parseFloat(i):i,l=this.options.isRemote?"string"===this.options.type?"contains":"equal":this.options.type?"contains":"equal",h=this.options.ignoreAccent,d=this.isForeignColumn(r)?r.foreignKeyValue:r.field;a=""===a||void 0===a?void 0:a;var c,u=[],f={field:d,predicate:"or",uid:this.options.uid,operator:"equal",type:this.options.type,matchCase:!0,ignoreAccent:h},g=this.options.dataManager.adaptor.getModuleName;"boolean"===this.options.type&&(void 0!==a&&-1!==this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(a.toLowerCase())?a="true":void 0!==a&&-1!==this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(a.toLowerCase())&&(a="false"),void 0!==a&&-1!==this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(a.toLowerCase())&&g?(g(),a=!0):void 0!==a&&-1!==this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(a.toLowerCase())&&g&&(g(),a=!1),l="equal"),"date"!==this.options.type&&"datetime"!==this.options.type||(a=this.valueFormatter.fromView(i,this.options.parserFn,this.options.type)),this.addDistinct(n);var m={requestType:"filtersearchbegin",filterModel:this,columnName:d,column:r,operator:l,matchCase:!0,ignoreAccent:h,filterChoiceCount:null,query:n,value:a};this.parent.trigger(p,m,(function(p){if(p.operator=p.operator,c=new sf.data.Predicate(d,p.operator,a,p.matchCase,p.ignoreAccent),"date"===t.options.type||"datetime"===t.options.type){var g={field:d,operator:l="equal",value:a,matchCase:!0,ignoreAccent:h};sf.base.isNullOrUndefined(a)||(c=Yi(g,t.options.type))}if(i&&"string"==typeof i&&t.isBlanks&&t.getLocalizedLabel("Blanks").toLowerCase().indexOf(i.toLowerCase())>=0){u=u.concat(e.generateNullValuePredicates(f));var m=e.generatePredicate(u);m.predicates.push(c),n.where(m)}else i.length?(c=sf.base.isNullOrUndefined(o)?c:c.and(o.e),n.where(c)):sf.base.isNullOrUndefined(o)||n.where(o.e);p.filterChoiceCount=sf.base.isNullOrUndefined(p.filterChoiceCount)?1e3:p.filterChoiceCount;var y={};(sf.popups.showSpinner(t.spinner),t.renderEmpty=!1,t.isForeignColumn(r)&&i.length)?("result"in r.dataSource?new sf.data.DataManager(r.dataSource.result):r.dataSource).executeQuery(n).then((function(e){var i=t.options.column.columnData;t.options.column.columnData=e.result,t.parent.notify("generateQuery",{predicate:y,column:r}),y.predicate.predicates.length?s.where(y.predicate):t.renderEmpty=!0,t.options.column.columnData=i,s.take(p.filterChoiceCount),t.search(p,s)})):(n.take(p.filterChoiceCount),t.search(p,n))}))},e.prototype.search=function(e,t){this.parent.dataSource&&"result"in this.parent.dataSource?this.filterEvent(e,t):this.processSearch(t)},e.prototype.getPredicateFromCols=function(t){for(var i=e.getPredicate(t),r=[],n={},s=void 0!==this.parent.getForeignKeyColumns,o=s?this.parent.getForeignKeyColumns():[],a=0,l=Object.keys(i);a<l.length;a++){var h=l[a],d=void 0;s&&this.parent.getColumnByField(h).isForeignColumn()&&(d=Xi(h,o)),d?(this.parent.notify("generateQuery",{predicate:n,column:d}),n.predicate.predicates.length&&r.push(sf.data.Predicate.or(n.predicate.predicates))):r.push(i[h])}return r.length&&sf.data.Predicate.and(r)},e.prototype.getQuery=function(){return this.parent.getQuery?this.parent.getQuery().clone():new sf.data.Query},e.prototype.getAllData=function(){var e=this,t=this.getQuery();t.requiresCount(),this.addDistinct(t);var i={requestType:"filterchoicerequest",query:t,filterChoiceCount:null};i.filterModel=this,this.parent.trigger(p,i,(function(i){i.filterChoiceCount=sf.base.isNullOrUndefined(i.filterChoiceCount)?1e3:i.filterChoiceCount,t.take(i.filterChoiceCount),e.parent.dataSource&&"result"in e.parent.dataSource?e.filterEvent(i,t):e.processDataOperation(t,!0)}))},e.prototype.addDistinct=function(e){var t=sf.data.DataUtil.distinct(this.options.filteredColumns,"field");return t.indexOf(this.options.column.field)<=-1&&(t=t.concat(this.options.column.field)),e.distinct(t),e},e.prototype.filterEvent=function(e,t){var i=this,r=gr(e,t);this.parent.trigger("dataStateChange",r.state),r.deffered.promise.then((function(e){i.dataSuccess(e)}))},e.prototype.processDataOperation=function(e,t){var i=this;this.options.dataSource=this.options.dataSource instanceof sf.data.DataManager?this.options.dataSource:new sf.data.DataManager(this.options.dataSource);var r=[],n=[];if(this.isForeignColumn(this.options.column)&&t){var s="result"in this.options.column.dataSource?new sf.data.DataManager(this.options.column.dataSource.result):this.options.column.dataSource;this.foreignKeyQuery.params=e.params,r.push(s.executeQuery(this.foreignKeyQuery)),n.push((function(e){return i.foreignKeyData=e}))}r.push(this.options.dataSource.executeQuery(e)),n.push(this.dataSuccess.bind(this));var o=0;Promise.all(r).then((function(e){for(var t=0;t<e.length;t++)n[o++](e[t].result)}))},e.prototype.dataSuccess=function(t){this.fullData=t;var i={dataSource:this.fullData,executeQuery:!0,field:this.options.field};if(this.parent.notify("beforeCheckboxRenderer",i),i.executeQuery){var r=new sf.data.Query;if(this.parent.searchSettings&&this.parent.searchSettings.key.length){var n=this.parent.searchSettings,s=n.fields.length?n.fields:this.options.columns.map((function(e){return e.field}));r.search(n.key,s,n.operator,n.ignoreCase,n.ignoreAccent)}if(this.options.filteredColumns.length){for(var o=[],a=0;a<this.options.filteredColumns.length;a++){var l=this.options.filteredColumns[a];this.options.uid?(l.uid=l.uid||this.parent.getColumnByField(l.field).uid,l.uid!==this.options.uid&&o.push(this.options.filteredColumns[a])):l.field!==this.options.field&&o.push(this.options.filteredColumns[a])}var h=this.getPredicateFromCols(o);h&&r.where(h)}var d=new sf.data.DataManager(i.dataSource).executeLocal(r),p=this.options.column;this.filteredData=e.getDistinct(d,this.options.field,p,this.foreignKeyData).records||[]}var c=i.executeQuery?this.filteredData:i.dataSource;this.processDataSource(null,!0,c,i),this.sInput&&this.sInput.focus();var u={requestType:"filterafteropen",columnName:this.options.field,columnType:this.options.type};u.filterModel=this,this.parent.notify(z,u)},e.prototype.processDataSource=function(e,t,i,r){sf.popups.showSpinner(this.spinner),this.updateResult(),this.createFilterItems(i,t,r)},e.prototype.processSearch=function(e){this.processDataOperation(e)},e.prototype.updateResult=function(){this.result={};var e=this.getPredicateFromCols(this.options.filteredColumns),t=new sf.data.Query;e&&t.where(e),this.parent.notify("before-checkbox-renderer-query",{query:t});for(var i=0,r=new sf.data.DataManager(this.fullData).executeLocal(t);i<r.length;i++){var n=r[i];this.result[$i(this.options.field,n)]=!0}},e.prototype.clickHandler=function(e){var t=e.target,i=yi(t,"e-checkbox-wrapper");if(yi(t,"e-searchbox")&&this.searchBoxClick(e),i){var r=i.querySelector(".e-selectall");r?this.updateAllCBoxes(!r.classList.contains("e-check")):Vi(i.parentElement),this.updateIndeterminatenBtn(),i.querySelector(".e-chk-hidden").focus()}this.setFocus(yi(i,"e-ftrchk"))},e.prototype.keyupHandler=function(e){this.setFocus(yi(e.target,"e-ftrchk"))},e.prototype.setFocus=function(e){var t=this.dlg.querySelector(".e-chkfocus");t&&t.classList.remove("e-chkfocus"),e&&e.classList.add("e-chkfocus")},e.prototype.updateAllCBoxes=function(e){for(var t=0,i=[].slice.call(this.cBox.getElementsByClassName("e-frame"));t<i.length;t++){var r=i[t];Wi(r,e),Gi(r.previousSibling,e)}},e.prototype.dialogOpen=function(){this.parent.element.classList.contains("e-device")&&(this.dialogObj.element.querySelector(".e-input-group").classList.remove("e-input-focus"),this.options.isResponsiveFilter||this.dialogObj.element.querySelector(".e-btn").focus())},e.prototype.createCheckbox=function(e,t,i){var r=t?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0);Gi(r.querySelector("input"),t);var n=r.querySelector(".e-label"),s=rr({},i,{column:this.options.column,parent:this.parent});(n.innerHTML=!sf.base.isNullOrUndefined(e)&&e.toString().length?e:this.getLocalizedLabel("Blanks"),n.innerHTML===this.getLocalizedLabel("Blanks")&&(this.isBlanks=!0),"boolean"==typeof e&&(n.innerHTML=!0===e?this.getLocalizedLabel("FilterTrue"):this.getLocalizedLabel("FilterFalse")),sf.base.addClass([n],["e-checkboxfiltertext"]),this.options.template&&i[this.options.column.field]!==this.getLocalizedLabel("SelectAll"))&&(n.innerHTML="",this.parent.isReact&&this.options.column.filter&&"string"!=typeof this.options.column.filter.itemTemplate?(this.options.template(s,this.parent,"filterItemTemplate",null,null,null,n),this.parent.renderTemplates()):Fi(n,this.options.template(s,this.parent,"filterItemTemplate")));return r},e.prototype.updateIndeterminatenBtn=function(){var e,t=this.cBox.children.length-1,i=[],r=!1,n=this.cBox.querySelector(".e-selectall"),s=this.cBox.querySelectorAll(".e-check:not(.e-selectall)").length;this.options.isResponsiveFilter||((e=this.dialogObj.btnObj[0]).disabled=!1);var o=n.previousSibling;Gi(o,!1),o.indeterminate=!1,t===s?(i=["e-check"],Gi(o,!0)):s?(i=["e-stop"],o.indeterminate=!0):(i=["e-uncheck"],r=!0,e&&(e.disabled=!0)),e&&(this.filterState=!e.disabled,e.dataBind()),sf.base.removeClass([n],["e-check","e-stop","e-uncheck"]),sf.base.addClass([n],i),this.parent.notify("refresh-cutsom-filter-ok-button",{disabled:r})},e.prototype.createFilterItems=function(e,t,i){var r,n,s=this.parent.createElement("div"),o=!1;this.options.isResponsiveFilter||(n=this.dialogObj.btnObj[0]);var a=-1,l="ejValue";i.executeQuery||(l=i.field);for(var h=0;h<e.length;h++){var d=sf.base.getValue(l,e[h]);(""===d||sf.base.isNullOrUndefined(d))&&(a+=1)}if(this.itemsCnt=-1!==a?e.length-a:e.length,e.length&&!this.renderEmpty){var p=this.getLocalizedLabel("SelectAll"),c=this.cBox.querySelector(".e-checkfltrnmdiv");c&&c.classList.remove("e-checkfltrnmdiv");var u=this.createCheckbox(p,!1,((r={})[this.options.field]=p,r)),f=_i(Ri("cbox"),u,"e-ftrchk");f.querySelector(".e-frame").classList.add("e-selectall"),s.appendChild(f);var g=new sf.data.Predicate("field","equal",this.options.field);this.options.foreignKeyValue&&(g=g.or("field","equal",this.options.foreignKeyValue));var m=new sf.data.DataManager(this.options.filteredColumns).executeLocal((new sf.data.Query).where(g)).length,y=void 0;for(h=0;h<e.length;h++){var v=Ri("cbox");this.values[v]=sf.base.getValue(l,e[h]);var b=sf.base.getValue(this.options.field,e[h]);this.options.formatFn&&(b=this.valueFormatter.toView(b,this.options.formatFn));var C={value:b,column:this.options.column,data:e[h]};if(this.parent.notify("filter-cbox-value",C),""===(b=C.value)||sf.base.isNullOrUndefined(b)){if(y)continue;y=!0}var w=this.createCheckbox(b,this.getCheckedState(m,this.values[v]),sf.base.getValue("dataObj",e[h]));s.appendChild(_i(v,w,"e-ftrchk"))}this.cBox.innerHTML="",Fi(this.cBox,[].slice.call(s.children)),this.updateIndeterminatenBtn(),n&&(n.disabled=!1),o=!1}else s.appendChild(this.parent.createElement("span",{innerHTML:this.getLocalizedLabel("NoResult")})),this.cBox.innerHTML="",this.cBox.appendChild(this.parent.createElement("div",{className:"e-checkfltrnmdiv"})),Fi(this.cBox.children[0],[].slice.call(s.children)),n&&(n.disabled=!0),o=!0;n&&(this.filterState=!n.disabled,n.dataBind());var S={requestType:"filterchoicerequest",dataSource:this.renderEmpty?[]:e};S.filterModel=this,this.parent.notify(z,S),this.parent.notify("refresh-cutsom-filter-ok-button",{disabled:o}),sf.popups.hideSpinner(this.spinner)},e.prototype.getCheckedState=function(e,t){if(this.isFiltered&&e){var i=this.result[t];return"notequal"===this.options.operator?!i:i}return!0},e.getDistinct=function(e,t,i,r){for(var n,s=e.length,o=[],a={},l=!(!i||!i.isForeignColumn)&&i.isForeignColumn();s--;)if(!((n=$i(t,n=e[s]))in a)){var h={};if(h.ejValue=n,a[n]=!0,l){var d=Qi(i,{},n,r)[0];sf.base.setValue("foreignKeyData",d,e[s]),n=sf.base.getValue(i.foreignKeyValue,d)}sf.base.setValue(t,sf.base.isNullOrUndefined(n)?null:n,h),sf.base.setValue("dataObj",e[s],h),o.push(h)}return sf.data.DataUtil.group(sf.data.DataUtil.sort(o,t,sf.data.DataUtil.fnAscending),"ejValue")},e.getPredicate=function(t){for(var i=sf.data.DataUtil.distinct(t,"field",!0)||[],r=[],n={},s=0;s<i.length;s++)0!==(r=new sf.data.DataManager(t).executeLocal((new sf.data.Query).where("field","equal",i[s].field))).length&&(n[i[s].field]=e.generatePredicate(r));return n},e.generatePredicate=function(t){var i,r=t?t.length:0,n=e.updateDateFilter(t[0]);n.ignoreAccent=!sf.base.isNullOrUndefined(n.ignoreAccent)&&n.ignoreAccent,i="date"===n.type||"datetime"===n.type?Yi(n,n.type):n.ejpredicate?n.ejpredicate:new sf.data.Predicate(n.field,n.operator,n.value,!e.getCaseValue(n),n.ignoreAccent);for(var s=1;s<r;s++)t[s]=e.updateDateFilter(t[s]),r>2&&s>1&&"or"===t[s].predicate?"date"===t[s].type||"datetime"===t[s].type?i.predicates.push(Yi(t[s],t[s].type)):i.predicates.push(new sf.data.Predicate(t[s].field,t[s].operator,t[s].value,!e.getCaseValue(t[s]),t[s].ignoreAccent)):i="date"===t[s].type||"datetime"===t[s].type?"and"===t[s].predicate&&"equal"===t[s].operator?i.or(Yi(t[s],t[s].type),t[s].type,t[s].ignoreAccent):i[t[s].predicate](Yi(t[s],t[s].type),t[s].type,t[s].ignoreAccent):t[s].ejpredicate?i[t[s].predicate](t[s].ejpredicate):i[t[s].predicate](t[s].field,t[s].operator,t[s].value,!e.getCaseValue(t[s]),t[s].ignoreAccent);return i||null},e.getCaseValue=function(e){return sf.base.isNullOrUndefined(e.matchCase)?!("string"===e.type||sf.base.isNullOrUndefined(e.type)&&"string"==typeof e.value):e.matchCase},e.updateDateFilter=function(e){return("date"===e.type||"datetime"===e.type||e.value instanceof Date)&&(e.type=e.type||"date"),e},e}(),en=(Kr=function(e,t){return(Kr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Kr(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),tn=function(e){function t(t,i){var r=e.call(this,t)||this;return r.childRefs=[],r.eventHandlers={},r.isDevice=!1,r.customFilterOperators=i,r.isExcel=!0,r}return en(t,e),t.prototype.getCMenuDS=function(e,t){var i={number:["Equal","NotEqual","","LessThan","LessThanOrEqual","GreaterThan","GreaterThanOrEqual","Between","","CustomFilter"],string:["Equal","NotEqual","","StartsWith","EndsWith","","Contains","","CustomFilter"]};i.date=i.number,i.datetime=i.number;for(var r=[],n=0;n<i[e].length;n++)i[e][n].length?t?r.push({text:this.getLocalizedLabel(i[e][n])+"...",iconCss:"e-icons e-icon-check "+(t===i[e][n].toLowerCase()?"":"e-emptyicon")}):r.push({text:this.getLocalizedLabel(i[e][n])+"..."}):r.push({separator:!0});return r},t.prototype.destroy=function(){if(this.dlg&&(this.unwireExEvents(),e.prototype.closeDialog.call(this)),!this.isDevice&&this.menuObj){var t=this.menuObj.element.querySelector("li.e-focused");t&&yi(t,"e-excel-menu")||this.destroyCMenu()}this.dlgObj&&!this.dlgObj.isDestroyed&&this.removeDialog()},t.prototype.createMenu=function(e,t,i,r){this.menu=this.parent.createElement("div",{className:"e-contextmenu-wrapper"}),this.parent.enableRtl?this.menu.classList.add("e-rtl"):this.menu.classList.remove("e-rtl");var n=this.parent.createElement("ul"),s=t?"e-excl-filter-icon e-filtered":"e-excl-filter-icon";if(this.parent.allowSorting&&"grid"===this.parent.getModuleName()&&!this.options.isResponsiveFilter){var o=this.parent.getColumnHeaderByUid(r.uid).getAttribute("aria-sort"),a=this.parent.getColumnByField(r.field).allowSorting,l=a&&"ascending"!==o?"e-excel-ascending":"e-disabled e-excel-ascending",h=a&&"descending"!==o?"e-excel-descending":"e-disabled e-excel-descending",d="string"===e?this.getLocalizedLabel("SortAtoZ"):"datetime"===e||"date"===e?this.getLocalizedLabel("SortByOldest"):this.getLocalizedLabel("SortSmallestToLargest"),p="string"===e?this.getLocalizedLabel("SortZtoA"):"datetime"===e||"date"===e?this.getLocalizedLabel("SortByNewest"):this.getLocalizedLabel("SortLargestToSmallest");n.appendChild(this.createMenuElem(d,l,"e-sortascending")),n.appendChild(this.createMenuElem(p,h,"e-sortdescending"));var c=this.parent.createElement("li",{className:"e-separator e-menu-item e-excel-separator"});n.appendChild(c)}this.options.isResponsiveFilter||n.appendChild(this.createMenuElem(this.getLocalizedLabel("ClearFilter"),t?"":"e-disabled",s)),"boolean"!==e&&n.appendChild(this.createMenuElem(this.getLocalizedLabel({string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"}[e]),"e-submenu",i&&this.ensureTextFilter()?"e-icon-check":s+" e-emptyicon",!0)),this.menu.appendChild(n),this.parent.notify("before-filter-cmenu-open",{element:this.menu}),this.parent.notify("refresh-cutsom-filter-clear-button",{isFiltered:t})},t.prototype.createMenuElem=function(e,t,i,r){var n=this.parent.createElement("li",{className:t+" e-menu-item"});return n.innerHTML=e,n.insertBefore(this.parent.createElement("span",{className:"e-menu-icon e-icons "+i}),n.firstChild),r&&n.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),n},t.prototype.wireExEvents=function(){sf.base.EventHandler.add(this.dlg,"mouseover",this.hoverHandler,this),sf.base.EventHandler.add(this.dlg,"click",this.clickExHandler,this)},t.prototype.unwireExEvents=function(){sf.base.EventHandler.remove(this.dlg,"mouseover",this.hoverHandler),sf.base.EventHandler.remove(this.dlg,"click",this.clickExHandler)},t.prototype.clickExHandler=function(e){var t=yi(e.target,"e-menu-item");t&&(this.getLocalizedLabel("ClearFilter")===t.innerText.trim()?(this.clearFilter(),this.closeDialog()):this.options.isResponsiveFilter&&this.getLocalizedLabel({string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"}[this.options.type])===t.innerText.trim()&&this.hoverHandler(e))},t.prototype.destroyCMenu=function(){this.isCMenuOpen=!1,this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),sf.base.remove(this.cmenu),this.parent.notify("render-responsive-cmenu",{target:null,header:"",isOpen:!1,col:this.options.column}))},t.prototype.hoverHandler=function(e){if(!this.options.isResponsiveFilter||"mouseover"!==e.type){var t,i=e.target.querySelector(".e-contextmenu"),r=yi(e.target,"e-menu-item"),n=this.menu.querySelector(".e-focused");if(n&&n.classList.remove("e-focused"),r&&(r.classList.add("e-focused"),t=r.classList.contains("e-submenu")),!i){if(!t){var s=this.menu.querySelector(".e-submenu");sf.base.isNullOrUndefined(s)||s.classList.remove("e-selected"),this.destroyCMenu()}var o=this.ensureTextFilter();if(!this.isCMenuOpen&&t){r.classList.add("e-selected"),this.isCMenuOpen=!0;var a={items:this.getCMenuDS(this.options.type,o?o.replace(/\s/g,""):void 0),select:this.selectHandler.bind(this),onClose:this.destroyCMenu.bind(this),enableRtl:this.parent.enableRtl,beforeClose:this.preventClose.bind(this),cssClass:this.options.isResponsiveFilter?"e-res-contextmenu-wrapper":""};this.parent.element.appendChild(this.cmenu),this.menuObj=new sf.navigations.ContextMenu(a,this.cmenu);var l=this.menu.querySelector(".e-submenu").getBoundingClientRect(),h={top:0,left:0};if(this.options.isResponsiveFilter){var d=document.querySelector(".e-responsive-dialog > .e-dlg-header-content").offsetHeight+4;this.menuObj.element.style.height="calc(100% - "+d+"px)",this.menuObj.open(d,0,document.body);var p=this.getLocalizedLabel({string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"}[this.options.type]);this.parent.notify("render-responsive-cmenu",{target:this.menuObj.element.parentElement,header:p,isOpen:!0})}else{if(sf.base.Browser.isDevice){this.isDevice=!0;var c=this.getContextBounds();h.top=(window.innerHeight-c.height)/2,h.left=(window.innerWidth-c.width)/2,this.closeDialog(),this.isDevice=!1}else h.top=sf.base.Browser.isIE?window.pageYOffset+l.top:window.scrollY+l.top,h.left=this.getCMenuYPosition(this.dlg);this.menuObj.open(h.top,h.left,e.target)}hr(this.parent.element,this.menuObj.element.parentElement)}}}},t.prototype.ensureTextFilter=function(){var e,t=this.existingPredicate[this.options.field];return t&&2===t.length?e="greaterthanorequal"===t[0].operator&&"lessthanorequal"===t[1].operator?"between":"customfilter":t&&1===t.length&&(this.optrData=this.customFilterOperators[this.options.type+"Operator"],e=t[0].operator),e},t.prototype.preventClose=function(e){if(this.options&&this.options.isResponsiveFilter&&e.event){var t=e.event.target,i=t.classList.contains("e-resfilterback")||t.classList.contains("e-res-back-btn")||t.classList.contains("e-menu-item");e.cancel=!i}else e.event instanceof MouseEvent&&e.event.target.classList.contains("e-submenu")&&(e.cancel=!0)},t.prototype.getContextBounds=function(){return this.menuObj.element.style.display="block",this.menuObj.element.getBoundingClientRect()},t.prototype.getCMenuYPosition=function(e){var t=this.getContextBounds().width,i=e.getBoundingClientRect(),r=i.right+t-this.parent.element.clientWidth,n=e.offsetWidth-e.clientWidth;return n=n?n+1:0,r<1?i.right+1-n:i.left-t-1+n},t.prototype.openDialog=function(e){var t=this;this.updateModel(e),this.getAndSetChkElem(e),this.showDialog(e),this.dialogObj.dataBind();var i=this.existingPredicate[e.field]&&this.existingPredicate[e.field].length||this.options.filteredColumns.filter((function(e){return t.options.field===e.field})).length;this.createMenu(e.type,i>0,1===i||2===i,e),this.dlg.insertBefore(this.menu,this.dlg.firstChild),this.dlg.classList.add("e-excelfilter"),this.parent.enableRtl&&this.dlg.classList.add("e-rtl"),this.dlg.classList.remove("e-checkboxfilter"),this.cmenu=this.parent.createElement("ul",{className:"e-excel-menu"}),this.parent.notify("filterDialogCreated",{}),this.wireExEvents()},t.prototype.closeDialog=function(){this.destroy()},t.prototype.selectHandler=function(e){e.item&&(this.parent.notify("filter-cmenu-select",{}),this.menuItem=e.item,this.renderDialogue(e))},t.prototype.renderDialogue=function(e){var t=this,i=e?e.element:void 0,r=this.options.field,n=!sf.base.isNullOrUndefined(r)&&Oi(r),s=!sf.base.isNullOrUndefined(r)&&ki(r),o=this.parent.createElement("div",{className:"e-xlfl-maindiv",id:n?s+"-xlflmenu":r+"-xlflmenu"});(this.dlgDiv=this.parent.createElement("div",{className:"e-xlflmenu",id:n?s+"-xlfldlg":r+"-xlfldlg"}),this.options.isResponsiveFilter)?document.querySelector(".e-resfilter > .e-dlg-content > .e-xl-customfilterdiv").appendChild(this.dlgDiv):this.parent.element.appendChild(this.dlgDiv);this.dlgObj=new sf.popups.Dialog({header:this.getLocalizedLabel("CustomFilter"),isModal:!0,overlayClick:this.removeDialog.bind(this),showCloseIcon:!0,closeOnEscape:!1,target:document.body,visible:!1,enableRtl:this.parent.enableRtl,open:function(){var e=t.dlgObj.element.querySelector("table.e-xlfl-table>tr");t.options.column.filterTemplate&&e.querySelector("#"+t.options.column.field+"-xlfl-frstvalue").focus()},close:this.removeDialog.bind(this),created:this.createdDialog.bind(this,i,r),buttons:[{click:this.filterBtnClick.bind(this,r),buttonModel:{content:this.getLocalizedLabel("OKButton"),isPrimary:!0,cssClass:"e-xlfl-okbtn"}},{click:this.removeDialog.bind(this),buttonModel:{content:this.getLocalizedLabel("CancelButton"),cssClass:"e-xlfl-cancelbtn"}}],content:o,width:430,animationSettings:{effect:"None"}});this.dlgObj.isStringTemplate=!0,this.renderResponsiveDialog(),this.dlgDiv.setAttribute("aria-label",this.getLocalizedLabel("CustomFilterDialogARIA")),this.childRefs.push(this.dlgObj),this.dlgObj.appendTo(this.dlgDiv)},t.prototype.renderResponsiveDialog=function(){if(this.options.isResponsiveFilter){var e=document.querySelector(".e-row-responsive-filter");e&&e.classList.remove("e-row-responsive-filter"),this.dlgObj.buttons=[{}],this.dlgObj.header=void 0,this.dlgObj.position={X:"",Y:""},this.dlgObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-xl-customfilterdiv"),this.dlgObj.width="100%",this.dlgObj.isModal=!1,this.dlgObj.showCloseIcon=!1}},t.prototype.removeDialog=function(){this.parent.notify("custom-filter-close",{}),(this.parent.isReact||this.parent.isVue)&&void 0!==this.parent.destroyTemplate&&jr(this.parent,["filterTemplate"]),this.removeObjects(this.childRefs),sf.base.remove(this.dlgDiv),this.parent.notify("filter-dialog-close",{})},t.prototype.createdDialog=function(e,t){if(this.renderCustomFilter(e,t),this.dlgObj.element.style.left="0px",this.options.isResponsiveFilter){var i=document.querySelector(".e-responsive-dialog > .e-dlg-header-content").offsetHeight+4;this.dlgObj.element.style.top=i+"px"}else this.dlgObj.element.style.top="0px";!this.options.isResponsiveFilter&&sf.base.Browser.isDevice&&window.innerWidth<440&&(this.dlgObj.element.style.width="90%"),this.parent.notify("beforeCustomFilterOpen",{column:t,dialog:this.dialogObj}),this.dlgObj.show(),hr(this.parent.element,this.dlgObj.element.parentElement)},t.prototype.renderCustomFilter=function(e,t){var i=this.dlgObj.element.querySelector(".e-xlfl-maindiv"),r=this.parent.createElement("div",{innerHTML:this.getLocalizedLabel("ShowRowsWhere"),className:"e-xlfl-dlgfields"});i.appendChild(r);var n=this.parent.createElement("div",{innerHTML:this.options.displayName,className:"e-xlfl-fieldset"});i.appendChild(n),this.renderFilterUI(t,i)},t.prototype.filterBtnClick=function(e){var t,i=!sf.base.isNullOrUndefined(e)&&Oi(e),r=!sf.base.isNullOrUndefined(e)&&ki(e),n=i?r:e,s=this.dlgDiv.querySelector("#"+n+"-xlfl-frstvalue").ej2_instances[0],o=this.dlgDiv.querySelector("#"+n+"-xlfl-frstoptr").ej2_instances[0],a=this.dlgDiv.querySelector("#"+n+"-xlfl-secndvalue").ej2_instances[0],l=this.dlgDiv.querySelector("#"+n+"-xlfl-secndoptr").ej2_instances[0];"string"===this.options.type&&(t=this.dlgDiv.querySelector("#"+n+"-xlflmtcase").ej2_instances[0].checked);var h=this.dlgDiv.querySelector("#"+n+"e-xlfl-frstpredicate").ej2_instances[0].checked?"and":"or";null===a.value&&(h="or"),this.filterByColumn(this.options.field,o.value,s.value,h,t,this.options.ignoreAccent,l.value,a.value),this.removeDialog()},t.prototype.filterByColumn=function(e,t,i,r,n,s,o,a){var l,h=this.parent.getColumnByField?this.parent.getColumnByField(e):this.options.column,d=this.isForeignColumn(h)?h.foreignKeyValue:e,p=[];p.push({field:d,predicate:r,matchCase:n,ignoreAccent:s,operator:t,value:i,type:this.options.type});var c={instance:this,handler:this.filterByColumn,arg1:e,arg2:t,arg3:i,arg4:r,arg5:n,arg6:s,arg7:o,arg8:a,cancel:!1};if(this.parent.notify(D,c),!c.cancel){l=new sf.data.Predicate(d,t.toLowerCase(),i,!n,s),sf.base.isNullOrUndefined(a)||sf.base.isNullOrUndefined(o)||(p.push({field:d,predicate:r,matchCase:n,ignoreAccent:s,operator:o,value:a,type:this.options.type}),l=l[r](d,o.toLowerCase(),a,!n,s));var u={action:"filtering",filterCollection:p,field:this.options.field,ejpredicate:l,actualPredicate:p};this.isForeignColumn(h)?this.foreignKeyFilter(u,p,l):this.options.handler(u)}},t.prototype.renderOperatorUI=function(e,t,i,r,n){var s=this.parent.createElement("tr",{className:"e-xlfl-fields"});t.appendChild(s);var o=this.parent.createElement("td",{className:"e-xlfl-optr"});s.appendChild(o);var a=this.parent.createElement("div",{className:"e-xlfl-optrdiv"}),l=!sf.base.isNullOrUndefined(e)&&Oi(e),h=!sf.base.isNullOrUndefined(e)&&ki(e),d=this.parent.createElement("input",{id:l?h+i:e+i});a.appendChild(d),o.appendChild(a);var p=this.options.type+"Operator",c=this.customFilterOperators[p];this.optrData=c;var u=this.dropSelectedVal(this.options.column,r,n),f="";this.menuItem&&((f=this.menuItem.text.slice(0,-3))!==this.getLocalizedLabel("CustomFilter")&&(u=n?f:void 0),f===this.getLocalizedLabel("Between")&&(u=this.getLocalizedLabel(n?"GreaterThanOrEqual":"LessThanOrEqual")));var g=this.options.column,m=new sf.dropdowns.DropDownList(ci({dataSource:c,fields:{text:"text",value:"value"},text:u,enableRtl:this.parent.enableRtl},g.filter.params));this.childRefs.push(m);var y={open:this.dropDownOpen.bind(this),change:this.dropDownValueChange.bind(this)};return Hr(d.id,[ae,"change"],y,this),m.addEventListener(ae,this.eventHandlers[d.id][ae]),m.addEventListener("change",this.eventHandlers[d.id].change),m.appendTo(d),{fieldElement:s,operator:this.getSelectedValue(u)}},t.prototype.removeHandlersFromComponent=function(e){e.element.classList.contains("e-dropdownlist")?Ur(e,[ae,"change"],this):e.element.classList.contains("e-autocomplete")&&Ur(e,[c,"focus"],this)},t.prototype.dropDownOpen=function(e){e.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()},t.prototype.dropDownValueChange=function(e){e.element.id.includes("-xlfl-frstoptr")?this.firstOperator=e.value.toString():this.secondOperator=e.value.toString()},t.prototype.getFilterUIInfo=function(){return{firstOperator:this.firstOperator,secondOperator:this.secondOperator,field:this.options.field}},t.prototype.getSelectedValue=function(e){var t=new sf.data.DataManager(this.optrData).executeLocal((new sf.data.Query).where("text","equal",e));return sf.base.isNullOrUndefined(t[0])?"":t[0].value},t.prototype.dropSelectedVal=function(e,t,i){var r;return r=t&&t.length>0?2===t.length?i?t[0].operator:t[1].operator:i?t[0].operator:void 0:i&&"string"===e.type&&!e.filter.operator?"startswith":i?e.filter.operator||"equal":void 0,this.getSelectedText(r)},t.prototype.getSelectedText=function(e){var t=new sf.data.DataManager(this.optrData).executeLocal((new sf.data.Query).where("value","equal",e));return sf.base.isNullOrUndefined(t[0])?"":t[0].text},t.prototype.renderFilterUI=function(e,t){var i=this.existingPredicate[e],r=this.parent.createElement("table",{className:"e-xlfl-table"});t.appendChild(r);var n=this.parent.createElement(oe);n.innerHTML='<col style="width: 50%"></col><col style="width: 50%"></col>',r.appendChild(n);var s=this.renderOperatorUI(e,r,"-xlfl-frstoptr",i,!0);this.firstOperator=s.operator,this.renderFlValueUI(e,s,"-xlfl-frstvalue",i,!0);var o=this.parent.createElement("tr",{className:"e-xlfl-predicate"});r.appendChild(o),this.renderRadioButton(e,o,i),s=this.renderOperatorUI(e,r,"-xlfl-secndoptr",i,!1),this.secondOperator=s.operator,this.renderFlValueUI(e,s,"-xlfl-secndvalue",i,!1)},t.prototype.renderRadioButton=function(e,t,i){var r=this.parent.createElement("td",{className:"e-xlfl-radio",attrs:{colSpan:"2"}});t.appendChild(r);var n=this.parent.createElement("div",{className:"e-xlfl-radiodiv",attrs:{style:"display: inline-block"}}),s=!sf.base.isNullOrUndefined(e)&&Oi(e),o=!sf.base.isNullOrUndefined(e)&&ki(e),a=this.parent.createElement("input",{id:s?o+"e-xlfl-frstpredicate":e+"e-xlfl-frstpredicate",attrs:{type:"radio"}}),l=this.parent.createElement("input",{id:s?o+"e-xlfl-secndpredicate":e+"e-xlfl-secndpredicate",attrs:{type:"radio"}});n.appendChild(a),n.appendChild(l),r.appendChild(n),"string"===this.options.type&&this.renderMatchCase(e,t,r,"-xlflmtcase",i);var h=new sf.buttons.RadioButton({label:this.getLocalizedLabel("AND"),name:"default",checked:!0,enableRtl:this.parent.enableRtl});this.childRefs.push(h);var d=new sf.buttons.RadioButton({label:this.getLocalizedLabel("OR"),name:"default",enableRtl:this.parent.enableRtl});this.childRefs.push(d),"and"===(i&&2===i.length?i[1].predicate:"and")?(h.checked=!0,d.checked=!1):(d.checked=!0,h.checked=!1),h.appendTo(a),d.appendTo(l),h.element.nextElementSibling.classList.add("e-xlfl-radio-and"),d.element.nextElementSibling.classList.add("e-xlfl-radio-or")},t.prototype.removeObjects=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];r&&!r.isDestroyed&&(this.removeHandlersFromComponent(r),r.destroy())}},t.prototype.renderFlValueUI=function(e,t,i,r,n){var s=this.parent.createElement("td",{className:"e-xlfl-value"});t.fieldElement.appendChild(s);var o=!sf.base.isNullOrUndefined(e)&&Oi(e),a=!sf.base.isNullOrUndefined(e)&&ki(e),l=this.parent.createElement("div",{className:"e-xlfl-valuediv"}),h=this.options.filteredColumns.some((function(t){return e===t.field})),d=this.options.filteredColumns.filter((function(t){return t.field===e}));if(this.options.column.filterTemplate){var p={},c=this.options.column;h&&i&&(p=this.getExcelFilterData(i,p,c,r,d));var u=this.parent.isReact&&"string"!=typeof this.options.column.filterTemplate,f=this.parent.element.id+c.uid+"filterTemplate";if(u)this.options.column.getFilterTemplate()(p,this.parent,"filterTemplate",f,null,null,l),this.parent.renderTemplates();else Fi(l,this.options.column.getFilterTemplate()(p,this.parent,"filterTemplate",f));(this.parent.isAngular?l.children[0]:l.querySelector("input")).id=o?a+i:e+i,s.appendChild(l)}else{var g=this.parent.createElement("input",{id:o?a+i:e+i});l.appendChild(g),s.appendChild(l);var m=void 0,y=void 0;r&&r.length>0&&(m=(y=2===r.length?n?r[0]:r[1]:n?r[0]:void 0)&&y.operator===t.operator?y.value:void 0,sf.base.isNullOrUndefined(m)&&(m=void 0)),{string:this.renderAutoComplete.bind(this),number:this.renderNumericTextBox.bind(this),date:this.renderDate.bind(this),datetime:this.renderDateTime.bind(this)}[this.options.type](this.options,e,g,m,this.parent.enableRtl)}},t.prototype.getExcelFilterData=function(e,t,i,r,n){var s="-xlfl-frstvalue"===e?0:1;if("-xlfl-frstvalue"===e||n.length>1){t={column:r instanceof Array?r[s]:r};var o=this.options.column.columnData&&n.length>1?1===this.options.column.columnData.length?0:1:s;t[this.options.field]=i.foreignKeyValue?this.options.column.columnData[o][i.foreignKeyValue]:n[o].value,this.options.foreignKeyValue&&(t[this.options.foreignKeyValue]=this.options.column.columnData[o][i.foreignKeyValue])}return t},t.prototype.renderMatchCase=function(e,t,i,r,n){var s=this.parent.createElement("div",{className:"e-xlfl-matchcasediv",attrs:{style:"display: inline-block"}}),o=!sf.base.isNullOrUndefined(e)&&Oi(e),a=!sf.base.isNullOrUndefined(e)&&ki(e),l=this.parent.createElement("input",{id:o?a+r:e+r,attrs:{type:"checkbox"}});s.appendChild(l),i.appendChild(s);var h=!!(n&&n.length>0)&&(n&&2===n.length?n[1].matchCase:n[0].matchCase),d=new sf.buttons.CheckBox({label:this.getLocalizedLabel("MatchCase"),enableRtl:this.parent.enableRtl,checked:h});this.childRefs.push(d),d.appendTo(l)},t.prototype.renderDate=function(e,t,i,r,n){var s=er(e.format,e.type),o=new sf.calendars.DatePicker(ci({format:s,cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:n,value:new Date(r),locale:this.parent.locale},e.column.filter.params));this.childRefs.push(o),o.appendTo(i)},t.prototype.renderDateTime=function(e,t,i,r,n){var s=er(e.format,e.type),o=new sf.calendars.DateTimePicker(ci({format:s,cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:n,value:new Date(r),locale:this.parent.locale},e.column.filter.params));this.childRefs.push(o),o.appendTo(i)},t.prototype.completeAction=function(e){e.result=Hi(e.result)},t.prototype.renderNumericTextBox=function(e,t,i,r,n){var s=new sf.inputs.NumericTextBox(ci({format:e.format,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:n,value:r,locale:this.parent.locale},e.column.filter.params));this.childRefs.push(s),s.appendTo(i)},t.prototype.renderAutoComplete=function(e,t,i,r,n){var s=this.options.column,o=this.isForeignColumn(s),a=o?s.dataSource:e.dataSource,l={value:o?s.foreignKeyValue:t},h=new sf.dropdowns.AutoComplete(ci({dataSource:a instanceof sf.data.DataManager?a:new sf.data.DataManager(a),fields:l,query:this.getQuery(),sortOrder:"Ascending",locale:this.parent.locale,cssClass:"e-popup-flmenu",autofill:!0,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:n,text:r},s.filter.params));if(a&&"result"in a){var d=gr({requestType:"stringfilterrequest"},this.getQuery());this.parent.trigger("dataStateChange",d.state),d.deffered.promise.then((function(e){h.dataSource=new sf.data.DataManager(e)}))}this.childRefs.push(h);var p={actionComplete:this.acActionComplete(h,t),focus:this.acFocus(h,t,e,i)};Hr(i.id,[c,"focus"],p,this),h.addEventListener("focus",this.eventHandlers[i.id].focus),h.addEventListener(c,this.eventHandlers[i.id][c]),h.appendTo(i)},t.prototype.acActionComplete=function(e,t){return function(i){var r=!sf.base.isNullOrUndefined(t)&&Oi(t);i.result=i.result.filter((function(t,i,n){return n.map((function(t){return r?Ar(e.fields.value,t):t[e.fields.value]})).indexOf(r?Ar(e.fields.value,t):t[e.fields.value])===i}))}},t.prototype.acFocus=function(e,t,i,r){var n=this;return function(){var s=!sf.base.isNullOrUndefined(t)&&Oi(t),o=!sf.base.isNullOrUndefined(t)&&ki(t),a=s?o:t;e.filterType=n.dlgDiv.querySelector("#"+a+(r.id===a+"-xlfl-frstvalue"?"-xlfl-frstoptr":"-xlfl-secndoptr")).ej2_instances[0].value,e.ignoreCase="string"!==i.type||!n.dlgDiv.querySelector("#"+a+"-xlflmtcase").ej2_instances[0].checked,e.filterType=sf.base.isNullOrUndefined(e.filterType)?"equal":e.filterType}},t}($r),rn=function(){function t(e,t,i,r){this.contentRefresh=!0,this.isModelChanged=!0,this.aria=new be,this.currentTarget=null,this.parent=e,this.sortSettings=t,this.sortedColumns=i,this.serviceLocator=r,this.focus=r.getService("focus"),this.addEventListener(),this.setFullScreenDialog()}return t.prototype.updateModel=function(){var e,t={field:this.columnName,direction:this.direction},i=this.parent.groupSettings.columns,r=!1;if(this.isMultiSort)(e=this.getSortedColsIndexByField(this.columnName))>-1&&this.sortSettings.columns.splice(e,1),this.sortSettings.columns.push(t),this.sortSettings.columns=this.sortSettings.columns;else if(i.length){for(var n=[],s=0,o=i.length;s<o;s++)if(e=this.getSortedColsIndexByField(i[s],n),this.columnName===i[s])r=!0,n.push(t);else{var a=this.getSortColumnFromField(i[s]);n.push({field:a.field,direction:a.direction,isFromGroup:a.isFromGroup})}r||n.push(t),this.sortSettings.columns=n}else this.sortSettings.columns=[t];this.parent.dataBind(),this.lastSortedCol=this.columnName},t.prototype.onActionComplete=function(e){var t=this.isRemove?{requestType:"sorting",type:c}:{columnName:this.columnName,direction:this.direction,requestType:"sorting",type:c};this.isRemove=!1,this.parent.trigger(c,sf.base.extend(e,t))},t.prototype.sortColumn=function(e,t,i){var r=this.parent;!1===this.parent.getColumnByField(e).allowSorting||this.parent.isContextMenuOpen()?this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:e}):(r.allowMultiSorting||(i=r.allowMultiSorting),this.isActionPrevent()?r.notify(I,{instance:this,handler:this.sortColumn,arg1:e,arg2:t,arg3:i}):(this.backupSettings(),this.columnName=e,this.direction=t,this.isMultiSort=i,this.removeSortIcons(),this.updateSortedCols(e,i),this.updateModel()))},t.prototype.setFullScreenDialog=function(){this.serviceLocator&&this.serviceLocator.registerAdaptiveService(this,this.parent.enableAdaptiveUI,e.ResponsiveDialogAction.isSort)},t.prototype.backupSettings=function(){this.lastSortedCols=hi(this.sortSettings.columns),this.lastCols=this.sortedColumns},t.prototype.restoreSettings=function(){this.isModelChanged=!1,this.isMultiSort=!0,this.parent.setProperties({sortSettings:{columns:this.lastSortedCols}},!0),this.sortedColumns=this.lastCols,this.isModelChanged=!0},t.prototype.updateSortedCols=function(e,t){if(!t)if(this.parent.allowGrouping)for(var i=0,r=this.sortedColumns.length;i<r;i++)this.parent.groupSettings.columns.indexOf(this.sortedColumns[i])<0&&(this.sortedColumns.splice(i,1),r--,i--);else this.sortedColumns.splice(0,this.sortedColumns.length);this.sortedColumns.indexOf(e)<0&&this.sortedColumns.push(e)},t.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName()){if(this.contentRefresh){var t=this.sortSettings.columns.length?{columnName:this.columnName,direction:this.direction,requestType:"sorting",type:p,target:this.currentTarget,cancel:!1}:{requestType:"sorting",type:p,cancel:!1,target:this.currentTarget};this.parent.notify(w,t)}this.refreshSortSettings(),this.removeSortIcons(),this.addSortIcons()}},t.prototype.refreshSortSettings=function(){this.sortedColumns.length=0;for(var e=this.sortSettings.columns,t=0;t<e.length;t++)e[t].isFromGroup||this.sortedColumns.push(e[t].field)},t.prototype.clearSorting=function(){var e=Ci(this.sortSettings.columns);if(this.isActionPrevent())this.parent.notify(I,{instance:this,handler:this.clearSorting});else for(var t=0,i=e.length;t<i;t++)this.removeSortColumn(e[t].field)},t.prototype.isActionPrevent=function(){return Ni(this.parent)},t.prototype.removeSortColumn=function(e){var t=this.parent,i=this.sortSettings.columns;if(!(0===i.length&&this.sortedColumns.indexOf(e)<0))if(this.isActionPrevent())this.parent.notify(I,{instance:this,handler:this.removeSortColumn,arg1:e});else{this.backupSettings(),this.removeSortIcons();for(var r={requestType:"sorting",type:p,target:this.currentTarget},n=0,s=i.length;n<s;n++)if(i[n].field===e){if(t.allowGrouping&&t.groupSettings.columns.indexOf(i[n].field)>-1)continue;this.sortedColumns.splice(this.sortedColumns.indexOf(i[n].field),1),i.splice(n,1),this.isRemove=!0,this.isModelChanged&&this.parent.notify(w,r);break}r.cancel||this.addSortIcons()}},t.prototype.getSortedColsIndexByField=function(e,t){for(var i=t||this.sortSettings.columns,r=0,n=i.length;r<n;r++)if(i[r].field===e)return r;return-1},t.prototype.getModuleName=function(){return"sort"},t.prototype.initialEnd=function(){if(this.parent.off(y,this.initialEnd),this.parent.getColumns().length&&this.sortSettings.columns.length){var e=this.parent;this.contentRefresh=!1,this.isMultiSort=this.sortSettings.columns.length>1;for(var t=0,i=e.sortSettings.columns.slice();t<i.length;t++){var r=i[t];this.sortedColumns.indexOf(r.field)>-1&&this.sortColumn(r.field,r.direction,!0)}this.isMultiSort=!1,this.contentRefresh=!0}},t.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:"set-fullscreen-dialog",handler:this.setFullScreenDialog},{event:y,handler:this.initialEnd},{event:"sorting-complete",handler:this.onActionComplete},{event:C,handler:this.onPropertyChanged},{event:R,handler:this.clickHandler},{event:S,handler:this.refreshSortIcons},{event:x,handler:this.keyPressed},{event:"cancel-Begin",handler:this.cancelBeginEvent},{event:F,handler:this.destroy}],Nr(this.parent,this.evtHandlers,!0,this))},t.prototype.removeEventListener=function(){this.parent.isDestroyed||Nr(this.parent,this.evtHandlers,!1)},t.prototype.destroy=function(){this.isModelChanged=!1;var e=this.parent.element;e&&(e.querySelector("."+H)||e.querySelector("."+U))&&(this.parent.element.querySelector(".e-gridpopup").getElementsByClassName("e-sortdirect").length&&(this.parent.element.querySelector(".e-gridpopup").style.display="none"),this.parent.refreshing||!this.parent.isDestroyed&&this.parent.allowSorting||this.clearSorting(),this.isModelChanged=!0,this.removeEventListener())},t.prototype.cancelBeginEvent=function(e){"sorting"===e.requestType&&(this.restoreSettings(),this.refreshSortIcons(),this.isMultiSort=!0)},t.prototype.clickHandler=function(e){var t=this.parent;this.currentTarget=null,this.popUpClickHandler(e);var i=sf.base.closest(e.target,".e-headercell");if(i&&!e.target.classList.contains("e-grptogglebtn")&&!i.classList.contains("e-resized")&&!e.target.classList.contains("e-rhandler")&&!e.target.classList.contains("e-columnmenu")&&!e.target.classList.contains("e-filtermenudiv")&&!yi(e.target,"e-stackedheadercell")&&!(t.allowSelection&&t.selectionSettings.allowColumnSelection&&e.target.classList.contains("e-headercell"))){var r=this.parent.getColumnByUid(i.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));"checkbox"!==r.type&&(this.initiateSort(i,e,r),sf.base.Browser.isDevice&&this.showPopUp(e))}if(i&&i.classList.remove("e-resized"),yi(e.target,"e-excel-ascending")||yi(e.target,"e-excel-descending")){var n=sf.base.closest(e.target,".e-filter-popup").getAttribute("uid"),s=sf.base.isNullOrUndefined(yi(e.target,"e-excel-descending"))?"Ascending":"Descending";this.sortColumn(t.getColumnByUid(n).field,s,!1)}},t.prototype.keyPressed=function(e){var t=e.target;if(!this.parent.isEdit&&("enter"===e.action||"ctrlEnter"===e.action||"shiftEnter"===e.action)&&sf.base.closest(t,".e-headercell")){var i=this.focus.getFocusedElement();if(sf.base.isNullOrUndefined(i)||!i.classList.contains("e-headercell")||!i.querySelector(".e-headercelldiv"))return;var r=this.parent.getColumnByUid(i.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));this.initiateSort(i,e,r)}},t.prototype.initiateSort=function(e,t,i){var r=this.parent,n=i.field;this.currentTarget=t.target;var s=e.getElementsByClassName("e-ascending").length?"Descending":"Ascending";this.isMultiSort=t.ctrlKey||this.enableSortMultiTouch||-1!==navigator.userAgent.indexOf("Mac OS")&&t.metaKey,t.shiftKey||this.sortSettings.allowUnsort&&e.getElementsByClassName("e-descending").length&&!(r.groupSettings.columns.indexOf(n)>-1)?this.removeSortColumn(n):this.sortColumn(n,s,this.isMultiSort)},t.prototype.showPopUp=function(e){var t=sf.base.closest(e.target,".e-headercell");!this.parent.allowMultiSorting||sf.base.isNullOrUndefined(t)&&!this.parent.isContextMenuOpen()||gi(this.parent.element.querySelector(".e-gridpopup"),e,"e-sortdirect e-icons e-icon-sortdirect"+(this.sortedColumns.length>1?" e-spanclicked":""))},t.prototype.popUpClickHandler=function(e){var t=e.target;sf.base.closest(t,".e-headercell")||e.target.classList.contains(q)||sf.base.closest(t,".e-gridpopup")?t.classList.contains("e-sortdirect")&&(t.classList.contains("e-spanclicked")?(t.classList.remove("e-spanclicked"),this.enableSortMultiTouch=!1,this.parent.element.querySelector(".e-gridpopup").style.display="none"):(t.classList.add("e-spanclicked"),this.enableSortMultiTouch=!0)):this.parent.element.querySelector(".e-gridpopup").style.display="none"},t.prototype.addSortIcons=function(){for(var e,t,i=this.parent,r=this.sortSettings.columns,n=this.parent.getColumns().map((function(e){return e.field})),s=0,o=r.length;s<o;s++)e=i.getColumnHeaderByField(r[s].field),-1===n.indexOf(r[s].field)||sf.base.isNullOrUndefined(e)||(this.aria.setSort(e,r[s].direction.toLowerCase()),this.isMultiSort&&r.length>1&&e.querySelector(".e-headercelldiv").insertBefore(this.parent.createElement("span",{className:"e-sortnumber",innerHTML:(s+1).toString()}),e.querySelector(".e-headertext")),t=e.querySelector(".e-sortfilterdiv"),"Ascending"===r[s].direction?sf.base.classList(t,["e-ascending","e-icon-ascending"],[]):sf.base.classList(t,["e-descending","e-icon-descending"],[]))},t.prototype.removeSortIcons=function(e){for(var t,i=this.parent,r=this.sortSettings.columns,n=this.parent.getColumns().map((function(e){return e.field})),s=e||0,o=sf.base.isNullOrUndefined(e)?r.length:e+1;s<o;s++)t=i.getColumnHeaderByField(r[s].field),sf.base.isNullOrUndefined(t)||i.allowGrouping&&i.groupSettings.columns.indexOf(r[s].field)>-1&&!t.querySelector(".e-sortfilterdiv")||-1!==n.indexOf(r[s].field)&&(this.aria.setSort(t,"none"),sf.base.classList(t.querySelector(".e-sortfilterdiv"),[],["e-descending","e-icon-descending","e-ascending","e-icon-ascending"]),t.querySelector(".e-sortnumber")&&t.querySelector(".e-headercelldiv").removeChild(t.querySelector(".e-sortnumber")))},t.prototype.getSortColumnFromField=function(e){for(var t=0,i=this.sortSettings.columns.length;t<i;t++)if(this.sortSettings.columns[t].field===e)return this.sortSettings.columns[t];return!1},t.prototype.updateAriaAttr=function(){for(var e=this.parent.getColumns().map((function(e){return e.field})),t=0,i=this.sortedColumns;t<i.length;t++){var r=i[t];if(-1!==e.indexOf(r)){var n=this.parent.getColumnHeaderByField(r);this.aria.setSort(n,this.getSortColumnFromField(r).direction)}}},t.prototype.refreshSortIcons=function(e){void 0===e&&(e={args:{isFrozen:!1}}),e.args.isFrozen||(this.removeSortIcons(),this.isMultiSort=!0,this.removeSortIcons(),this.addSortIcons(),this.isMultiSort=!1,this.updateAriaAttr())},t.prototype.showCustomSort=function(e){this.responsiveDialogRenderer.isCustomDialog=e,this.responsiveDialogRenderer.showResponsiveDialog()},t}(),nn=function(){function e(e){this.pagerModule=e}return e.prototype.render=function(){this.pagerElement=this.pagerModule.element,this.renderNumericContainer(),this.refreshNumericLinks(),this.wireEvents()},e.prototype.refresh=function(){this.pagerModule.updateTotalPages(),this.links.length&&this.updateLinksHtml(),this.updateStyles()},e.prototype.refreshNumericLinks=function(){var e,t=this.pagerModule,i=t.element.querySelector(".e-numericcontainer"),r=document.createDocumentFragment();i.innerHTML="";for(var n=1;n<=t.pageCount;n++)e=sf.base.createElement("a",{className:"e-link e-numericitem e-spacing e-pager-default",attrs:{role:"link",tabindex:"-1","aria-label":"Goto Page "+n,href:"javascript:void(0);",name:"Goto page"+n}}),t.currentPage===n&&sf.base.classList(e,["e-currentitem","e-active"],["e-pager-default"]),r.appendChild(e);i.appendChild(r),this.links=[].slice.call(i.childNodes)},e.prototype.wireEvents=function(){sf.base.EventHandler.add(this.pagerElement,"click",this.clickHandler,this)},e.prototype.unwireEvents=function(){sf.base.EventHandler.remove(this.pagerModule.element,"click",this.clickHandler)},e.prototype.destroy=function(){this.unwireEvents()},e.prototype.renderNumericContainer=function(){this.element=sf.base.createElement("div",{className:"e-pagercontainer",attrs:{role:"navigation"}}),this.renderFirstNPrev(this.element),this.renderPrevPagerSet(this.element),this.element.appendChild(sf.base.createElement("div",{className:"e-numericcontainer"})),this.renderNextPagerSet(this.element),this.renderNextNLast(this.element),this.pagerModule.element.appendChild(this.element)},e.prototype.renderFirstNPrev=function(e){this.first=sf.base.createElement("div",{className:"e-first e-icons e-icon-first",attrs:{title:this.pagerModule.getLocalizedLabel("firstPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("firstPageTooltip"),tabindex:"-1"}}),this.prev=sf.base.createElement("div",{className:"e-prev e-icons e-icon-prev",attrs:{title:this.pagerModule.getLocalizedLabel("previousPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("previousPageTooltip"),tabindex:"-1"}}),sf.base.append([this.first,this.prev],e)},e.prototype.renderPrevPagerSet=function(e){var t=sf.base.createElement("div");this.PP=sf.base.createElement("a",{className:"e-link e-pp e-spacing",innerHTML:"...",attrs:{title:this.pagerModule.getLocalizedLabel("previousPagerTooltip"),role:"link","aria-label":this.pagerModule.getLocalizedLabel("previousPagerTooltip"),tabindex:"-1",name:this.pagerModule.getLocalizedLabel("previousPagerTooltip"),href:"javascript:void(0);"}}),t.appendChild(this.PP),e.appendChild(t)},e.prototype.renderNextPagerSet=function(e){var t=sf.base.createElement("div");this.NP=sf.base.createElement("a",{className:"e-link e-np e-spacing",innerHTML:"...",attrs:{title:this.pagerModule.getLocalizedLabel("nextPagerTooltip"),role:"link","aria-label":this.pagerModule.getLocalizedLabel("nextPagerTooltip"),tabindex:"-1",name:this.pagerModule.getLocalizedLabel("nextPagerTooltip"),href:"javascript:void(0);"}}),t.appendChild(this.NP),e.appendChild(t)},e.prototype.renderNextNLast=function(e){this.next=sf.base.createElement("div",{className:"e-next e-icons e-icon-next",attrs:{title:this.pagerModule.getLocalizedLabel("nextPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("nextPageTooltip"),tabindex:"-1"}}),this.last=sf.base.createElement("div",{className:"e-last e-icons e-icon-last",attrs:{title:this.pagerModule.getLocalizedLabel("lastPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("lastPageTooltip"),tabindex:"-1"}}),sf.base.append([this.next,this.last],e)},e.prototype.clickHandler=function(e){var t=this.pagerModule,i=e.target;return t.previousPageNo=t.currentPage,i.classList.contains("e-disable")||sf.base.isNullOrUndefined(i.getAttribute("index"))||(t.currentPage=parseInt(i.getAttribute("index"),10),t.dataBind()),!1},e.prototype.updateLinksHtml=function(){var e,t,i=this.pagerModule;i.currentPage=1===i.totalPages?1:i.currentPage,i.currentPage>i.totalPages&&i.totalPages&&(i.currentPage=i.totalPages),e=parseInt((i.currentPage/i.pageCount).toString(),10),i.currentPage%i.pageCount==0&&e>0&&(e-=1);for(var r=0;r<i.pageCount;r++)(t=e*i.pageCount+1+r)<=i.totalPages?(this.links[r].style.display="",this.links[r].setAttribute("index",t.toString()),this.links[r].innerHTML=i.customText?i.customText+t:t.toString(),i.currentPage!==t?this.links[r].classList.add("e-pager-default"):this.links[r].classList.remove("e-pager-default")):(this.links[r].innerHTML=i.customText?i.customText+t:t.toString(),this.links[r].style.display="none"),sf.base.classList(this.links[r],[],["e-currentitem","e-active"]);this.first.setAttribute("index","1"),this.last.setAttribute("index",i.totalPages.toString()),this.prev.setAttribute("index",(i.currentPage-1).toString()),this.next.setAttribute("index",(i.currentPage+1).toString()),this.pagerElement.querySelector(".e-mfirst").setAttribute("index","1"),this.pagerElement.querySelector(".e-mlast").setAttribute("index",i.totalPages.toString()),this.pagerElement.querySelector(".e-mprev").setAttribute("index",(i.currentPage-1).toString()),this.pagerElement.querySelector(".e-mnext").setAttribute("index",(i.currentPage+1).toString()),this.PP.setAttribute("index",(parseInt(this.links[0].getAttribute("index"),10)-i.pageCount).toString()),this.NP.setAttribute("index",(parseInt(this.links[this.links.length-1].getAttribute("index"),10)+1).toString())},e.prototype.updateStyles=function(){this.updateFirstNPrevStyles(),this.updatePrevPagerSetStyles(),this.updateNextPagerSetStyles(),this.updateNextNLastStyles(),this.links.length&&sf.base.classList(this.links[(this.pagerModule.currentPage-1)%this.pagerModule.pageCount],["e-currentitem","e-active"],[])},e.prototype.updateFirstNPrevStyles=function(){var e=["e-firstpage","e-pager-default"],t=["e-firstpagedisabled","e-disable"],i=["e-prevpage","e-pager-default"],r=["e-prevpagedisabled","e-disable"];this.pagerModule.totalPages>0&&this.pagerModule.currentPage>1?(sf.base.classList(this.prev,i,r),sf.base.classList(this.first,e,t),sf.base.classList(this.pagerElement.querySelector(".e-mfirst"),e,t),sf.base.classList(this.pagerElement.querySelector(".e-mprev"),i,r)):(sf.base.classList(this.prev,r,i),sf.base.classList(this.first,t,e),sf.base.classList(this.pagerElement.querySelector(".e-mprev"),r,i),sf.base.classList(this.pagerElement.querySelector(".e-mfirst"),t,e))},e.prototype.updatePrevPagerSetStyles=function(){this.pagerModule.currentPage>this.pagerModule.pageCount?sf.base.classList(this.PP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"]):sf.base.classList(this.PP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"])},e.prototype.updateNextPagerSetStyles=function(){var e=this.pagerModule,t=this.links[0].innerHTML.replace(e.customText,"");!t.length||!this.links.length||parseInt(t,10)+e.pageCount>e.totalPages?sf.base.classList(this.NP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"]):sf.base.classList(this.NP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"])},e.prototype.updateNextNLastStyles=function(){var e=["e-lastpage","e-pager-default"],t=["e-lastpagedisabled","e-disable"],i=["e-nextpage","e-pager-default"],r=["e-nextpagedisabled","e-disable"],n=this.pagerModule;n.currentPage===n.totalPages||0===n.totalRecordsCount?(sf.base.classList(this.last,t,e),sf.base.classList(this.next,r,i),sf.base.classList(this.pagerElement.querySelector(".e-mlast"),t,e),sf.base.classList(this.pagerElement.querySelector(".e-mnext"),r,i)):(sf.base.classList(this.last,e,t),sf.base.classList(this.next,i,r),sf.base.classList(this.pagerElement.querySelector(".e-mlast"),e,t),sf.base.classList(this.pagerElement.querySelector(".e-mnext"),i,r))},e}(),sn=function(){function e(e){this.pagerModule=e}return e.prototype.render=function(){var e=sf.base.createElement("div",{className:"e-parentmsgbar",attrs:{"aria-label":"Pager Information"}});this.pageNoMsgElem=sf.base.createElement("span",{className:"e-pagenomsg",styles:"textalign:right"}),this.pageCountMsgElem=sf.base.createElement("span",{className:"e-pagecountmsg",styles:"textalign:right"}),sf.base.append([this.pageNoMsgElem,this.pageCountMsgElem],e),this.pagerModule.element.appendChild(e),this.refresh()},e.prototype.refresh=function(){var e=this.pagerModule;this.pageNoMsgElem.textContent=this.format(e.getLocalizedLabel("currentPageInfo"),[0===e.totalRecordsCount?0:e.currentPage,e.totalPages||0,e.totalRecordsCount||0])+" ",this.pageCountMsgElem.textContent=this.format(e.getLocalizedLabel(e.totalRecordsCount<=1?"totalItemInfo":"totalItemsInfo"),[e.totalRecordsCount||0,e.totalRecordsCount?e.pageSize*(e.currentPage-1)+1:0,e.pageSize*e.currentPage>e.totalRecordsCount?e.totalRecordsCount:e.pageSize*e.currentPage]),this.pageNoMsgElem.parentElement.setAttribute("aria-label",this.pageNoMsgElem.textContent+this.pageCountMsgElem.textContent)},e.prototype.hideMessage=function(){this.pageNoMsgElem&&(this.pageNoMsgElem.style.display="none"),this.pageCountMsgElem&&(this.pageCountMsgElem.style.display="none")},e.prototype.showMessage=function(){this.pageNoMsgElem||this.render(),this.pageNoMsgElem.style.display="",this.pageCountMsgElem.style.display=""},e.prototype.destroy=function(){},e.prototype.format=function(e,t){for(var i,r=0;r<t.length;r++)i=new RegExp("\\{"+r+"\\}","gm"),e=e.replace(i,t[r].toString());return e},e}(),on=(Qr=function(e,t){return(Qr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Qr(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),an=function(e,t,r,n){var s,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(a=(o<3?s(a):o>3?s(t,r,a):s(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},ln=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.hasParent=!1,r.pageRefresh="pager-refresh",r}return on(t,e),t.prototype.requiredModules=function(){var e=[];return this.enableExternalMessage&&e.push({member:"externalMessage",args:[this]}),this.checkpagesizes()&&e.push({member:"pagerdropdown",args:[this]}),e},t.prototype.preRender=function(){this.defaultConstants={currentPageInfo:"{0} of {1} pages",totalItemsInfo:"({0} items)",totalItemInfo:"({0} item)",firstPageTooltip:"Go to first page",lastPageTooltip:"Go to last page",nextPageTooltip:"Go to next page",previousPageTooltip:"Go to previous page",nextPagerTooltip:"Go to next pager",previousPagerTooltip:"Go to previous pager",pagerDropDown:"Items per page",pagerAllDropDown:"Items",CurrentPageInfo:"{0} of {1} pages",TotalItemsInfo:"({0} items)",FirstPageTooltip:"Go to first page",LastPageTooltip:"Go to last page",NextPageTooltip:"Go to next page",PreviousPageTooltip:"Go to previous page",NextPagerTooltip:"Go to next pager",PreviousPagerTooltip:"Go to previous pager",PagerDropDown:"Items per page",PagerAllDropDown:"Items",All:"All"},this.containerModule=new nn(this),this.pagerMessageModule=new sn(this)},t.prototype.render=function(){this.template?this.isReactTemplate()?(this.on(this.pageRefresh,this.pagerTemplate,this),this.notify(this.pageRefresh,{})):this.pagerTemplate():(this.initLocalization(),this.updateRTL(),this.totalRecordsCount=this.totalRecordsCount||0,this.renderFirstPrevDivForDevice(),this.containerModule.render(),this.enablePagerMessage&&this.pagerMessageModule.render(),this.renderNextLastDivForDevice(),this.checkpagesizes()&&this.pagerdropdownModule&&this.pagerdropdownModule.render(),this.addAriaLabel(),this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render(),this.refresh(),this.trigger("created",{currentPage:this.currentPage,totalRecordsCount:this.totalRecordsCount}))},t.prototype.getPersistData=function(){return this.addOnPersist(["currentPage","pageSize"])},t.prototype.destroy=function(){this.isReactTemplate()&&(this.off(this.pageRefresh,this.pagerTemplate),this.hasParent||this.destroyTemplate(["template"])),e.prototype.destroy.call(this),this.containerModule.destroy(),this.pagerMessageModule.destroy(),this.isReactTemplate()||(this.element.innerHTML="")},t.prototype.destroyTemplate=function(e,t){this.clearTemplate(e,t)},t.prototype.getModuleName=function(){return"pager"},t.prototype.onPropertyChanged=function(e,t){if(!this.isDestroyed){e.pageCount!==t.pageCount&&(this.containerModule.refreshNumericLinks(),this.containerModule.refresh());for(var i=0,r=Object.keys(e);i<r.length;i++){switch(r[i]){case"currentPage":this.checkGoToPage(e.currentPage,t.currentPage)&&this.currentPageChanged(e,t);break;case"pageSize":case"totalRecordsCount":case"customText":this.checkpagesizes()&&this.pagerdropdownModule&&(t.pageSize!==e.pageSize&&(this.currentPage=1),this.pagerdropdownModule.setDropDownValue("value",this.pageSize)),e.pageSize!==t.pageSize?(this.pageSize=e.pageSize,this.currentPageChanged(e,t)):this.refresh();break;case"pageSizes":this.checkpagesizes()&&this.pagerdropdownModule&&(this.pagerdropdownModule.destroy(),this.pagerdropdownModule.render()),this.refresh();break;case"template":this.templateFn=this.compile(this.template),this.refresh();break;case"locale":this.initLocalization(),this.refresh();break;case"enableExternalMessage":this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render();break;case"externalMessage":this.externalMessageModule&&this.externalMessageModule.refresh();break;case"enableRtl":this.updateRTL();break;case"enablePagerMessage":this.enablePagerMessage?this.pagerMessageModule.showMessage():this.pagerMessageModule.hideMessage()}}}},t.prototype.getLocalizedLabel=function(e){return this.localeObj.getConstant(e)},t.prototype.goToPage=function(e){this.checkGoToPage(e)&&(this.currentPage=e,this.dataBind())},t.prototype.setPageSize=function(e){this.pageSize=e,this.dataBind()},t.prototype.checkpagesizes=function(){return!(!0!==this.pageSizes&&!this.pageSizes.length)},t.prototype.checkGoToPage=function(e,t){return e!==this.currentPage&&(this.previousPageNo=this.currentPage),sf.base.isNullOrUndefined(t)||(this.previousPageNo=t),this.previousPageNo!==e&&e>=1&&e<=this.totalPages},t.prototype.currentPageChanged=function(e,t){if(this.enableQueryString&&this.updateQueryString(this.currentPage),e.currentPage!==t.currentPage||e.pageSize!==t.pageSize){var i={currentPage:this.currentPage,newProp:e,oldProp:t,cancel:!1};this.trigger("click",i),i.cancel||this.refresh()}},t.prototype.pagerTemplate=function(){if(!this.isReactTemplate()||!this.hasParent){var e;this.element.classList.add("e-pagertemplate"),this.compile(this.template);var t={currentPage:this.currentPage,pageSize:this.pageSize,pageCount:this.pageCount,totalRecordsCount:this.totalRecordsCount,totalPages:this.totalPages},i=this.element.parentElement.id+"_template";this.isReactTemplate()?(this.getPagerTemplate()(t,this,"template",i,null,null,this.element),this.renderReactTemplates()):(e=this.isVue?this.getPagerTemplate()(t,this):this.getPagerTemplate()(t),Fi(this.element,e))}},t.prototype.updateTotalPages=function(){this.totalPages=this.totalRecordsCount%this.pageSize==0?this.totalRecordsCount/this.pageSize:parseInt((this.totalRecordsCount/this.pageSize).toString(),10)+1},t.prototype.getPagerTemplate=function(){return this.templateFn},t.prototype.compile=function(e){if(e)try{document.querySelectorAll(e).length&&(this.templateFn=sf.base.compile(document.querySelector(e).innerHTML.trim()))}catch(t){this.templateFn=sf.base.compile(e)}},t.prototype.refresh=function(){this.template?this.isReactTemplate()?(this.updateTotalPages(),this.notify(this.pageRefresh,{})):(this.element.innerHTML="",this.updateTotalPages(),this.pagerTemplate()):(this.updateRTL(),this.containerModule.refresh(),this.enablePagerMessage&&this.pagerMessageModule.refresh(),this.pagerdropdownModule&&this.pagerdropdownModule.refresh(),this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.refresh())},t.prototype.updateRTL=function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")},t.prototype.initLocalization=function(){this.localeObj=new sf.base.L10n(this.getModuleName(),this.defaultConstants,this.locale)},t.prototype.updateQueryString=function(e){var t=this.getUpdatedURL(window.location.href,"page",e.toString());window.history.pushState({path:t},"",t)},t.prototype.getUpdatedURL=function(e,t,i){var r=new RegExp("([?|&])"+t+"=.*?(&|#|$)","i");if(e.match(r))return e.replace(r,"$1"+t+"="+i+"$2");var n="";return-1!==e.indexOf("#")&&(n=e.replace(/.*#/,"#"),e=e.replace(/#.*/,"")),e+(-1!==e.indexOf("?")?"&":"?")+t+"="+i+n},t.prototype.renderFirstPrevDivForDevice=function(){this.element.appendChild(sf.base.createElement("div",{className:"e-mfirst e-icons e-icon-first",attrs:{title:this.getLocalizedLabel("firstPageTooltip"),tabindex:"-1"}})),this.element.appendChild(sf.base.createElement("div",{className:"e-mprev e-icons e-icon-prev",attrs:{title:this.getLocalizedLabel("previousPageTooltip"),tabindex:"-1"}}))},t.prototype.renderNextLastDivForDevice=function(){this.element.appendChild(sf.base.createElement("div",{className:"e-mnext e-icons e-icon-next",attrs:{title:this.getLocalizedLabel("nextPageTooltip"),tabindex:"-1"}})),this.element.appendChild(sf.base.createElement("div",{className:"e-mlast e-icons e-icon-last",attrs:{title:this.getLocalizedLabel("lastPageTooltip"),tabindex:"-1"}}))},t.prototype.addAriaLabel=function(){var e=[".e-mfirst",".e-mprev",".e-mnext",".e-mlast"];if(!sf.base.Browser.isDevice)for(var t=0;t<e.length;t++){var i=this.element.querySelector(e[t]);i.setAttribute("aria-label",i.getAttribute("title"))}},t.prototype.isReactTemplate=function(){return(this.isReact||this.isVue)&&this.template&&"string"!=typeof this.template},an([sf.base.Property(!1)],t.prototype,"enableQueryString",void 0),an([sf.base.Property(!1)],t.prototype,"enableExternalMessage",void 0),an([sf.base.Property(!0)],t.prototype,"enablePagerMessage",void 0),an([sf.base.Property(12)],t.prototype,"pageSize",void 0),an([sf.base.Property(10)],t.prototype,"pageCount",void 0),an([sf.base.Property(1)],t.prototype,"currentPage",void 0),an([sf.base.Property()],t.prototype,"totalRecordsCount",void 0),an([sf.base.Property()],t.prototype,"externalMessage",void 0),an([sf.base.Property(!1)],t.prototype,"pageSizes",void 0),an([sf.base.Property()],t.prototype,"template",void 0),an([sf.base.Property("")],t.prototype,"customText",void 0),an([sf.base.Event()],t.prototype,"click",void 0),an([sf.base.Event()],t.prototype,"dropDownChanged",void 0),an([sf.base.Event()],t.prototype,"created",void 0),t=an([sf.base.NotifyPropertyChanges],t)}(sf.base.Component),hn=function(){function e(e){this.pagerModule=e}return e.prototype.getModuleName=function(){return"pagerdropdown"},e.prototype.render=function(){var e=this.pagerModule;this.pagerDropDownDiv=sf.base.createElement("div",{className:"e-pagesizes"});var t=sf.base.createElement("div",{className:"e-pagerdropdown"}),i=sf.base.createElement("div",{className:"e-pagerconstant"}),r=sf.base.createElement("input",{attrs:{type:"text",tabindex:"1"}});this.pagerCons=sf.base.createElement("span",{className:"e-constant",innerHTML:this.pagerModule.getLocalizedLabel("pagerDropDown")}),t.appendChild(r),i.appendChild(this.pagerCons),this.pagerDropDownDiv.appendChild(t),this.pagerDropDownDiv.appendChild(i),this.pagerModule.element.appendChild(this.pagerDropDownDiv);var n=this.pagerModule.pageSizes,s=n.length?this.convertValue(n):[this.pagerModule.getLocalizedLabel("All"),"5","10","12","20"],o=this.pagerModule.pageSize;this.dropDownListObject=new sf.dropdowns.DropDownList({dataSource:s,value:o.toString(),change:this.onChange.bind(this),cssClass:"e-alldrop"}),this.dropDownListObject.appendTo(r),n.length&&(this.dropDownListObject.element.value=this.pagerModule.pageSize.toString()),e.pageSize=o,e.dataBind(),e.trigger("dropDownChanged",{pageSize:o}),this.addEventListener()},e.prototype.onChange=function(e){this.dropDownListObject.value===this.pagerModule.getLocalizedLabel("All")?(this.pagerModule.pageSize=this.pagerModule.totalRecordsCount,this.refresh(),e.value=this.pagerModule.pageSize,document.getElementsByClassName("e-popup-open e-alldrop").length&&(document.getElementsByClassName("e-popup-open e-alldrop")[0].style.display="none")):(this.pagerModule.pageSize=parseInt(this.dropDownListObject.value,10),this.pagerCons.innerHTML!==this.pagerModule.getLocalizedLabel("pagerDropDown")&&this.refresh()),this.pagerModule.dataBind(),this.pagerModule.trigger("dropDownChanged",{pageSize:parseInt(this.dropDownListObject.value,10)})},e.prototype.refresh=function(){this.pagerCons&&(this.pagerModule.pageSize===this.pagerModule.totalRecordsCount?this.pagerCons.innerHTML=this.pagerModule.getLocalizedLabel("pagerAllDropDown"):this.pagerCons.innerHTML=this.pagerModule.getLocalizedLabel("pagerDropDown"))},e.prototype.beforeValueChange=function(e){if("number"==typeof e.newProp.value){var t=e.newProp.value.toString();e.newProp.value=t}},e.prototype.convertValue=function(e){for(var t=e,i=0;i<t.length;i++)t[i]=parseInt(t[i],10)?t[i].toString():""!==this.pagerModule.getLocalizedLabel(t[i])?this.pagerModule.getLocalizedLabel(t[i]):t[i];return t},e.prototype.setDropDownValue=function(e,t){this.dropDownListObject&&(this.dropDownListObject[e]=t)},e.prototype.addEventListener=function(){this.dropDownListObject.on("beforeValueChange",this.beforeValueChange,this)},e.prototype.removeEventListener=function(){this.dropDownListObject.off("beforeValueChange",this.beforeValueChange)},e.prototype.destroy=function(e){this.dropDownListObject&&!this.dropDownListObject.isDestroyed&&(this.removeEventListener(),this.dropDownListObject.destroy(),sf.base.remove(this.pagerDropDownDiv))},e}(),dn=function(){function e(e){this.pagerModule=e}return e.prototype.getModuleName=function(){return"externalMessage"},e.prototype.render=function(){this.element=sf.base.createElement("div",{className:"e-pagerexternalmsg",attrs:{"aria-label":"Pager external message"}}),this.pagerModule.element.appendChild(this.element),this.refresh()},e.prototype.refresh=function(){this.pagerModule.externalMessage&&this.pagerModule.externalMessage.toString().length?(this.showMessage(),this.element.innerHTML=this.pagerModule.externalMessage):this.hideMessage()},e.prototype.hideMessage=function(){sf.base.isNullOrUndefined(this.element)||(this.element.style.display="none")},e.prototype.showMessage=function(){this.element.style.display=""},e.prototype.destroy=function(){sf.base.remove(this.element)},e}(),pn=function(){function e(e,t){this.isInitialRender=!0,ln.Inject(dn,hn),this.parent=e,this.pageSettings=t,this.addEventListener()}return e.prototype.getModuleName=function(){return"pager"},e.prototype.render=function(){var e=this.parent;this.pagerDestroy(),sf.base.isNullOrUndefined(this.parent.pagerTemplate)||(this.pageSettings.template=this.parent.pagerTemplate,this.parent.pageTemplateChange=!0),this.element=this.parent.createElement("div",{className:"e-gridpager"});var t=ci({},sf.base.extend({},mi(this.pageSettings)),{click:this.clickHandler.bind(this),dropDownChanged:this.onSelect.bind(this),enableRtl:e.enableRtl,locale:e.locale,created:this.addAriaAttr.bind(this)},["parentObj","propName"]);this.pagerObj=new ln(t),this.pagerObj.hasParent=!0,this.pagerObj.on("pager-refresh",this.renderReactPagerTemplate,this),this.pagerObj.allowServerDataBinding=!1},e.prototype.onSelect=function(e){this.pageSettings.pageSize=e.pageSize,this.isInitialLoad||(this.pageSettings.currentPage=1)},e.prototype.addAriaAttr=function(){if(!this.pageSettings.template){for(var e=this.parent.createElement("div",{className:"e-numericcontainer"}),t=this.element.querySelector(".e-pagercontainer"),i=document.createDocumentFragment(),r=this.element.querySelector(".e-numericcontainer"),n=r.querySelectorAll("a"),s=0;s<n.length;s++){this.parent.getContentTable()?n[s].setAttribute("aria-owns",this.parent.getContentTable().id):n[s].setAttribute("aria-owns",this.parent.element.getAttribute("id")+"_content_table");var o=this.parent.createElement("div");o.appendChild(n[s]),i.appendChild(o)}e.appendChild(i),t.replaceChild(e,r);for(var a=[".e-mfirst",".e-mprev",".e-first",".e-prev",".e-next",".e-last",".e-mnext",".e-mlast"],l=0;l<a.length;l++){var h=this.element.querySelector(a[l]);this.parent.getContentTable()&&h.setAttribute("aria-owns",this.parent.getContentTable().id)}}},e.prototype.dataReady=function(e){this.updateModel(e)},e.prototype.refresh=function(){this.pagerObj.refresh()},e.prototype.goToPage=function(e){this.pagerObj.goToPage(e)},e.prototype.setPageSize=function(e){this.pagerObj.setPageSize(e)},e.prototype.updateModel=function(e){this.parent.pageSettings.totalRecordsCount=e.count,this.parent.dataBind()},e.prototype.onActionComplete=function(e){this.parent.trigger(c,sf.base.extend(e,{currentPage:this.parent.pageSettings.currentPage,requestType:"paging",type:c}))},e.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName()){for(var t=e.properties,i=0,r=Object.keys(t);i<r.length;i++){var n=r[i];this.pagerObj[n]=t[n]}this.pagerObj.dataBind()}},e.prototype.clickHandler=function(e){var t=this.parent;if(this.isForceCancel||Ni(t)&&!t.prevPageMoving)return this.isForceCancel?this.isForceCancel=!1:(sf.base.isNullOrUndefined(e.newProp)||sf.base.isNullOrUndefined(e.newProp.pageSize)?e.currentPage&&(t.notify(I,{instance:this,handler:this.goToPage,arg1:e.currentPage}),this.pagerObj.currentPage=t.pageSettings.currentPage===this.pagerObj.currentPage?this.pagerObj.previousPageNo:t.pageSettings.currentPage):(t.notify(I,{instance:this,handler:this.setPageSize,arg1:e.newProp.pageSize}),this.pagerObj.pageSize=e.oldProp.pageSize,t.pageSettings.pageSize=e.newProp.pageSize),this.isForceCancel=!0,this.pagerObj.dataBind()),void(e.cancel=!0);t.pageSettings.pageSize=this.pagerObj.pageSize,t.prevPageMoving=!1;var i=this.pageSettings.currentPage;this.pageSettings.currentPage=e.currentPage;var r={cancel:!1,requestType:"paging",previousPage:i,currentPage:e.currentPage,type:p};this.parent.notify(w,r),r.cancel&&(e.cancel=!0),this.parent.requestTypeAction="paging"},e.prototype.keyPressHandler=function(e){e.action in cn&&(e.preventDefault(),this.element.querySelector(cn[e.action]).click())},e.prototype.updateExternalMessage=function(e){this.pagerObj.enableExternalMessage||(this.pagerObj.enableExternalMessage=!0,this.pagerObj.dataBind()),this.pagerObj.externalMessage=e,this.pagerObj.dataBind()},e.prototype.appendToElement=function(){this.isInitialLoad=!0,this.parent.element.appendChild(this.element),this.parent.setGridPager(this.element),this.pagerObj.isReact=this.parent.isReact,this.pagerObj.isVue=this.parent.isVue,this.pagerObj.appendTo(this.element),this.isInitialLoad=!1},e.prototype.enableAfterRender=function(e){e.module===this.getModuleName()&&e.enable&&(this.render(),this.appendToElement(),this.isReactTemplate()&&(this.pagerObj.updateTotalPages(),this.created()))},e.prototype.addEventListener=function(){this.handlers={load:this.render,end:this.appendToElement,ready:this.dataReady,complete:this.onActionComplete,updateLayout:this.enableAfterRender,inboundChange:this.onPropertyChanged,keyPress:this.keyPressHandler,created:this.created},this.parent.isDestroyed||(this.parent.isReact&&this.parent.addEventListener("create",this.handlers.created.bind(this)),this.evtHandlers=[{event:f,handler:this.handlers.load},{event:g,handler:this.handlers.end},{event:m,handler:this.handlers.ready},{event:"paging-complete",handler:this.handlers.complete},{event:v,handler:this.handlers.updateLayout},{event:C,handler:this.handlers.inboundChange},{event:x,handler:this.handlers.keyPress},{event:F,handler:this.destroy}],Nr(this.parent,this.evtHandlers,!0,this))},e.prototype.created=function(){this.isInitialRender&&this.isReactTemplate()&&(this.isInitialRender=!1,this.renderReactPagerTemplate())},e.prototype.isReactTemplate=function(){return this.parent.isReact&&this.pagerObj.template&&"string"!=typeof this.pagerObj.template},e.prototype.renderReactPagerTemplate=function(){if(!this.isInitialRender&&this.isReactTemplate()){this.parent.destroyTemplate(["pagerTemplate"]),this.element.classList.add("e-pagertemplate"),this.pagerObj.compile(this.pagerObj.template);var e=this.parent.pageSettings,t={currentPage:e.currentPage,pageSize:e.pageSize,pageCount:e.pageCount,totalRecordsCount:e.totalRecordsCount,totalPages:this.pagerObj.totalPages},i=this.parent.id+"_pagertemplate";this.pagerObj.templateFn(t,this.parent,"pagerTemplate",i,null,null,this.pagerObj.element),this.parent.renderTemplates()}},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.isReact&&this.parent.removeEventListener("create",this.handlers.created),this.parent.off("pager-refresh",this.renderReactPagerTemplate),Nr(this.parent,this.evtHandlers,!1))},e.prototype.destroy=function(){this.removeEventListener(),this.isReactTemplate()&&this.parent.destroyTemplate(["pagerTemplate"]),this.pagerObj.destroy()},e.prototype.pagerDestroy=function(){this.pagerObj&&!this.pagerObj.isDestroyed&&(this.pagerObj.destroy(),sf.base.remove(this.element))},e}(),cn={pageUp:".e-prev",pageDown:".e-next",ctrlAltPageDown:".e-last",ctrlAltPageUp:".e-first",altPageUp:".e-pp",altPageDown:".e-np"},un=(Xr=function(e,t){return(Xr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Xr(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),fn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-filterbarcell"}),t}return un(t,e),t.prototype.getGui=function(){return this.parent.createElement("div")},t.prototype.render=function(e,t){var i,r=this.parent.element.querySelector(".e-filterbar"),n=this.element.cloneNode(),s=this.getGui(),o=e.column;if(r.appendChild(n),n.setAttribute("e-mappinguid",o.uid),o.filterTemplate){var a={};t&&(a[o.field]=t[o.field]);if(a.column=o,o.visible){var l=this.parent.isReact&&"string"!=typeof o.filterTemplate,h=this.parent.element.id+o.uid+"filterTemplate";if(l)o.getFilterTemplate()(a,this.parent,"filterTemplate",h,null,null,n),this.parent.renderTemplates();else Fi(n,o.getFilterTemplate()(a,this.parent,"filterTemplate",h))}else n.classList.add("e-hide")}else if("checkbox"!==o.type){if(!sf.base.isNullOrUndefined(o.allowFiltering)&&!o.allowFiltering||sf.base.isNullOrUndefined(o.filterBarTemplate)){sf.base.attributes(s,{class:"e-filterdiv e-fltrinputdiv"}),i=this.parent.createElement("input",{id:o.field+"_filterBarcell",className:"e-filtertext",attrs:{type:"search",title:o.headerText+e.attributes.title,value:t[e.column.field]?t[e.column.field]:"",role:"search"}}),s.appendChild(i);d={element:i,floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}};sf.inputs.Input.createInput(d,this.parent.createElement)}else if(n.classList.add("e-fltrtemp"),sf.base.attributes(s,{class:"e-fltrtempdiv"}),sf.base.isNullOrUndefined(o.filterBarTemplate.create))i=this.parent.createElement("input",{id:o.field+"_filterBarcell",className:"e-filterUi_input e-filtertext e-fltrTemp",attrs:{type:"search",title:o.headerText}}),s.appendChild(i);else{var d={column:o,node:Element},p=o.filterBarTemplate.create;if("string"==typeof p&&(p=sf.base.getValue(p,window)),"string"==typeof(i=p(d))){var c=this.parent.createElement("div");c.innerHTML=i,i=c.firstChild}sf.base.attributes(s,{class:"e-filterUi_input e-filtertext e-fltrTemp",title:o.headerText,id:o.field+"_filterBarcell"}),s.appendChild(i)}if((!1===o.allowFiltering||""===o.field||sf.base.isNullOrUndefined(o.field))&&(i.setAttribute("disabled","true"),i.classList.add("e-disable")),o.visible||n.classList.add("e-hide"),this.appendHtml(n,s),this.parent.filterSettings.showFilterBarOperator&&"FilterBar"===this.parent.filterSettings.type&&!this.parent.isPrinting&&sf.base.isNullOrUndefined(o.filterTemplate)&&this.operatorIconRender(s,o,e),(sf.base.isNullOrUndefined(o.allowFiltering)||o.allowFiltering)&&!sf.base.isNullOrUndefined(o.filterBarTemplate)){var u=o.filterBarTemplate.write;d={element:i,column:o};"string"==typeof u&&(u=sf.base.getValue(u,window)),u.call(this,d)}}return n},t.prototype.appendHtml=function(e,t){return e.appendChild(t),e},t.prototype.operatorIconRender=function(e,t,i){var r=this.parent,n=this.parent.createElement("input",{className:" e-filterbaroperator e-icons e-icon-filter",id:i.column.uid});e.querySelector("span").appendChild(n);var s=t.filter&&t.filter.operator?t.filter.operator:"equal";sf.base.isNullOrUndefined(r.filterModule.operators[t.field])||(s=r.filterModule.operators[t.field]),this.dropOptr=new sf.dropdowns.DropDownList({fields:{text:"text",value:"value"},popupHeight:"auto",value:s,width:"0px",enabled:t.allowFiltering,popupWidth:"auto",enableRtl:this.parent.enableRtl,change:this.internalEvent.bind(this),beforeOpen:function(){var e=r.filterModule.customOperators;this.dataSource=e[r.getColumnByUid(this.element.id).type+"Operator"];for(var i=0;i<this.dataSource.length;i++)t.filter&&t.filter.operator&&sf.base.isNullOrUndefined(r.filterModule.operators[t.field])&&this.dataSource[i].value===t.filter.operator&&(this.value=t.filter.operator)}}),this.dropOptr.appendTo(n);var o=sf.base.closest(this.dropOptr.element,"span");o.classList.add("e-filterbardropdown"),o.removeAttribute("tabindex")},t.prototype.internalEvent=function(e){var t=this.parent,i=t.getColumnByUid(e.element.getAttribute("id"));e.column=i,t.filterModule.operators[i.field]=e.value,t.notify("get-filterbar-operator",e)},t}(ve),gn=function(){function e(e,t,i,r){this.ddOpen=this.dropDownOpen.bind(this),this.parent=e,this.serviceLocator=i,this.filterSettings=r,this.customFilterOperators=t,this.parent&&(this.parent.on(T,this.destroyDropDownList,this),this.parent.on(F,this.destroyDropDownList,this))}return e.prototype.renderOperatorUI=function(e,t,i,r,n){this.dialogObj=r;var s=i.type+"Operator";this.optrData=this.customOptr=sf.base.isNullOrUndefined(n)?sf.base.isNullOrUndefined(this.parent.filterSettings.operators)||sf.base.isNullOrUndefined(this.parent.filterSettings.operators[s])?this.customFilterOperators[s]:this.parent.filterSettings.operators[s]:n;var o=this.customOptr,a=this.dropSelectedVal(i,s),l=this.parent.createElement("div",{className:"e-flm_optrdiv"});e.appendChild(l);var h=this.parent.createElement("input",{id:i.uid+"-floptr"});l.appendChild(h),this.dropOptr=new sf.dropdowns.DropDownList({dataSource:o,fields:{text:"text",value:"value"},cssClass:"e-popup-flmenu",enableRtl:this.parent.enableRtl,text:a}),this.dropOptr.addEventListener(ae,this.ddOpen),this.dropOptr.appendTo("#"+i.uid+"-floptr")},e.prototype.renderResponsiveDropDownList=function(e){e.popup.element.style.width="100%"},e.prototype.dropDownOpen=function(e){e.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString(),this.parent.enableAdaptiveUI&&this.renderResponsiveDropDownList(e)},e.prototype.dropSelectedVal=function(e,t){for(var i="",r=0,n=this.parent.filterSettings.columns;r<n.length;r++){var s=n[r];if(e.field===s.field||e.isForeignColumn()&&e.foreignKeyValue===s.field){var o=new sf.data.DataManager(this.optrData).executeLocal((new sf.data.Query).where("value","equal",s.operator));i=sf.base.isNullOrUndefined(o[0])?"":o[0].text}}if(""===i)if(e.filter.operator)for(var a=Object.keys(this.optrData).length,l=0;l<a;l++)this.optrData[l].value===e.filter.operator&&(i=this.optrData[l].text);else i=this.optrData[0].text;return i},e.prototype.getFlOperator=function(){return this.dropOptr.value},e.prototype.destroyDropDownList=function(){this.dropOptr.isDestroyed||(this.dropOptr.removeEventListener(ae,this.ddOpen),this.dropOptr.destroy(),this.parent.off(T,this.destroyDropDownList),this.parent.off(F,this.destroyDropDownList))},e}(),mn=function(){function e(e,t,i){this.parent=e,this.serLocator=t,this.filterSettings=i,this.parent&&(this.parent.on(T,this.destroy,this),this.parent.on(F,this.destroy,this))}return e.prototype.create=function(e){this.instance=this.parent.createElement("input",{className:"e-flmenu-input",id:"strui-"+e.column.uid}),e.target.appendChild(this.instance),this.dialogObj=e.dialogObj,this.actObj=this.getAutoCompleteOptions(e),this.actObj.appendTo(this.instance)},e.prototype.getAutoCompleteOptions=function(e){var t,i=e.column.isForeignColumn();i&&((t=new sf.data.Query).params=this.parent.query.params);var r=i?e.column.dataSource:this.parent.dataSource,n={value:i?e.column.foreignKeyValue:e.column.field},s=new sf.dropdowns.AutoComplete(sf.base.extend({dataSource:r instanceof sf.data.DataManager?r:new sf.data.DataManager(r),fields:n,locale:this.parent.locale,enableRtl:this.parent.enableRtl,query:i?t:this.parent.query.clone(),sortOrder:"Ascending",cssClass:"e-popup-flmenu",autofill:!0,placeholder:e.localizeText.getConstant("EnterValue")},e.column.filter.params));if(this.acFocus=this.focus(s,e),this.acComplete=this.actionComplete(s),this.acOpen=this.openPopup.bind(this),s.addEventListener("focus",this.acFocus),s.addEventListener(ae,this.acOpen),s.addEventListener(c,this.acComplete),r&&"result"in r){var o=gr({requestType:"stringfilterrequest"},this.parent.getQuery?this.parent.getQuery().clone():new sf.data.Query);this.parent.trigger("dataStateChange",o.state),o.deffered.promise.then((function(e){s.dataSource=new sf.data.DataManager(e)}))}return s},e.prototype.write=function(e){""===e.filteredValue||sf.base.isNullOrUndefined(e.filteredValue)||(document.querySelector("#strui-"+e.column.uid).ej2_instances[0].value=e.filteredValue)},e.prototype.read=function(e,t,i,r){var n=document.querySelector("#strui-"+t.uid).ej2_instances[0];sf.base.Browser.isDevice&&(n.hidePopup(),n.focusOut());var s=n.value;(sf.base.isNullOrUndefined(s)||""===s)&&(s=null),r.filterByColumn(t.field,i,s,"and",this.parent.filterSettings.enableCaseSensitivity)},e.prototype.openPopup=function(e){ji(e,this.dialogObj)},e.prototype.focus=function(e,t){return function(){e.filterType=t.getOptrInstance.getFlOperator()}},e.prototype.actionComplete=function(e){return function(t){t.result=t.result.filter((function(t,i,r){return r.map((function(t){return sf.base.getValue(e.fields.value,t)})).indexOf(sf.base.getValue(e.fields.value,t))===i}))}},e.prototype.destroy=function(){this.actObj&&!this.actObj.isDestroyed&&(this.actObj.removeEventListener("focus",this.acFocus),this.actObj.removeEventListener(ae,this.acOpen),this.actObj.removeEventListener(c,this.acComplete),this.actObj.destroy(),this.parent.off(T,this.destroy),this.parent.off(F,this.destroy))},e}(),yn=function(){function e(e,t,i){this.filterSettings=i,this.parent=e,this.serviceLocator=t,this.parent&&(this.parent.on(T,this.destroy,this),this.parent.on(F,this.destroy,this))}return e.prototype.keyEventHandler=function(e){if(13===e.keyCode||9===e.keyCode){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),this.dispatchEvent(t)}},e.prototype.create=function(e){this.instance=this.parent.createElement("input",{className:"e-flmenu-input",id:"numberui-"+e.column.uid}),e.target.appendChild(this.instance),this.numericTxtObj=new sf.inputs.NumericTextBox(sf.base.extend({format:"string"==typeof e.column.format||sf.base.isUndefined(e.column.format)?e.column.format:e.column.format.format,locale:this.parent.locale,cssClass:"e-popup-flmenu",placeholder:e.localizeText.getConstant("EnterValue"),enableRtl:this.parent.enableRtl},e.column.filter.params)),this.numericTxtObj.appendTo(this.instance)},e.prototype.write=function(e){var t=document.querySelector("#numberui-"+e.column.uid).ej2_instances[0];t.element.addEventListener("keydown",this.keyEventHandler),t.value=e.filteredValue},e.prototype.read=function(e,t,i,r){var n=document.querySelector("#numberui-"+t.uid).ej2_instances[0].value;r.filterByColumn(t.field,i,n,"and",!0)},e.prototype.destroy=function(){this.numericTxtObj&&!this.numericTxtObj.isDestroyed&&(this.numericTxtObj.destroy(),this.parent.off(T,this.destroy),this.parent.off(F,this.destroy))},e}(),vn=function(){function e(e,t,i){this.parent=e,this.serviceLocator=t,this.filterSettings=i,this.parent&&(this.parent.on(T,this.destroy,this),this.parent.on(F,this.destroy,this))}return e.prototype.create=function(e){var t=e.column.isForeignColumn(),i=t?e.column.dataSource:this.parent.dataSource,r=t?e.column.foreignKeyValue:e.column.field;this.elem=this.parent.createElement("input",{className:"e-flmenu-input",id:"bool-ui-"+e.column.uid}),e.target.appendChild(this.elem),this.dialogObj=e.dialogObj,this.dropInstance=new sf.dropdowns.DropDownList(sf.base.extend({dataSource:i instanceof sf.data.DataManager?i:new sf.data.DataManager(i),query:(new sf.data.Query).select(r),fields:{text:r,value:r},placeholder:e.localizeText.getConstant("SelectValue"),cssClass:"e-popup-flmenu",locale:this.parent.locale,enableRtl:this.parent.enableRtl},e.column.filter.params)),this.ddOpen=this.openPopup.bind(this),this.ddComplete=this.actionComplete(r),this.dropInstance.addEventListener(ae,this.ddOpen),this.dropInstance.addEventListener(c,this.ddComplete),this.dropInstance.appendTo(this.elem)},e.prototype.write=function(e){var t=document.querySelector("#bool-ui-"+e.column.uid).ej2_instances[0];sf.base.isNullOrUndefined(e.filteredValue)||(t.text=e.filteredValue)},e.prototype.read=function(e,t,i,r){var n=document.querySelector("#bool-ui-"+t.uid).ej2_instances[0].value;r.filterByColumn(t.field,i,n,"and",!1)},e.prototype.openPopup=function(e){ji(e,this.dialogObj)},e.prototype.actionComplete=function(e){return function(t){t.result=sf.data.DataUtil.distinct(t.result,e,!0)}},e.prototype.destroy=function(){this.dropInstance&&!this.dropInstance.isDestroyed&&(this.dropInstance.removeEventListener(ae,this.ddOpen),this.dropInstance.removeEventListener(c,this.ddComplete),this.dropInstance.destroy(),this.parent.off(T,this.destroy),this.parent.off(F,this.destroy))},e}(),bn=function(){function e(e,t,i){this.dpOpen=this.openPopup.bind(this),this.parent=e,this.locator=t,this.fltrSettings=i,this.parent&&(this.parent.on(T,this.destroy,this),this.parent.on(F,this.destroy,this))}return e.prototype.create=function(e){var t=er(e.column.format,e.column.type);this.dialogObj=e.dialogObj,this.inputElem=this.parent.createElement("input",{className:"e-flmenu-input",id:"dateui-"+e.column.uid}),e.target.appendChild(this.inputElem),"date"===e.column.type?this.datePickerObj=new sf.calendars.DatePicker(sf.base.extend({format:t,cssClass:"e-popup-flmenu",placeholder:e.localizeText.getConstant("ChooseDate"),width:"100%",locale:this.parent.locale,enableRtl:this.parent.enableRtl},e.column.filter.params)):"datetime"===e.column.type&&(this.datePickerObj=new sf.calendars.DateTimePicker(sf.base.extend({format:t,cssClass:"e-popup-flmenu",placeholder:e.localizeText.getConstant("ChooseDate"),width:"100%",locale:this.parent.locale,enableRtl:this.parent.enableRtl},e.column.filter.params))),this.datePickerObj.addEventListener(ae,this.dpOpen),this.datePickerObj.appendTo(this.inputElem)},e.prototype.write=function(e){document.querySelector("#dateui-"+e.column.uid).ej2_instances[0].value=sf.base.isNullOrUndefined(e.filteredValue)?null:new Date(e.filteredValue)},e.prototype.read=function(e,t,i,r){var n=document.querySelector("#dateui-"+t.uid).ej2_instances[0].value;n=sf.base.isNullOrUndefined(n)?null:n,r.filterByColumn(t.field,i,n,"and",!0)},e.prototype.openPopup=function(e){e.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()},e.prototype.destroy=function(){this.parent.off(T,this.destroy),this.parent.off(F,this.destroy),sf.base.isNullOrUndefined(this.datePickerObj)||this.datePickerObj.isDestroyed||(this.datePickerObj.removeEventListener(ae,this.dpOpen),this.datePickerObj.destroy())},e}(),Cn=function(){function e(e,t,i,r,n){this.isDialogOpen=!1,this.maxHeight="350px",this.isMenuCheck=!1,this.colTypes={string:mn,number:yn,date:bn,boolean:vn,datetime:bn},this.parent=e,this.filterSettings=t,this.serviceLocator=i,this.customFilterOperators=r,this.filterObj=n,this.flMuiObj=new gn(this.parent,this.customFilterOperators,this.serviceLocator),this.l10n=this.serviceLocator.getService("localization"),this.menuFilterBase=new $r(e)}return e.prototype.clearCustomFilter=function(e){this.clearBtnClick(e)},e.prototype.applyCustomFilter=function(e){this.filterBtnClick(e.col)},e.prototype.openDialog=function(e){this.options=e,this.col=this.parent.getColumnByField(e.field),(sf.base.isNullOrUndefined(this.col.filter)||sf.base.isNullOrUndefined(this.col.filter.type)||"Menu"===this.col.filter.type)&&this.renderDlgContent(e.target,this.col)},e.prototype.closeDialog=function(e){if(this.dlgObj){(this.parent.isReact||this.parent.isVue)&&jr(this.parent,["filterTemplate"]);var t=document.getElementById(this.dlgObj.element.id);if(this.dlgObj&&!this.dlgObj.isDestroyed&&t){var i={cancel:!1,column:this.col,target:e,element:t};if(this.parent.notify(T,i),i.cancel)return;this.isDialogOpen=!1,this.isMenuCheck&&(this.menuFilterBase.unWireEvents(),this.parent.off(z,this.actionComplete),this.isMenuCheck=!1),this.dlgObj.destroy(),sf.base.remove(t)}this.parent.notify("filter-dialog-close",{})}},e.prototype.renderDlgContent=function(e,t){var i={requestType:"filterbeforeopen",columnName:t.field,columnType:t.type};i.filterModel=this,this.parent.trigger(p,i);var r=this.parent.createElement("div",{className:"e-flmenu-maindiv",id:t.uid+"-flmenu"});(this.dlgDiv=this.parent.createElement("div",{className:"e-flmenu",id:t.uid+"-flmdlg"}),this.dlgDiv.setAttribute("aria-label",this.l10n.getConstant("FilterMenuDialogARIA")),this.parent.enableAdaptiveUI)?document.querySelector(".e-resfilter > .e-dlg-content > .e-mainfilterdiv").appendChild(this.dlgDiv):this.parent.element.appendChild(this.dlgDiv);this.dlgObj=new sf.popups.Dialog({showCloseIcon:!1,closeOnEscape:!1,locale:this.parent.locale,visible:!1,enableRtl:this.parent.enableRtl,created:this.dialogCreated.bind(this,e,t),position:this.parent.element.classList.contains("e-device")?{X:"center",Y:"center"}:{X:"",Y:""},target:this.parent.element.classList.contains("e-device")?document.body:this.parent.element,buttons:[{click:this.filterBtnClick.bind(this,t),buttonModel:{content:this.l10n.getConstant("FilterButton"),isPrimary:!0,cssClass:"e-flmenu-okbtn"}},{click:this.clearBtnClick.bind(this,t),buttonModel:{content:this.l10n.getConstant("ClearButton"),cssClass:"e-flmenu-cancelbtn"}}],content:r,width:!sf.base.isNullOrUndefined(yi(e,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:250,animationSettings:{effect:"None"},cssClass:"e-filter-popup"});this.dlgObj.isStringTemplate=!0,this.renderResponsiveDialog(),this.dlgObj.appendTo(this.dlgDiv)},e.prototype.renderResponsiveDialog=function(){this.parent.enableAdaptiveUI&&(this.dlgObj.position={X:"",Y:""},this.dlgObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-mainfilterdiv"),this.dlgObj.width="100%",this.dlgObj.isModal=!1,this.dlgObj.buttons=[{}])},e.prototype.dialogCreated=function(e,t){!sf.base.Browser.isDevice&&e&&Ui(e,this.dlgObj),this.renderFilterUI(e,t),this.parent.notify("filterDialogCreated",{}),this.parent.enableAdaptiveUI?(this.dlgObj.element.style.left="0px",this.dlgObj.element.style.maxHeight="none"):this.dlgObj.element.style.maxHeight=this.maxHeight,this.dlgObj.show(),t.filterTemplate||this.writeMethod(t,this.dlgObj.element.querySelector("#"+t.uid+"-flmenu"));var i={requestType:"filterafteropen",columnName:t.field,columnType:t.type};i.filterModel=this,this.isDialogOpen=!0,this.isMenuCheck||this.parent.trigger(c,i)},e.prototype.renderFilterUI=function(e,t){var i=this.dlgObj.element.querySelector(".e-flmenu-maindiv");this.parent.log("column_type_missing",{column:t}),this.renderOperatorUI(i,e,t),this.renderFlValueUI(i,e,t)},e.prototype.renderOperatorUI=function(e,t,i){this.flMuiObj.renderOperatorUI(e,t,i,this.dlgObj,this.filterObj.menuOperator)},e.prototype.renderFlValueUI=function(e,t,i){var r=this.parent.createElement("div",{className:"e-flmenu-valuediv"}),n=this.filterObj;e.appendChild(r);var s=new this.colTypes[i.type](this.parent,this.serviceLocator,this.parent.filterSettings);if(i.filterTemplate){var o={};o[i.field]=o.value=n.values[i.field],i.foreignKeyValue&&(o[i.foreignKeyValue]=n.values[i.field],o[i.field]=void 0);o.column=i;var a=this.parent.isReact&&"string"!=typeof i.filterTemplate,l=this.parent.element.id+i.uid+"filterTemplate";if(a)i.getFilterTemplate()(o,this.parent,"filterTemplate",l,null,null,r),this.parent.renderTemplates();else Fi(r,i.getFilterTemplate()(o,this.parent,"filterTemplate",l));this.isMenuCheck&&(this.menuFilterBase.cBox=this.dlgObj.element.querySelector(".e-checkboxlist.e-fields"),this.menuFilterBase.wireEvents(),this.parent.on(z,this.actionComplete,this),this.menuFilterBase.getAllData())}else if(sf.base.isNullOrUndefined(i.filter)||sf.base.isNullOrUndefined(i.filter.ui)||sf.base.isNullOrUndefined(i.filter.ui.create))s.create({column:i,target:r,getOptrInstance:this.flMuiObj,localizeText:this.l10n,dialogObj:this.dlgObj});else{var h=i.filter.ui.create;"string"==typeof h&&(h=sf.base.getValue(h,window)),h({column:i,target:r,getOptrInstance:this.flMuiObj,dialogObj:this.dlgObj})}},e.prototype.writeMethod=function(e,t){for(var i,r=t.querySelector(".e-flmenu-valinput"),n=new this.colTypes[e.type](this.parent,this.serviceLocator,this.parent.filterSettings),s=0,o=this.filterSettings.columns;s<o.length;s++){var a=o[s];e.uid===a.uid&&(i=a.value)}if(sf.base.isNullOrUndefined(e.filter)||sf.base.isNullOrUndefined(e.filter.ui)||sf.base.isNullOrUndefined(e.filter.ui.write))n.write({column:e,target:r,parent:this.parent,filteredValue:i});else{var l=e.filter.ui.write;"string"==typeof l&&(l=sf.base.getValue(l,window)),l({column:e,target:r,parent:this.parent,filteredValue:i})}},e.prototype.filterBtnClick=function(e){var t=this.dlgObj.element.querySelector(".e-flmenu-valuediv input"),i=this.flMuiObj.getFlOperator(),r=new this.colTypes[e.type](this.parent,this.serviceLocator,this.parent.filterSettings);if(e.filterTemplate){var n=this.dlgDiv.querySelector(".e-flmenu-valuediv"),s=void 0;if(n.children[0].value)s=n.children[0].value;else if(sf.base.isNullOrUndefined(n.children[0].ej2_instances)){var o=n.querySelector(".e-control");s="boolean"===e.type?o.checked:sf.base.isNullOrUndefined(o.ej2_instances)?o.value:o.ej2_instances[0].value}else s=(this.parent.isAngular?n.children[0]:n.querySelector("input")).ej2_instances[0].value;this.filterObj.filterByColumn(e.field,i,s)}else if(sf.base.isNullOrUndefined(e.filter)||sf.base.isNullOrUndefined(e.filter.ui)||sf.base.isNullOrUndefined(e.filter.ui.read))r.read(t,e,i,this.filterObj);else{var a=e.filter.ui.read;"string"==typeof a&&(a=sf.base.getValue(a,window)),a({element:t,column:e,operator:i,fltrObj:this.filterObj})}this.closeDialog()},e.prototype.closeResponsiveDialog=function(){this.closeDialog()},e.prototype.clearBtnClick=function(e){this.filterObj.removeFilteredColsByField(e.field),this.closeDialog();var t=this.parent.showColumnMenu?".e-columnmenu":".e-icon-filter",i=this.parent.element.querySelector('[e-mappinguid="'+e.uid+'"]').parentElement.querySelector(t);i&&i.classList.remove("e-filtered")},e.prototype.destroy=function(){this.closeDialog()},e.prototype.getFilterUIInfo=function(){return{field:this.col.field,operator:this.flMuiObj.getFlOperator()}},e.prototype.renderCheckBoxMenu=function(){return this.isMenuCheck=!0,this.menuFilterBase.updateModel(this.options),this.menuFilterBase.getAndSetChkElem(this.options),this.dlgObj.buttons=[{click:this.menuFilterBase.btnClick.bind(this.menuFilterBase),buttonModel:{content:this.menuFilterBase.getLocalizedLabel("FilterButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.menuFilterBase.btnClick.bind(this.menuFilterBase),buttonModel:{cssClass:"e-flat",content:this.menuFilterBase.getLocalizedLabel("ClearButton")}}],this.menuFilterBase.dialogObj=this.dlgObj,this.menuFilterBase.dlg=this.dlgObj.element,this.menuFilterBase.dlg.classList.add("e-menucheckbox"),this.menuFilterBase.dlg.classList.remove("e-checkboxfilter"),this.maxHeight="800px",this.menuFilterBase.sBox.innerHTML},e.prototype.actionComplete=function(e){this.isMenuCheck&&this.parent.trigger(c,e)},e}(),wn=function(){function e(e,t,i){this.parent=e,this.isresetFocus=!0,this.checkBoxBase=new $r(e),this.addEventListener()}return e.prototype.destroy=function(){this.removeEventListener(),this.checkBoxBase.closeDialog()},e.prototype.openDialog=function(e){this.checkBoxBase.openDialog(e),this.parent.log("column_type_missing",{column:e.column})},e.prototype.closeDialog=function(){this.destroy(),this.isresetFocus&&this.parent.notify("restore-Focus",{})},e.prototype.closeResponsiveDialog=function(){this.checkBoxBase.closeDialog()},e.prototype.getModuleName=function(){return"checkboxFilter"},e.prototype.actionBegin=function(e){this.parent.trigger(p,e)},e.prototype.actionComplete=function(e){this.parent.trigger(c,e)},e.prototype.actionPrevent=function(e){Ni(this.parent)&&(this.parent.notify(I,e),e.cancel=!0)},e.prototype.clearCustomFilter=function(e){this.checkBoxBase.clearFilter(e)},e.prototype.applyCustomFilter=function(){this.checkBoxBase.fltrBtnHandler(),this.checkBoxBase.closeDialog()},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on("cbox-filter-begin",this.actionBegin,this),this.parent.on(z,this.actionComplete,this),this.parent.on(D,this.actionPrevent,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("cbox-filter-begin",this.actionBegin),this.parent.off(z,this.actionComplete),this.parent.off(D,this.actionPrevent))},e}(),Sn=(Yr=function(e,t){return(Yr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Yr(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),xn=function(e){function t(t,i,r,n){var s=e.call(this,t,i,r)||this;return s.parent=t,s.isresetFocus=!0,s.excelFilterBase=new tn(t,n),s}return Sn(t,e),t.prototype.destroy=function(){this.excelFilterBase.closeDialog()},t.prototype.openDialog=function(e){this.excelFilterBase.openDialog(e)},t.prototype.closeDialog=function(){this.excelFilterBase.closeDialog(),this.isresetFocus&&this.parent.notify("restore-Focus",{})},t.prototype.clearCustomFilter=function(e){this.excelFilterBase.clearFilter(e)},t.prototype.closeResponsiveDialog=function(e){e?this.excelFilterBase.removeDialog():this.closeDialog()},t.prototype.applyCustomFilter=function(e){e.isCustomFilter?this.excelFilterBase.filterBtnClick(e.col.field):(this.excelFilterBase.fltrBtnHandler(),this.excelFilterBase.closeDialog())},t.prototype.filterByColumn=function(e,t,i,r,n,s,o,a){this.excelFilterBase.filterByColumn(e,t,i,r,n,s,o,a)},t.prototype.getFilterUIInfo=function(){return this.excelFilterBase.getFilterUIInfo()},t.prototype.getModuleName=function(){return"excelFilter"},t}(wn),Rn=function(){function t(e,t,i){this.predicate="and",this.contentRefresh=!0,this.filterByMethod=!0,this.refresh=!0,this.values={},this.operators={},this.cellText={},this.nextFlMenuOpen="",this.type={Menu:Cn,CheckBox:wn,Excel:xn},this.filterOperators={contains:"contains",endsWith:"endswith",equal:"equal",greaterThan:"greaterthan",greaterThanOrEqual:"greaterthanorequal",lessThan:"lessthan",lessThanOrEqual:"lessthanorequal",notEqual:"notequal",startsWith:"startswith"},this.fltrDlgDetails={field:"",isOpen:!1},this.skipNumberInput=["="," ","!"],this.skipStringInput=[">","<","="],this.actualPredicate={},this.parent=e,this.filterSettings=t,this.serviceLocator=i,this.addEventListener(),this.setFullScreenDialog()}return t.prototype.render=function(t){if(!(sf.data.DataUtil.getObject("args.isFrozen",t)||this.parent.getFrozenMode()===ee&&sf.data.DataUtil.getObject("args.renderFrozenRightContent",t))){var i=this.parent;if(this.l10n=this.serviceLocator.getService("localization"),this.getLocalizedCustomOperators(),"FilterBar"===this.parent.filterSettings.type&&i.columns.length){var r=this.parent.element.querySelector(".e-filterbar");r&&sf.base.remove(r);var n=new le(this.serviceLocator,e.CellType.Filter,i);this.serviceLocator.getService("cellRendererFactory").addCellRenderer(e.CellType.Filter,new fn(this.parent,this.serviceLocator)),this.valueFormatter=this.serviceLocator.getService("valueFormatter"),n.element=this.parent.createElement("tr",{className:"e-filterbar"});var s=this.generateRow();if(s.data=this.values,"Right"===i.getFrozenMode())i.getFrozenRightHeader().querySelector("thead").appendChild(n.element);else this.parent.getHeaderContent().querySelector("thead").appendChild(n.element);var o=this.parent.element.querySelector(".e-rowdragheader");this.element=n.render(s,i.getColumns(),null,null,n.element);var a=this.element.querySelector(".e-detailheadercell");a&&(a.className="e-filterbarcell e-mastercell"),o&&(o.className="e-dragheadercell e-mastercell");var l=[].slice.call(this.element.getElementsByClassName("e-grouptopleftcell"));l.length&&l[l.length-1].classList.add("e-lastgrouptopleftcell"),this.wireEvents(),this.parent.notify("freezerender",{case:"filter"})}}},t.prototype.showCustomFilter=function(e){this.responsiveDialogRenderer.isCustomDialog=e,this.responsiveDialogRenderer.showResponsiveDialog(this.column)},t.prototype.setFilterModel=function(e){var t=e.filter.type||this.parent.filterSettings.type;this.filterModule=new this.type[t](this.parent,this.parent.filterSettings,this.serviceLocator,this.customOperators,this)},t.prototype.destroy=function(){var e=this.parent.element;if(e&&(e.querySelector("."+H)||e.querySelector("."+U))){if(this.filterModule&&this.filterModule.destroy(),this.parent.refreshing||!this.parent.isDestroyed&&this.parent.allowFiltering||(this.filterSettings.columns=[]),this.updateFilterMsg(),this.removeEventListener(),this.unWireEvents(),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator)for(var t=[].slice.call(this.element.getElementsByClassName("e-filterbaroperator")),i=0;i<t.length;i++)t[i].ej2_instances[0]&&t[i].ej2_instances[0].destroy();if(this.element){this.element.parentElement&&sf.base.remove(this.element);var r=this.parent.getHeaderContent().querySelector(".e-filterbar");this.parent.isFrozenGrid()&&r&&sf.base.remove(r)}}},t.prototype.setFullScreenDialog=function(){this.serviceLocator&&this.serviceLocator.registerAdaptiveService(this,this.parent.enableAdaptiveUI,e.ResponsiveDialogAction.isFilter)},t.prototype.generateRow=function(){var e=new N({});return e.cells=this.generateCells(),e},t.prototype.generateCells=function(){var t=[];if(this.parent.allowGrouping)for(var i=0,r=this.parent.groupSettings.columns.length;i<r;i++)t.push(this.generateCell({},e.CellType.HeaderIndent));(this.parent.detailTemplate||this.parent.childGrid)&&t.push(this.generateCell({},e.CellType.DetailHeader)),this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()&&t.push(this.generateCell({},e.CellType.RowDragHIcon));for(var n=0,s=this.parent.getColumns();n<s.length;n++){var o=s[n];t.push(this.generateCell(o))}return"Right"===this.parent.getFrozenMode()&&t.push(this.generateCell({},e.CellType.RowDragHIcon)),t},t.prototype.generateCell=function(t,i){var r={visible:t.visible,isDataCell:!1,rowId:"",column:t,cellType:i||e.CellType.Filter,attributes:{title:this.l10n.getConstant("FilterbarTitle")}};return new P(r)},t.prototype.updateModel=function(){var e=this.parent.getColumnByField(this.fieldName);this.filterObjIndex=this.getFilteredColsIndexByField(e),this.prevFilterObject=this.filterSettings.columns[this.filterObjIndex];for(var t=Array.isArray(this.value)?this.value:[this.value],i=0,r=t.length;i<r;i++){var n=e.isForeignColumn()?e.foreignKeyValue:this.fieldName;this.currentFilterObject={field:n,uid:e.uid,isForeignKey:e.isForeignColumn(),operator:this.operator,value:t[i],predicate:this.predicate,matchCase:this.matchCase,ignoreAccent:this.ignoreAccent,actualFilterValue:{},actualOperator:{}};var s=this.getFilteredColsIndexByField(e);s>-1&&!Array.isArray(this.value)?this.filterSettings.columns[s]=this.currentFilterObject:this.filterSettings.columns.push(this.currentFilterObject)}this.filterSettings.columns=this.filterSettings.columns,this.parent.dataBind()},t.prototype.getFilteredColsIndexByField=function(e){for(var t=this.filterSettings.columns,i=0,r=t.length;i<r;i++)if(t[i].uid===e.uid||e.isForeignColumn()&&this.parent.getColumnByUid(e.uid).field===e.foreignKeyValue)return i;return-1},t.prototype.onActionComplete=function(e){var t=this.isRemove?{requestType:"filtering",type:c}:{currentFilterObject:this.currentFilterObject,currentFilteringColumn:sf.base.isNullOrUndefined(this.column)?void 0:this.column.field,columns:this.filterSettings.columns,requestType:"filtering",type:c};this.parent.trigger(c,sf.base.extend(e,t)),this.isRemove=!1},t.prototype.wireEvents=function(){sf.base.EventHandler.add(this.parent.getHeaderContent(),"keyup",this.keyUpHandlerImmediate,this)},t.prototype.unWireEvents=function(){sf.base.EventHandler.remove(this.parent.getHeaderContent(),"keyup",this.keyUpHandlerImmediate)},t.prototype.enableAfterRender=function(e){e.module===this.getModuleName()&&e.enable&&(this.parent.getHeaderTable().classList.add("e-sortfilter"),this.render())},t.prototype.refreshFilterValue=function(){"FilterBar"===this.filterSettings.type&&this.filterSettings.columns.length&&!this.parent.getCurrentViewRecords().length&&this.parent.enablePersistence&&(this.initialEnd(),this.parent.removeEventListener("beforeDataBound",this.refreshFilterValueFn))},t.prototype.initialEnd=function(){if(this.parent.off(y,this.initialEnd),this.parent.getColumns().length&&this.filterSettings.columns.length){var e=this.parent;this.contentRefresh=!1,this.initialLoad=!0;for(var t=0,i=e.filterSettings.columns;t<i.length;t++){var r=i[t];this.filterByColumn(r.field,r.operator,r.value,r.predicate,r.matchCase,r.ignoreAccent,r.actualFilterValue,r.actualOperator)}this.initialLoad=!1,this.updateFilterMsg(),this.contentRefresh=!0}},t.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on("set-fullscreen-dialog",this.setFullScreenDialog,this),this.parent.on(v,this.enableAfterRender,this),this.parent.on("filtering-complete",this.onActionComplete,this),this.parent.on(C,this.onPropertyChanged,this),this.parent.on(x,this.keyUpHandler,this),this.parent.on("column-position-changed",this.columnPositionChanged,this),this.parent.on(S,this.render,this),this.parent.on(y,this.initialEnd,this),this.parent.on(T,this.filterMenuClose,this),this.docClickHandler=this.clickHandler.bind(this),sf.base.EventHandler.add(document,"click",this.docClickHandler,this),sf.base.EventHandler.add(this.parent.element,"mousedown",this.refreshClearIcon,this),this.parent.on("filterOpen",this.columnMenuFilter,this),this.parent.on(R,this.filterIconClickHandler,this),this.parent.on("persist-data-changed",this.initialEnd,this),this.parent.on("close-filter-dialog",this.clickHandler,this),this.parent.on(F,this.destroy,this),this.refreshFilterValueFn=this.refreshFilterValue.bind(this),this.parent.addEventListener("beforeDataBound",this.refreshFilterValueFn))},t.prototype.removeEventListener=function(){sf.base.EventHandler.remove(document,"click",this.docClickHandler),sf.base.EventHandler.remove(this.parent.element,"mousedown",this.refreshClearIcon),this.parent.isDestroyed||(this.parent.off("set-fullscreen-dialog",this.setFullScreenDialog),this.parent.off(v,this.enableAfterRender),this.parent.off("filtering-complete",this.onActionComplete),this.parent.off(C,this.onPropertyChanged),this.parent.off(x,this.keyUpHandler),this.parent.off("column-position-changed",this.columnPositionChanged),this.parent.off(S,this.render),this.parent.off("filterOpen",this.columnMenuFilter),this.parent.off(T,this.filterMenuClose),this.parent.off(R,this.filterIconClickHandler),this.parent.off("close-filter-dialog",this.clickHandler),this.parent.off(F,this.destroy))},t.prototype.refreshClearIcon=function(e){if(this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type&&e.target.classList.contains("e-clear-icon")){var t=e.target.previousElementSibling;sf.inputs.Input.setValue(null,t,"Never",!0),"Immediate"===this.filterSettings.mode&&this.removeFilteredColsByField(t.id.slice(0,-14))}},t.prototype.filterMenuClose=function(){this.fltrDlgDetails.isOpen=!1},t.prototype.filterByColumn=function(e,t,i,r,n,s,o,a){var l,h=this,d=this.parent;if(this.column=d.grabColumnByFieldFromAllCols(e),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&(t=this.getOperatorName(e)),this.column)if("FilterBar"===this.filterSettings.type&&(l=d.getHeaderContent().querySelector("[id='"+this.column.field+"_filterBarcell']")),sf.base.isNullOrUndefined(this.column.allowFiltering)||this.column.allowFiltering)if(Ni(d))d.notify(I,{instance:this,handler:this.filterByColumn,arg1:e,arg2:t,arg3:i,arg4:r,arg5:n,arg6:s,arg7:o,arg8:a});else{if(this.predicate=r||(Array.isArray(i)?"or":"and"),this.value=i,this.matchCase=n||!1,this.ignoreAccent=this.ignoreAccent=sf.base.isNullOrUndefined(s)?this.parent.filterSettings.ignoreAccent:s,this.fieldName=e,this.operator=t,i=sf.base.isNullOrUndefined(i)?i:i.toString(),"number"!==this.column.type&&"date"!==this.column.type||(this.matchCase=!0),d.getColumnHeaderByField(e).setAttribute("aria-filtered","true"),l&&"FilterBar"===this.filterSettings.type){if(i&&i.length<1||!this.filterByMethod&&this.checkForSkipInput(this.column,i))return this.filterStatusMsg=i&&i.length<1?"":this.l10n.getConstant("InvalidFilterMessage"),void this.updateFilterMsg();l.value!==i&&(l.value=i)}sf.base.isNullOrUndefined(this.column.format)?this.values[this.column.field]=i:(this.applyColumnFormat(i),this.initialLoad&&"FilterBar"===this.filterSettings.type&&(l.value=this.values[this.column.field]));var p={field:this.fieldName,predicate:r,matchCase:n,ignoreAccent:s,operator:this.operator,value:this.value,type:this.column.type};this.parent.filterSettings.columns.filter((function(e){return e.field===h.fieldName})).length>1&&!sf.base.isNullOrUndefined(this.actualPredicate[this.fieldName])?this.actualPredicate[this.fieldName].push(p):this.actualPredicate[this.fieldName]=[p],this.checkAlreadyColFiltered(this.column.field)||this.updateModel()}else this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:this.column.headerText})},t.prototype.applyColumnFormat=function(e){var t=this,i="date"===this.column.type||"datetime"===this.column.type?new Date(e):parseFloat(e);("date"===this.column.type||"datetime"===this.column.type)&&e&&e.split(",").length>1?this.values[this.column.field]=e.split(",").map((function(e){return t.setFormatForFlColumn(new Date(e),t.column)})):this.values[this.column.field]=this.setFormatForFlColumn(i,this.column)},t.prototype.skipUid=function(e){for(var t=!0,i=Object.keys(e),r=0;r<i.length;r++){var n=Object.keys(e[i[r]]);1===n.length&&"uid"===n[0]&&(t=!1)}return t},t.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName())for(var t=0,i=Object.keys(e.properties);t<i.length;t++){var r=i[t];switch(r){case"columns":var n={currentFilterObject:this.currentFilterObject,currentFilteringColumn:this.column?this.column.field:void 0,action:"filter",columns:this.filterSettings.columns,requestType:"filtering",type:p,cancel:!1};if(this.contentRefresh&&this.skipUid(e.properties.columns)){if(this.parent.notify(w,n),n.cancel)return void(sf.base.isNullOrUndefined(this.prevFilterObject)?this.filterSettings.columns.splice(this.filterSettings.columns.length-1,1):this.filterSettings.columns[this.filterObjIndex]=this.prevFilterObject);this.updateFilterIcon(),this.refreshFilterSettings(),this.updateFilterMsg(),this.updateFilter()}break;case"showFilterBarStatus":e.properties[r]?this.updateFilterMsg():this.parent.allowPaging&&this.parent.updateExternalMessage("");break;case"showFilterBarOperator":case"type":this.parent.refreshHeader(),this.refreshFilterSettings()}}},t.prototype.refreshFilterSettings=function(){if("FilterBar"===this.filterSettings.type){for(var e=0;e<this.filterSettings.columns.length;e++){this.column=this.parent.grabColumnByUidFromAllCols(this.filterSettings.columns[e].uid);var t=this.filterSettings.columns[e].value;if(t=!sf.base.isNullOrUndefined(t)&&t.toString(),sf.base.isNullOrUndefined(this.column.format)){var i=this.filterSettings.columns[e].field;this.values[i]=this.filterSettings.columns[e].value}else this.applyColumnFormat(t);(n=this.getFilterBarElement(this.column.field))&&(""===this.cellText[this.filterSettings.columns[e].field]||sf.base.isNullOrUndefined(this.cellText[this.filterSettings.columns[e].field])?n.value=this.filterSettings.columns[e].value:n.value=this.cellText[this.column.field])}if(0===this.filterSettings.columns.length){var r=this.parent.getColumns();for(e=0;e<r.length;e++){var n;(n=this.getFilterBarElement(r[e].field))&&""!==n.value&&(n.value="",delete this.values[r[e].field])}}}},t.prototype.updateFilterIcon=function(){if(0===this.filterSettings.columns.length&&this.parent.element.querySelector(".e-filtered"))for(var e=[].slice.call(this.parent.element.getElementsByClassName("e-filtered")),t=0,i=e.length;t<i;t++)e[t].removeAttribute("aria-filtered"),e[t].classList.remove("e-filtered")},t.prototype.getFilterBarElement=function(e){var t,i="[id='"+e+"_filterBarcell']";return i&&!sf.base.isNullOrUndefined(this.element)&&(t=this.element.querySelector(i)),t},t.prototype.refreshFilter=function(){this.refreshFilterSettings(),this.updateFilterMsg()},t.prototype.clearFiltering=function(e){var t=this,i=Ci(this.filterSettings.columns);if(!sf.base.isNullOrUndefined(e))return this.refresh=!1,e.forEach((function(e){t.removeFilteredColsByField(e,!1)})),this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0),this.parent.renderModule.refresh(),void(this.refresh=!0);if(Ni(this.parent))this.parent.notify(I,{instance:this,handler:this.clearFiltering});else{for(var r=0;r<i.length;r++)i[r].uid=i[r].uid||this.parent.getColumnByField(i[r].field).uid;var n=i.map((function(e){return e.uid})),s=n.filter((function(e,t){return n.indexOf(e)===t}));this.refresh=!1;r=0;for(var o=s.length;r<o;r++)this.removeFilteredColsByField(this.parent.getColumnByUid(s[r]).field,!1);if(this.refresh=!0,s.length&&this.parent.renderModule.refresh(),0===this.parent.filterSettings.columns.length&&this.parent.element.querySelector(".e-filtered")){var a=[].slice.call(this.parent.element.getElementsByClassName("e-filtered"));for(r=0,o=a.length;r<o;r++)a[0].removeAttribute("aria-filtered"),a[0].classList.remove("e-filtered")}this.isRemove=!0,this.filterStatusMsg="",this.updateFilterMsg()}},t.prototype.checkAlreadyColFiltered=function(e){for(var t=0,i=this.filterSettings.columns;t<i.length;t++){var r=i[t];if(r.field===e&&r.value===this.value&&r.operator===this.operator&&r.predicate===this.predicate)return!0}return!1},t.prototype.columnMenuFilter=function(e){this.column=e.col;var t=sf.base.closest(e.target,"#"+e.id);e.isClose&&!t?this.filterModule.closeDialog():t&&this.filterDialogOpen(this.column,e.target)},t.prototype.filterDialogOpen=function(e,t,i,r){this.filterModule&&this.filterModule.closeDialog(),this.setFilterModel(e),this.filterModule.openDialog(this.createOptions(e,t,i,r))},t.prototype.createOptions=function(e,t,i,r){var n=this.parent,s=e.filter.dataSource||n.dataSource&&"result"in n.dataSource?n.dataSource:n.getDataModule().dataManager,o=e.filter.type||this.parent.filterSettings.type;return{type:e.type,field:e.field,displayName:e.headerText,dataSource:s,format:e.format,height:800,columns:n.getColumns(),filteredColumns:n.filterSettings.columns,target:t,dataManager:n.getDataModule().dataManager,formatFn:e.getFormatter(),ignoreAccent:n.filterSettings.ignoreAccent,parserFn:e.getParser(),query:n.query,template:e.getFilterItemTemplate(),hideSearchbox:!sf.base.isNullOrUndefined(e.filter.hideSearchbox)&&e.filter.hideSearchbox,handler:this.filterHandler.bind(this),localizedStrings:n.getLocaleConstants(),position:{X:i,Y:r},column:e,foreignKeyValue:e.foreignKeyValue,actualPredicate:this.actualPredicate,localeObj:n.localeObj,isRemote:n.getDataModule().isRemote(),allowCaseSensitive:this.filterSettings.enableCaseSensitivity,isResponsiveFilter:this.parent.enableAdaptiveUI,operator:this.actualPredicate[e.field]&&"Menu"===o?this.actualPredicate[e.field][0].operator:"equal"}},t.prototype.removeFilteredColsByField=function(e,t){var i,r=this.filterSettings.columns;if(Ni(this.parent)){var n={instance:this,handler:this.removeFilteredColsByField,arg1:e,arg2:t};this.parent.notify(I,n)}else{for(var s=r.map((function(e){return e.uid})),o=s.filter((function(e,t){return s.indexOf(e)===t})),a=function(n,s){r[n].uid=r[n].uid||l.parent.getColumnByField(r[n].field).uid;var a=r.length,h=l.parent.grabColumnByUidFromAllCols(o[n]);if(h.field===e||h.field===h.foreignKeyValue&&h.isForeignColumn()){var d=l.filterSettings.columns.filter((function(e){return e.uid===h.uid}))[0];if("FilterBar"===l.filterSettings.type&&!t){var c="[id='"+h.field+"_filterBarcell']";(i=l.parent.getHeaderContent().querySelector(c))&&(i.value="",delete l.values[e])}for(;a--;)r[a].uid===h.uid&&r.splice(a,1);var u=l.parent.getColumnHeaderByField(h.field);if(u.removeAttribute("aria-filtered"),"FilterBar"!==l.filterSettings.type){var f=l.parent.showColumnMenu?".e-columnmenu":".e-icon-filter";u.querySelector(f).classList.remove("e-filtered")}return l.isRemove=!0,l.actualPredicate[e]&&delete l.actualPredicate[e],l.values[e]&&delete l.values[e],l.refresh&&l.parent.notify(w,{requestType:"filtering",type:p,currentFilterObject:d,currentFilterColumn:h,action:"clearFilter"}),"break"}},l=this,h=0,d=o.length;h<d;h++){if("break"===a(h))break}this.updateFilterMsg()}},t.prototype.getModuleName=function(){return"filter"},t.prototype.keyUpHandlerImmediate=function(e){13!==e.keyCode&&this.keyUpHandler(e)},t.prototype.keyUpHandler=function(e){var t=this.parent,i=e.target;if(i&&sf.base.matches(i,".e-filterbar input")){var r=sf.base.closest(i,"th.e-filterbarcell");if(this.column=t.getColumnByUid(r.getAttribute("e-mappinguid")),!this.column)return;if("altDownArrow"===e.action&&this.parent.filterSettings.showFilterBarOperator){var n=sf.base.closest(i,"span").querySelector(".e-filterbaroperator");n.ej2_instances[0].showPopup(),n.focus()}"Immediate"!==this.filterSettings.mode&&(13!==e.keyCode||e.target.classList.contains("e-filterbaroperator"))||9===e.keyCode||this.column.filterTemplate||(this.value=i.value.trim(),this.processFilter(e))}if("altDownArrow"===e.action&&"FilterBar"!==this.filterSettings.type){var s=t.focusModule.currentInfo.element;if(s&&s.classList.contains("e-headercell")){var o=t.getColumnByUid(s.firstElementChild.getAttribute("e-mappinguid"));this.openMenuByField(o.field),this.parent.focusModule.clearIndicator()}}"escape"===e.action&&"Menu"===this.filterSettings.type&&this.filterModule&&(this.filterModule.closeDialog(),t.notify("restore-Focus",{}))},t.prototype.updateCrossIcon=function(e){e.value.length&&e.nextElementSibling.classList.remove("e-hide")},t.prototype.updateFilterMsg=function(){if("FilterBar"===this.filterSettings.type){var e=this.parent,t=void 0,i=this.filterSettings.columns,r=void 0;if(!this.filterSettings.showFilterBarStatus)return;if(i.length>0&&this.filterStatusMsg!==this.l10n.getConstant("InvalidFilterMessage")){this.filterStatusMsg="";for(var n=0;n<i.length;n++)if(r=e.grabColumnByUidFromAllCols(i[n].uid)||e.grabColumnByFieldFromAllCols(i[n].field),n&&(this.filterStatusMsg+=" && "),sf.base.isNullOrUndefined(r.format))this.filterStatusMsg+=r.headerText+": "+this.values[r.field];else{var s="date"===r.type||"datetime"===r.type?this.valueFormatter.fromView(this.values[r.field],r.getParser(),r.type):this.values[r.field];if("date"!==r.type&&"datetime"!==r.type)t=this.serviceLocator.getService("valueFormatter").toView(s,r.getParser()).toString();else t=this.setFormatForFlColumn(s,r);this.filterStatusMsg+=r.headerText+": "+t}}e.allowPaging&&e.updateExternalMessage(this.filterStatusMsg),this.filterStatusMsg=""}},t.prototype.setFormatForFlColumn=function(e,t){return this.serviceLocator.getService("valueFormatter").toView(e,t.getFormatter()).toString()},t.prototype.checkForSkipInput=function(e,t){var i;if("number"===e.type)(sf.data.DataUtil.operatorSymbols[t]||this.skipNumberInput.indexOf(t)>-1)&&(i=!0);else if("string"===e.type)for(var r=0,n=t;r<n.length;r++){var s=n[r];this.skipStringInput.indexOf(s)>-1&&(i=!0)}return i},t.prototype.processFilter=function(e){this.stopTimer(),this.startTimer(e)},t.prototype.startTimer=function(e){var t=this;this.timer=window.setInterval((function(){t.onTimerTick()}),13===e.keyCode?0:this.filterSettings.immediateModeDelay)},t.prototype.stopTimer=function(){window.clearInterval(this.timer)},t.prototype.onTimerTick=function(){var e,t="[id='"+this.column.field+"_filterBarcell']",i=this.element.querySelector(t);if(!i&&this.parent.isFrozenGrid()&&(i=this.parent.getHeaderContent().querySelector(t)),this.cellText[this.column.field]=i.value,this.stopTimer(),sf.base.isNullOrUndefined(this.column.filterBarTemplate))e=JSON.parse(JSON.stringify(i.value));else{var r=this.column.filterBarTemplate.read;"string"==typeof r&&(r=sf.base.getValue(r,window)),sf.base.isNullOrUndefined(r)||(this.value=r.call(this,i))}sf.base.isNullOrUndefined(this.value)||""===this.value?this.removeFilteredColsByField(this.column.field):(this.validateFilterValue(this.value),this.filterByMethod=!1,this.filterByColumn(this.column.field,this.operator,this.value,this.predicate,this.filterSettings.enableCaseSensitivity,this.ignoreAccent),this.filterByMethod=!0,i.value=e,this.updateFilterMsg())},t.prototype.validateFilterValue=function(e){var t,i;switch(this.matchCase=this.filterSettings.enableCaseSensitivity,this.column.type){case"number":this.column.filter.operator?this.operator=this.column.filter.operator:this.operator=this.filterOperators.equal,t=[">","<","=","!"];for(var r=0;r<e.length;r++)if(t.indexOf(e[r])>-1){i=r;break}this.getOperator(e.substring(i)),0!==i&&(this.value=e.substring(0,i)),""!==this.value&&e.length>=1&&(this.value=this.valueFormatter.fromView(this.value,this.column.getParser(),this.column.type)),isNaN(this.value)&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage"));break;case"date":case"datetime":this.operator=this.filterOperators.equal,""===this.value||this.value instanceof Date||(this.getOperator(e),this.value=this.valueFormatter.fromView(this.value,this.column.getParser(),this.column.type),sf.base.isNullOrUndefined(this.value)&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage")));break;case"string":this.matchCase=!1,"*"===e.charAt(0)?(this.value=this.value.slice(1),this.operator=this.filterOperators.startsWith):"%"===e.charAt(e.length-1)?(this.value=this.value.slice(0,-1),this.operator=this.filterOperators.startsWith):"%"===e.charAt(0)?(this.value=this.value.slice(1),this.operator=this.filterOperators.endsWith):this.column.filter.operator?this.operator=this.column.filter.operator:this.operator=this.filterOperators.startsWith;break;case"boolean":"true"===e.toLowerCase()||"1"===e?this.value=!0:"false"===e.toLowerCase()||"0"===e?this.value=!1:e.length&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage")),this.operator=this.filterOperators.equal;break;default:this.column.filter.operator?this.operator=this.column.filter.operator:this.operator=this.filterOperators.equal}},t.prototype.getOperator=function(e){var t=e.charAt(0),i=e.slice(0,2),r=sf.base.extend({"=":this.filterOperators.equal,"!":this.filterOperators.notEqual},sf.data.DataUtil.operatorSymbols);(r.hasOwnProperty(t)||r.hasOwnProperty(i))&&(this.operator=r[t],this.value=e.substring(1),this.operator||(this.operator=r[i],this.value=e.substring(2))),this.operator!==this.filterOperators.lessThan&&this.operator!==this.filterOperators.greaterThan||"="===this.value.charAt(0)&&(this.operator=this.operator+"orequal",this.value=this.value.substring(1))},t.prototype.columnPositionChanged=function(){this.parent.filterSettings.type},t.prototype.getLocalizedCustomOperators=function(){var e=[{value:"equal",text:this.l10n.getConstant("Equal")},{value:"greaterthan",text:this.l10n.getConstant("GreaterThan")},{value:"greaterthanorequal",text:this.l10n.getConstant("GreaterThanOrEqual")},{value:"lessthan",text:this.l10n.getConstant("LessThan")},{value:"lessthanorequal",text:this.l10n.getConstant("LessThanOrEqual")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}];this.customOperators={stringOperator:[{value:"startswith",text:this.l10n.getConstant("StartsWith")},{value:"endswith",text:this.l10n.getConstant("EndsWith")},{value:"contains",text:this.l10n.getConstant("Contains")},{value:"equal",text:this.l10n.getConstant("Equal")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}],numberOperator:e,dateOperator:e,datetimeOperator:e,booleanOperator:[{value:"equal",text:this.l10n.getConstant("Equal")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}]}},t.prototype.openMenuByField=function(e){var t=this.parent;if(t.enableAdaptiveUI)this.showCustomFilter(!1);else{var i=t.getColumnByField(e),r=t.getColumnHeaderByField(e).querySelector(".e-filtermenudiv");if(r){var n=t.element.getBoundingClientRect(),s=r.getBoundingClientRect();this.filterDialogOpen(i,r,s.right-n.left,s.bottom-n.top)}}},t.prototype.filterIconClickHandler=function(e){var t=e.target;if(t.classList.contains("e-filtermenudiv")&&("Menu"===this.parent.filterSettings.type||"CheckBox"===this.parent.filterSettings.type||"Excel"===this.parent.filterSettings.type)){var i=this.parent.getColumnByUid(yi(t,"e-headercell").firstElementChild.getAttribute("e-mappinguid"));if(this.column=i,this.fltrDlgDetails.field===i.field&&this.fltrDlgDetails.isOpen)return;this.filterModule&&this.filterModule.closeDialog(),this.fltrDlgDetails={field:i.field,isOpen:!0},this.openMenuByField(i.field)}},t.prototype.clickHandler=function(e){if("FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&(yi(e.target,"e-filterbarcell")&&e.target.classList.contains("e-input-group-icon")&&sf.base.closest(e.target,"div").querySelector(".e-filterbaroperator").focus(),e.target.classList.contains("e-list-item"))){var t=document.querySelector(".e-popup-open").getAttribute("id").replace("_popup","");-1!==t.indexOf("grid-column")&&sf.base.closest(document.getElementById(t),"div").querySelector(".e-filtertext").focus()}if("Immediate"===this.filterSettings.mode||"Menu"===this.parent.filterSettings.type||"CheckBox"===this.parent.filterSettings.type||"Excel"===this.parent.filterSettings.type){var i=e.target,r=i.classList.contains("e-day"),n=yi(this.parent.element,"e-dialog"),s=!1,o=yi(i,"e-popup"),a=this.parent.element.querySelector(".e-filter-popup");if(n&&o&&(s=n.id===o.id),a&&(yi(i,"e-excel-ascending")||yi(i,"e-excel-descending"))&&this.filterModule.closeDialog(i),yi(i,"e-filter-popup")||i.classList.contains("e-filtermenudiv"))return;!this.filterModule||yi(i,"e-popup-wrapper")||sf.base.closest(i,".e-filter-item.e-menu-item")||r||(s&&!yi(i,"e-filter-popup")&&!yi(i,"e-popup-flmenu")||!o&&a)&&(this.filterModule.isresetFocus=yi(i,"e-grid")&&yi(i,"e-grid").id===this.parent.element.id,this.filterModule.closeDialog(i))}},t.prototype.filterHandler=function(e){this.actualPredicate[e.field]=e.actualPredicate;for(var t=new sf.data.DataManager(this.filterSettings.columns),i=(new sf.data.Query).where("field",this.filterOperators.equal,e.field),r=t.executeLocal(i),n=0;n<r.length;n++){for(var s=-1,o=0;o<this.filterSettings.columns.length;o++)if(r[n].field===this.filterSettings.columns[o].field){s=o;break}-1!==s&&this.filterSettings.columns.splice(s,1)}this.values[e.field]&&delete this.values[e.field];var a=this.parent.showColumnMenu?".e-columnmenu":".e-icon-filter",l=this.parent.getColumnHeaderByField(e.field).querySelector(a);"filtering"===e.action?(this.filterSettings.columns=this.filterSettings.columns.concat(e.filterCollection),this.filterSettings.columns.length&&l&&l.classList.add("e-filtered")):(l&&l.classList.remove("e-filtered"),e.requestType="filtering",this.parent.renderModule.refresh(e)),this.parent.dataBind()},t.prototype.updateFilter=function(){var e=this.filterSettings.columns;this.actualPredicate={};for(var t=0;t<e.length;t++){this.column=this.parent.getColumnByField(e[t].field)||Xi(e[t].field,this.parent.getForeignKeyColumns());var i=e[t].field;this.parent.getColumnByField(e[t].field)||(i=Xi(e[t].field,this.parent.getForeignKeyColumns()).field),this.refreshFilterIcon(i,e[t].operator,e[t].value,e[t].type,e[t].predicate,e[t].matchCase,e[t].ignoreAccent,e[t].uid)}},t.prototype.refreshFilterIcon=function(e,t,i,r,n,s,o,a){var l={field:e,predicate:n,matchCase:s,ignoreAccent:o,operator:t,value:i,type:r};this.actualPredicate[e]?this.actualPredicate[e].push(l):this.actualPredicate[e]=[l];var h=a?this.parent.grabColumnByUidFromAllCols(a).field:e;this.addFilteredClass(h)},t.prototype.addFilteredClass=function(e){var t;this.parent.showColumnMenu?t=this.parent.getColumnHeaderByField(e).querySelector(".e-columnmenu"):this.parent.getColumnByField(e)&&(t=this.parent.getColumnHeaderByField(e).querySelector(".e-icon-filter")),t&&t.classList.add("e-filtered")},t.prototype.getFilterUIInfo=function(){return this.filterModule?this.filterModule.getFilterUIInfo():{}},t.prototype.getOperatorName=function(e){return document.getElementById(this.parent.getColumnByField(e).uid).ej2_instances[0].value},t.prototype.renderCheckboxOnFilterMenu=function(){return this.filterModule.renderCheckBoxMenu()},t}(),Fn={root:"e-rhandler",suppress:"e-rsuppress",icon:"e-ricon",helper:"e-rhelper",header:"th.e-headercell",cursor:"e-rcursor"},En=function(){function t(e){this.tapped=!1,this.isDblClk=!0,this.parent=e,this.parent.isDestroyed||(this.widthService=new ht(e),this.addEventListener())}return t.prototype.autoFitColumns=function(e){var t=null==e||e.length<=0?this.parent.getColumns().map((function(e){return e.field})):"string"==typeof e?[e]:e;this.findColumn(t)},t.prototype.autoFit=function(){var e=this.parent.getColumns().filter((function(e){return!0===e.autoFit})).map((function(e){return e.field||e.headerText}));e.length>0&&this.autoFitColumns(e),"Auto"===this.parent.resizeSettings.mode&&this.widthService.setWidthToTable()},t.prototype.resizeColumn=function(e,t,i){var r,n,s,o,a,l,d=this.parent,p=0,c=0,u=i||this.parent.getUidByColumnField(e),f=this.parent.getNormalizedColumnIndex(u),g=this.parent.getColumnIndexByField(e),m=d.getFrozenColumns()||d.getFrozenLeftColumnsCount(),y=d.getMovableColumnsCount();if(sf.base.isNullOrUndefined(d.getFooterContent())||(s=d.getFooterContentTable()),d.isFrozenGrid()){var v=d.getColumnByField(e);v.getFreezeTableName()===ie?(r=d.getHeaderTable(),n=d.getContentTable(),o=r.querySelector('[e-mappinguid="'+u+'"]').parentElement.cloneNode(!0),a=n.querySelectorAll("td:nth-child("+(f+1)+")"),s&&(l=s.querySelectorAll("td:nth-child("+(f+1)+")"))):"movable"===v.getFreezeTableName()?(r=d.getHeaderContent().querySelector("."+_).children[0],n=d.getContent().querySelector("."+G).children[0],o=r.querySelector('[e-mappinguid="'+u+'"]').parentElement.cloneNode(!0),a=n.querySelectorAll("td:nth-child("+(f-m+1)+")"),s&&(l=(s=d.getFooterContent().querySelector(".e-movablefootercontent").children[0]).querySelectorAll("td:nth-child("+(f-m+1)+")"))):v.getFreezeTableName()===te&&(r=d.getHeaderContent().querySelector(".e-frozen-right-header").children[0],n=d.getContent().querySelector(".e-frozen-right-content").children[0],o=r.querySelector('[e-mappinguid="'+u+'"]').parentElement.cloneNode(!0),a=n.querySelectorAll("td:nth-child("+(f-(m+y)+1)+")"),s&&(l=(s=d.getFooterContent().querySelector(".e-movablefootercontent").children[0]).querySelectorAll("td:nth-child("+(f-(m+y)+1)+")")))}else r=d.getHeaderTable(),n=d.getContentTable(),o=r.querySelector('[e-mappinguid="'+u+'"]').parentElement.cloneNode(!0),a=n.querySelectorAll("td:nth-child("+(f+1)+"):not(.e-groupcaption)"),s&&(l=s.querySelectorAll("td:nth-child("+(f+1)+"):not(.e-groupcaption)"));var b=[].slice.call(r.querySelector("tr").getElementsByClassName("e-grouptopleftcell"));if(b.length>0)for(var C=0;C<b.length;C++)c+=b[C].offsetWidth;var w=n.querySelector(".e-detailrowcollapse")||n.querySelector(".e-detailrowexpand");(this.parent.detailTemplate||this.parent.childGrid)&&w&&(c+=w.offsetWidth);var S=[o],x=[],R=[];if(s)for(C=0;C<l.length;C++)R[C]=l[C].cloneNode(!0);for(C=0;C<a.length;C++)x[C]=a[C].cloneNode(!0);var F=this.createTable(r,S,"e-gridheader"),E=this.createTable(n,x,"e-gridcontent"),I=null;R.length&&(I=this.createTable(s,R,"e-gridfooter"));var T=d.getColumns()[g],z=T.width=sf.base.formatUnit(Math.max(F,E,I)),D=T.maxWidth&&parseFloat(T.maxWidth.toString());if(parseInt(z,10)>D&&(T.width=D),this.widthService.setColumnWidth(d.getColumns()[g]),!1===d.getColumns().some((function(e){return null===e.width||void 0===e.width||e.width.length<=0}))){var M=d.getColumns();for(C=0;C<M.length;C++)M[C].visible&&(p+=parseFloat(M[C].width))}var O=p+c;p>0&&!d.isFrozenGrid()&&((this.parent.detailTemplate||this.parent.childGrid)&&this.widthService.setColumnWidth(new h({width:"30px"})),"Auto"===this.parent.resizeSettings.mode&&(O="100%"),r.style.width=sf.base.formatUnit(O),n.style.width=sf.base.formatUnit(O),sf.base.isNullOrUndefined(s)||(s.style.width=sf.base.formatUnit(O))),d.isFrozenGrid()&&this.widthService.refreshFrozenScrollbar();var k=r.offsetWidth;d.getContent().scrollWidth>k?(r.classList.add("e-tableborder"),n.classList.add("e-tableborder")):(r.classList.remove("e-tableborder"),n.classList.remove("e-tableborder")),sf.base.isNullOrUndefined(s)||s.classList.add("e-tableborder")},t.prototype.destroy=function(){var e=this.parent.element;e&&(e.querySelector("."+H)||e.querySelector("."+U))&&(this.widthService=null,this.unwireEvents(),this.removeEventListener())},t.prototype.getModuleName=function(){return"resize"},t.prototype.findColumn=function(e){for(var t=0;t<e.length;t++){var i=e[t],r=this.parent.getColumnIndexByField(i),n=this.parent.getColumns()[r];r>-1&&!sf.base.isNullOrUndefined(n)&&!0===n.visible&&this.resizeColumn(i,r)}},t.prototype.createTable=function(e,t,i){var r=this.parent.createElement("div");r.className=this.parent.element.className,r.style.cssText="display: inline-block;visibility:hidden;position:absolute";var n=this.parent.createElement("div");n.className=i;var s=this.parent.createElement("table");s.className=e.className,s.classList.add("e-resizetable"),s.style.cssText="table-layout: auto;width: auto";for(var o=this.parent.createElement("tr"),a=0;a<t.length;a++){var l=o.cloneNode();l.className=e.querySelector("tr").className,l.appendChild(t[a]),s.appendChild(l)}n.appendChild(s),r.appendChild(n),document.body.appendChild(r);var h=s.getBoundingClientRect().width;return document.body.removeChild(r),Math.ceil(h)},t.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(S,this.refreshHeight,this),this.parent.on(g,this.wireEvents,this),this.parent.on(y,this.autoFit,this),this.parent.on(O,this.refreshHeight,this),this.parent.on(F,this.destroy,this))},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(S,this.refreshHeight),this.parent.off(g,this.wireEvents),this.parent.off(O,this.refreshHeight),this.parent.off(F,this.destroy))},t.prototype.render=function(){this.unwireEvents(),this.wireEvents(),this.setHandlerHeight()},t.prototype.refreshHeight=function(){if(this.parent.getHeaderTable()){for(var e=this.getResizeHandlers(),t=0;t<e.length;t++)e[t].parentElement.offsetHeight>0&&(e[t].style.height=e[t].parentElement.offsetHeight+"px");this.setHandlerHeight()}},t.prototype.wireEvents=function(){sf.base.EventHandler.add(this.parent.getHeaderContent(),sf.base.Browser.touchStartEvent,this.touchResizeStart,this),sf.base.EventHandler.add(this.parent.getHeaderContent(),"dblclick",this.callAutoFit,this)},t.prototype.unwireEvents=function(){sf.base.EventHandler.remove(this.parent.getHeaderContent(),sf.base.Browser.touchStartEvent,this.touchResizeStart),sf.base.EventHandler.remove(this.parent.getHeaderContent(),"dblclick",this.callAutoFit)},t.prototype.getResizeHandlers=function(){return this.parent.isFrozenGrid()?[].slice.call(this.parent.getHeaderContent().getElementsByClassName(Fn.root)):[].slice.call(this.parent.getHeaderTable().getElementsByClassName(Fn.root))},t.prototype.setHandlerHeight=function(){for(var e=[].slice.call(this.parent.getHeaderTable().getElementsByClassName(Fn.suppress)),t=0;t<e.length;t++)e[t].style.height=e[t].parentElement.offsetHeight+"px"},t.prototype.callAutoFit=function(e){if(e.target.classList.contains("e-rhandler")){var t=this.getTargetColumn(e);if(t.columns)return;this.resizeColumn(t.field,this.parent.getNormalizedColumnIndex(t.uid),t.uid),sf.base.closest(e.target,Fn.header).classList.add("e-resized")}},t.prototype.touchResizeStart=function(t){if(!e.Global.timer)return e.Global.timer=setTimeout((function(){e.Global.timer=null}),300),this.resizeStart(t);clearTimeout(e.Global.timer),e.Global.timer=null,this.callAutoFit(t)},t.prototype.resizeStart=function(e){var t=this;if(e.target.classList.contains("e-rhandler")){if(!this.helper){if(0===this.getScrollBarWidth()){if(this.parent.allowGrouping)for(var i=0;i<this.parent.groupSettings.columns.length;i++)this.widthService.setColumnWidth(new h({width:"30px"}),i);for(var r=0,n=this.refreshColumnWidth();r<n.length;r++){var s=n[r];this.widthService.setColumnWidth(s)}this.widthService.setWidthToTable()}if(this.refreshStackedColumnWidth(),this.element=e.target,this.parent.getVisibleFrozenColumns()){var o=this.parent.getMovableContentTbody(),a=this.parent.getFrozenLeftContentTbody(),l=this.parent.getFrozenRightContentTbody(),d=[].slice.call(o.querySelectorAll("tr")),p=[].slice.call(a.querySelectorAll("tr")),c=[];this.parent.getFrozenMode()===ee&&l&&(c=[].slice.call(l.querySelectorAll("tr")));var u=function(e){Sr(f.parent,(function(i,r){t.parent.rowHeight?r[e].style.height=t.parent.rowHeight+"px":r[e].style.removeProperty("height")}),[p,d,c])},f=this;for(i=0;i<d.length;i++)u(i)}this.parentElementWidth=this.parent.element.getBoundingClientRect().width,this.appendHelper(),this.column=this.getTargetColumn(e),this.pageX=this.getPointX(e),this.column.getFreezeTableName()===te?this.parent.enableRtl?this.minMove=(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0)-parseFloat(sf.base.isNullOrUndefined(this.column.width)?"":this.column.width.toString()):this.minMove=parseFloat(sf.base.isNullOrUndefined(this.column.width)?"":this.column.width.toString())-(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0):this.parent.enableRtl?this.minMove=parseFloat(this.column.width.toString())-(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0):this.minMove=(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0)-parseFloat(sf.base.isNullOrUndefined(this.column.width)?"":this.column.width.toString()),this.minMove+=this.pageX}if(sf.base.Browser.isDevice&&!this.helper.classList.contains(Fn.icon))this.helper.classList.add(Fn.icon),sf.base.EventHandler.add(document,sf.base.Browser.touchStartEvent,this.removeHelper,this),sf.base.EventHandler.add(this.helper,sf.base.Browser.touchStartEvent,this.resizeStart,this);else{var g={e:e,column:this.column};this.parent.trigger("resizeStart",g,(function(e){e.cancel||t.parent.isEdit?t.cancelResizeAction():(sf.base.EventHandler.add(document,sf.base.Browser.touchEndEvent,t.resizeEnd,t),sf.base.EventHandler.add(t.parent.element,sf.base.Browser.touchMoveEvent,t.resizing,t),t.updateCursor("add"))}))}}},t.prototype.cancelResizeAction=function(e){e&&(sf.base.EventHandler.remove(this.parent.element,sf.base.Browser.touchMoveEvent,this.resizing),sf.base.EventHandler.remove(document,sf.base.Browser.touchEndEvent,this.resizeEnd),this.updateCursor("remove")),sf.base.Browser.isDevice&&(sf.base.EventHandler.remove(document,sf.base.Browser.touchStartEvent,this.removeHelper),sf.base.EventHandler.remove(this.helper,sf.base.Browser.touchStartEvent,this.resizeStart)),sf.base.detach(this.helper),this.refresh()},t.prototype.getWidth=function(e,t,i){return t&&e<t?t:i&&e>i?i:e},t.prototype.updateResizeEleHeight=function(){for(var e=[].slice.call(this.parent.getHeaderContent().getElementsByClassName("e-rhandler")),t=0;t<e.length;t++)e[t].style.height=this.element.parentElement.offsetHeight+"px"},t.prototype.getColData=function(e,t){return{width:parseFloat(sf.base.isNullOrUndefined(this.widthService.getWidth(e))||"auto"===this.widthService.getWidth(e)?"0":this.widthService.getWidth(e).toString())+t,minWidth:e.minWidth?parseFloat(e.minWidth.toString()):null,maxWidth:e.maxWidth?parseFloat(e.maxWidth.toString()):null}},t.prototype.resizing=function(e){if(!sf.base.isNullOrUndefined(this.column)){var t=0;sf.base.isNullOrUndefined(this.column)&&(t=yi(this.element,"th").offsetWidth),this.parent.allowTextWrap&&(this.updateResizeEleHeight(),this.setHelperHeight());var i=this.getPointX(e),r=this.parent.enableRtl?-(i-this.pageX):i-this.pageX;this.column.getFreezeTableName()===te&&(r=this.parent.enableRtl?i-this.pageX:this.pageX-i);var n=this.getColData(this.column,r);n.width||(n.width=sf.base.closest(this.element,"th").offsetWidth);var s=this.getWidth(n.width,n.minWidth,n.maxWidth);if(this.parent.log("resize_min_max",{column:this.column,width:s}),this.column.getFreezeTableName()===te&&(this.parent.enableRtl&&this.minMove>=i||!this.parent.enableRtl&&this.minMove<=i)&&(s=this.column.minWidth?parseFloat(this.column.minWidth.toString()):10,this.pageX=i=this.minMove),(this.column.getFreezeTableName()!==te&&(!this.parent.enableRtl&&this.minMove>=i||this.parent.enableRtl&&this.minMove<=i)||this.column.getFreezeTableName()===te&&(this.parent.enableRtl&&this.minMove>=i||!this.parent.enableRtl&&this.minMove<=i))&&(s=this.column.minWidth?parseFloat(this.column.minWidth.toString()):10,this.pageX=i=this.minMove),s!==parseFloat(sf.base.isNullOrUndefined(this.column.width)||"auto"===this.column.width?t.toString():this.column.width.toString())){this.pageX=i,this.column.width=sf.base.formatUnit(s);var o={e:e,column:this.column};if(this.parent.trigger("resizing",o),o.cancel)return void this.cancelResizeAction(!0);var a=[this.column],l=[this.column];this.column.columns&&(a=this.getSubColumns(this.column,[]),a=this.calulateColumnsWidth(a,!1,r),l=this.calulateColumnsWidth(a,!0,r));for(var h=0,d=l;h<d.length;h++){var p=d[h];this.widthService.setColumnWidth(p,null,"resize")}this.updateHelper()}this.isDblClk=!1}},t.prototype.calulateColumnsWidth=function(e,t,i){for(var r=[],n=0,s=e;n<s.length;n++){for(var o=s[n],a=0,l=0;l<e.length;l++)a+=parseFloat(e[l].width.toString());var h=this.getColData(o,parseFloat(o.width)*i/a),d=this.getWidth(h.width,h.minWidth,h.maxWidth);d!==parseFloat(o.width.toString())&&(t&&(o.width=sf.base.formatUnit(d<1?1:d)),r.push(o))}return r},t.prototype.getSubColumns=function(e,t){for(var i=0,r=e.columns;i<r.length;i++){var n=r[i];!1!==n.visible&&n.allowResizing&&(n.columns?this.getSubColumns(n,t):t.push(n))}return t},t.prototype.resizeEnd=function(e){if(this.helper&&!this.parent.isDestroyed){sf.base.EventHandler.remove(this.parent.element,sf.base.Browser.touchMoveEvent,this.resizing),sf.base.EventHandler.remove(document,sf.base.Browser.touchEndEvent,this.resizeEnd),this.updateCursor("remove"),sf.base.detach(this.helper);var t={e:e,column:this.column},i=this.parent.getContent().querySelector("."+Q),r=i.querySelector("."+G)?i.querySelector("."+G):i;r.scrollHeight>r.clientHeight&&(this.parent.scrollModule.setPadding(),r.style.overflowY="scroll"),this.parent.trigger("resizeStop",t),sf.base.closest(this.element,".e-headercell").classList.add("e-resized"),yi(this.element,"e-frozenheader")?this.isFrozenColResized=!0:this.isFrozenColResized=!1,this.parent.isFrozenGrid()&&this.parent.notify("freezerender",{case:"textwrap"}),this.parent.allowTextWrap&&(this.updateResizeEleHeight(),this.parent.notify("textWrapRefresh",{case:"textwrap"})),this.refresh(),this.doubleTapEvent(e),this.isDblClk=!0}},t.prototype.getPointX=function(e){return e.touches&&e.touches.length?e.touches[0].pageX:e.pageX},t.prototype.refreshColumnWidth=function(){for(var e=this.parent.getColumns(),t=0,i=[].slice.apply(this.parent.getHeaderContent().querySelectorAll("th.e-headercell"));t<i.length;t++)for(var r=i[t],n=0,s=e;n<s.length;n++){var o=s[n];if(r.querySelector("[e-mappinguid]")&&r.querySelector("[e-mappinguid]").getAttribute("e-mappinguid")===o.uid&&o.visible){o.width=r.getBoundingClientRect().width;break}}return e},t.prototype.refreshStackedColumnWidth=function(){for(var e=0,t=this.parent.getStackedColumns(this.parent.columns);e<t.length;e++){var i=t[e];i.width=this.getStackedWidth(i,0)}},t.prototype.getStackedWidth=function(e,t){for(var i=0,r=e.columns;i<r.length;i++){var n=r[i];!1!==n.visible&&(n.columns?this.getStackedWidth(n,t):t+=n.width)}return t},t.prototype.getTargetColumn=function(e){var t=sf.base.closest(e.target,Fn.header),i=(t=t.querySelector(".e-headercelldiv")||t.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid");return this.parent.getColumnByUid(i)},t.prototype.updateCursor=function(e){var t=[].slice.call(this.parent.getHeaderContent().querySelectorAll("th"));t.push(this.parent.element);for(var i=0,r=t;i<r.length;i++){r[i].classList[e](Fn.cursor)}},t.prototype.refresh=function(){this.column=null,this.pageX=null,this.element=null,this.helper=null},t.prototype.appendHelper=function(){this.helper=this.parent.createElement("div",{className:Fn.helper}),this.parent.element.appendChild(this.helper),this.setHelperHeight()},t.prototype.setHelperHeight=function(){var e=this.parent.isFrozenGrid(),t=e?this.parent.getContent().querySelector("."+Q).offsetHeight:this.parent.getContent().offsetHeight-this.getScrollBarWidth(),i=sf.base.closest(this.element,Fn.header),r=[].slice.call(this.parent.getHeaderContent().querySelectorAll("tr")),n=this.parent.getFrozenRightColumnsCount();e&&(r=yi(i,_)?[].slice.call(this.parent.getHeaderContent().querySelector("."+_).querySelectorAll("tr")):n&&yi(i,"e-frozen-right-header")?[].slice.call(this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelectorAll("tr")):[].slice.call(this.parent.getHeaderContent().querySelector(".e-frozen-left-header").querySelectorAll("tr")));for(var s=r.indexOf(i.parentElement);s<r.length&&s>-1;s++)t+=r[s].offsetHeight;var o=this.calcPos(i);yi(i,"e-frozen-right-header")?o.left+=this.parent.enableRtl?i.offsetWidth-2:-1:o.left+=this.parent.enableRtl?-1:i.offsetWidth-2,this.helper.style.cssText="height: "+t+"px; top: "+o.top+"px; left:"+Math.floor(o.left)+"px;",this.parent.enableVirtualization&&this.helper.classList.add("e-virtual-rhandler")},t.prototype.getScrollBarWidth=function(e){var t=this.parent.getContent().firstChild;return t.scrollHeight>t.clientHeight&&e||t.scrollWidth>t.clientWidth?Di():0},t.prototype.removeHelper=function(e){var t=e.target.classList;t.contains(Fn.root)||t.contains(Fn.icon)||!this.helper||(sf.base.EventHandler.remove(document,sf.base.Browser.touchStartEvent,this.removeHelper),sf.base.EventHandler.remove(this.helper,sf.base.Browser.touchStartEvent,this.resizeStart),sf.base.detach(this.helper),this.refresh())},t.prototype.updateHelper=function(){var e,t=sf.base.closest(this.element,Fn.header);if((e=yi(t,"e-frozen-right-header")?Math.floor(this.calcPos(t).left+(this.parent.enableRtl?t.offsetWidth-2:-1)):Math.floor(this.calcPos(t).left+(this.parent.enableRtl?-1:t.offsetWidth-2)))>this.parentElementWidth&&(e=this.parentElementWidth-2),this.parent.isFrozenGrid()){var i=sf.base.closest(t,"."+X).offsetLeft;e<i&&(e=i)}this.helper.style.left=e+"px"},t.prototype.calcPos=function(e){for(var t={top:0,left:0},i=e.getBoundingClientRect(),r=e.ownerDocument,n=yi(e,"e-grid")||r.documentElement;n&&(n===r.body||n===r.documentElement)&&"static"===n.style.position;)n=n.parentNode;return n&&n!==e&&1===n.nodeType&&(t=n.getBoundingClientRect()),{top:i.top-t.top,left:i.left-t.left}},t.prototype.doubleTapEvent=function(e){var t=this;this.getUserAgent()&&this.isDblClk&&(this.tapped?(clearTimeout(this.tapped),this.callAutoFit(e),this.tapped=null):this.tapped=setTimeout((function(){t.tapped=null}),300))},t.prototype.getUserAgent=function(){var e=sf.base.Browser.userAgent.toLowerCase();return/iphone|ipod|ipad/.test(e)},t.prototype.timeoutHandler=function(){this.tapped=null},t}(),In=function(){function e(e){this.parent=e,this.parent.isDestroyed||(this.parent.on("header-drop",this.headerDrop,this),this.parent.on(v,this.enableAfterRender,this),this.parent.on("reorder-complete",this.onActionComplete,this),this.parent.on("columnDrag",this.drag,this),this.parent.on("columnDragStart",this.dragStart,this),this.parent.on("column-drag-stop",this.dragStop,this),this.parent.on("header-drop",this.headerDrop,this),this.parent.on(S,this.createReorderElement,this),this.parent.on(x,this.keyPressHandler,this),this.parent.on(F,this.destroy,this))}return e.prototype.chkDropPosition=function(e,t){var i=this.parent.getColumnByUid(t.firstElementChild.getAttribute("e-mappinguid")),r=!i||!i.lockColumn;return(e.parentElement.isEqualNode(t.parentElement)||this.parent.enableColumnVirtualization||this.parent.isFrozenGrid()&&Array.prototype.indexOf.call(sf.base.closest(e,"thead").children,e.parentElement)===Array.prototype.indexOf.call(sf.base.closest(t,"thead").children,t.parentElement))&&this.targetParentContainerIndex(e,t)>-1&&r},e.prototype.chkDropAllCols=function(e,t){for(var i,r=this.getHeaderCells();!i&&r.length>0;)i=e!==r.pop()&&this.targetParentContainerIndex(e,t)>-1;return i},e.prototype.findColParent=function(e,t,i){i=i;for(var r=0,n=t.length;r<n;r++){if(e===t[r])return!0;if(t[r].columns){var s=i.length;if(i.push(t[r]),this.findColParent(e,t[r].columns,i))return!0;i.splice(s,i.length-s)}}return!1},e.prototype.getColumnsModel=function(e){var t=[],i=[];if(!this.parent.getFrozenColumns()&&this.parent.isFrozenGrid())return this.parent.getColumns();for(var r=0,n=e.length;r<n;r++)t.push(e[r]),e[r].columns&&(i=i.concat(e[r].columns));return i.length&&(t=t.concat(this.getColumnsModel(i))),t},e.prototype.headerDrop=function(e){var t=this.parent,i=(this.element.querySelector(".e-headercelldiv")||this.element.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid"),r=t.getColumnByUid(i);if(sf.base.closest(e.target,"th")&&(sf.base.isNullOrUndefined(r)||r.allowReordering&&!r.lockColumn)){var n=sf.base.closest(e.target,".e-headercell"),s=(n.querySelector(".e-headercelldiv")||n.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid");if(!sf.base.isNullOrUndefined(s)){var o=t.getColumnByUid(s);if(sf.base.isNullOrUndefined(o)||!o.allowReordering||o.lockColumn)return void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:r,destColumn:o})}if(n&&this.chkDropPosition(this.element,n)&&this.chkDropAllCols(this.element,n))if(this.parent.enableColumnVirtualization){var a=this.parent.columns,l=this.element.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"),h=this.parent.columns.filter((function(e){return e.uid===l})),d=null,p=h[0],c=n.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");a.some((function(e,t){return e.uid===c&&(d=t,e.uid===c)})),sf.base.isNullOrUndefined(d)||this.moveColumns(d,p)}else{var u=this.targetParentContainerIndex(this.element,n),f=this.element.firstElementChild.getAttribute("e-mappinguid");if(this.destElement=n,this.parent.notify("set-reorder-destination-element",{ele:n}),f)this.moveColumns(u,this.parent.getColumnByUid(f));else{var g=this.getHeaderCells(),m=vi(this.element,g);a=this.getColumnsModel(this.parent.columns);this.moveColumns(u,a[m])}}}else this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:r})},e.prototype.isActionPrevent=function(e){return Ni(e)},e.prototype.moveColumns=function(e,t,i,r){var n=this.parent;if(this.isActionPrevent(n))n.notify(I,{instance:this,handler:this.moveColumns,arg1:e,arg2:t});else{var s=!n.getFrozenColumns()&&n.isFrozenGrid(),o=this.getColParent(t,this.parent.columns),a=o?o.columns:s?this.parent.getColumns():this.parent.columns,l=bi(t,a);if((this.parent.isFrozenGrid()&&o||this.parent.lockcolPositionCount)&&!i){for(var h=0;h<a.length;h++)if(a[h].field===t.field){l=h;break}var d=this.parent.getColumnByUid(this.destElement.firstElementChild.getAttribute("e-mappinguid"));if(d){for(h=0;h<a.length;h++)if(a[h].field===d.field){e=h;break}}else for(h=0;h<a.length;h++)a[h].headerText===this.destElement.innerText.trim()&&(e=h)}if(n.allowReordering&&l!==e&&-1!==l&&-1!==e){a.splice(e,0,a.splice(l,1)[0]);var c={column:t,destIndex:e,columns:a,parent:o,cancel:!1};n.notify("refresh-frozen-columns",c),c.cancel||(n.getColumns(!0),n.notify("column-position-changed",{fromIndex:e,toIndex:l}),!1!==r&&n.notify(w,{type:p,requestType:"reorder",fromIndex:e,toIndex:l,toColumnUid:t.uid}))}}},e.prototype.targetParentContainerIndex=function(e,t){var i=!this.parent.getFrozenColumns()&&this.parent.isFrozenGrid()?this.parent.getColumns():this.parent.columns,r=this.getHeaderCells(),n=this.getColumnsModel(i),s=this.getColParent(n[vi(e,r)],i);return i=s?s.columns:i,bi(n[vi(t,r)],i)},e.prototype.getHeaderCells=function(){var e=this.parent.getFrozenColumns();if(e||this.parent.lockcolPositionCount){var t=void 0,i=void 0,r=[],n=[].slice.call(this.parent.getHeaderTable().getElementsByClassName("e-columnheader"));if(e)for(var s=[].slice.call(this.parent.getHeaderContent().querySelector("."+_).getElementsByClassName("e-columnheader")),o=0;o<n.length;o++){t=[].slice.call(n[o].getElementsByClassName("e-headercell")),i=[].slice.call(s[o].getElementsByClassName("e-headercell"));for(var a=void 0,l=0;l<t.length;l++){for(var h=0;h<i.length;h++)if(i[h].innerText===t[l].innerText){a=!0;break}a||(r=r.concat([t[l]]))}for(h=0;h<i.length;h++)r.push(i[h])}else for(o=0;o<n.length;o++){i=[].slice.call(n[o].getElementsByClassName("e-headercell"));for(l=0;l<i.length;l++){for(a=void 0,h=l+1;h<i.length;h++)if(i[h].innerText===i[l].innerText){a=!0;break}a||(r=r.concat([i[l]]))}}return r}return[].slice.call(this.parent.element.getElementsByClassName("e-headercell"))},e.prototype.getColParent=function(e,t){var i=[];return this.findColParent(e,t,i),i[i.length-1]},e.prototype.reorderSingleColumn=function(e,t){var i=this.parent.enableColumnVirtualization?this.parent.columns.filter((function(t){return t.field===e}))[0]:this.parent.getColumnByField(e),r=this.parent.enableColumnVirtualization?this.parent.columns.filter((function(e){return e.field===t}))[0]:this.parent.getColumnByField(t);if((sf.base.isNullOrUndefined(i)||i.allowReordering&&!i.lockColumn)&&(sf.base.isNullOrUndefined(r)||r.allowReordering&&!i.lockColumn)){var n=r,s=this.getColParent(n,this.parent.columns),o=bi(n,s?s.columns:this.parent.columns);o>-1&&this.moveColumns(o,i,!0)}else this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:i,destColumn:r})},e.prototype.reorderMultipleColumns=function(e,t){var i=this.parent.getColumnIndexByField(t),r=this.parent.getColumnByField(t);if(!(i<0)&&(sf.base.isNullOrUndefined(r)||r.allowReordering&&!r.lockColumn)){for(var n=0;n<e.length;n++){var s=this.parent.getColumnByField(e[n]);if(!sf.base.isNullOrUndefined(s)&&(!s.allowReordering||s.lockColumn))return}for(n=0;n<e.length;n++){s=this.parent.getColumnByIndex(i);var o=this.getColParent(s,this.parent.columns),a=bi(s,o?o.columns:this.parent.columns);a>-1&&this.moveColumns(a,this.parent.getColumnByField(e[n]),!0,!0),this.parent.getColumnIndexByField(e[n+1])>=a&&i++}}},e.prototype.moveTargetColumn=function(e,t){t>-1&&this.moveColumns(t,e,!0)},e.prototype.reorderSingleColumnByTarget=function(e,t){this.moveTargetColumn(this.parent.getColumnByField(e),t)},e.prototype.reorderMultipleColumnByTarget=function(e,t){for(var i=0;i<e.length;i++)this.reorderSingleColumnByTarget(e[i],t)},e.prototype.reorderColumns=function(e,t){"string"==typeof e?(this.reorderSingleColumn(e,t),this.fromCol=e):(this.reorderMultipleColumns(e,t),this.fromCol=e[0])},e.prototype.reorderColumnByIndex=function(e,t){this.moveTargetColumn(this.parent.getColumnByIndex(e),t)},e.prototype.reorderColumnByTargetIndex=function(e,t){"string"==typeof e?this.reorderSingleColumnByTarget(e,t):this.reorderMultipleColumnByTarget(e,t)},e.prototype.enableAfterRender=function(e){e.module===this.getModuleName()&&e.enable&&this.createReorderElement()},e.prototype.createReorderElement=function(e){e&&e.args.isXaxis&&this.setDisplay("none");var t=this.parent.element.querySelector("."+V);this.upArrow=t.appendChild(this.parent.createElement("div",{className:"e-icons e-icon-reorderuparrow e-reorderuparrow",attrs:{style:"display:none"}})),this.downArrow=t.appendChild(this.parent.createElement("div",{className:"e-icons e-icon-reorderdownarrow e-reorderdownarrow",attrs:{style:"display:none"}}))},e.prototype.onActionComplete=function(e){this.parent.trigger(c,sf.base.extend(e,{type:c}));var t=this.fromCol&&this.parent.getColumnHeaderByField(this.fromCol);t&&this.parent.focusModule.onClick({target:t},!0)},e.prototype.destroy=function(){var e=this.parent.element;!this.parent.isDestroyed&&e&&(e.querySelector("."+H)||e.querySelector("."+U))&&(this.upArrow.parentNode&&sf.base.remove(this.upArrow),this.downArrow.parentNode&&sf.base.remove(this.downArrow),this.parent.off("header-drop",this.headerDrop),this.parent.off(v,this.enableAfterRender),this.parent.off("reorder-complete",this.onActionComplete),this.parent.off("columnDrag",this.drag),this.parent.off("columnDragStart",this.dragStart),this.parent.off("column-drag-stop",this.dragStop),this.parent.off(S,this.createReorderElement),this.parent.off(x,this.keyPressHandler),this.parent.off(F,this.destroy))},e.prototype.keyPressHandler=function(e){var t=this.parent;switch(e.action){case"ctrlLeftArrow":case"ctrlRightArrow":var i=t.focusModule.currentInfo.element;if(i&&i.classList.contains("e-headercell")){var r=t.getColumnByUid(i.firstElementChild.getAttribute("e-mappinguid")),n=t.getVisibleColumns(),s=n.indexOf(r),o="ctrlLeftArrow"===e.action?n[s-1]:n[s+1];o&&o.field&&r.field&&this.reorderColumns(r.field,o.field)}}},e.prototype.drag=function(e){var t=this.parent,i=e.target;if(e.column.allowReordering&&!e.column.lockColumn){var r=sf.base.closest(i,".e-headercell:not(.e-stackedHeaderCell)"),n=t.element.querySelector(".e-cloneproperties"),s=t.isFrozenGrid()?t.getMovableVirtualContent():t.getContent().firstElementChild,o=this.x>Si(e.event).x+s.scrollLeft;sf.base.removeClass([].slice.call(t.getHeaderTable().getElementsByClassName("e-reorderindicate")),["e-reorderindicate"]),this.setDisplay("none"),this.stopTimer(),sf.base.classList(n,["e-defaultcur"],["e-notallowedcur"]),this.updateScrollPostion(e.event),r&&!r.isEqualNode(this.element)&&(i=r,this.chkDropPosition(this.element,i)&&this.chkDropAllCols(this.element,i)?(this.updateArrowPosition(i,o),sf.base.classList(i,["e-allowDrop","e-reorderindicate"],[])):t.allowGrouping&&yi(e.target,"e-groupdroparea")||sf.base.classList(n,["e-notallowedcur"],["e-defaultcur"])),t.trigger("columnDrag",{target:i,draggableType:"headercell",column:e.column})}},e.prototype.updateScrollPostion=function(e){var t=this,i=Si(e).x,r=this.parent.element.getBoundingClientRect(),n=r.right;if(this.parent.isFrozenGrid())this.updateFrozenScrollPosition(i,r);else{var s=r.left,o=this.parent.getContent().firstElementChild;i>s&&i<s+35?this.timer=window.setInterval((function(){t.setScrollLeft(o,!0)}),50):i<n&&i>n-35&&(this.timer=window.setInterval((function(){t.setScrollLeft(o,!1)}),50))}},e.prototype.updateFrozenScrollPosition=function(e,t){var i=this,r=this.parent.getContent().querySelector("."+G),n=this.parent.element.querySelector("."+_).getBoundingClientRect(),s=this.parent.getFrozenLeftCount(),o=this.parent.getFrozenRightColumnsCount()?n.right:t.right,a=s?n.left:t.left;e>a&&e<a+35?this.timer=window.setInterval((function(){i.setScrollLeft(r,!0)}),50):e<o&&e>o-35&&(this.timer=window.setInterval((function(){i.setScrollLeft(r,!1)}),50))},e.prototype.setScrollLeft=function(e,t){var i=e.scrollLeft;e.scrollLeft=e.scrollLeft+(t?-5:5),i!==e.scrollLeft&&this.setDisplay("none")},e.prototype.stopTimer=function(){window.clearInterval(this.timer)},e.prototype.updateArrowPosition=function(e,t){var i=e.getBoundingClientRect(),r=this.parent.element.getBoundingClientRect();if(!(t&&i.left<r.left||!t&&i.right>r.right)){if(this.parent.isFrozenGrid()&&e.classList.contains("e-headercell")){var n=this.parent.getFrozenLeftCount(),s=this.parent.getFrozenRightColumnsCount(),o=this.element.querySelector(".e-headercelldiv"),a=o?this.parent.getColumnByUid(o.getAttribute("data-uid")):null,l=this.parent.getColumnByUid(e.firstElementChild.getAttribute("e-mappinguid")),h=Math.round(this.parent.getFrozenVirtualHeader().getBoundingClientRect().right),d=Math.round(this.parent.getMovableVirtualHeader().getBoundingClientRect().right);if(l){if(n&&!s&&this.parent.getNormalizedColumnIndex(l.uid)>=n&&(t&&Math.round(i.left)<h||!t&&d<i.right))return;if(!n&&s&&a&&a.getFreezeTableName()!==l.getFreezeTableName()&&!t&&Math.round(i.right)<h)return}}var p=this.parent.getHeaderContent().classList.contains("e-sticky");this.upArrow.style.top=p?i.top+i.height+"px":i.top+i.height-r.top+"px",this.downArrow.style.top=p?i.top-7+"px":i.top-r.top-7+"px",this.upArrow.style.left=this.downArrow.style.left=p?(t?i.left:i.right)-4+"px":(t?i.left:i.right)-r.left-4+"px",this.setDisplay("")}},e.prototype.dragStart=function(e){var t=this.parent,i=e.target;if(this.element=i.classList.contains("e-headercell")?i:yi(i,"e-headercell"),e.column.allowReordering&&!e.column.lockColumn){var r=t.isFrozenGrid()?t.getMovableVirtualContent():t.getContent().firstElementChild;this.x=Si(e.event).x+r.scrollLeft,t.trigger("columnDragStart",{target:i,draggableType:"headercell",column:e.column})}},e.prototype.dragStop=function(e){var t=this.parent;this.setDisplay("none"),this.stopTimer(),e.cancel||t.trigger("columnDrop",{target:e.target,draggableType:"headercell",column:e.column}),sf.base.removeClass([].slice.call(t.getHeaderTable().getElementsByClassName("e-reorderindicate")),["e-reorderindicate"])},e.prototype.setDisplay=function(e){this.upArrow.style.display=e,this.downArrow.style.display=e},e.prototype.getModuleName=function(){return"reorder"},e}(),Tn=function(){function e(e){var t=this;this.selectedRows=[],this.isOverflowBorder=!0,this.selectedRowColls=[],this.isRefresh=!0,this.isReplaceDragEle=!0,this.istargetGrid=!1,this.helper=function(e){var i=t.parent,r=t.draggable.currentStateTarget,n=t.parent.createElement("div",{className:"e-cloneproperties e-draganddrop e-grid e-dragclone",styles:'height:"auto", z-index:2, width:'+i.element.offsetWidth}),s=t.parent.createElement("table",{styles:"width:"+i.element.offsetWidth}),o=t.parent.createElement(se);if(document.getElementsByClassName("e-griddragarea").length||i.rowDropSettings.targetID&&(!r.classList.contains("e-selectionbackground")&&"Single"!==i.selectionSettings.type||!yi(r,"e-rowcell"))||!i.rowDropSettings.targetID&&!yi(r,"e-rowdragdrop"))return!1;i.rowDropSettings.targetID&&"Row"===i.selectionSettings.mode&&"Single"===i.selectionSettings.type&&i.selectRow(parseInt(t.draggable.currentStateTarget.parentElement.getAttribute(ne),10)),t.startedRow=sf.base.closest(r,"tr").cloneNode(!0);var a=t.parent.isFrozenGrid();if(a){var l=parseInt(sf.base.closest(r,"tr").getAttribute(ne),10);t.startedRow.innerHTML="",t.startedRow.innerHTML+=i.getRowByIndex(l).innerHTML,t.startedRow.innerHTML+=i.getMovableRowByIndex(l).innerHTML,i.getFrozenMode()===ee&&(t.startedRow.innerHTML+=i.getFrozenRightRowByIndex(l).innerHTML)}t.processArgs(r);var h={selectedRow:t.rows,dragelement:r,cloneElement:n,cancel:!1,data:t.rowData},d=i.getSelectedRows();i.trigger("rowDragStartHelper",h);if(h.cancel)return!1;wi(t.startedRow,".e-indentcell"),wi(t.startedRow,".e-detailrowcollapse"),wi(t.startedRow,".e-detailrowexpand"),t.removeCell(t.startedRow,J);var p=new RegExp("e-active","g");if(t.startedRow.innerHTML=t.startedRow.innerHTML.replace(p,""),o.appendChild(t.startedRow),i.getSelectedRowIndexes().length>1&&t.startedRow.hasAttribute("aria-selected")){var c=i.getFrozenMode()===ee?3:2,u=t.parent.createElement("span",{className:"e-dropitemscount",innerHTML:a?""+d.length/c:""+d.length});n.appendChild(u)}var f=sf.base.closest(r,"tr").querySelector(".e-icon-rowdragicon");return f&&f.classList.add("e-dragstartrow"),s.appendChild(o),n.appendChild(s),i.element.appendChild(n),n},this.dragStart=function(e){var i=t.parent;if(!document.getElementsByClassName("e-griddragarea").length){var r=e.target,n=t.parent.element.querySelector(".e-dropitemscount");t.parent.getSelectedRecords().length>1&&n&&(n.style.left=t.parent.element.querySelector(".e-cloneproperties table").offsetWidth-5+"px"),t.processArgs(r),i.trigger("rowDragStart",{rows:t.rows,target:e.target,draggableType:"rows",fromIndex:parseInt(t.rows[0].getAttribute(ne),10),data:Object.keys(t.rowData[0]).length>0?t.rowData:t.currentViewData()}),t.dragStartData=t.rowData;var s=document.getElementById(i.rowDropSettings.targetID);i.rowDropSettings.targetID&&s&&s.ej2_instances&&"grid"===s.ej2_instances[0].getModuleName()&&s.ej2_instances[0].getContent().classList.add("e-allowRowDrop")}},this.drag=function(e){var i=t.parent;if(t.isDropGrid=t.parent,t.istargetGrid=!1,t.parent.rowDropSettings.targetID){var r=document.getElementById(i.rowDropSettings.targetID);t.isDropGrid=r.ej2_instances[0],yi(e.target,"e-grid")&&(t.istargetGrid=t.parent.rowDropSettings.targetID===yi(e.target,"e-grid").id)}var n=t.parent.element.querySelector(".e-cloneproperties"),s=t.getElementFromPosition(n,e.event);sf.base.classList(n,["e-defaultcur"],["e-notallowedcur","e-movecur","e-grabcur"]),t.isOverflowBorder=!0,t.hoverState=i.enableHover;var o=yi(s,"e-grid")?sf.base.closest(e.target,"tr"):null;if(i.enableHover=!1,e.target){t.processArgs(s);var a={rows:t.rows,target:s,draggableType:"rows",data:t.rowData,originalEvent:e,cancel:!1};if(i.trigger("rowDrag",a),t.stopTimer(),!a.cancel){if(i.element.classList.add("e-rowdrag"),t.dragTarget=o&&yi(s,"e-grid").id===n.parentElement.id?parseInt(o.getAttribute(ne),10):parseInt(t.startedRow.getAttribute(ne),10),i.rowDropSettings.targetID)yi(s,"e-grid")&&yi(n.parentElement,"e-grid").id!==yi(s,"e-grid").id?sf.base.classList(n,["e-grabcur"],["e-notallowedcur"]):sf.base.classList(n,["e-notallowedcur"],["e-defaultcur"]);else{var l=yi(s,"e-grid");l&&l.id===n.parentElement.id?sf.base.classList(n,["e-movecur"],["e-defaultcur"]):sf.base.classList(n,["e-notallowedcur"],["e-movecur"])}if(yi(t.isDropGrid.element,"e-grid")){if((!t.isDropGrid.groupSettings.columns.length||e.target.classList.contains("e-selectionbackground"))&&!t.isDropGrid.element.querySelector(".e-emptyrow"))if(yi(s,"e-grid")&&yi(s,"e-grid").id===t.isDropGrid.element.id&&t.updateScrollPostion(e.event),(t.isOverflowBorder||t.parent.frozenRows>t.dragTarget)&&(parseInt(t.startedRow.getAttribute(ne),10)!==t.dragTarget||t.istargetGrid)||t.istargetGrid&&o&&t.isDropGrid.getRowByIndex(t.isDropGrid.getCurrentViewRecords().length-1).getAttribute("data-uid")===o.getAttribute("data-uid"))t.moveDragRows(e,t.startedRow,o);else{var h=void 0;if(t.parent.enableVirtualization)h=o&&parseInt(o.getAttribute(ne),10)===t.parent.renderModule.data.dataManager.dataSource.json.length-1;else{var d=t.parent.getRowByIndex(t.parent.getCurrentViewRecords().length-1).getAttribute("data-uid");h=o&&d===o.getAttribute("data-uid")&&d!==t.startedRow.getAttribute("data-uid")}if(h&&!t.parent.rowDropSettings.targetID){var p=t.parent.createElement("div",{className:"e-lastrow-dragborder"}),c=t.parent.getContent();p.style.width=t.parent.element.offsetWidth-t.getScrollWidth()+"px",t.parent.enableVirtualization&&(p.style.zIndex="1"),c.getElementsByClassName("e-lastrow-dragborder").length||(c.classList.add("e-grid-relative"),c.appendChild(p),p.style.bottom=t.getScrollWidth()+"px")}t.removeBorder(o)}if(s&&s.classList.contains(Q)&&!t.isDropGrid.element.querySelector(".e-emptyrow")&&t.istargetGrid){t.removeBorder(o);var u=t.isDropGrid.getCurrentViewRecords().length-1,f=".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse",g=[];g=[].slice.call(t.isDropGrid.getRowByIndex(u).querySelectorAll(f)),t.isDropGrid.isFrozenGrid()&&(g=t.borderRowElement(u,f)),g.length>0&&qi(g,!0,"e-dragborder")}}}}},this.dragStop=function(e){Ni(t.parent)?t.parent.notify(I,{instance:t,handler:t.processDragStop,arg1:e}):t.processDragStop(e)},this.processDragStop=function(e){var i=t.parent;if(!t.parent.isDestroyed){var r=t.getElementFromPosition(e.helper,e.event),n=r&&!r.classList.contains("e-dlg-overlay")?r:e.target;i.element.classList.remove("e-rowdrag");var s=document.getElementById(i.rowDropSettings.targetID);if(i.rowDropSettings.targetID&&s&&s.ej2_instances&&"grid"===s.ej2_instances[0].getModuleName()&&s.ej2_instances[0].getContent().classList.remove("e-allowRowDrop"),yi(t.isDropGrid.element,"e-grid")){t.stopTimer(),t.isDropGrid.enableHover=t.hoverState,t.isDropGrid.getContent().classList.remove("e-grid-relative"),t.removeBorder(r);var o=t.isDropGrid.element.querySelector(".e-dragstartrow");o&&o.classList.remove("e-dragstartrow")}t.processArgs(n);var a={target:n,draggableType:"rows",cancel:!1,fromIndex:parseInt(t.rows[0].getAttribute(ne),10),dropIndex:t.dragTarget,rows:t.rows,data:Object.keys(t.dragStartData[0]).length>0?t.dragStartData:t.currentViewData()};i.trigger("rowDrop",a,(function(){if(!(yi(n,Y)||yi(n,"e-emptyrow")||yi(n,U))||a.cancel)return t.dragTarget=null,void sf.base.remove(e.helper);t.isRefresh=!1;var r=t.parent.getSelectedRowIndexes();i.isRowDragable()&&(!t.parent.rowDropSettings.targetID&&t.startedRow.querySelector("td.e-selectionbackground")&&r.length>1&&r.length!==t.parent.getCurrentViewRecords().length?t.reorderRows(r,a.dropIndex):t.reorderRows([parseInt(t.startedRow.getAttribute(ne),10)],t.dragTarget),t.dragTarget=null,i.rowDropSettings.targetID||(sf.base.remove(e.helper),i.enableVirtualization?i.refresh():t.rowOrder(a))),t.isRefresh=!0}))}},this.removeCell=function(e,t){return[].slice.call(e.querySelectorAll("td")).filter((function(i){i.classList.contains(t)&&e.deleteCell(i.cellIndex)}))},this.parent=e,this.parent.isDestroyed||(this.parent.on(g,this.initializeDrag,this),this.parent.on("columnDrop",this.columnDrop,this),this.onDataBoundFn=this.onDataBound.bind(this),this.parent.addEventListener(u,this.onDataBoundFn),this.parent.on(v,this.enableAfterRender,this),this.parent.on(F,this.destroy,this))}return e.prototype.refreshRow=function(e,t,i,r,n,s,o){var a,l,h,d,p=this.parent,c=p.isFrozenGrid(),u=p.getFrozenMode()===ee,f=p.getContentTable().querySelector(se),g=p.getHeaderTable().querySelector(se);c&&(a=p.getMovableHeaderTbody(),l=p.getMovableContentTbody(),u&&(h=p.getFrozenRightHeaderTbody(),d=p.getFrozenRightContentTbody()));for(var m=p.getFrozenMode()===ee?3:2,y=0,v=e.rows.length;y<v;y++)c?y%m==0?t.insertBefore(e.rows[y],n):y%m==1?i.insertBefore(e.rows[y],s):r.insertBefore(e.rows[y],o):t.insertBefore(e.rows[y],n);var b,C,w=[].slice.call(t.getElementsByClassName(Y));if(c&&(b=[].slice.call(i.getElementsByClassName(Y)),u&&(C=[].slice.call(r.getElementsByClassName(Y)))),this.refreshData(w,b,C),this.parent.frozenRows){var S=function(e,t){e<x.parent.frozenRows?Mr(g,a,h,w,b,C,(function(t,i){t.appendChild(i[e])})):Mr(f,l,d,w,b,C,(function(t,i){t.appendChild(i[e])}))},x=this;for(y=0,v=w.length;y<v;y++)S(y)}},e.prototype.updateFrozenRowreOrder=function(e){var t,i,r,n,s=this.parent,o=this.parent.isFrozenGrid(),a=s.getFrozenMode()===ee,l=s.getContentTable().querySelector(se),h=s.getHeaderTable().querySelector(se);o&&(t=s.getMovableHeaderTbody(),i=s.getMovableContentTbody(),a&&(r=s.getFrozenRightHeaderTbody(),n=s.getFrozenRightContentTbody()));var d,p,c=[].slice.call(h.getElementsByClassName(Y)).concat([].slice.call(l.getElementsByClassName(Y)));o&&(d=[].slice.call(t.getElementsByClassName(Y)).concat([].slice.call(i.getElementsByClassName(Y))),a&&(p=[].slice.call(r.getElementsByClassName(Y)).concat([].slice.call(n.getElementsByClassName(Y)))));var u=s.createElement(se),f=s.createElement(se),g=s.createElement(se);this.parent.clearSelection();for(var m=this.refreshRowTarget(e),y=0,v=c.length;y<v;y++)u.appendChild(c[y]),o&&(f.appendChild(d[y]),a&&g.appendChild(p[y]));this.refreshRow(e,u,f,g,m.target,m.mTarget,m.frTarget)},e.prototype.refreshRowTarget=function(e){var t,i,r=this.parent,n=parseInt(e.target.parentElement.getAttribute(ne),10);(e.fromIndex<e.dropIndex||e.fromIndex===e.dropIndex)&&(n+=1);var s=r.getRowByIndex(n);return r.isFrozenGrid()&&(t=r.getMovableRowByIndex(n),r.getFrozenMode()===ee&&(i=r.getFrozenRightRowByIndex(n))),{target:s,mTarget:t,frTarget:i}},e.prototype.updateFrozenColumnreOrder=function(e){var t,i,r=this.parent,n=this.parent.isFrozenGrid(),s=r.getContentTable().querySelector(se);n&&(t=r.getMovableContentTbody(),r.getFrozenMode()===ee&&(i=r.getFrozenRightContentTbody())),this.parent.clearSelection();var o=this.refreshRowTarget(e);this.refreshRow(e,s,t,i,o.target,o.mTarget,o.frTarget)},e.prototype.refreshData=function(e,t,i){for(var r={},n={},s={},o={},a=this.parent.getRowsObject(),l=this.parent.getMovableRowsObject(),h=this.parent.getFrozenRightRowsObject(),d=this.parent.getCurrentViewRecords(),p=0,c=e.length;p<c;p++){var u=parseInt(e[p].getAttribute(ne),10);r[p]=a[u],o[p]=d[u],this.parent.isFrozenGrid()&&(n[p]=l[u],i&&(s[p]=h[u]))}var f,g,m=this.parent.getRows();this.parent.isFrozenGrid()&&(f=this.parent.getMovableRows(),i&&(g=this.parent.getFrozenRightRows()));for(p=0,c=e.length;p<c;p++)m[p]=e[p],a[p]=r[p],d[p]=o[p],this.parent.isFrozenGrid()&&(f[p]=t[p],l[p]=n[p],i&&(g[p]=i[p],h[p]=s[p]));vr(this.parent,a,e),this.parent.isFrozenGrid()&&(vr(this.parent,l,t),i&&vr(this.parent,h,i))},e.prototype.rowOrder=function(e){if(e.dropIndex!==e.fromIndex&&!isNaN(e.dropIndex)){if(this.parent.isDetail()){this.parent.detailCollapseAll();var t=[].slice.call(this.parent.getContentTable().querySelector(se).children),i=this.parent.getRowsObject();t.filter((function(e){e.classList.contains("e-detailrow")&&e.remove()}));for(var r=0,n=i.length;r<n&&i[r];r++)i[r].isDetailRow&&(this.parent.getRowsObject().splice(r,1),r--)}if(e.target.classList.contains("e-rowcelldrag")&&(e.target=e.target.parentElement),this.parent.frozenRows?this.updateFrozenRowreOrder(e):this.updateFrozenColumnreOrder(e),this.selectedRowColls.length>0){this.parent.selectRows(this.selectedRowColls);var s=[];if(this.parent.filterSettings.columns.length||this.parent.sortSettings.columns.length){for(r=0,n=e.rows.length;r<n;r++)s.push(parseInt(e.rows[r].getAttribute(ne),10));this.selectedRowColls=s}this.selectedRowColls=[]}}},e.prototype.currentViewData=function(){for(var e=this.parent.getSelectedRowIndexes(),t=[],i=parseInt(this.startedRow.getAttribute(ne),10),r=0,n=e.length;r<n;r++){t[r]=this.parent.currentViewData[e[r]]}return this.parent.rowDropSettings.targetID||0!==e.length||(t[0]=this.parent.currentViewData[i]),t},e.prototype.saveChange=function(e,t){var i=this;this.parent.getDataModule().saveChanges(e,this.parent.getPrimaryKeyFieldNames()[0],{},t).then((function(){i.parent.notify(w,{type:p,requestType:"rowdraganddrop"})})).catch((function(e){sf.base.isNullOrUndefined(e.error)||sf.base.isNullOrUndefined(e.error.message)||(e.error=e.error.message),i.parent.trigger("actionFailure",e)}))},e.prototype.reorderRows=function(e,t){for(var i=this.parent.getSelectedRowIndexes(),r=[],n=[],s=this.parent.renderModule.data.dataManager.dataSource.json,o=this.parent.allowPaging?this.parent.pageSettings.currentPage*this.parent.pageSettings.pageSize-this.parent.pageSettings.pageSize:0,a=t+o,l=e[0]+o,h=0,d=e.length;h<d;h++)n[h]=s[e[h]+o];for(h=0,d=i.length;h<d;h++)r[h]=s[i[h]+o];for(h=0,d=n.length;h<d;h++){if(0!==h){for(var c=0,u=s.length;c<u;c++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[c])===JSON.stringify(n[h])){l=c;break}for(c=0,u=s.length;c<u;c++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[c])===JSON.stringify(n[h-1])){l>c&&(a=c+1);break}}this.reorderRow(l-o,a-o)}this.isRefresh&&this.parent.notify(w,{type:p,requestType:"rowdraganddrop"});for(h=0,d=r.length;h<d;h++)for(c=0,u=s.length;c<u;c++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[c])===JSON.stringify(r[h])){i[h]=c-o;break}this.selectedRowColls=i},e.prototype.stopTimer=function(){window.clearInterval(this.timer)},e.prototype.initializeDrag=function(){var e=this.parent;this.draggable=new sf.base.Draggable(e.element,{dragTarget:".e-rowcelldrag, .e-rowdragdrop, .e-rowcell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop,isReplaceDragEle:this.isReplaceDragEle})},e.prototype.updateScrollPostion=function(e){var t=this,i=Si(e).y,r=this.isDropGrid.getContent().getBoundingClientRect(),n=this.isDropGrid.getRowHeight()-15,s=this.isDropGrid.getContent().firstElementChild,o=this.parent.enableVirtualization?20:0;if(r.top>=i){var a=-this.isDropGrid.getRowHeight();this.isOverflowBorder=!1,this.timer=window.setInterval((function(){t.setScrollDown(s,a)}),200)}else if(r.top+this.isDropGrid.getContent().clientHeight-n-33-o<=i){var l=this.isDropGrid.getRowHeight();this.isOverflowBorder=!1,this.timer=window.setInterval((function(){t.setScrollDown(s,l)}),200)}},e.prototype.setScrollDown=function(e,t){e.scrollTop=e.scrollTop+t},e.prototype.moveDragRows=function(e,t,i){var r=this.parent.element.querySelector(".e-cloneproperties"),n=sf.base.closest(e.target,"tr");if(yi(n,"e-grid")&&(yi(r.parentElement,"e-grid").id===yi(n,"e-grid").id||this.istargetGrid)){var s=n||this.startedRow;this.setBorder(s,e.event,t,i)}},e.prototype.setBorder=function(e,t,i,r){var n=this.parent.element;this.istargetGrid&&(n=this.isDropGrid.element);var s=this.parent.element.querySelector(".e-cloneproperties");if(this.removeFirstRowBorder(e),this.removeLastRowBorder(e),yi(e,"e-grid")&&e.classList.contains(Y)&&(!this.parent.rowDropSettings.targetID&&yi(s.parentElement,"e-grid").id===yi(e,"e-grid").id||this.istargetGrid)){sf.base.removeClass(n.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"),["e-dragborder"]);var o=[],a=parseInt(r.getAttribute(ne),10);if(r&&0===a){var l=this.parent.createElement("div",{className:"e-firstrow-dragborder"}),h=this.isDropGrid.getHeaderContent();h.classList.add("e-grid-relative"),l.style.width=n.offsetWidth-this.getScrollWidth()+"px",h.getElementsByClassName("e-firstrow-dragborder").length||h.appendChild(l)}else this.parent.rowDropSettings.targetID&&r?(e=this.isDropGrid.getRowByIndex(a-1),o=[].slice.call(e.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))):r&&parseInt(i.getAttribute(ne),10)>a?(e=this.parent.getRowByIndex(a-1),o=[].slice.call(e.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))):o=[].slice.call(e.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"));var d=this.parent.isFrozenGrid();if(r&&0!==a&&d){var p=parseInt(e.getAttribute(ne),10);o=this.borderRowElement(p,".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse")}o.length>0&&qi(o,!0,"e-dragborder")}},e.prototype.borderRowElement=function(e,t){var i=[];return i=[].slice.call(this.isDropGrid.getRowByIndex(e).querySelectorAll(t)).concat([].slice.call(this.isDropGrid.getMovableRowByIndex(e).querySelectorAll(t))),this.isDropGrid.getFrozenMode()===ee&&(i=i.concat([].slice.call(this.isDropGrid.getFrozenRightRowByIndex(e).querySelectorAll(t)))),i},e.prototype.getScrollWidth=function(){var e=this.parent.getContent().firstElementChild;return e.scrollWidth>e.offsetWidth?Dt.getScrollBarWidth():0},e.prototype.removeFirstRowBorder=function(e){this.isDropGrid.element.getElementsByClassName("e-firstrow-dragborder").length>0&&e&&0!==e.rowIndex&&sf.base.remove(this.isDropGrid.element.getElementsByClassName("e-firstrow-dragborder")[0])},e.prototype.removeLastRowBorder=function(e){var t;t=this.parent.enableVirtualization?e&&parseInt(e.getAttribute(ne),10)!==this.parent.renderModule.data.dataManager.dataSource.json.length-1:e&&this.parent.getRowByIndex(this.parent.getCurrentViewRecords().length-1).getAttribute("data-uid")!==e.getAttribute("data-uid"),this.parent.element.getElementsByClassName("e-lastrow-dragborder").length>0&&e&&t&&sf.base.remove(this.parent.element.getElementsByClassName("e-lastrow-dragborder")[0])},e.prototype.removeBorder=function(e){if(this.removeFirstRowBorder(e),this.parent.rowDropSettings.targetID||this.removeLastRowBorder(e),e=(this.isDropGrid.isFrozenGrid()?this.isDropGrid.getMovableRows():this.isDropGrid.getRows()).filter((function(e){return e.querySelector("td.e-dragborder")}))[0]){var t=[].slice.call(e.getElementsByClassName("e-dragborder"));if(this.parent.isFrozenGrid()){var i=parseInt(e.getAttribute(ne),10);t=this.borderRowElement(i,".e-dragborder")}qi(t,!1,"e-dragborder")}},e.prototype.getElementFromPosition=function(e,t){var i=Si(t);e.style.display="none";var r=document.elementFromPoint(i.x,i.y);return e.style.display="",r},e.prototype.onDataBound=function(){this.selectedRowColls.length>0&&this.parent.enableVirtualization&&(this.parent.selectRows(this.selectedRowColls),this.selectedRowColls=[])},e.prototype.getTargetIdx=function(e){return e?parseInt(e.getAttribute(ne),10):0},e.prototype.singleRowDrop=function(e){var t=sf.base.closest(e.target,"tr"),i=e.droppedElement.parentElement.ej2_instances[0],r=t?t.rowIndex:i.currentViewData.length-1;this.reorderRow(this.startedRowIndex,r)},e.prototype.columnDrop=function(e){var t=this.parent;if("grouping"!==e.droppedElement.getAttribute("action")&&(yi(e.target,Y)||yi(e.target,"e-emptyrow")||yi(e.target,U))){var i=sf.base.closest(e.target,"tr"),r=void 0;if("true"!==e.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&e.droppedElement.parentElement.id===t.element.id||"true"===e.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&e.droppedElement.parentElement.id!==t.element.id)return;if(e.droppedElement.parentElement.id!==t.element.id)r=e.droppedElement.parentElement.ej2_instances[0];else if(this.isSingleRowDragDrop||"true"===e.droppedElement.querySelector("tr").getAttribute("single-dragrow"))return void this.singleRowDrop(e);if(r.element.id!==t.element.id&&r.rowDropSettings.targetID!==t.element.id)return;var n=r.getSelectedRecords(),s=this.getTargetIdx(i);isNaN(s)&&(s=0),t.allowPaging&&(s=s+t.pageSettings.currentPage*t.pageSettings.pageSize-t.pageSettings.pageSize),t.notify("rows-added",{toIndex:s,records:n}),t.notify(w,{type:p,requestType:"rowdraganddrop"});var o=r.getSelectedRowIndexes(),a=r.allowPaging?r.pageSettings.currentPage*r.pageSettings.pageSize-r.pageSettings.pageSize:0;this.selectedRows=[];for(var l=0,h=n.length;l<h;l++)this.selectedRows.push(a+o[l]);r.notify("rows-removed",{indexes:this.selectedRows,records:n}),r.notify(w,{type:p,requestType:"rowdraganddrop"})}},e.prototype.reorderRow=function(e,t){var i=this.parent;if(!i.sortSettings.columns.length&&!i.groupSettings.columns.length&&!i.filterSettings.columns.length){var r=i.allowPaging?i.pageSettings.currentPage*i.pageSettings.pageSize-i.pageSettings.pageSize:0;t+=r,this.selectedRows=i.getSelectedRowIndexes(),i.notify("row-position-changed",{fromIndex:e+r,toIndex:t})}},e.prototype.enableAfterRender=function(e){e.module===this.getModuleName()&&e.enable&&this.initializeDrag()},e.prototype.destroy=function(){var e=this.parent.element;!this.parent.isDestroyed&&e&&(e.querySelector("."+H)||e.querySelector("."+U))&&(this.draggable.destroy(),this.parent.off(g,this.initializeDrag),this.parent.off("columnDrop",this.columnDrop),this.parent.removeEventListener(u,this.onDataBoundFn),this.parent.off(v,this.enableAfterRender),this.parent.off(F,this.destroy))},e.prototype.getModuleName=function(){return"rowDragAndDrop"},e.prototype.processArgs=function(e){var t=this.parent,i=parseInt(this.startedRow.getAttribute(ne),10);t.getSelectedRecords().length>0&&!1===this.startedRow.cells[0].classList.contains("e-selectionbackground")||0===t.getSelectedRecords().length?(this.parent.enableVirtualization?this.rows=[this.startedRow]:(this.rows=[this.parent.getRowByIndex(i)],t.isFrozenGrid()&&(this.rows=[t.getRowByIndex(i),t.getMovableRowByIndex(i)],t.getFrozenMode()===ee&&(this.rows=[t.getRowByIndex(i),t.getMovableRowByIndex(i),t.getFrozenRightRowByIndex(i)]))),this.rowData=[this.parent.getRowInfo(this.startedRow.querySelector("."+q)).rowData]):(this.rows=t.getSelectedRows(),this.rowData=t.getSelectedRecords())},e}(),zn=function(){function e(e,t,i,r){var n=this;this.sortRequired=!0,this.isAppliedGroup=!1,this.isAppliedUnGroup=!1,this.reorderingColumns=[],this.visualElement=sf.base.createElement("div",{className:"e-cloneproperties e-dragclone e-gdclone",styles:"line-height:23px",attrs:{action:"grouping"}}),this.helper=function(e){var t=n.parent,i=e.sender.target,r=i.classList.contains("e-groupheadercell")?i:yi(i,"e-groupheadercell");return!(!r||!i.classList.contains("e-drag")&&n.groupSettings.allowReordering)&&(n.column=t.getColumnByField(r.firstElementChild.getAttribute("ej-mappingname")),n.visualElement.textContent=r.textContent,n.visualElement.style.width=r.offsetWidth+2+"px",n.visualElement.style.height=r.offsetHeight+2+"px",n.visualElement.setAttribute("e-mappinguid",n.column.uid),t.element.appendChild(n.visualElement),n.visualElement)},this.dragStart=function(e){n.parent.element.classList.add("e-ungroupdrag")},this.drag=function(e){n.groupSettings.allowReordering&&n.animateDropper(e);var t=e.target,i=n.parent.element.querySelector(".e-cloneproperties");n.parent.trigger("columnDrag",{target:t,draggableType:"headercell",column:n.column}),n.groupSettings.allowReordering||(sf.base.classList(i,["e-defaultcur"],["e-notallowedcur"]),yi(t,U)||yi(t,"e-headercell")||sf.base.classList(i,["e-notallowedcur"],["e-defaultcur"]))},this.dragStop=function(e){n.parent.element.classList.remove("e-ungroupdrag");var t=!(yi(e.target,U)||yi(e.target,"e-gridheader"));if(n.groupSettings.allowReordering&&t){if(sf.base.remove(e.helper),yi(e.target,"e-groupdroparea"))n.rearrangeGroup();else if(!yi(e.target,"e-grid")){var i=n.parent.getColumnByUid(e.helper.getAttribute("e-mappinguid")).field;-1!==n.groupSettings.columns.indexOf(i)&&n.ungroupColumn(i)}}else t&&sf.base.remove(e.helper)},this.animateDropper=function(e){var t=n.parent.element.querySelector(".e-cloneproperties").getAttribute("e-mappinguid"),i=n.parent.getColumnByUid(t).field,r=yi(e.target,"e-groupdroparea"),s=yi(e.target,"e-group-animator"),o=[].slice.call(n.element.getElementsByClassName("e-groupheadercell")).map((function(e){return e.querySelector("div").getAttribute("ej-mappingname")})),a=JSON.parse(JSON.stringify(o));if(s||r){if(s){var l=s.querySelector("div[ej-mappingname]").getAttribute("ej-mappingname"),h=+s.getAttribute("index");if(l!==i){var d=a.indexOf(i);-1!==d&&a.splice(d,1);var p=-1!==h&&d===h;a.splice(h+(p?1:0),0,i)}}else r&&-1===a.indexOf(i)&&a.push(i);n.element.innerHTML="",a.length&&!n.element.classList.contains("e-grouped")&&n.element.classList.add("e-grouped"),n.reorderingColumns=a;for(var c=0;c<a.length;c++)n.addColToGroupDrop(a[c])}else n.addLabel(),n.removeColFromGroupDrop(i)},this.drop=function(e){var t=n.parent,i=t.getColumnByUid(e.droppedElement.getAttribute("e-mappinguid"));n.element.classList.remove("e-hover"),sf.base.remove(e.droppedElement),n.aria.setDropTarget(n.parent.element.querySelector(".e-groupdroparea"),!1),n.aria.setGrabbed(n.parent.getHeaderTable().querySelector("[aria-grabbed=true]"),!1),sf.base.isNullOrUndefined(i)||!1===i.allowGrouping||yi(t.getColumnHeaderByUid(i.uid),"e-grid").getAttribute("id")!==t.element.getAttribute("id")?n.parent.log("action_disabled_column",{moduleName:n.getModuleName(),columnName:i.headerText}):n.groupColumn(i.field)},this.contentRefresh=!0,this.aria=new be,this.parent=e,this.groupSettings=t,this.serviceLocator=r,this.sortedColumns=i,this.focus=r.getService("focus"),this.addEventListener(),this.groupGenerator=new ge(this.parent)}return e.prototype.addLabel=function(){if(!this.element.getElementsByClassName("e-group-animator").length){var e=this.l10n.getConstant("GroupDropArea");this.element.innerHTML=e,this.element.classList.remove("e-grouped")}},e.prototype.rearrangeGroup=function(){this.sortRequired=!1,this.updateModel()},e.prototype.columnDrag=function(e){this.groupSettings.allowReordering&&e.column.allowGrouping&&this.animateDropper(e);var t=this.parent.element.querySelector(".e-cloneproperties");sf.base.classList(t,["e-defaultcur"],["e-notallowedcur"]),yi(e.target,"e-groupdroparea")||this.parent.allowReordering&&yi(e.target,"e-headercell")||sf.base.classList(t,["e-notallowedcur"],["e-defaultcur"]),e.target.classList.contains("e-groupdroparea")?this.element.classList.add("e-hover"):this.element.classList.remove("e-hover")},e.prototype.columnDragStart=function(e){if(!e.target.classList.contains("e-stackedheadercell")){var t=this.parent.element.querySelector(".e-groupdroparea");this.aria.setDropTarget(t,e.column.allowGrouping);var i=e.target.classList.contains("e-headercell")?e.target:yi(e.target,"e-headercell");this.aria.setGrabbed(i,!0,!e.column.allowGrouping)}},e.prototype.columnDrop=function(e){var t=this.parent;if("grouping"===e.droppedElement.getAttribute("action")){var i=t.getColumnByUid(e.droppedElement.getAttribute("e-mappinguid"));if(sf.base.isNullOrUndefined(i)||!1===i.allowGrouping||yi(t.getColumnHeaderByUid(i.uid),"e-grid").getAttribute("id")!==t.element.getAttribute("id"))return;this.ungroupColumn(i.field)}},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(v,this.enableAfterRender,this),this.parent.on("grouping-complete",this.onActionComplete,this),this.parent.on("ungrouping-complete",this.onActionComplete,this),this.parent.on(C,this.onPropertyChanged,this),this.parent.on(R,this.clickHandler,this),this.parent.on("columnDrag",this.columnDrag,this),this.parent.on("columnDragStart",this.columnDragStart,this),this.parent.on("header-drop",this.columnDrop,this),this.parent.on("columnDrop",this.columnDrop,this),this.parent.on(S,this.refreshSortIcons,this),this.parent.on("sorting-complete",this.refreshSortIcons,this),this.parent.on(x,this.keyPressHandler,this),this.parent.on(y,this.initialEnd,this),this.parent.on(b,this.initialEnd,this),this.parent.on(g,this.render,this),this.parent.on("group-aggregates",this.onGroupAggregates,this),this.parent.on(F,this.destroy,this),this.parent.on("group-expand-collapse",this.updateExpand,this),this.parent.on("persist-data-changed",this.initialEnd,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(g,this.render),this.parent.off(v,this.enableAfterRender),this.parent.off("grouping-complete",this.onActionComplete),this.parent.off("ungrouping-complete",this.onActionComplete),this.parent.off(C,this.onPropertyChanged),this.parent.off(R,this.clickHandler),this.parent.off("columnDrag",this.columnDrag),this.parent.off("columnDragStart",this.columnDragStart),this.parent.off("columnDrop",this.columnDrop),this.parent.off("header-drop",this.columnDrop),this.parent.off(S,this.refreshSortIcons),this.parent.off("sorting-complete",this.refreshSortIcons),this.parent.off(x,this.keyPressHandler),this.parent.off("group-aggregates",this.onGroupAggregates),this.parent.off(F,this.destroy),this.parent.off("group-expand-collapse",this.updateExpand))},e.prototype.initialEnd=function(){var e=this.parent;if(this.parent.off(y,this.initialEnd),this.parent.off(b,this.initialEnd),this.parent.getColumns().length&&this.groupSettings.columns.length){this.contentRefresh=!1;for(var t=0,i=e.groupSettings.columns;t<i.length;t++){var r=i[t];this.groupColumn(r)}this.contentRefresh=!0}},e.prototype.keyPressHandler=function(e){var t=this.parent;if("ctrlSpace"===e.action||this.groupSettings.columns.length&&-1!==["altDownArrow","altUpArrow","ctrlDownArrow","ctrlUpArrow","enter"].indexOf(e.action))switch(e.preventDefault(),e.action){case"altDownArrow":case"altUpArrow":var i=t.allowSelection?t.getSelectedRowIndexes():[];if(i.length){for(var r=t.getContentTable().querySelector(se).children,n=void 0,s=t.getDataRows()[i[i.length-1]].rowIndex;s>=0;s--)if(!r[s].classList.contains(Y)&&!r[s].classList.contains("e-detailrow")){n=r[s];break}this.expandCollapseRows(n.querySelector("altUpArrow"===e.action?".e-recordplusexpand":".e-recordpluscollapse"))}break;case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"enter":if(this.parent.isEdit||null!==sf.base.closest(e.target,"#"+this.parent.element.id+"_searchbar"))return;var o=this.focus.getFocusedElement(),a=o?o.parentElement.querySelector('[class^="e-record"]'):null;if(!a)break;this.expandCollapseRows(a);break;case"ctrlSpace":var l=t.focusModule.currentInfo.element;if(l&&l.classList.contains("e-headercell")){var h=t.getColumnByUid(l.firstElementChild.getAttribute("e-mappinguid"));h.field&&t.groupSettings.columns.indexOf(h.field)<0?this.groupColumn(h.field):this.ungroupColumn(h.field)}}},e.prototype.clickHandler=function(e){this.expandCollapseRows(e.target),this.applySortFromTarget(e.target),this.unGroupFromTarget(e.target),this.toogleGroupFromHeader(e.target)},e.prototype.unGroupFromTarget=function(e){e.classList.contains("e-ungroupbutton")&&this.ungroupColumn(e.parentElement.getAttribute("ej-mappingname"))},e.prototype.toogleGroupFromHeader=function(e){this.groupSettings.showToggleButton&&(e.classList.contains("e-grptogglebtn")?e.classList.contains("e-toggleungroup")?this.ungroupColumn(this.parent.getColumnByUid(e.parentElement.getAttribute("e-mappinguid")).field):this.groupColumn(this.parent.getColumnByUid(e.parentElement.getAttribute("e-mappinguid")).field):e.classList.contains("e-toggleungroup")&&this.ungroupColumn(e.parentElement.getAttribute("ej-mappingname")))},e.prototype.applySortFromTarget=function(e){var t=this.parent,i=sf.base.closest(e,".e-groupheadercell");if(t.allowSorting&&i&&!e.classList.contains("e-ungroupbutton")&&!e.classList.contains("e-toggleungroup")){var r=i.firstElementChild.getAttribute("ej-mappingname");t.getColumnHeaderByField(r).getElementsByClassName("e-ascending").length?t.sortColumn(r,"Descending",!0):t.sortColumn(r,"Ascending",!0)}},e.prototype.expandCollapseRows=function(e){var t=yi(e,"e-recordplusexpand")||yi(e,"e-recordpluscollapse");if(t){var i=this.parent.getContentTable().querySelector(se).children,r=void 0,n=this.parent,s=t.parentElement.getElementsByClassName("e-indentcell").length,o=t.parentElement.getAttribute("data-uid"),a=n.getRowObjectFromUID(o),l=!1;if(t.classList.contains("e-recordpluscollapse")?(sf.base.addClass([t],"e-recordplusexpand"),sf.base.removeClass([t],"e-recordpluscollapse"),t.firstElementChild.className="e-icons e-gdiagonaldown e-icon-gdownarrow",l=!0,a.isExpand=!0,Zi(n)&&this.updateVirtualRows(n,e,l,void 0,void 0),this.parent.groupSettings.enableLazyLoading&&this.parent.contentModule.captionExpand(t.parentElement)):(r=!0,a.isExpand=!1,sf.base.removeClass([t],"e-recordplusexpand"),sf.base.addClass([t],"e-recordpluscollapse"),t.firstElementChild.className="e-icons e-gnextforward e-icon-grightarrow",Zi(n)&&this.updateVirtualRows(n,e,!r,void 0,void 0),this.parent.groupSettings.enableLazyLoading&&this.parent.contentModule.captionCollapse(t.parentElement)),this.aria.setExpand(t,l),!Zi(n)&&!this.parent.groupSettings.enableLazyLoading){for(var h=n.getRowsObject(),d=h.indexOf(a),p={},c=d;c<h.length&&!(c>d&&h[c].indent===s);c++){if(h[c].isDetailRow){var u=h[c-1].isExpand&&h[c-1].visible;i[c].style.display=u?"":"none"}else if(!1===p[h[c].parentUid])h[c].visible=!1,i[c].style.display="none";else{if(!(h[c].isDataRow||h[c].isCaptionRow||h[c].isDetailRow))if((u=h[c].cells.some((function(e){return e.isDataCell&&e.visible})))===h[c].visible)continue;h[c].visible=!0,i[c].style.display="",i[c].classList.remove("e-hide")}h[c].isCaptionRow&&(p[h[c].uid]=h[c].isExpand&&h[c].visible)}this.parent.notify("refresh-Expand-and-Collapse",{rows:this.parent.getRowsObject()})}this.parent.notify("infinite-group-collapse",{isCollapse:r,parentUid:o})}},e.prototype.updateVirtualRows=function(e,t,i,r,n){var s=e.getRowObjectFromUID(t.closest("tr").getAttribute("data-uid"));s.isExpand=i,ni(e),this.parent.notify("refresh-virtual-max-page",{}),(r=e.getDataModule().generateQuery(!1)).queries=e.getDataModule().aggregateQuery(e.getQuery().clone()).queries;var o={requestType:"virtualscroll",rowObject:s};e.contentModule&&(o.virtualInfo=e.contentModule.prevInfo),e.getDataModule().getData(o,r.requiresCount()).then((function(t){return e.renderModule.dataManagerSuccess(t,o)}))},e.prototype.expandCollapse=function(e){e||this.parent.notify("initial-collapse",e);for(var t,i=this.parent.getContentTable().querySelector(se).children,r=0,n=i.length;r<n;r++)i[r].querySelectorAll(".e-recordplusexpand, .e-recordpluscollapse").length?((t=i[r].querySelector(e?".e-recordpluscollapse":".e-recordplusexpand"))&&(t.className=e?"e-recordplusexpand":"e-recordpluscollapse",t.firstElementChild.className=e?"e-icons e-gdiagonaldown e-icon-gdownarrow":"e-icons e-gnextforward e-icon-grightarrow"),i[r].firstElementChild.classList.contains("e-recordplusexpand")||i[r].firstElementChild.classList.contains("e-recordpluscollapse")||(i[r].style.display=e?"":"none")):i[r].style.display=e?"":"none";this.parent.updateVisibleExpandCollapseRows(),this.parent.notify("refresh-Expand-and-Collapse",{rows:this.parent.getRowsObject()})},e.prototype.expandAll=function(){this.expandCollapse(!0)},e.prototype.collapseAll=function(){this.expandCollapse(!1)},e.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization"),this.renderGroupDropArea(),this.initDragAndDrop(),this.refreshToggleBtn()},e.prototype.renderGroupDropArea=function(){var e=this.parent.element.querySelector(".e-groupdroparea");e&&sf.base.remove(e),this.element=this.parent.createElement("div",{className:"e-groupdroparea",attrs:{tabindex:"-1"}}),this.groupSettings.allowReordering&&this.element.classList.add("e-group-animate"),this.updateGroupDropArea(),this.parent.element.insertBefore(this.element,this.parent.element.firstChild),this.groupSettings.showDropArea||(this.element.style.display="none")},e.prototype.updateGroupDropArea=function(e){if(this.groupSettings.showDropArea&&!this.groupSettings.columns.length){var t=this.l10n.getConstant("GroupDropArea");this.element.innerHTML=t,this.element.classList.remove("e-grouped")}else(this.element.innerHTML===this.l10n.getConstant("GroupDropArea")&&(1===this.groupSettings.columns.length||!this.isAppliedGroup&&!this.isAppliedUnGroup)||e)&&(this.element.innerHTML=""),this.element.classList.add("e-grouped")},e.prototype.initDragAndDrop=function(){this.initializeGHeaderDrop(),this.initializeGHeaderDrag()},e.prototype.initializeGHeaderDrag=function(){new sf.base.Draggable(this.element,{dragTarget:this.groupSettings.allowReordering?".e-drag":".e-groupheadercell",distance:this.groupSettings.allowReordering?-10:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop})},e.prototype.initializeGHeaderDrop=function(){new sf.base.Droppable(this.element,{accept:".e-dragclone",drop:this.drop})},e.prototype.groupColumn=function(e){var t=this.parent,i=t.getColumnByField(e);sf.base.isNullOrUndefined(i)||!1===i.allowGrouping||this.contentRefresh&&this.groupSettings.columns.indexOf(e)>-1?this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:i.headerText}):Ni(t)?t.notify(I,{instance:this,handler:this.groupColumn,arg1:e}):(i.visible=t.groupSettings.showGroupedColumn,this.colName=e,this.isAppliedGroup=!0,this.contentRefresh?this.updateModel():this.addColToGroupDrop(e),this.updateGroupDropArea(),this.isAppliedGroup=!1)},e.prototype.ungroupColumn=function(e){var t=this.parent,i=this.parent.enableColumnVirtualization?this.parent.columns.filter((function(t){return t.field===e}))[0]:t.getColumnByField(e);if(!(sf.base.isNullOrUndefined(i)||!1===i.allowGrouping||this.groupSettings.columns.indexOf(e)<0))if(Ni(t))t.notify(I,{instance:this,handler:this.ungroupColumn,arg1:e});else{i.visible=!0,this.colName=i.field;var r=JSON.parse(JSON.stringify(this.groupSettings.columns));if(r.splice(r.indexOf(this.colName),1),this.sortedColumns.indexOf(e)<0)for(var n=0,s=t.sortSettings.columns.length;n<s;n++)if(e===t.sortSettings.columns[n].field){t.sortSettings.columns.splice(n,1);break}this.groupSettings.allowReordering&&(this.reorderingColumns=r),this.groupSettings.columns=r,t.allowGrouping&&(this.isAppliedUnGroup=!0,this.parent.dataBind())}},e.prototype.updateModel=function(){var e=JSON.parse(JSON.stringify(this.groupSettings.columns));e=this.reorderingColumns.length?JSON.parse(JSON.stringify(this.reorderingColumns)):e,this.sortRequired&&(-1===e.indexOf(this.colName)&&e.push(this.colName),this.groupAddSortingQuery(this.colName)),this.sortRequired=!0,this.parent.groupSettings.columns=e,this.parent.dataBind()},e.prototype.onActionComplete=function(e){"grouping"===e.requestType?this.addColToGroupDrop(this.colName):this.removeColFromGroupDrop(this.colName);var t=this.groupSettings.columns.indexOf(this.colName)>-1?{columnName:this.colName,requestType:"grouping",type:c}:{requestType:"ungrouping",type:c};this.parent.trigger(c,sf.base.extend(e,t)),this.colName=null},e.prototype.groupAddSortingQuery=function(e){for(var t=0;t<this.parent.sortSettings.columns.length&&this.parent.sortSettings.columns[t].field!==e;)t++;this.parent.sortSettings.columns.length===t?this.parent.sortSettings.columns.push({field:e,direction:"Ascending",isFromGroup:!0}):this.parent.allowSorting||(this.parent.sortSettings.columns[t].direction="Ascending")},e.prototype.createElement=function(e){var t=this.parent,i="Ascending",r=this.parent.createElement("div",{className:"e-grid-icon e-group-animator"}),n=this.parent.createElement("div",{className:"e-grid-icon e-groupheadercell"}),s=this.parent.createElement("div",{attrs:{"ej-mappingname":e}});Oi(e)&&s.setAttribute("ej-complexname",ki(e));var o=this.parent.getColumnByField(e),a=t.getColumnHeaderByUid(o.uid);return this.groupSettings.allowReordering&&s.appendChild(this.parent.createElement("span",{className:"e-drag e-icons e-icon-drag",innerHTML:"&nbsp;",attrs:{title:"Drag",tabindex:"-1","aria-label":"Drag the grouped column"}})),s.appendChild(this.parent.createElement("span",{className:"e-grouptext",innerHTML:o.headerText,attrs:{tabindex:"-1","aria-label":"sort the grouped column"}})),this.groupSettings.showToggleButton&&s.appendChild(this.parent.createElement("span",{className:"e-togglegroupbutton e-icons e-icon-ungroup e-toggleungroup",innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":"ungroup button"}})),a.querySelectorAll(".e-ascending,.e-descending").length&&(i=a.querySelector(".e-ascending")?"Ascending":"Descending"),s.appendChild(this.parent.createElement("span",{className:"e-groupsort e-icons e-"+i.toLowerCase()+" e-icon-"+i.toLowerCase(),innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":"sort the grouped column"}})),s.appendChild(this.parent.createElement("span",{className:"e-ungroupbutton e-icons e-icon-hide",innerHTML:"&nbsp;",attrs:{title:this.l10n.getConstant("UnGroup"),tabindex:"-1","aria-label":"ungroup the grouped column"},styles:this.groupSettings.showUngroupButton?"":"display:none"})),n.appendChild(s),this.groupSettings.allowReordering&&(r.appendChild(n),r.appendChild(this.createSeparator()),n=r),n},e.prototype.addColToGroupDrop=function(e){var t=Oi(e)?this.parent.element.querySelector(".e-groupdroparea div[ej-complexname="+ki(e)+"]"):this.parent.element.querySelector(".e-groupdroparea div[ej-mappingname="+e+"]");if(!this.groupSettings.allowReordering||!t){var i=this.parent.getColumnByField(e);if(!sf.base.isNullOrUndefined(i)){var r=this.createElement(e);if(this.groupSettings.allowReordering){var n=this.element.getElementsByClassName("e-group-animator").length;r.setAttribute("index",n.toString())}this.element.appendChild(r)}}},e.prototype.createSeparator=function(){return this.parent.createElement("span",{className:"e-nextgroup e-icons e-icon-next",innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":"Separator for the grouped columns"},styles:this.groupSettings.showUngroupButton?"":"display:none"})},e.prototype.refreshToggleBtn=function(e){if(this.groupSettings.showToggleButton)for(var t=[].slice.call(this.parent.getHeaderTable().getElementsByClassName("e-headercelldiv")),i=0,r=t.length;i<r;i++)if(!t[i].classList.contains("e-emptycell")&&!t[i].classList.contains("e-headerchkcelldiv")){var n=this.parent.getColumnByUid(t[i].getAttribute("e-mappinguid"));(!this.parent.showColumnMenu||this.parent.showColumnMenu&&!n.showColumnMenu)&&(t[i].getElementsByClassName("e-grptogglebtn").length&&sf.base.remove(t[i].querySelectorAll(".e-grptogglebtn")[0]),e||t[i].appendChild(this.parent.createElement("span",{className:"e-grptogglebtn e-icons "+(this.groupSettings.columns.indexOf(n.field)>-1?"e-toggleungroup e-icon-ungroup":"e-togglegroup e-icon-group"),attrs:{tabindex:"-1","aria-label":"Group button"}})))}},e.prototype.removeColFromGroupDrop=function(e){if(!sf.base.isNullOrUndefined(this.getGHeaderCell(e))){var t=this.getGHeaderCell(e);if(this.groupSettings.allowReordering){var i=yi(t,"e-group-animator");sf.base.remove(i)}else sf.base.remove(t);this.updateGroupDropArea()}this.isAppliedUnGroup=!1},e.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName())for(var t=0,i=Object.keys(e.properties);t<i.length;t++){var r=i[t];switch(r){case"columns":var n=void 0;if(this.contentRefresh){if(this.isAppliedUnGroup)n={columnName:this.colName,requestType:"ungrouping",type:p};else{if(!this.isAppliedGroup){this.updateGroupDropArea(!0);for(var s=0;s<this.parent.sortSettings.columns.length;s++)this.parent.sortSettings.columns[s].isFromGroup&&(this.parent.sortSettings.columns.splice(s,1),s--);for(var o=0;o<this.groupSettings.columns.length;o++){this.colName=this.groupSettings.columns[o],this.parent.getColumnByField(this.colName).visible=this.parent.groupSettings.showGroupedColumn,this.groupAddSortingQuery(this.colName),o<this.groupSettings.columns.length-1&&this.addColToGroupDrop(this.groupSettings.columns[o])}}n={columnName:this.colName,requestType:e.properties[r].length?"grouping":"ungrouping",type:p}}if(!this.groupSettings.showGroupedColumn){var a=e.oldProperties[r];for(o=0;o<a.length;o++)-1===e.properties[r].indexOf(a[o])&&(this.parent.getColumnByField(a[o]).visible=!0)}this.parent.notify(w,n)}break;case"showDropArea":this.updateGroupDropArea(),this.groupSettings.showDropArea?this.element.style.display="":this.element.style.display="none";break;case"showGroupedColumn":this.updateGroupedColumn(this.groupSettings.showGroupedColumn),this.parent.notify(w,{requestType:"refresh"});break;case"showUngroupButton":this.updateButtonVisibility(this.groupSettings.showUngroupButton,"e-ungroupbutton");break;case"showToggleButton":this.updateButtonVisibility(this.groupSettings.showToggleButton,"e-togglegroupbutton "),this.parent.refreshHeader();break;case"enableLazyLoading":this.parent.freezeRefresh()}}},e.prototype.updateGroupedColumn=function(e){for(var t=0;t<this.groupSettings.columns.length;t++)this.parent.getColumnByField(this.groupSettings.columns[t]).visible=e},e.prototype.updateButtonVisibility=function(e,t){for(var i=[].slice.call(this.element.getElementsByClassName(t)),r=0;r<i.length;r++)i[r].style.display=e?"":"none"},e.prototype.enableAfterRender=function(e){e.module===this.getModuleName()&&e.enable&&this.render()},e.prototype.destroy=function(){var e=this.parent.element;e&&(e.querySelector("."+H)||e.querySelector("."+U))&&(!this.parent.isDestroyed&&this.parent.allowGrouping||this.parent.refreshing||this.clearGrouping(),this.removeEventListener(),this.refreshToggleBtn(!0),this.element.parentNode&&sf.base.remove(this.element))},e.prototype.clearGrouping=function(){var e=JSON.parse(JSON.stringify(this.groupSettings.columns));this.contentRefresh=!1;for(var t=0,i=e.length;t<i;t++)t===i-1&&(this.contentRefresh=!0),this.ungroupColumn(e[t]);this.contentRefresh=!0},e.prototype.getModuleName=function(){return"group"},e.prototype.refreshSortIcons=function(){var e,t=this.parent,i=t.sortSettings.columns,r=t.groupSettings.columns,n=this.parent.getColumns().map((function(e){return e.field}));this.refreshToggleBtn();for(var s=0,o=i.length;s<o;s++)-1!==n.indexOf(i[s].field)&&(e=t.getColumnHeaderByField(i[s].field),!t.allowSorting&&(this.sortedColumns.indexOf(i[s].field)>-1||this.groupSettings.columns.indexOf(i[s].field)>-1)?(sf.base.classList(e.querySelector(".e-sortfilterdiv"),["e-ascending","e-icon-ascending"],[]),i.length>1&&e.querySelector(".e-headercelldiv").appendChild(this.parent.createElement("span",{className:"e-sortnumber",innerHTML:(s+1).toString()}))):this.getGHeaderCell(i[s].field)&&this.getGHeaderCell(i[s].field).getElementsByClassName("e-groupsort").length&&("Ascending"===i[s].direction?sf.base.classList(this.getGHeaderCell(i[s].field).querySelector(".e-groupsort"),["e-ascending","e-icon-ascending"],["e-descending","e-icon-descending"]):sf.base.classList(this.getGHeaderCell(i[s].field).querySelector(".e-groupsort"),["e-descending","e-icon-descending"],["e-ascending","e-icon-ascending"])));for(s=0,o=r.length;s<o;s++)-1!==n.indexOf(r[s])&&t.getColumnHeaderByField(r[s]).setAttribute("aria-grouped","true")},e.prototype.getGHeaderCell=function(e){return this.element&&this.element.querySelector('[ej-mappingname="'+e+'"]')?this.element.querySelector('[ej-mappingname="'+e+'"]').parentElement:null},e.prototype.onGroupAggregates=function(e){var t=this.iterateGroupAggregates(e),i=this.groupGenerator.generateRows(t,{}),r=this.parent.getRowsObject().filter((function(e){return!e.isDataRow})),n=i.filter((function(e){return!e.isDataRow}));(this.parent.isReact||this.parent.isVue)&&this.parent.destroyTemplate(["groupFooterTemplate","groupCaptionTemplate","footerTemplate"]);for(var s=0;s<n.length;s++){var o=n[s],a={cells:o.cells.filter((function(e){return e.isDataCell})),data:o.data,dataUid:r[s]?r[s].uid:""};this.parent.notify("refresh-aggregate-cell",a)}},e.prototype.iterateGroupAggregates=function(e){var t=e instanceof Array?e:[],i=this.parent.getRowsObject(),r=this.parent.getCurrentViewRecords(),n=[],s=i.map((function(e){return"delete"===e.edit&&n.push(e.data),e.changes instanceof Object?e.changes:e.data})),o=this.parent.getPrimaryKeyFieldNames()[0];s=0===t.length?s:t;var a=r.map((function(e){var t,i=sf.data.DataUtil.getObject(o,e);return s.some((function(e){return t=e,i===sf.data.DataUtil.getObject(o,e)}))?t:e})),l=e;if((!l.type||"cancel"!==l.type)&&n.length>0)for(var h=0;h<n.length;h++){var d=a.indexOf(n[h]);a.splice(d,1)}for(var p,c,u=[],f=this.parent.aggregates,g=0;g<f.length;g++)for(var m=f[g],y=0;y<m.columns.length;y++){var v;v={type:m.columns[y].type.toString().toLowerCase(),field:m.columns[y].field},u.push(v)}for(var b=this.parent.groupSettings.columns,C=0;C<b.length;C++)c=p||a,p=sf.data.DataUtil.group(c,b[C],u,null,null);return p},e.prototype.updateExpand=function(e){for(var t=e.uid,i=e.isExpand,r=this.parent.getRowsObject(),n=0;n<r.length;n++){var s=r[n];if(s.uid===t||sf.base.isNullOrUndefined(t)){s.isExpand=i;for(var o=function(e){var i=r[e],n=void 0;if(i.parentUid!==s.uid&&(n=r.filter((function(e){return e.uid===i.parentUid}))[0]),i.parentUid===s.uid?i.visible=s.isExpand:sf.base.isNullOrUndefined(n)||i.parentUid!==n.uid||(n.isExpand&&!0===n.visible?i.visible=!0:n.isExpand&&!1===n.visible&&(i.visible=!1)),sf.base.isNullOrUndefined(t))return"break"},a=n+1;a<r.length;a++){if("break"===o(a))break}}}this.parent.notify(y,{rows:r,args:{isFrozen:!1,rows:r}})},e}(),Dn=function(){function t(e,t){this.aria=new be,this.childRefs=[],this.parent=e,this.parent.isDestroyed||(this.focus=t.getService("focus"),this.parent.on(R,this.clickHandler,this),this.parent.on(F,this.destroy,this),this.parent.on(x,this.keyPressHandler,this),this.parent.on("expandchildgrid",this.expand,this),this.parent.on("column-visible-changed",this.refreshColSpan,this),this.parent.on(F,this.destroyChildGrids,this),this.parent.on("destroy-child-grid",this.destroyChildGrids,this))}return t.prototype.clickHandler=function(e){this.toogleExpandcollapse(sf.base.closest(e.target,"td"))},t.prototype.toogleExpandcollapse=function(t){var i,r=this.parent,n=this.parent.getContentTable(),s=this.parent.getCurrentViewRecords().length-1,o=t&&t.classList.contains("e-detailrowcollapse");if(t&&(t.classList.contains("e-detailrowcollapse")||t.classList.contains("e-detailrowexpand"))){var a=t.parentElement,l=a.getAttribute("data-uid"),h=r.getRowObjectFromUID(l),d=this.parent.getContentTable().querySelector(se).children[a.rowIndex+1];if(t.classList.contains("e-detailrowcollapse")){var p=h.data;if(this.isDetailRow(d))d.style.display="",r.notify("detail-state-change",{data:p,childGrid:r.childGrid,detailElement:t,isExpanded:o});else if(r.getDetailTemplate()||r.childGrid){var c=Ri("grid-row"),u=this.parent.createElement("tr",{className:"e-detailrow",attrs:{"data-uid":c}}),f=this.parent.createElement("td",{className:"e-detailcell"}),g=this.parent.getVisibleColumns().length;this.parent.allowRowDragAndDrop&&g++,f.setAttribute("colspan",g.toString());var m=new N({isDataRow:!0,isExpand:!0,uid:c,isDetailRow:!0,cells:[new P({cellType:e.CellType.Indent}),new P({isDataCell:!0,visible:!0})]});m.parentUid=h.uid;for(var v=0,C=r.groupSettings.columns.length;v<C;v++)u.appendChild(this.parent.createElement("td",{className:"e-indentcell"})),m.cells.unshift(new P({cellType:e.CellType.Indent}));if(u.appendChild(this.parent.createElement("td",{className:"e-detailindentcell"})),u.appendChild(f),a.parentNode.insertBefore(u,a.nextSibling),r.detailTemplate){var w=this.parent.isReact&&"string"!=typeof r.detailTemplate,S=r.element.id+"detailTemplate";w?(r.getDetailTemplate()(p,r,"detailTemplate",S,null,null,f),this.parent.renderTemplates()):Fi(f,r.getDetailTemplate()(p,r,"detailTemplate",S))}else{i=new Yt(this.getGridModel(r,h,r.printMode)),this.childRefs.push(i),i.query&&(i.query=i.query.clone()),i.parentDetails={parentID:r.element.id,parentPrimaryKeys:r.getPrimaryKeyFieldNames(),parentKeyField:r.childGrid.queryString,parentKeyFieldValue:p[r.childGrid.queryString],parentRowData:p},i.isLegacyTemplate=r.isReact||r.isLegacyTemplate,r.isPrinting&&(i.isPrinting=!0,i.on(y,this.promiseResolve(i),this),i.on(b,this.promiseResolve(i),this)),h.childGrid=i;var x=i.getInjectedModules(),R=r.getInjectedModules();x&&x.length===R.length||i.setInjectedModules(R);var F=this.parent.createElement("div",{id:"child"+Ei(a,"e-grid").length+"_grid"+a.rowIndex+Ri("")});f.appendChild(F),i.appendTo(F)}u.appendChild(f),a.nextSibling?a.parentNode.insertBefore(u,a.nextSibling):a.parentNode.appendChild(u);var E=r.getRows(),I=r.getRowsObject();E.splice(E.indexOf(a)+1,0,u),I.splice(I.indexOf(h)+1,0,m),r.trigger("detailDataBound",{detailElement:f,data:p,childGrid:i}),r.notify("detailDataBound",{rows:I})}if(sf.base.classList(t,["e-detailrowexpand"],["e-detailrowcollapse"]),sf.base.classList(t.firstElementChild,["e-dtdiagonaldown","e-icon-gdownarrow"],["e-dtdiagonalright","e-icon-grightarrow"]),h.isExpand=!0,t.classList.contains("e-lastrowcell")&&this.parent.getContent().clientHeight>n.scrollHeight){sf.base.removeClass(t.parentElement.querySelectorAll("td"),"e-lastrowcell");var T=n.querySelector(se).getElementsByClassName("e-detailrow").length-1;sf.base.addClass(n.querySelector(se).getElementsByClassName("e-detailrow")[T].childNodes,["e-lastrowcell"]),this.lastrowcell=!0}this.aria.setExpand(t,!0)}else this.isDetailRow(d)&&(d.style.display="none",r.notify("detail-state-change",{data:h.data,childGrid:r.childGrid,detailElement:t,isExpanded:o})),sf.base.classList(t,["e-detailrowcollapse"],["e-detailrowexpand"]),sf.base.classList(t.firstElementChild,["e-dtdiagonalright","e-icon-grightarrow"],["e-dtdiagonaldown","e-icon-gdownarrow"]),parseInt(a.getAttribute(ne),10)===s&&this.lastrowcell&&(sf.base.addClass(t.parentElement.querySelectorAll("td"),"e-lastrowcell"),this.lastrowcell=!1),h.isExpand=!1,this.aria.setExpand(t,!1);sf.base.isNullOrUndefined(r.detailTemplate)||(r.updateVisibleExpandCollapseRows(),r.notify("refresh-Expand-and-Collapse",{rows:r.getRowsObject()}))}},t.prototype.getGridModel=function(e,t,i){var r;return e.isPrinting&&t.isExpand&&e.expandedRows&&e.expandedRows[t.index]&&e.expandedRows[t.index].gridModel?(e.expandedRows[t.index].gridModel.hierarchyPrintMode=e.childGrid.hierarchyPrintMode,r=e.expandedRows[t.index].gridModel):(e.isPrinting&&e.childGrid.allowPaging&&(e.childGrid.allowPaging="CurrentPage"===i),r=sf.base.extend({},{},e.childGrid,!0)),r},t.prototype.promiseResolve=function(e){var t=this;return function(){e.off(y,t.promiseResolve),e.off(b,t.promiseResolve),e.notify("hierarchyprint",{})}},t.prototype.isDetailRow=function(e){return e&&e.classList.contains("e-detailrow")},t.prototype.destroy=function(){var e=this.parent.element;!this.parent.isDestroyed&&e&&(e.querySelector("."+H)||e.querySelector("."+U))&&(this.parent.off(R,this.clickHandler),this.parent.off(F,this.destroy),this.parent.off(x,this.keyPressHandler),this.parent.off("expandchildgrid",this.expand),this.parent.off("column-visible-changed",this.refreshColSpan),this.parent.off(F,this.destroyChildGrids),this.parent.off("destroy-child-grid",this.destroyChildGrids))},t.prototype.getTDfromIndex=function(e,t){var i=this.parent.getDataRows()[e];return i&&i.querySelector(t)?i.querySelector(t):null},t.prototype.expand=function(e){isNaN(e)||(e=this.getTDfromIndex(e,".e-detailrowcollapse")),e&&e.classList.contains("e-detailrowcollapse")&&this.toogleExpandcollapse(e)},t.prototype.collapse=function(e){isNaN(e)||(e=this.getTDfromIndex(e,".e-detailrowexpand")),e&&e.classList.contains("e-detailrowexpand")&&this.toogleExpandcollapse(e)},t.prototype.expandAll=function(){this.expandCollapse(!0),this.parent.trigger(c,{requestType:"expandAllComplete",type:c,moduleObj:this})},t.prototype.collapseAll=function(){this.expandCollapse(!1),this.parent.trigger(c,{requestType:"collapseAllComplete",type:c,moduleObj:this})},t.prototype.expandCollapse=function(e){for(var t,i=this.parent.getDataRows(),r=0,n=i.length;r<n;r++)t=i[r].querySelector(".e-detailrowcollapse, .e-detailrowexpand"),e?this.expand(t):this.collapse(t)},t.prototype.keyPressHandler=function(e){var t=this.parent;switch(e.action){case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"altUpArrow":case"altDownArrow":var i=t.allowSelection?t.getSelectedRowIndexes():[];if(i.length){var r=t.getDataRows()[i[i.length-1]].querySelector(".e-detailrowcollapse, .e-detailrowexpand");"altDownArrow"===e.action?this.expand(r):this.collapse(r)}break;case"enter":if(this.parent.isEdit)return;var n=this.focus.getFocusedElement();if(!e.target.classList.contains("e-detailrowcollapse")&&!e.target.classList.contains("e-detailrowexpand"))break;this.toogleExpandcollapse(n)}},t.prototype.refreshColSpan=function(){for(var e=this.parent.contentModule.getTable().querySelectorAll("tr.e-detailrow"),t=this.parent.getVisibleColumns().length,i=0;i<e.length;i++)e[i].querySelector(".e-detailcell").setAttribute("colspan",t+"")},t.prototype.destroyChildGrids=function(){for(var e=this.parent.getRowsObject(),t=0;t<e.length;t++)e[t].childGrid=null;for(t=0;t<this.childRefs.length;t++)this.childRefs[t].isDestroyed||this.childRefs[t].destroy();this.childRefs=[]},t.prototype.getModuleName=function(){return"detailRow"},t}(),Mn=function(){function t(e,t){this.predefinedItems={},this.items=["Add","Edit","Update","Delete","Cancel","Print","Search","ColumnChooser","PdfExport","ExcelExport","CsvExport","WordExport"],this.parent=e,this.gridID=e.element.id,this.serviceLocator=t,this.addEventListener()}return t.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization");for(var e=this.parent.enableAdaptiveUI,t=["Edit","Delete","Update","Cancel"],i=0,r=["Add","Edit","Update","Delete","Cancel","Print","PdfExport","ExcelExport","WordExport","CsvExport"];i<r.length;i++){var n=r[i],s=n.toLowerCase(),o=s[0].toUpperCase()+s.slice(1);this.predefinedItems[n]={id:this.gridID+"_"+s,prefixIcon:"e-"+s,text:this.l10n.getConstant(o),tooltipText:this.l10n.getConstant(o)},e&&(this.predefinedItems[n].text="",this.predefinedItems[n].visible=-1===t.indexOf(n))}this.predefinedItems.Search={id:this.gridID+"_search",tooltipText:this.l10n.getConstant("Search"),align:"Right",cssClass:"e-search-wrapper",type:"Input"},this.predefinedItems.ColumnChooser={id:this.gridID+"_columnchooser",cssClass:"e-cc e-ccdiv e-cc-toolbar",suffixIcon:"e-columnchooser-btn",text:e?"":this.l10n.getConstant("Columnchooser"),tooltipText:this.l10n.getConstant("Columnchooser"),align:"Right"},"Vertical"===this.parent.rowRenderingMode&&(this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&(this.predefinedItems.responsiveFilter={id:this.gridID+"_responsivefilter",cssClass:"e-gridresponsiveicons e-icons",suffixIcon:"e-resfilter-icon",tooltipText:this.l10n.getConstant("FilterButton")}),this.parent.allowSorting&&(this.predefinedItems.responsiveSort={id:this.gridID+"_responsivesort",cssClass:"e-gridresponsiveicons e-icons",suffixIcon:"e-ressort-icon",tooltipText:this.l10n.getConstant("Sort")})),this.parent.enableAdaptiveUI&&this.parent.toolbar.indexOf("Search")>-1&&(this.predefinedItems.responsiveBack={id:this.gridID+"_responsiveback",cssClass:"e-gridresponsiveicons e-icons",suffixIcon:"e-resback-icon",visible:!1}),this.createToolbar()},t.prototype.getToolbar=function(){return this.toolbar.element},t.prototype.destroy=function(){this.toolbar&&!this.toolbar.isDestroyed&&(this.toolbar.element?(this.toolbar.off("render-react-toolbar-template",this.addReactToolbarPortals),this.toolbar.destroy()):(this.parent.destroyTemplate(["toolbarTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),this.unWireEvent(),this.removeEventListener(),this.element.parentNode&&sf.base.remove(this.element))},t.prototype.bindSearchEvents=function(){this.searchElement=sf.base.select("#"+this.gridID+"_searchbar",this.element),this.wireEvent(),this.refreshToolbarItems(),this.parent.searchSettings&&this.updateSearchBox()},t.prototype.toolbarCreated=function(e){this.element.querySelector(".e-search-wrapper")&&(!this.parent.enableAdaptiveUI||e?this.element.querySelector(".e-search-wrapper").innerHTML='<div class="e-input-group e-search" role="search">                    <input id="'+this.gridID+'_searchbar" class="e-input" name="input" type="search"                     placeholder= "'+this.l10n.getConstant("Search")+'"/>                    <span id="'+this.gridID+'_searchbutton" class="e-input-group-icon e-search-icon e-icons"                     tabindex="-1" title="'+this.l10n.getConstant("Search")+'" aria-label= "search"></span>                     </div>':this.element.querySelector(".e-search-wrapper").innerHTML='<span id="'+this.gridID+'_searchbutton" class="e-input-group-icon e-search-icon e-icons"                     tabindex="-1" title="'+this.l10n.getConstant("Search")+'" aria-label= "search"></span>                     </div>'),this.bindSearchEvents()},t.prototype.createToolbar=function(){var e=this.getItems();this.toolbar=new sf.navigations.Toolbar({items:e,clicked:this.toolbarClickHandler.bind(this),enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,created:this.toolbarCreated.bind(this)}),this.toolbar.isReact=this.parent.isReact,this.toolbar.on("render-react-toolbar-template",this.addReactToolbarPortals,this);this.toolbar.isStringTemplate=!0;var t="viewContainerRef";if(this.parent[t]&&(this.toolbar.registeredTemplate={},this.toolbar[t]=this.parent[t]),this.element=this.parent.createElement("div",{id:this.gridID+"_toolbarItems"}),this.parent.enableAdaptiveUI&&this.element.classList.add("e-res-toolbar"),this.parent.toolbarTemplate)if("string"==typeof this.parent.toolbarTemplate)this.toolbar.appendTo(this.parent.toolbarTemplate),this.element=this.toolbar.element;else{var i=this.parent.isReact&&"string"!=typeof this.parent.toolbarTemplate,r=this.parent.element.id+"toolbarTemplate";i?(di(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate",r,null,null,this.element),this.parent.renderTemplates()):Fi(this.element,di(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate"))}else this.toolbar.appendTo(this.element);this.parent.element.insertBefore(this.element,this.parent.getHeaderContent())},t.prototype.addReactToolbarPortals=function(e){this.parent.isReact&&e&&(this.parent.portals=this.parent.portals.concat(e),this.parent.renderTemplates())},t.prototype.renderResponsiveSearch=function(t){t?(this.toolbarCreated(!0),this.refreshResponsiveToolbarItems(e.ResponsiveToolbarAction.isSearch),this.searchElement=sf.base.select("#"+this.gridID+"_searchbar",this.element),yi(this.searchElement,"e-toolbar-right").classList.add("e-responsive-right"),this.parent.searchSettings&&this.updateSearchBox(),this.searchBoxObj.searchFocus({target:this.searchElement}),this.searchElement.focus()):this.refreshResponsiveToolbarItems(e.ResponsiveToolbarAction.isInitial)},t.prototype.refreshResponsiveToolbarItems=function(t){if(t===e.ResponsiveToolbarAction.isInitial){for(var i=this.parent.element.id,r=[i+"_edit",i+"_delete"],n=this.parent.getSelectedRowIndexes(),s=[i+"_responsiveback",i+"_update",i+"_cancel"],o=0,a=this.toolbar.items;o<a.length;o++){var l=a[o];(p=this.toolbar.element.querySelector("#"+l.id))&&(r.indexOf(l.id)>-1?n.length?p.parentElement.classList.remove("e-hidden"):p.parentElement.classList.add("e-hidden"):-1===s.indexOf(l.id)?p.parentElement.classList.remove("e-hidden"):p.parentElement.classList.add("e-hidden"))}if(this.searchElement)yi(this.searchElement,"e-toolbar-right").classList.remove("e-responsive-right"),this.toolbarCreated(!1),this.unWireEvent(),this.searchElement=void 0}if(t===e.ResponsiveToolbarAction.isSearch){r=[this.parent.element.id+"_responsiveback",this.parent.element.id+"_search"];for(var h=0,d=this.toolbar.items;h<d.length;h++){var p;l=d[h];(p=this.toolbar.element.querySelector("#"+l.id))&&(r.indexOf(l.id)>-1?p.parentElement.classList.remove("e-hidden"):p.parentElement.classList.add("e-hidden"))}}},t.prototype.refreshToolbarItems=function(e){var t=this.parent,i=[],r=[],n=t.editSettings,s=t.currentViewData&&t.currentViewData.length;n.allowAdding?i.push(this.gridID+"_add"):r.push(this.gridID+"_add"),n.allowEditing&&s?i.push(this.gridID+"_edit"):r.push(this.gridID+"_edit"),n.allowDeleting&&s?i.push(this.gridID+"_delete"):r.push(this.gridID+"_delete"),"Batch"===t.editSettings.mode?t.element.getElementsByClassName("e-updatedtd").length&&(n.allowAdding||n.allowEditing)?(i.push(this.gridID+"_update"),i.push(this.gridID+"_cancel")):(r.push(this.gridID+"_update"),r.push(this.gridID+"_cancel")):t.isEdit&&(n.allowAdding||n.allowEditing)?(i=[this.gridID+"_update",this.gridID+"_cancel"],r=[this.gridID+"_add",this.gridID+"_edit",this.gridID+"_delete"]):(r.push(this.gridID+"_update"),r.push(this.gridID+"_cancel")),this.enableItems(i,!0),this.enableItems(r,!1)},t.prototype.getItems=function(){var e=[],t=this.parent.toolbar||[];if("string"==typeof this.parent.toolbar)return[];"Vertical"===this.parent.rowRenderingMode&&(this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&e.push(this.getItemObject("responsiveFilter")),this.parent.allowSorting&&e.push(this.getItemObject("responsiveSort")));for(var r=0,n=t;r<n.length;r++){var s=n[r];switch(i(s)){case"number":e.push(this.getItemObject(this.items[s]));break;case"string":e.push(this.getItemObject(s));break;default:e.push(this.getItem(s))}}return this.parent.enableAdaptiveUI&&this.parent.toolbar.indexOf("Search")>-1&&e.push(this.getItemObject("responsiveBack")),e},t.prototype.getItem=function(e){var t=this.predefinedItems[e.text];return t?sf.base.extend(t,t,e):e},t.prototype.getItemObject=function(e){return this.predefinedItems[e]||{text:e,id:this.gridID+"_"+e}},t.prototype.enableItems=function(e,t){for(var i=0,r=e;i<r.length;i++){var n=r[i],s=sf.base.select("#"+n,this.element);s&&this.toolbar.enableItems(s.parentElement,t)}},t.prototype.toolbarClickHandler=function(e){var t=this,i=this.parent,r=this.gridID;sf.base.extend(e,{cancel:!1});var n=e,s=e.originalEvent;i.trigger("toolbarClick",n,(function(e){if(e.originalEvent=e.originalEvent?e.originalEvent:s,!e.cancel)switch(!sf.base.isNullOrUndefined(e.item)&&e.item.id){case r+"_print":i.print();break;case r+"_edit":i.startEdit();break;case r+"_update":i.endEdit();break;case r+"_cancel":i.closeEdit();break;case r+"_add":i.addRecord();break;case r+"_delete":i.deleteRecord();break;case r+"_search":e.originalEvent.target.id===r+"_searchbutton"&&t.searchElement?t.search():!i.enableAdaptiveUI||t.searchElement||!e.originalEvent.target.classList.contains("e-search-wrapper")&&e.originalEvent.target.id!==r+"_searchbutton"||t.renderResponsiveSearch(!0);break;case r+"_columnchooser":var n=t.parent.element.querySelector(".e-ccdiv"),o=n.getBoundingClientRect().top,a=n.getBoundingClientRect().left,l=e.originalEvent.target;o=n.getBoundingClientRect().top+n.offsetTop,i.createColumnchooser(a,o,l);break;case r+"_responsivefilter":i.showResponsiveCustomFilter();break;case r+"_responsivesort":i.showResponsiveCustomSort();break;case r+"_responsiveback":t.renderResponsiveSearch(!1)}}))},t.prototype.modelChanged=function(e){"edit"===e.module&&this.refreshToolbarItems()},t.prototype.onPropertyChanged=function(e){e.module===this.getModuleName()&&this.parent.toolbar&&(this.element&&sf.base.remove(this.element),this.render())},t.prototype.keyUpHandler=function(e){13===e.keyCode&&this.search()},t.prototype.search=function(){this.parent.search(this.searchElement.value)},t.prototype.updateSearchBox=function(){this.searchElement&&(this.searchElement.value=this.parent.searchSettings.key)},t.prototype.wireEvent=function(){this.searchElement&&(this.searchBoxObj=new yt(this.searchElement),sf.base.EventHandler.add(this.searchElement,"keyup",this.keyUpHandler,this),this.searchBoxObj.wireEvent())},t.prototype.unWireEvent=function(){this.searchElement&&(sf.base.EventHandler.remove(this.searchElement,"keyup",this.keyUpHandler),this.searchBoxObj.unWireEvent())},t.prototype.reRenderToolbar=function(){this.element&&sf.base.remove(this.element),this.render()},t.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:"set-fullscreen-dialog",handler:this.reRenderToolbar},{event:g,handler:this.render},{event:v,handler:this.onPropertyChanged},{event:C,handler:this.updateSearchBox.bind(this)},{event:w,handler:this.refreshToolbarItems},{event:"toolbar-refresh",handler:this.refreshToolbarItems},{event:C,handler:this.modelChanged},{event:u,handler:this.refreshToolbarItems},{event:R,handler:this.removeResponsiveSearch},{event:"row-mode-change",handler:this.reRenderToolbar},{event:F,handler:this.destroy}],Nr(this.parent,this.evtHandlers,!0,this),this.rowSelectedFunction=this.rowSelected.bind(this),this.rowDeSelectedFunction=this.rowSelected.bind(this),this.parent.addEventListener("rowSelected",this.rowSelectedFunction),this.parent.addEventListener("rowDeselected",this.rowDeSelectedFunction))},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(Nr(this.parent,this.evtHandlers,!1),this.parent.removeEventListener("rowSelected",this.rowSelectedFunction),this.parent.removeEventListener("rowDeselected",this.rowDeSelectedFunction))},t.prototype.removeResponsiveSearch=function(e){var t=e.target,i=t.classList.contains("e-search-icon")||t.classList.contains("e-search-wrapper");this.parent.enableAdaptiveUI&&!i&&this.searchElement&&!yi(e.target,"e-res-toolbar")&&this.renderResponsiveSearch(!1)},t.prototype.rowSelected=function(){this.parent.enableAdaptiveUI&&this.refreshResponsiveToolbarItems(e.ResponsiveToolbarAction.isInitial)},t.prototype.getModuleName=function(){return"toolbar"},t}(),On=(Jr=function(e,t){return(Jr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Jr(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),kn=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.aggregates={},r.parent=t,r.locator=i,r.modelGenerator=new pe(r.parent),r.addEventListener(),r}return On(t,e),t.prototype.renderPanel=function(){var e=this.parent.createElement("div",{className:j}),t=this.parent.createElement("div",{className:"e-summarycontent"}),i=t;if(this.parent.isFrozenGrid()){var r=this.parent.createElement("div",{className:"e-frozenfootercontent e-frozen-left-footercontent"}),n=this.parent.createElement("div",{className:"e-movablefootercontent"}),s=this.parent.createElement("div",{className:"e-frozenfootercontent e-frozen-right-footercontent"});(this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount())&&(t.appendChild(r),this.frozenContent=r),t.appendChild(n),this.movableContent=n,i=n,this.parent.getFrozenRightColumnsCount()&&(t.appendChild(s),this.frozenRightContent=s)}sf.base.Browser.isDevice&&(i.style.overflowX="scroll"),e.appendChild(t),this.setPanel(e),null!=this.parent.getPager()?this.parent.element.insertBefore(e,this.parent.getPager()):this.parent.element.appendChild(e)},t.prototype.renderTable=function(){var e=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),t=this.createContentTable("_footer_table").querySelector("."+X),i=this.parent.createElement("tfoot");if(t.appendChild(i),this.parent.isFrozenGrid()){var r=t.cloneNode(!0),n=t.cloneNode(!0);if(e&&(this.frozenContent.appendChild(r),this.freezeTable=r),this.parent.getFrozenRightColumnsCount()){sf.base.remove(n.querySelector(oe));var s=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(oe).cloneNode(!0);n.insertBefore(s,n.querySelector(se)),this.frozenRightContent.appendChild(n),this.frTable=n}this.movableContent.appendChild(t),sf.base.remove(t.querySelector(oe));var o=this.parent.getHeaderContent().querySelector("."+_).querySelector(oe).cloneNode(!0);t.insertBefore(o,t.querySelector(se)),this.setColGroup(o)}this.setTable(t)},t.prototype.renderSummaryContent=function(e,t,i,r){var n=this.parent.dataSource instanceof Array?this.parent.dataSource:this.parent.currentViewData,s=this.modelGenerator.getData(),o=sf.base.isNullOrUndefined(i)?this.modelGenerator.getColumns():this.modelGenerator.getColumns(i,r),a=sf.base.isNullOrUndefined(i)?this.modelGenerator.generateRows(n,e||this.aggregates):this.modelGenerator.generateRows(n,e||this.aggregates,i,r),l=document.createDocumentFragment(),h=new le(this.locator,null,this.parent);h.element=this.parent.createElement("TR",{className:"e-summaryrow"});for(var d=0,p=s.length;d<p;d++){var c=a[d];if(c){var u=h.render(c,o);l.appendChild(u)}}t.tFoot.appendChild(l),this.aggregates=sf.base.isNullOrUndefined(e)?this.aggregates:e},t.prototype.refresh=function(e){var t=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),i=this.parent.getMovableColumnsCount(),r=this.parent.getFrozenRightColumnsCount();if(this.parent.isFrozenGrid()&&(sf.base.remove(this.getPanel()),this.renderPanel(),this.renderTable(),t&&(this.freezeTable.tFoot.innerHTML="",this.renderSummaryContent(e,this.freezeTable,0,t))),this.getTable().tFoot.innerHTML="",this.renderSummaryContent(e,this.getTable(),t,r?t+i:void 0),this.parent.getFrozenRightColumnsCount()){this.frTable.tFoot.innerHTML="",this.renderSummaryContent(e,this.frTable,t+i,t+i+r);var n=[].slice.call(this.getTable().getElementsByClassName("e-lastsummarycell"));if(n.length)for(var s=0;s<n.length;s++)n[s].style.borderRight="0px"}if(this.parent.isFrozenGrid()){var o=[].slice.call(this.parent.element.querySelector(".e-movablefootercontent").getElementsByClassName("e-summaryrow")),a=void 0;if(t){a=[].slice.call(this.parent.element.querySelector(".e-frozen-left-footercontent").getElementsByClassName("e-summaryrow")),this.refreshHeight(a,o);var l=this.frozenContent;l.offsetHeight||(l.style.height=this.getTable().offsetHeight+"px")}if(r){var h=[].slice.call(this.parent.element.querySelector(".e-frozen-right-footercontent").getElementsByClassName("e-summaryrow"));this.refreshHeight(h,o),a&&this.refreshHeight(h,a);var d=this.frTable;d.offsetHeight||(d.style.height=this.getTable().offsetHeight+"px")}this.parent.allowResizing&&this.updateFooterTableWidth(this.getTable())}this.onScroll()},t.prototype.refreshHeight=function(e,t){for(var i=0;i<e.length;i++){var r=e[i].getBoundingClientRect().height,n=t[i].getBoundingClientRect().height;r<n?(e[i].classList.remove("e-hide"),e[i].style.height=n+"px"):r>n&&(t[i].classList.remove("e-hide"),t[i].style.height=r+"px")}},t.prototype.refreshCol=function(){var e,t=e=this.parent.element.querySelector("."+H).querySelector(oe).cloneNode(!0);this.parent.getFrozenColumns()&&(this.parent.enableColumnVirtualization&&this.parent.contentModule.isXaxis()?e=this.parent.getMovableVirtualHeader().querySelector(oe).cloneNode(!0):(e=Ji(t,this.parent.getFrozenColumns(),this.parent),this.freezeTable.replaceChild(t,this.freezeTable.querySelector(oe))));this.getTable().replaceChild(e,this.getColGroup()),this.setColGroup(e)},t.prototype.onWidthChange=function(e){this.getColFromIndex(e.index).style.width=sf.base.formatUnit(e.width),this.parent.allowResizing&&"resize"===e.module&&this.updateFooterTableWidth(this.getTable())},t.prototype.onScroll=function(e){void 0===e&&(e={left:this.parent.isFrozenGrid()?this.parent.getContent().querySelector("."+G).scrollLeft:this.parent.getContent().firstChild.scrollLeft}),this.getTable().parentElement.scrollLeft=e.left},t.prototype.getColFromIndex=function(e){var t=this.parent.getVisibleFrozenLeftCount()||this.parent.getFrozenColumns(),i=this.parent.getVisibleMovableCount(),r=this.parent.getVisibleFrozenRightCount(),n=this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()?1:0;return t&&e<t+n?this.freezeTable.querySelector(oe).children[e]:r&&e>=t+i+n?this.frTable.querySelector(oe).children[e-(t?t+i+n:t+i)]:this.getColGroup().children[e-(t?t+n:t)]},t.prototype.columnVisibilityChanged=function(){this.refresh()},t.prototype.addEventListener=function(){this.evtHandlers=[{event:"colgroup-refresh",handler:this.refreshCol},{event:"column-width-changed",handler:this.onWidthChange},{event:"scroll",handler:this.onScroll},{event:"column-visible-changed",handler:this.columnVisibilityChanged},{event:"refresh-footer-rendered",handler:this.refreshFooterRenderer}],Nr(this.parent,this.evtHandlers,!0,this)},t.prototype.removeEventListener=function(){Nr(this.parent,this.evtHandlers,!1)},t.prototype.updateFooterTableWidth=function(e){var t=this.parent.getHeaderTable();t&&e&&(e.style.width=t.style.width)},t.prototype.refreshFooterRenderer=function(e){var t=this.onAggregates(e);this.refresh(t)},t.prototype.getIndexByKey=function(e,t){for(var i=this.parent.getPrimaryKeyFieldNames()[0],r=0;r<t.length;r++)if(t[r][i]===e[i])return r;return-1},t.prototype.onAggregates=function(e){e=e instanceof Array?e:[];var t=this.parent.getPrimaryKeyFieldNames()[0],i=[],r=!1,n={},s=!1;!this.parent.renderModule.data.isRemote()&&this.parent.allowFiltering&&this.parent.filterSettings.columns.length&&(s=!0);var o=this.parent.dataSource instanceof Array?s?this.parent.getFilteredRecords():this.parent.dataSource:this.parent.dataSource.dataSource.json.length?this.parent.dataSource.dataSource.json:this.parent.getCurrentViewRecords();if(this.parent.editModule&&(n=this.parent.editModule.getBatchChanges()),Object.keys(n).length){for(var a=0;a<o.length;a++)r=!1,n.changedRecords.length&&this.getIndexByKey(o[a],n.changedRecords)>-1&&(r=!0,i.push(n.changedRecords[this.getIndexByKey(o[a],n.changedRecords)])),n.deletedRecords.length&&this.getIndexByKey(o[a],n.deletedRecords)>-1?r=!0:r||i.push(o[a]);if(n.addedRecords.length)for(a=0;a<n.addedRecords.length;a++)i.push(n.addedRecords[a])}else{if(e.length)i=hi(o).map((function(i){var r,n=sf.data.DataUtil.getObject(t,i);return e.some((function(e){return r=e,n===sf.data.DataUtil.getObject(t,e)}))?r:i}));else i=o}var l=e;l.type&&"cancel"===l.type&&(i=o);var h,d={},p=this.parent.aggregates;for(a=0;a<p.length;a++)for(var c=0;c<p[a].columns.length;c++){var u=p[a].columns[c].type.toString();h=Ii(u,i,p[a].columns[c],this.parent),d[p[a].columns[c].field+" - "+u.toLowerCase()]=h}return{result:i,count:i.length,aggregates:d}},t}(me),An=(Zr=function(e,t){return(Zr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Zr(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Bn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-summarycell",attrs:{role:"gridcell",tabindex:"-1"}}),t}return An(t,e),t.prototype.getValue=function(e,t,i){var r=sf.base.isNullOrUndefined(i.type)?i.columnName:i.field+" - "+("string"==typeof i.type?i.type.toLowerCase():"");return t[i.columnName]?t[i.columnName][r]:""},t.prototype.evaluate=function(e,t,i,r){var n=t.column;if(this.parent.on("refresh-aggregate-cell",this.refreshWithAggregate(e,t),this),!(n.footerTemplate||n.groupFooterTemplate||n.groupCaptionTemplate))return"Vertical"===this.parent.rowRenderingMode&&(e.style.display="none"),!0;"Vertical"===this.parent.rowRenderingMode&&e.classList.add("e-lastsummarycell");var s=n.getTemplate(t.cellType),o=this.parent.getColumnByField(i[n.columnName].field);if(!sf.base.isNullOrUndefined(o)&&(i[n.columnName].headerText=o.headerText,o.isForeignColumn())){var a=o.columnData.filter((function(e){return e[o.foreignKeyField]===i[n.columnName].key}))[0];a&&(i[n.columnName].foreignKey=a[o.foreignKeyValue])}if(this.parent.isReact&&(n.footerTemplate?"string"!=typeof n.footerTemplate:n.groupFooterTemplate?"string"!=typeof n.groupFooterTemplate:!!n.groupCaptionTemplate&&"string"!=typeof n.groupCaptionTemplate)){var l=i[n.columnName];if("groupCaptionTemplate"===s.property||"groupFooterTemplate"===s.property){l.groupKey=l.key}s.fn(l,this.parent,s.property,"",null,null,e),this.parent.renderTemplates()}else Fi(e,s.fn(i[n.columnName],this.parent,s.property,""));return!1},t.prototype.refreshWithAggregate=function(e,t){var i=this,r=t;return function(t){var n=r,s=n.column.columnName?n.column.columnName:null,o=sf.base.isNullOrUndefined(s)?null:t.cells.filter((function(e){return e.column.columnName===s}))[0];e.parentElement&&e.parentElement.getAttribute("data-uid")===t.dataUid&&s&&s===o.column.columnName&&i.refreshTD(e,o,t.data)}},t}(ve),Nn=function(){function t(e,t){this.parent=e,this.locator=t,this.addEventListener()}return t.prototype.getModuleName=function(){return"aggregate"},t.prototype.initiateRender=function(){for(var t=this,i=this.locator.getService("cellRendererFactory"),r=new Bn(this.parent,this.locator),n=[e.CellType.Summary,e.CellType.CaptionSummary,e.CellType.GroupSummary],s=0;s<n.length;s++)i.addCellRenderer(n[s],r);this.footerRenderer=new kn(this.parent,this.locator),this.footerRenderer.renderPanel(),this.footerRenderer.renderTable();var o=this.footerRenderer.getPanel();this.parent.element.scrollHeight>=this.parent.getHeight(this.parent.height)&&o&&sf.base.addClass([o],["e-footerpadding"]),this.locator.register("footerRenderer",this.footerRenderer);this.parent.on(m,(function e(){t.prepareSummaryInfo(),t.parent.off(m,e)}),this),this.parent.on(m,this.footerRenderer.refresh,this.footerRenderer)},t.prototype.prepareSummaryInfo=function(){var e=this;Pn(this.parent.aggregates,(function(t){var r=sf.base.getValue("customFormat",t);if(sf.base.isNullOrUndefined(r)||t.setPropertiesSilent({format:r}),"object"===i(t.format)){var n=new a;t.setFormatter(n.getFormatFunction(sf.base.extend({},t.format)))}else if("string"==typeof t.format){var s=e.locator.getService("valueFormatter");t.setFormatter(s.getFormatFunction({format:t.format}))}t.setPropertiesSilent({columnName:t.columnName||t.field})}))},t.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName()){sf.base.isNullOrUndefined(this.footerRenderer)&&this.initiateRender(),this.prepareSummaryInfo(),this.footerRenderer.refresh();var t=new ue(this.parent);0===new ce(this.parent).getData().length&&t.isEmpty()||this.parent.notify(w,{})}},t.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(g,this.initiateRender,this),this.parent.on(v,this.onPropertyChanged,this),this.parent.on("refresh-aggregates",this.refresh,this),this.parent.on(F,this.destroy,this))},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.footerRenderer.removeEventListener(),this.parent.off(g,this.initiateRender),this.parent.off(m,this.footerRenderer.refresh),this.parent.off(v,this.onPropertyChanged),this.parent.off("refresh-aggregates",this.refresh),this.parent.off(F,this.destroy),sf.base.remove(this.parent.element.querySelector("."+j)))},t.prototype.destroy=function(){this.removeEventListener()},t.prototype.refresh=function(e){var t=e instanceof Array?e:[e];this.parent.notify("refresh-footer-rendered",t),this.parent.groupSettings.columns.length>0&&this.parent.notify("group-aggregates",t)},t}();function Pn(e,t){for(var i=0;i<e.length;i++)for(var r=0;r<e[i].columns.length;r++)t(e[i].columns[r],e[i])}var Ln,qn,Hn,Un,jn,Vn,Gn,_n=function(){function e(e,t,i){var r=this;this.fromWheel=!1,this.touchMove=!1,this.options={},this.sentinelInfo={up:{check:function(e,t){var i=e.top-r.containerRect.top;return t.entered=i>=0,i+r.options.pageHeight/2>=0},axis:"Y"},down:{check:function(e,t){var i=e.bottom;return t.entered=e.bottom<=r.containerRect.bottom,i-r.containerRect.top-r.options.pageHeight/2<=r.options.pageHeight/2},axis:"Y"},right:{check:function(e,t){var i=e.right;return r.movableEle?(t.entered=i<r.movableContainerRect.right,i-r.movableContainerRect.width<=r.movableContainerRect.right):(t.entered=i<r.containerRect.right,i-r.containerRect.width<=r.containerRect.right)},axis:"X"},left:{check:function(e,t){var i=e.left;return t.entered=i>0,r.movableEle?i+r.movableContainerRect.width>=r.movableContainerRect.left:i+r.containerRect.width>=r.containerRect.left},axis:"X"}},this.element=e,this.options=t,this.movableEle=i}return e.prototype.observe=function(e,t){var i=this;this.containerRect=this.options.container.getBoundingClientRect(),sf.base.EventHandler.add(this.options.container,"wheel",(function(){return i.fromWheel=!0}),this),sf.base.EventHandler.add(this.options.container,"scroll",this.virtualScrollHandler(e,t),this),this.options.movableContainer&&(this.movableContainerRect=this.options.movableContainer.getBoundingClientRect(),sf.base.EventHandler.add(this.options.scrollbar,"wheel",(function(){return i.fromWheel=!0}),this),sf.base.EventHandler.add(this.options.scrollbar,"scroll",this.virtualScrollHandler(e,t),this))},e.prototype.check=function(e){var t=this.sentinelInfo[e];return!this.movableContainerRect||"left"!==e&&"right"!==e?t.check(this.element.getBoundingClientRect(),t):t.check(this.movableEle.getBoundingClientRect(),t)},e.prototype.virtualScrollHandler=function(e,t){var i=this,r="chrome"===sf.base.Browser.info.name?200:100,n=sf.base.debounce(e,r),s=sf.base.debounce(e,50);return this.options.prevTop=this.options.prevLeft=0,function(e){var r=i.options.movableContainer?i.options.container.scrollTop:e.target.scrollTop,o=i.options.movableContainer?i.options.scrollbar.scrollLeft:e.target.scrollLeft,a=i.options.prevTop<r?"down":"up";a=i.options.prevLeft===o?a:i.options.prevLeft<o?"right":"left",i.options.prevTop=r,i.options.prevLeft=o;var l=i.sentinelInfo[a];if(-1!==i.options.axes.indexOf(l.axis)){var h=i.check(a);if(l.entered&&(!i.movableEle||"right"!==a&&"left"!==a?t(i.element,l,a,{top:r,left:o},i.fromWheel,h):t(i.movableEle,l,a,{top:r,left:o},i.fromWheel,h)),h){var d=n;"X"===l.axis&&(d=s),d({direction:a,sentinel:l,offset:{top:r,left:o},focusElement:document.activeElement})}i.fromWheel=!1}}},e.prototype.setPageHeight=function(e){this.options.pageHeight=e},e}(),Wn=function(){function e(e){this.cOffsets={},this.cache={},this.movableCache={},this.frozenRightCache={},this.rowCache={},this.data={},this.groups={},this.currentInfo={},this.parent=e,this.model=this.parent.pageSettings,this.rowModelGenerator=this.parent.allowGrouping?new ge(this.parent):new he(this.parent)}return e.prototype.generateRows=function(e,t){var i=this.parent.isFrozenGrid(),r=!1,n=t.virtualInfo=t.virtualInfo||this.getData(),s=n.sentinelInfo&&"X"===n.sentinelInfo.axis,o=s||!n.loadNext||n.loadSelf?n.page:n.nextInfo.page,a=[],l=this.getBlockIndexes(o),h=[];if(this.currentInfo.blockIndexes&&(l=n.blockIndexes=t.virtualInfo.blockIndexes=this.includePrevPage?this.currentInfo.blockIndexes.slice(1):this.currentInfo.blockIndexes.slice(0,this.currentInfo.blockIndexes.length-1),r=!0),(i&&this.parent.getFrozenMode()!==ee&&!t.renderMovableContent||this.parent.getFrozenMode()===ee&&!t.renderMovableContent&&!t.renderFrozenRightContent||!i)&&this.checkAndResetCache(t.requestType),Zi(this.parent)&&this.parent.vcRows.length)return this.parent.vcRows;if(this.parent.enableColumnVirtualization)for(var d=0;d<n.blockIndexes.length;d++){if(this.isBlockAvailable(n.blockIndexes[d])&&(this.cache[n.blockIndexes[d]]=this.rowModelGenerator.refreshRows(this.cache[n.blockIndexes[d]])),t.renderMovableContent&&this.isMovableBlockAvailable(n.blockIndexes[d])||t.renderFrozenRightContent&&this.isFrozenRightBlockAvailable(n.blockIndexes[d]))(g=t.renderMovableContent?this.movableCache:this.frozenRightCache)[n.blockIndexes[d]]=this.rowModelGenerator.refreshRows(g[n.blockIndexes[d]])}var p=n.blockIndexes;for(d=0;d<p.length;d++){if(!this.isBlockAvailable(p[d])){var c=sf.base.isNullOrUndefined(this.startIndex)?this.getStartIndex(p[d],e):this.startIndex,u=this.rowModelGenerator.generateRows(e,{virtualInfo:n,startIndex:c});Zi(this.parent)&&!this.parent.vcRows.length&&(this.parent.vRows=u,this.parent.vcRows=u,this.parent.notify("refresh-virtual-max-page",{}));var f=void 0;Zi(this.parent)?this.getGroupVirtualRecordsByIndex(u):r?this.setBlockForManualRefresh(this.cache,l,u):(f=~~Math.max(u.length,this.model.pageSize)/2,this.isBlockAvailable(l[0])||(this.cache[l[0]]=u.slice(0,f)),this.isBlockAvailable(l[1])||(this.cache[l[1]]=u.slice(f)))}if(this.parent.groupSettings.columns.length&&!s&&this.cache[p[d]]&&(this.cache[p[d]]=this.updateGroupRow(this.cache[p[d]],p[d])),t.renderMovableContent&&!this.isMovableBlockAvailable(p[d])||t.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(p[d])){var g=t.renderMovableContent?this.movableCache:this.frozenRightCache;c=sf.base.isNullOrUndefined(this.startIndex)?this.getStartIndex(p[d],e):this.startIndex,u=this.rowModelGenerator.generateRows(e,{virtualInfo:n,startIndex:c});if(r)this.setBlockForManualRefresh(g,l,u);else{f=~~Math.max(u.length,this.model.pageSize)/2;(t.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(l[0])||t.renderMovableContent&&!this.isMovableBlockAvailable(l[0]))&&(g[l[0]]=u.slice(0,f)),(t.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(l[1])||t.renderMovableContent&&!this.isMovableBlockAvailable(l[1]))&&(g[l[1]]=u.slice(f))}}if(t.renderMovableContent||t.renderFrozenRightContent||!this.cache[p[d]])(g=t.renderMovableContent?this.movableCache:this.frozenRightCache)[p[d]]&&a.push.apply(a,g[p[d]]);else a.push.apply(a,this.cache[p[d]]);this.isBlockAvailable(p[d])&&h.push(p[d])}n.blockIndexes=h;return this.parent.allowGrouping&&this.parent.groupSettings.columns.length?this.parent.currentViewData.records=a.map((function(e){return e.data})):i?(t.renderMovableContent&&("Left"===this.parent.getFrozenMode()||"Right"===this.parent.getFrozenMode()||this.parent.getFrozenColumns())||t.renderFrozenRightContent)&&(this.parent.currentViewData=a.map((function(e){return e.data}))):this.parent.currentViewData=a.map((function(e){return e.data})),a},e.prototype.setBlockForManualRefresh=function(e,t,i){var r=this.model.pageSize/2;this.includePrevPage?(e[t[0]-1]=i.slice(0,r),e[t[0]]=i.slice(r,2*r),e[t[1]]=i.slice(2*r,3*r),e[t[2]]=i.slice(3*r,4*r)):(e[t[0]]=i.slice(0,r),e[t[1]]=i.slice(r,2*r),e[t[2]]=i.slice(2*r,3*r),e[t[2]+1]=i.slice(3*r,4*r))},e.prototype.getBlockIndexes=function(e){return[e+(e-1),2*e]},e.prototype.getPage=function(e){return e%2==0?e/2:(e+1)/2},e.prototype.isBlockAvailable=function(e){return e in this.cache},e.prototype.isMovableBlockAvailable=function(e){return e in this.movableCache},e.prototype.isFrozenRightBlockAvailable=function(e){return e in this.frozenRightCache},e.prototype.getData=function(){return{page:this.model.currentPage,blockIndexes:this.getBlockIndexes(this.model.currentPage),direction:"down",columnIndexes:this.parent.getColumnIndexesInView()}},e.prototype.getStartIndex=function(e,t,i){void 0===i&&(i=!0);var r=e%2==0,n=(this.getPage(e)-1)*this.model.pageSize;return i||!r?n:n+~~(this.model.pageSize/2)},e.prototype.getColumnIndexes=function(e){var t=this;void 0===e&&(e=this.parent.getHeaderContent().querySelector("."+V)),this.parent.isFrozenGrid()&&(e=e.querySelector("."+_));var i=[],r=0|e.scrollLeft,n=Object.keys(this.cOffsets),s=e.getBoundingClientRect().width;r=Math.min(this.cOffsets[n.length-1]-s,r);var o=sf.base.Browser.isDevice?2*s:s/2,a=r+s+(0===r?o:0);return n.some((function(e){var n=Number(e),s=t.cOffsets[e];return r-o<=s&&a+o>=s&&i.push(n),a+o<s})),this.addFrozenIndex(i),i},e.prototype.addFrozenIndex=function(e){if(this.parent.getFrozenColumns()&&this.parent.enableColumnVirtualization&&0===e[0])for(var t=0;t<this.parent.getFrozenColumns();t++)e.push(e[e.length-1]+1)},e.prototype.checkAndResetCache=function(e){var t=["paging","refresh","sorting","filtering","searching","grouping","ungrouping","reorder","save","delete"];this.parent.getFrozenColumns()&&this.parent.frozenRows&&this.parent.enableColumnVirtualization&&"reorder"===e&&t.splice(t.indexOf(e),1);var i=t.some((function(t){return e===t}));return i&&(this.cache={},this.data={},this.groups={},this.movableCache={},this.frozenRightCache={}),i},e.prototype.refreshColOffsets=function(){var e=this,t=0;this.cOffsets={};for(var i=this.parent.groupSettings.columns.length,r=this.parent.columns,n=r.length,s=this.parent.groupSettings.columns,o=0;o<s.length;o++)this.cOffsets[o]=30+(0|this.cOffsets[o-1]);for(var a,l=Array.apply(null,Array(n)).map((function(){return t++})),h=0;h<l.length;h++)l[h]=l[h]+i,this.cOffsets[l[h]]=(0|this.cOffsets[l[h]-1])+((a=r[h]).visible&&(e.parent.groupSettings.showGroupedColumn?a.visible:e.parent.groupSettings.columns.indexOf(a.field)<0)?parseInt(r[h].width,10):0)},e.prototype.updateGroupRow=function(e,t){for(var i=e[0],r=[],n=Object.keys(this.cache),s=0;s<n.length;s++)Number(n[s])<t&&(r=r.concat(this.cache[n[s]]));return i&&i.isDataRow||t%2==0?e:this.iterateGroup(e,r)},e.prototype.iterateGroup=function(e,t){var i=e[0],r=0;return i&&i.isDataRow||e.some((function(e){return t.some((function(t,i){var n=t&&void 0!==t.data.field&&t.data.field===e.data.field&&t.data.key===e.data.key;return n&&(r=i),n}))}))&&(e.shift(),e=this.iterateGroup(e,t.slice(r))),e},e.prototype.getRows=function(){for(var e=[],t=Object.keys(this.cache),i=0;i<t.length;i++)e=e.concat(this.cache[t[i]]);return e},e.prototype.generateCells=function(){for(var e=[],t=this.parent.columnModel,i=0;i<t.length;i++)e.push(this.rowModelGenerator.generateCell(t[i]));return e},e.prototype.getGroupVirtualRecordsByIndex=function(e){for(var t=this.parent.contentModule.getGroupedTotalBlocks(),i=this.parent.contentModule.getBlockSize(),r=1;r<=t;r++){var n=0;this.cache[r]=[];for(var s=(r-1)*i;s<e.length&&n!==i;s++)this.cache[r].push(e[s]),e[s].isDataRow&&n++}},e}(),Kn=(Ln=function(e,t){return(Ln=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ln(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Qn=function(t){function i(e,i){var r=t.call(this,e,i)||this;return r.prevHeight=0,r.startIndex=0,r.preStartIndex=0,r.preventEvent=!1,r.actions=["filtering","searching","grouping","ungrouping"],r.offsets={},r.tmpOffsets={},r.virtualEle=new Yn,r.offsetKeys=[],r.isFocused=!1,r.isSelection=!1,r.isBottom=!1,r.rndrCount=0,r.empty=void 0,r.isCancel=!1,r.requestTypes=["beginEdit","cancel","delete","add","save"],r.isNormaledit="Normal"===r.parent.editSettings.mode,r.virtualData={},r.emptyRowData={},r.vfColIndex=[],r.frzIdx=1,r.isContextMenuOpen=!1,r.isSelectionScroll=!1,r.validationCheck=!1,r.locator=i,r.eventListener("on"),r.parent.on("column-visible-changed",r.setVisible,r),r.vgenerator=r.generator,r}return Kn(i,t),i.prototype.renderTable=function(){this.header=this.locator.getService("rendererFactory").getRenderer(e.RenderType.Header),t.prototype.renderTable.call(this),this.virtualEle.table=this.getTable(),this.virtualEle.content=this.content=this.getPanel().querySelector("."+Q),this.virtualEle.renderWrapper(this.parent.height),this.virtualEle.renderPlaceHolder(),this.virtualEle.wrapper.style.position="absolute";var i=this.parent.dataSource instanceof sf.data.DataManager&&!this.parent.dataSource.dataSource.offline,r={container:this.content,pageHeight:2*this.getBlockHeight(),debounceEvent:i,axes:this.parent.enableColumnVirtualization?["X","Y"]:["Y"]};this.observer=new _n(this.virtualEle.wrapper,r)},i.prototype.renderEmpty=function(e){this.getTable().appendChild(e),this.virtualEle.adjustTable(0,0)},i.prototype.getReorderedFrozenRows=function(e){var t=e.virtualInfo.blockIndexes,i=e.virtualInfo.columnIndexes,r=e.virtualInfo.page;e.virtualInfo.blockIndexes=[1,2],e.virtualInfo.page=1,e.renderMovableContent||(e.virtualInfo.columnIndexes=[]);var n=this.parent.getCurrentViewRecords().length,s=this.parent.renderModule.data.dataManager.dataSource.json.slice(0,n),o=this.vgenerator.generateRows(s,e);return e.virtualInfo.blockIndexes=t,e.virtualInfo.columnIndexes=i,e.virtualInfo.page=r,o.splice(0,this.parent.frozenRows)},i.prototype.scrollListener=function(e){if(this.scrollAfterEdit(),this.parent.enablePersistence&&(this.parent.scrollPosition=e.offset),this.preventEvent||this.parent.isDestroyed)this.preventEvent=!1;else{sf.base.isNullOrUndefined(document.activeElement)?this.isFocused=!1:this.isFocused=this.content===sf.base.closest(document.activeElement,"."+Q)||this.content===document.activeElement;var t=e.sentinel,i=this.currentInfo=this.getInfoFromView(e.direction,t,e.offset);if(Zi(this.parent))return i.blockIndexes&&this.prevInfo.blockIndexes.toString()===i.blockIndexes.toString()?void 0:(i.event="refresh-virtual-block",sf.base.isNullOrUndefined(i.offsets)||(i.offsets.top=this.content.scrollTop),this.parent.pageSettings.currentPage=i.page,void this.parent.notify(i.event,{requestType:"virtualscroll",virtualInfo:i,focusElement:e.focusElement}));if(this.prevInfo&&("Y"===t.axis&&this.prevInfo.blockIndexes.toString()===i.blockIndexes.toString()||"X"===t.axis&&this.prevInfo.columnIndexes.toString()===i.columnIndexes.toString()))return sf.base.Browser.isIE&&this.parent.hideSpinner(),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType,void("Y"===t.axis&&this.restoreEdit());this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization?i.columnIndexes:[]),this.parent.pageSettings.currentPage=i.loadNext&&!i.loadSelf?i.nextInfo.page:i.page,this.requestType="virtualscroll",this.parent.notify(i.event,{requestType:"virtualscroll",virtualInfo:i,focusElement:e.focusElement})}},i.prototype.block=function(e){return this.vgenerator.isBlockAvailable(e)},i.prototype.getInfoFromView=function(e,t,i){var r=!1,n=[],s={direction:e,sentinelInfo:t,offsets:i,startIndex:this.preStartIndex,endIndex:this.preEndIndex};s.page=this.getPageFromTop(i.top,s),s.blockIndexes=n=this.vgenerator.getBlockIndexes(s.page),s.loadSelf=!this.vgenerator.isBlockAvailable(n[s.block]);var o=this.ensureBlocks(s);if("upArrow"===this.activeKey&&s.blockIndexes.toString()!==o.toString()){var a=o[o.length-1];-1===s.blockIndexes.indexOf(a)&&(r=!0)}if(s.blockIndexes=o,s.loadNext=!o.filter((function(e){return-1===n.indexOf(e)})).every(this.block.bind(this)),s.event=s.loadNext||s.loadSelf?w:"refresh-virtual-block",s.nextInfo=s.loadNext?{page:Math.max(1,s.page+("down"===e?1:-1))}:{},r&&(s.blockIndexes=[s.blockIndexes[0]-1,s.blockIndexes[0],s.blockIndexes[0]+1]),"downArrow"===this.activeKey){var l=Math.ceil(this.rowIndex/this.getBlockSize());1!==l&&(s.blockIndexes[1]!==l||s.blockIndexes.length<3)&&(s.blockIndexes=[l-1,l,l+1])}return s.columnIndexes="X"===t.axis?this.vgenerator.getColumnIndexes():this.parent.getColumnIndexesInView(),this.parent.enableColumnVirtualization&&"X"===t.axis&&(s.event="refresh-virtual-block"),s},i.prototype.setKeyboardNavIndex=function(){this.blazorDataLoad=!0,"downArrow"!==this.activeKey&&"upArrow"!==this.activeKey||(this.blzRowIndex="downArrow"===this.activeKey?this.rowIndex+1:this.rowIndex-1,document.activeElement.blur())},i.prototype.ensureBlocks=function(e){var t,i=this,r=e.blockIndexes[e.block],n=r,s=Math.max,o="down"===e.direction?[s(r,1),++r,++r]:[s(r-1,1),r,r+1];return this.parent.enableColumnVirtualization&&this.parent.isFrozenGrid()&&("X"===e.sentinelInfo.axis||"Y"===e.sentinelInfo.axis&&e.page===this.prevInfo.page)&&(o=this.prevInfo.blockIndexes),o=o.filter((function(e,t){return o.indexOf(e)===t})),this.prevInfo.blockIndexes.toString()===o.toString()||((e.loadSelf||"down"===e.direction&&this.isEndBlock(n))&&(o=this.vgenerator.getBlockIndexes(e.page)),o.some((function(e,r){var n=e===(Zi(i.parent)?i.getGroupedTotalBlocks():i.getTotalBlocks());return n&&(t=r),n})),void 0!==t&&(o=o.slice(0,t+1),0===e.block&&1===o.length&&this.vgenerator.isBlockAvailable(o[0]-1)&&(o=[o[0]-1,o[0]]))),o},i.prototype.appendContent=function(e,t,i){var r=this,n=this.parent.isFrozenGrid(),s=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),o=this.parent.enableColumnVirtualization&&n;this.checkFirstBlockColIndexes(i);var a=i.virtualInfo.sentinelInfo&&"Y"===i.virtualInfo.sentinelInfo.axis&&this.currentInfo.page&&this.currentInfo.page!==i.virtualInfo.page?this.currentInfo:i.virtualInfo;this.prevInfo=this.prevInfo||i.virtualInfo;var l=a.columnIndexes[0]-1;o&&a.columnIndexes[0]===s&&(l=a.columnIndexes[0]-s-1);var h,d=this.getColumnOffset(l),p=a.blockIndexes;this.parent.groupSettings.columns.length&&this.refreshOffsets(),"100%"===this.parent.height&&(this.parent.element.style.height="100%");var c,u=this.parent.height.toString().indexOf("%")<0?this.content.getBoundingClientRect().height:this.parent.element.getBoundingClientRect().height;if(!this.requestTypes.some((function(e){return e===r.requestType}))){var f=this.getTranslateY(this.content.scrollTop,u,a);this.virtualEle.adjustTable(o?0:d,f),o&&this.virtualEle.adjustMovableTable(d,0)}if(this.parent.enableColumnVirtualization&&(this.header.virtualEle.adjustTable(o?0:d,0),o&&this.header.virtualEle.adjustMovableTable(d,0)),this.parent.enableColumnVirtualization){var g=a.columnIndexes;h=this.getColumnOffset(g[g.length-1])-this.getColumnOffset(g[0]-1)+"",o?this.header.virtualEle.setMovableWrapperWidth(h):this.header.virtualEle.setWrapperWidth(h)}if(o?this.virtualEle.setMovableWrapperWidth(h,sf.base.Browser.isIE||"edge"===sf.base.Browser.info.name):this.virtualEle.setWrapperWidth(h,sf.base.Browser.isIE||"edge"===sf.base.Browser.info.name),sf.base.isNullOrUndefined(e.parentNode)||sf.base.remove(e),n?i.renderFrozenRightContent?c=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(se):i.renderMovableContent?i.renderMovableContent&&(c=this.parent.getMovableVirtualContent().querySelector(se)):c=this.parent.getFrozenVirtualContent().querySelector(se):c=this.parent.element.querySelector("."+Q).querySelector(se),c&&(sf.base.remove(c),e=null),this.parent.isReact&&!sf.base.isNullOrUndefined(this.parent.rowTemplate)?e=t:(e=this.parent.createElement(se)).appendChild(t),this.parent.frozenRows&&"virtualscroll"===i.requestType&&1===this.parent.pageSettings.currentPage)for(var m=0;m<this.parent.frozenRows;m++)e.children[0].remove();if(n?(i.renderFrozenRightContent?(this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("."+X).appendChild(e),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType):i.renderMovableContent?i.renderMovableContent&&(this.parent.getMovableVirtualContent().querySelector("."+X).appendChild(e),this.parent.getFrozenMode()!==ee&&(this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType)):this.parent.getFrozenVirtualContent().querySelector("."+X).appendChild(e),this.vfColIndex.length&&(i.virtualInfo.columnIndexes=a.columnIndexes=sf.base.extend([],this.vfColIndex),this.vfColIndex=i.renderMovableContent?[]:this.vfColIndex)):(this.getTable().appendChild(e),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType),this.parent.groupSettings.columns.length){if(!Zi(this.parent)&&"up"===a.direction){var y=this.offsets[this.getTotalBlocks()]-this.prevHeight;this.preventEvent=!0;var v=this.content.scrollTop;this.content.scrollTop=v+y}this.setVirtualHeight(),this.observer.setPageHeight(this.getOffset(p[p.length-1])-this.getOffset(p[0]-1))}this.prevInfo=a,this.isFocused&&"downArrow"!==this.activeKey&&"upArrow"!==this.activeKey&&this.content.focus();var b=Math.ceil(this.getTotalBlocks()/2);if(this.isBottom&&(this.isBottom=!1,this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-1]),this.parent.pageSettings.currentPage===b&&1===p.length&&(this.isBottom=!0,this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-2]),"virtualscroll"===i.requestType&&"X"===i.virtualInfo.sentinelInfo.axis&&this.parent.notify(E,{}),this.focusCell(i),this.restoreEdit(i),this.restoreAdd(i),this.ensureSelectedRowPosition(),this.validationScrollLeft(i,n),!this.initialRowTop){var C=this.parent.element.getBoundingClientRect().top;this.initialRowTop=this.parent.getRowByIndex(0).getBoundingClientRect().top-C}var w=i.tableName,S="Left-Right"===this.parent.getFrozenMode()?"frozen-right"===w:"movable"===w;n&&!S||(this.vgenerator.startIndex=null,this.vgenerator.currentInfo={},this.vgenerator.includePrevPage=null)},i.prototype.validationScrollLeft=function(e,t){var i=this.parent.getFrozenColumns(),r=this.parent.getFrozenMode(),n=!t||e&&(i||"Left"===r||"Right"===r?e.renderMovableContent:e.renderFrozenRightContent);if(this.validationCheck&&n)if(this.validationCol){var s=this.vgenerator.cOffsets[this.validationCol.index-this.parent.getVisibleFrozenColumns()-1];this.validationCol=null,this.parent.isFrozenGrid()?this.movableContent.scrollLeft=s:this.content.scrollLeft=s}else this.validationCheck=!1,this.parent.editModule.editFormValidate()},i.prototype.ensureSelectedRowPosition=function(){if(!this.isSelection&&this.isSelectionScroll&&!sf.base.isNullOrUndefined(this.selectRowIndex)){this.isSelectionScroll=!1;var e=this.parent.getRowByIndex(this.selectRowIndex);e&&!this.isRowInView(e)&&this.rowSelected({rowIndex:this.selectRowIndex,row:e},!0)}},i.prototype.checkFirstBlockColIndexes=function(e){if(this.parent.enableColumnVirtualization&&this.parent.isFrozenGrid()&&0===e.virtualInfo.columnIndexes[0]){var t=[],i=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount();if(!e.renderMovableContent&&e.virtualInfo.columnIndexes.length>i){this.vfColIndex=e.virtualInfo.columnIndexes;for(var r=0;r<i;r++)t.push(r);e.virtualInfo.columnIndexes=t}else e.renderMovableContent&&(this.vfColIndex.length||(this.vfColIndex=sf.base.extend([],e.virtualInfo.columnIndexes)),e.virtualInfo.columnIndexes=sf.base.extend([],this.vfColIndex),e.virtualInfo.columnIndexes.splice(0,i))}},i.prototype.focusCell=function(e){if("upArrow"===this.activeKey||"downArrow"===this.activeKey){var t=this.parent.getRowByIndex(this.rowIndex);t.cells[this.cellIndex].focus({preventScroll:!0}),this.parent.selectRow(parseInt(t.getAttribute(ne),10)),this.activeKey=this.empty}},i.prototype.restoreEdit=function(e){if(this.isNormaledit){var t=this.parent.getFrozenColumns(),i=e&&this.parent.isFrozenGrid(),r=this.parent.getFrozenMode(),n=e&&(t||"Left"===r||"Right"===r?e.renderMovableContent:e.renderFrozenRightContent);if((!i||i&&n)&&this.parent.editSettings.allowEditing&&this.parent.editModule&&!sf.base.isNullOrUndefined(this.editedRowIndex)){var s=this.getRowByIndex(this.editedRowIndex),o=this.content,a=Object.keys(this.virtualData),l=e&&e.virtualInfo&&"X"===e.virtualInfo.sentinelInfo.axis;if(i&&l&&(s=this.parent.getMovableRowByIndex(this.editedRowIndex),o=this.movableContent),a.length&&s&&!o.querySelector("."+Z)){var h=s.getBoundingClientRect().top;(l||h<this.content.offsetHeight&&h>this.parent.getRowHeight())&&(this.parent.isEdit=!1,this.parent.editModule.startEdit(s))}if(s&&this.content.querySelector("."+Z)&&!a.length){var d=sf.base.extend({},this.getRowObjectByIndex(this.editedRowIndex));this.virtualData=this.getVirtualEditedData(d)}}this.restoreAdd(e)}},i.prototype.getVirtualEditedData=function(e){var t=[].slice.call(this.parent.element.getElementsByClassName("e-gridform"));if(!(this.parent.editModule&&this.parent.editModule.formObj&&this.parent.editModule.formObj.isDestroyed))for(var i=0;i<t.length;i++)e=this.parent.editModule.getCurrentEditedData(t[i],e);return e},i.prototype.restoreAdd=function(e){var t=this.parent.getFrozenColumns(),i=e&&this.parent.isFrozenGrid(),r=this.parent.getFrozenMode(),n=e&&e.virtualInfo&&e.virtualInfo.sentinelInfo&&"X"===e.virtualInfo.sentinelInfo.axis&&i?!(this.parent.getMovableVirtualHeader().querySelector("."+$)||this.parent.getMovableVirtualContent().querySelector("."+$)):!this.parent.element.querySelector("."+$),s=e&&(t||"Left"===r||"Right"===r?e.renderMovableContent:e.renderFrozenRightContent);if((!i||i&&s)&&this.isNormaledit&&this.isAdd&&n){var o="Top"===this.parent.editSettings.newRowPosition&&this.content.scrollTop<this.parent.getRowHeight(),a="Bottom"===this.parent.editSettings.newRowPosition&&this.parent.pageSettings.currentPage===this.maxPage;(o||a)&&(this.parent.isEdit=!1,this.parent.addRecord())}},i.prototype.onDataReady=function(e){sf.base.isNullOrUndefined(e.count)||(this.count=e.count,this.maxPage=Math.ceil(e.count/this.parent.pageSettings.pageSize)),this.vgenerator.checkAndResetCache(e.requestType),["refresh","filtering","searching","grouping","ungrouping","reorder",void 0].some((function(t){return e.requestType===t}))&&this.refreshOffsets(),this.setVirtualHeight(),this.resetScrollPosition(e.requestType)},i.prototype.setVirtualHeight=function(e){var t=this.parent.enableColumnVirtualization?this.getColumnOffset(this.parent.columns.length+this.parent.groupSettings.columns.length-1)+"px":"100%";if(this.parent.isFrozenGrid()){var i=1===this.parent.pageSettings.currentPage&&Object.keys(this.offsets).length<=2?this.offsets[1]:this.offsets[this.getTotalBlocks()-2];i=i>this.content.clientHeight?i:0,this.virtualEle.setVirtualHeight(i,t)}else{var r=this.offsets[Zi(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks()];this.virtualEle.setVirtualHeight(r,t)}this.parent.enableColumnVirtualization&&(this.header.virtualEle.setVirtualHeight(1,t),this.parent.isFrozenGrid()&&(this.virtualEle.setMovableVirtualHeight(1,t),this.header.virtualEle.setMovableVirtualHeight(1,t)))},i.prototype.getPageFromTop=function(e,t){var i=this,r=Zi(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks(),n=0;return this.offsetKeys.some((function(s){var o=Number(s),a=e<=i.offsets[s]||o===r&&e>i.offsets[s];return a&&(i.offsetKeys.length%2!=0&&o.toString()===i.offsetKeys[i.offsetKeys.length-2]&&e<=i.offsets[i.offsetKeys.length-1]&&(o+=1),t.block=o%2==0?1:0,n=Math.max(1,Math.min(i.vgenerator.getPage(o),i.maxPage))),a})),n},i.prototype.getTranslateY=function(e,t,i,r){void 0===i&&((i={page:this.getPageFromTop(e,{})}).blockIndexes=this.vgenerator.getBlockIndexes(i.page));var n=(i.blockIndexes[0]||1)-1,s=this.getOffset(n),o=this.getOffset(i.blockIndexes[i.blockIndexes.length-1]);r&&(i=this.prevInfo);var a=s>e?this.getOffset(n-1):o<e+t?this.getOffset(n+1):s,l=this.offsets[i.blockIndexes[i.blockIndexes.length-1]]-this.tmpOffsets[i.blockIndexes[0]],h=Zi(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks();return a+l>this.offsets[h]&&(a-=a+l-this.offsets[h]),a},i.prototype.getOffset=function(e){return Math.min(0|this.offsets[e],0|this.offsets[this.maxBlock])},i.prototype.onEntered=function(){var e=this;return function(t,i,r,n,s,o){sf.base.Browser.isIE&&!s&&o&&!e.preventEvent&&e.parent.showSpinner();var a=e.parent.enableColumnVirtualization&&e.parent.isFrozenGrid(),l="X"===i.axis,h=e.prevInfo.offsets?e.prevInfo.offsets.top:null,d=e.content.getBoundingClientRect().height,p=e.getColumnOffset(l?e.vgenerator.getColumnIndexes()[0]-1:e.prevInfo.columnIndexes[0]-1);if(l&&!a){var c=Object.keys(e.vgenerator.cOffsets).length-e.prevInfo.columnIndexes.length,u=e.vgenerator.cOffsets[c-1];p=p>u?u:p}var f=e.getTranslateY(n.top,d,l&&h===n.top?e.prevInfo:void 0,!0);e.virtualEle.adjustTable(a?0:p,Math.min(f,e.offsets[e.maxBlock])),a&&e.virtualEle.adjustMovableTable(p,0),e.parent.enableColumnVirtualization&&(e.header.virtualEle.adjustTable(a?0:p,0),a&&e.header.virtualEle.adjustMovableTable(p,0))}},i.prototype.dataBound=function(){this.parent.notify("refresh-virtual-frozen-height",{}),this.isSelection&&"upArrow"!==this.activeKey&&"downArrow"!==this.activeKey?this.parent.selectRow(this.selectedRowIndex):this.activeKey=this.empty},i.prototype.rowSelected=function(e,t){if((this.isSelection||t)&&!this.isLastBlockRow(e.rowIndex)){var i=lr(this.content.firstElementChild),r=this.parent.element.getBoundingClientRect().top,n=e.row.getBoundingClientRect().top-r,s=this.content.getBoundingClientRect().height,o=s<n,a=o?n-s:this.initialRowTop-n,l=o?i.height-a:i.height+a;this.virtualEle.adjustTable(i.width,l),this.content.querySelector("tbody").lastElementChild.getBoundingClientRect().top-r<s&&(l+=s-(e.row.getBoundingClientRect().top-r),this.virtualEle.adjustTable(i.width,l-this.parent.getRowHeight()/2))}this.isSelection=!1},i.prototype.isLastBlockRow=function(e){var t=this.parent.getContent().firstElementChild,i=Math.floor(t.offsetHeight/this.parent.getRowHeight())-1;return e>=this.maxPage*this.parent.pageSettings.pageSize-i},i.prototype.refreshMaxPage=function(){this.parent.groupSettings.columns.length&&this.parent.vcRows.length&&(this.maxPage=Math.ceil(this.parent.vcRows.length/this.parent.pageSettings.pageSize))},i.prototype.setVirtualPageQuery=function(e){var t=this.parent.getContent().querySelector(".e-row");if(t&&this.parent.isManualRefresh&&this.currentInfo.blockIndexes&&3===this.currentInfo.blockIndexes.length){this.vgenerator.startIndex=parseInt(t.getAttribute("aria-rowindex"),10),this.vgenerator.currentInfo=sf.base.extend({},this.currentInfo),this.vgenerator.currentInfo.blockIndexes=this.currentInfo.blockIndexes.slice(),(this.vgenerator.includePrevPage=this.currentInfo.blockIndexes[0]%2==0)?(this.vgenerator.startIndex=this.vgenerator.startIndex-this.getBlockSize(),this.vgenerator.currentInfo.blockIndexes.unshift(this.currentInfo.blockIndexes[0]-1)):this.vgenerator.currentInfo.blockIndexes.push(this.currentInfo.blockIndexes[this.currentInfo.blockIndexes.length-1]+1);var i=(this.vgenerator.currentInfo.blockIndexes[0]-1)*this.getBlockSize(),r=this.vgenerator.currentInfo.blockIndexes.length*this.getBlockSize();e.query.skip(i),e.query.take(r),e.skipPage=!0}},i.prototype.eventListener=function(e){var t=this;this.parent[e](m,this.onDataReady,this),this.parent.addEventListener(u,this.dataBound.bind(this)),this.parent.addEventListener(p,this.actionBegin.bind(this)),this.parent.addEventListener(c,this.actionComplete.bind(this)),this.parent.addEventListener("rowSelected",this.rowSelected.bind(this)),this.parent[e]("refresh-virtual-block",this.refreshContentRows,this),this.parent[e]("select-virtual-Row",this.selectVirtualRow,this),this.parent[e]("virtaul-cell-focus",this.virtualCellFocus,this),this.parent[e]("virtual-scroll-edit-action-begin",this.editActionBegin,this),this.parent[e]("virtual-scroll-add-action-begin",this.addActionBegin,this),this.parent[e]("virtual-scroll-edit",this.restoreEdit,this),this.parent[e]("virtual-scroll-edit-success",this.editSuccess,this),this.parent[e]("refresh-virtual-cache",this.refreshCache,this),this.parent[e]("edit-reset",this.resetIsedit,this),this.parent[e](M,this.getVirtualData,this),this.parent[e]("virtual-scroll-edit-cancel",this.editCancel,this),this.parent[e]("refresh-virtual-max-page",this.refreshMaxPage,this),this.parent[e]("set-virtual-page-query",this.setVirtualPageQuery,this),this.parent[e]("select-row-on-context-open",this.selectRowOnContextOpen,this),this.parent[e]("reset-virtual-focus",this.resetVirtualFocus,this),this.parent[e]("refresh-virtual-editform-cells",this.refreshCells,this),this.parent[e]("scroll-to-edit",this.scrollToEdit,this);for(var i=this.actions,r=0;r<i.length;r++)this.parent[e](i[r]+"-begin",this.onActionBegin,this);this.parent.on(y,(function e(){t.observer.observe((function(e){return t.scrollListener(e)}),t.onEntered());var i=t.parent;if(i.enablePersistence&&i.scrollPosition){t.content.scrollTop=i.scrollPosition.top;var r={direction:"down",sentinel:t.observer.sentinelInfo.down,offset:i.scrollPosition,focusElement:i.element};t.scrollListener(r),i.enableColumnVirtualization&&(t.content.scrollLeft=i.scrollPosition.left)}t.parent.off(y,e)}),this)},i.prototype.scrollToEdit=function(e){var t=this.parent.isFrozenGrid(),i=!0;if(this.validationCheck=!0,this.isAdd&&this.content.scrollTop>0){i=!1;var r=Object.keys(this.offsets);this.content.scrollTop="Top"===this.parent.editSettings.newRowPosition?0:this.offsets[r.length-1]}var n=this.parent.getRowByIndex(this.editedRowIndex);if(!(n||sf.base.isNullOrUndefined(this.editedRowIndex)||n&&this.isRowInView(n))){var s=this.parent.getRowHeight(),o=this.editedRowIndex*s;sf.base.isNullOrUndefined(o)||(i=!1,this.content.scrollTop=o)}if(e&&i){var a=this.vgenerator.cOffsets[e.index-this.parent.getVisibleFrozenColumns()-1];if(!this.parent.enableColumnVirtualization){var l=this.parent.getHeaderContent().querySelector('.e-headercelldiv[e-mappinguid="'+e.uid+'"]');a=t?l.parentElement.offsetLeft-this.parent.getFrozenVirtualHeader().offsetWidth:l.parentElement.offsetLeft}t?this.parent.getMovableVirtualContent().scrollLeft=this.parent.enableRtl?-Math.abs(a):a:this.content.scrollLeft=this.parent.enableRtl?-Math.abs(a):a}e&&!i&&(this.validationCol=e)},i.prototype.refreshCells=function(e){e.cells=this.vgenerator.generateCells()},i.prototype.resetVirtualFocus=function(e){this.isCancel=e.isCancel},i.prototype.getVirtualData=function(e){if(this.isNormaledit){var t=this.parent.element.querySelector('.e-griderror:not([style*="display: none"])'),i=Object.keys(this.virtualData);if(e.isScroll=0!==i.length&&this.currentInfo.sentinelInfo&&"X"===this.currentInfo.sentinelInfo.axis,t)return;this.virtualData=i.length?this.virtualData:e.virtualData,this.getVirtualEditedData(this.virtualData),e.virtualData=this.virtualData,e.isAdd=this.isAdd,e.isCancel=this.isCancel}},i.prototype.selectRowOnContextOpen=function(e){this.isContextMenuOpen=e.isOpen},i.prototype.editCancel=function(e){var t=fr(this.parent,e.data);sf.base.isNullOrUndefined(t)||(e.data=this.parent.getCurrentViewRecords()[t])},i.prototype.editSuccess=function(e){this.isNormaledit&&(!this.isAdd&&e.data&&this.updateCurrentViewData(e.data),this.isAdd=!1)},i.prototype.updateCurrentViewData=function(e){var t=fr(this.parent,e);sf.base.isNullOrUndefined(t)||(this.parent.getCurrentViewRecords()[t]=e)},i.prototype.actionBegin=function(e){"virtualscroll"!==e.requestType&&(this.requestType=e.requestType),e.cancel||this.parent.notify("refresh-virtual-frozenrows",e)},i.prototype.virtualCellFocus=function(e){var t=document.activeElement;if(t.classList.contains(q)&&e&&("upArrow"===e.action||"downArrow"===e.action)){var i=parseInt(t.parentElement.getAttribute(ne),10);if(e&&("downArrow"===e.action||"upArrow"===e.action)){var r=this.parent.getContent().firstElementChild;"downArrow"===e.action?i+=1:i-=1,this.rowIndex=i,this.cellIndex=parseInt(t.getAttribute(re),10);var n=this.parent.getRowByIndex(i),s=this.parent.pageSettings.currentPage,o=Math.floor(r.offsetHeight/this.parent.getRowHeight())-1,a=!1;sf.base.isNullOrUndefined(n)&&(a=!0,("downArrow"===e.action&&s===this.maxPage-1||"upArrow"===e.action&&1===s)&&(a=!1)),a||pr(n,this.parent)&&"downArrow"===e.action||cr(n,2*this.parent.getRowHeight())&&"upArrow"===e.action?(this.activeKey=e.action,r.scrollTop="downArrow"===e.action?(i-o)*this.parent.getRowHeight():i*this.parent.getRowHeight()):this.activeKey=this.empty,this.parent.selectRow(i)}}},i.prototype.editActionBegin=function(e){this.editedRowIndex=e.index;var t=sf.base.extend({},this.getRowObjectByIndex(e.index)),i=Object.keys(this.virtualData);e.data=i.length?this.virtualData:t,e.isScroll=0!==i.length&&this.currentInfo.sentinelInfo&&"X"===this.currentInfo.sentinelInfo.axis},i.prototype.refreshCache=function(e){var t=Math.ceil((this.editedRowIndex+1)/this.getBlockSize()),i=this.editedRowIndex-(t-1)*this.getBlockSize();this.vgenerator.cache[t][i].data=e.data,this.vgenerator.movableCache[t]&&(this.vgenerator.movableCache[t][i].data=e.data),this.vgenerator.frozenRightCache[t]&&(this.vgenerator.frozenRightCache[t][i].data=e.data)},i.prototype.actionComplete=function(e){var t=["delete","save","cancel"];t.some((function(t){return t===e.requestType}))&&(this.refreshOffsets(),this.parent.isFrozenGrid()?(this.vgenerator.refreshColOffsets(),this.parent.contentModule.virtualRenderer.virtualEle.setVirtualHeight()):this.refreshVirtualElement()),this.isNormaledit&&(["sorting","filtering","grouping","refresh","searching","ungrouping","reorder"].some((function(t){return t===e.requestType}))||t.some((function(t){return t===e.requestType})))&&(this.isCancel=!0,this.isAdd=!1,this.editedRowIndex=this.empty,this.virtualData={},this.parent.editModule&&(this.parent.editModule.editModule.previousData=void 0)),this.parent.enableColumnVirtualization&&"filterafteropen"===e.requestType&&this.currentInfo.columnIndexes&&this.currentInfo.columnIndexes[0]>0&&this.parent.resetFilterDlgPosition(e.columnName)},i.prototype.resetIsedit=function(){this.parent.enableVirtualization&&this.isNormaledit&&(this.parent.editSettings.allowEditing&&Object.keys(this.virtualData).length||this.parent.editSettings.allowAdding&&this.isAdd)&&(this.parent.isEdit=!0)},i.prototype.scrollAfterEdit=function(){if(this.parent.editModule&&this.parent.editSettings.allowEditing&&this.isNormaledit&&this.parent.element.querySelector(".e-gridform")){var e=this.parent.element.querySelector("."+Z),t=this.parent.element.querySelector("."+$);if(e||t){var i=e?sf.base.extend({},this.getRowObjectByIndex(this.editedRowIndex)):sf.base.extend({},this.emptyRowData),r=Object.keys(this.virtualData);this.virtualData=r.length?this.getVirtualEditedData(this.virtualData):this.getVirtualEditedData(i)}}},i.prototype.createEmptyRowdata=function(){var e=this;this.parent.columnModel.filter((function(t){e.emptyRowData[t.field]=e.empty}))},i.prototype.addActionBegin=function(e){if(this.isNormaledit){Object.keys(this.emptyRowData).length||this.createEmptyRowdata(),this.isAdd=!0;var t=this.parent.pageSettings.currentPage;!this.parent.frozenRows&&this.content.scrollTop>0&&"Top"===this.parent.editSettings.newRowPosition&&(this.isAdd=!0,this.onActionBegin(),e.startEdit=!1,this.content.scrollTop=0),t<this.maxPage-1&&"Bottom"===this.parent.editSettings.newRowPosition&&(this.isAdd=!0,this.parent.setProperties({pageSettings:{currentPage:this.maxPage-1}},!0),e.startEdit=!1,this.content.scrollTop=this.offsets[this.offsetKeys.length])}},i.prototype.getRowObjectByIndex=function(e){return this.getRowCollection(e,!1,!0)},i.prototype.getBlockSize=function(){return this.parent.pageSettings.pageSize>>1},i.prototype.getBlockHeight=function(){return this.getBlockSize()*this.parent.getRowHeight()},i.prototype.isEndBlock=function(e){var t=Zi(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks();return e>=t||e===t-1},i.prototype.getGroupedTotalBlocks=function(){var e=this.parent.vcRows;return Math.floor(e.length/this.getBlockSize()<1?1:e.length/this.getBlockSize())},i.prototype.getTotalBlocks=function(){return Math.ceil(this.count/this.getBlockSize())},i.prototype.getColumnOffset=function(e){return 0|this.vgenerator.cOffsets[e]},i.prototype.getModelGenerator=function(){return new Wn(this.parent)},i.prototype.resetScrollPosition=function(e){this.actions.some((function(t){return t===e}))&&(this.preventEvent=0!==this.content.scrollTop,this.content.scrollTop=0),"virtualscroll"!==e&&(this.isAdd=!1)},i.prototype.onActionBegin=function(e){this.parent.setProperties({pageSettings:{currentPage:1}},!0)},i.prototype.getRows=function(){return this.vgenerator.getRows()},i.prototype.getRowByIndex=function(e){var t;return Zi(this.parent)&&(t=this.parent.getDataRows()[e]),this.prevInfo&&(t=this.getRowCollection(e,!1)),t},i.prototype.getMovableVirtualRowByIndex=function(e){return this.getRowCollection(e,!0)},i.prototype.getFrozenRightVirtualRowByIndex=function(e){return this.getRowCollection(e,!1,!1,!0)},i.prototype.getRowCollection=function(e,t,i,r){var n=(this.prevInfo.blockIndexes[0]-1)*this.getBlockSize(),s=t?this.parent.getMovableDataRows():this.parent.getDataRows();s=r?this.parent.getFrozenRightDataRows():s;var o=i?this.parent.getCurrentViewRecords():s;i&&this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&(n=parseInt(this.parent.getRows()[0].getAttribute(ne),10),o=o.filter((function(e){return sf.base.isNullOrUndefined(e.items)})));var a=o[e-n];return this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(a=i?e<=this.parent.frozenRows?this.parent.getRowsObject()[e].data:a:e<=this.parent.frozenRows?s[e]:s[e-n+this.parent.frozenRows]),a},i.prototype.getVirtualRowIndex=function(e){return(this.prevInfo.blockIndexes[0]-1)*this.getBlockSize()+e},i.prototype.refreshOffsets=function(){var e=this.parent,t=0,i=this.getBlockSize(),r=Zi(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks();this.prevHeight=this.offsets[r],this.maxBlock=r%2==0?r-2:r-1,this.offsets={};for(var n=Array.apply(null,Array(r)).map((function(){return++t})),s=0;s<n.length;s++){var o=(this.vgenerator.cache[n[s]]||[]).length,a=Zi(this.parent)?e.vcRows.length%i:this.count%i,l=!Zi(this.parent)&&n[s]in this.vgenerator.cache?o*this.parent.getRowHeight():a&&n[s]===r?a*this.parent.getRowHeight():this.getBlockHeight();this.offsets[n[s]]=(0|this.offsets[n[s]-1])+l,this.tmpOffsets[n[s]]=0|this.offsets[n[s]-1]}this.offsetKeys=Object.keys(this.offsets),Zi(this.parent)&&(this.parent.vGroupOffsets=this.offsets),this.parent.enableColumnVirtualization&&this.vgenerator.refreshColOffsets()},i.prototype.refreshVirtualElement=function(){this.vgenerator.refreshColOffsets(),this.setVirtualHeight()},i.prototype.setVisible=function(e){var t,i,r=this.parent,n=this.parent.getFrozenColumns();n&&(t=[].slice.call(this.parent.getFrozenVirtualContent().querySelectorAll("col")),i=[].slice.call(this.parent.getMovableVirtualContent().querySelectorAll("col")));var s,o=[];(o=this.getRows()).some((function(e){return e.isDataRow&&(s=e),e.isDataRow}));var a=!0;!r.groupSettings.columns.length&&s&&(a=!1);for(var l=r.getDataRows(),h=0,d=e.length;h<d;h++){var p=e[h],c=r.getNormalizedColumnIndex(p.uid),u=!0===p.visible?"":"none",f=void 0;if(t&&i?c>=n?(f=i,l=this.parent.getMovableRows(),c-=n):f=t:f=this.getColGroup().children,-1!==c&&s&&c<s.cells.length&&sf.base.setStyleAttribute(f[c],{display:u}),!a){var g=void 0;p.width&&(g=p.visible?this.virtualEle.wrapper.offsetWidth+parseInt(p.width.toString(),10):this.virtualEle.wrapper.offsetWidth-parseInt(p.width.toString(),10)),g>r.width?(this.setDisplayNone(l,c,u,o),this.parent.enableColumnVirtualization&&this.virtualEle.setWrapperWidth(g+""),this.refreshVirtualElement()):a=!0}!this.parent.invokedFromMedia&&p.hideAtMedia&&this.parent.updateMediaColumns(p),this.parent.invokedFromMedia=!1}a||n?this.refreshContentRows({requestType:"refresh"}):this.parent.notify("partial-refresh",{rows:o,args:{isFrozen:!1,rows:o}})},i.prototype.selectVirtualRow=function(e){var t=this;if(e.isAvailable=e.selectedIndex<this.count,e.isAvailable&&!this.isContextMenuOpen&&"upArrow"!==this.activeKey&&"downArrow"!==this.activeKey&&!this.isSelection&&!this.requestTypes.some((function(e){return e===t.requestType}))&&!this.parent.selectionModule.isInteracted){var i=this.parent.getRowByIndex(e.selectedIndex),r=this.parent.getRowHeight();if(!i||!this.isRowInView(i)){this.isSelection=!0,this.selectedRowIndex=e.selectedIndex;var n=(e.selectedIndex+1)*r;if(!sf.base.isNullOrUndefined(n)){var s=this.content.scrollTop<n?"down":"up";this.selectRowIndex=e.selectedIndex,this.content.scrollTop=n,this.isSelectionScroll=this.observer.check(s)}}}this.parent.isFrozenGrid()&&this.requestType?this.parent.getTablesCount()===this.frzIdx?(this.requestType=this.empty,this.frzIdx=1):this.frzIdx++:this.requestType=this.empty},i.prototype.isRowInView=function(e){var t=e.getBoundingClientRect().top,i=e.getBoundingClientRect().bottom;return t>=this.content.getBoundingClientRect().top&&i<=this.content.getBoundingClientRect().bottom},i}(me),Xn=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.virtualEle=new Yn,r.isMovable=!1,r.gen=new Wn(r.parent),r.parent.on("column-visible-changed",r.setVisible,r),r.parent.on("refresh-virtual-block",(function(e){return"X"===e.virtualInfo.sentinelInfo.axis?r.refreshUI():null}),r),r}return Kn(t,e),t.prototype.renderTable=function(){this.gen.refreshColOffsets(),this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector("."+V))),e.prototype.renderTable.call(this),this.virtualEle.table=this.getTable(),this.virtualEle.content=this.getPanel().querySelector("."+V),this.virtualEle.content.style.position="relative",this.virtualEle.renderWrapper(),this.virtualEle.renderPlaceHolder("absolute")},t.prototype.appendContent=function(e){this.isMovable?(this.virtualEle.movableWrapper.appendChild(e),this.isMovable=!1):this.virtualEle.wrapper.appendChild(e)},t.prototype.refreshUI=function(){this.isMovable=this.parent.isFrozenGrid(),this.setFrozenTable(this.parent.getMovableVirtualContent()),this.gen.refreshColOffsets(),this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector("."+V))),e.prototype.refreshUI.call(this),this.setFrozenTable(this.parent.getFrozenVirtualContent())},t.prototype.setVisible=function(e){var t,i,r,n,s,o=this.parent,a=this.parent.getFrozenColumns();a&&(n=[].slice.call(this.parent.getFrozenVirtualHeader().querySelectorAll("col")),s=[].slice.call(this.parent.getMovableVirtualHeader().querySelectorAll("col")));for(var l=0,h=e.length;l<h;l++){var d=e[l];i=o.getNormalizedColumnIndex(d.uid),t=d.visible?"":"none";var p=void 0;if(n&&s?i>=a?(p=s,i-=a):p=n:p=this.getColGroup().children,sf.base.setStyleAttribute(p[i],{display:t}),o.enableColumnVirtualization&&!o.groupSettings.columns.length){var c=void 0;(c=d.visible?this.virtualEle.wrapper.offsetWidth+parseInt(d.width.toString(),10):this.virtualEle.wrapper.offsetWidth-parseInt(d.width.toString(),10))>o.width?(this.setDisplayNone(d,t),this.virtualEle.setWrapperWidth(c+""),this.gen.refreshColOffsets()):r=!0}else r=!0;r&&!a&&this.refreshUI()}a&&this.parent.notify("column-position-changed",{})},t.prototype.setFrozenTable=function(e){this.parent.isFrozenGrid()&&this.parent.enableColumnVirtualization&&this.parent.contentModule.isXaxis()&&this.parent.contentModule.setTable(e.querySelector("."+X))},t.prototype.setDisplayNone=function(e,t){var i=this.parent.isFrozenGrid(),r=this.getTable();i&&"movable"===e.getFreezeTableName()&&(r=this.parent.getMovableVirtualHeader().querySelector("."+X));for(var n=0,s=[].slice.apply(r.querySelectorAll("th.e-headercell"));n<s.length;n++){var o=s[n];if(o.querySelector("[e-mappinguid]")&&o.querySelector("[e-mappinguid]").getAttribute("e-mappinguid")===e.uid){sf.base.setStyleAttribute(o,{display:t}),""===t&&sf.base.removeClass([o],"e-hide");break}}},t}(ye),Yn=function(){function e(){}return e.prototype.renderWrapper=function(e){this.wrapper=sf.base.createElement("div",{className:"e-virtualtable",styles:"min-height:"+sf.base.formatUnit(e)}),this.wrapper.appendChild(this.table),this.content.appendChild(this.wrapper)},e.prototype.renderPlaceHolder=function(e){void 0===e&&(e="relative"),this.placeholder=sf.base.createElement("div",{className:"e-virtualtrack",styles:"position:"+e}),this.content.appendChild(this.placeholder)},e.prototype.renderFrozenWrapper=function(e){this.wrapper=sf.base.createElement("div",{className:"e-virtualtable",styles:"min-height:"+sf.base.formatUnit(e)+"; display: flex"}),this.content.appendChild(this.wrapper)},e.prototype.renderFrozenPlaceHolder=function(){this.placeholder=sf.base.createElement("div",{className:"e-virtualtrack"}),this.content.appendChild(this.placeholder)},e.prototype.renderMovableWrapper=function(e){this.movableWrapper=sf.base.createElement("div",{className:"e-virtualtable",styles:"min-height:"+sf.base.formatUnit(e)}),this.movableContent.appendChild(this.movableWrapper)},e.prototype.renderMovablePlaceHolder=function(){this.movablePlaceholder=sf.base.createElement("div",{className:"e-virtualtrack"}),this.movableContent.appendChild(this.movablePlaceholder)},e.prototype.adjustTable=function(e,t){this.wrapper.style.transform="translate("+e+"px, "+t+"px)"},e.prototype.adjustMovableTable=function(e,t){this.movableWrapper.style.transform="translate("+e+"px, "+t+"px)"},e.prototype.setMovableWrapperWidth=function(e,t){this.movableWrapper.style.width=e?e+"px":t?"100%":""},e.prototype.setMovableVirtualHeight=function(e,t){this.movablePlaceholder.style.height=e+"px",this.movablePlaceholder.style.width=t},e.prototype.setWrapperWidth=function(e,t){this.wrapper.style.width=e?e+"px":t?"100%":""},e.prototype.setVirtualHeight=function(e,t){this.placeholder.style.height=e+"px",this.placeholder.style.width=t},e.prototype.setFreezeWrapperWidth=function(e,t,i){e.style.width=t?t+"px":i?"100%":""},e}(),Jn=function(){function t(e,t){this.parent=e,this.locator=t,this.addEventListener()}return t.prototype.getModuleName=function(){return"virtualscroll"},t.prototype.instantiateRenderer=function(){this.parent.log(["limitation","virtual_height"],"virtualization");var t=this.locator.getService("rendererFactory");this.parent.isFrozenGrid()||(this.parent.enableColumnVirtualization&&t.addRenderer(e.RenderType.Header,new Xn(this.parent,this.locator)),t.addRenderer(e.RenderType.Content,new Qn(this.parent,this.locator))),this.ensurePageSize()},t.prototype.ensurePageSize=function(){var e=this.parent.getRowHeight(),t=this.parent.height.toString().indexOf("%")<0?this.parent.height:this.parent.element.getBoundingClientRect().height;this.blockSize=~~(t/e);var i=2*this.blockSize,r=this.parent.pageSettings.pageSize;this.parent.setProperties({pageSettings:{pageSize:r<i?i:r}},!0)},t.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(f,this.instantiateRenderer,this),this.parent.on("column-width-changed",this.refreshVirtualElement,this),this.parent.on("create-virtual-validation-form",this.createVirtualValidationForm,this),this.parent.on("validate-virtual-form",this.virtualEditFormValidation,this),this.parent.on(F,this.destroy,this))},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(f,this.instantiateRenderer),this.parent.off("column-width-changed",this.refreshVirtualElement),this.parent.off("create-virtual-validation-form",this.createVirtualValidationForm),this.parent.off("validate-virtual-form",this.virtualEditFormValidation),this.parent.off(F,this.destroy))},t.prototype.getCurrentEditedData=function(e){var t={virtualData:sf.base.extend({},{},e,!0),isAdd:!1,isScroll:!1,endEdit:!0};return this.parent.notify(M,t),t.virtualData},t.prototype.createVirtualValidationForm=function(e){var t=this.parent;if(t.enableVirtualization&&"Normal"===t.editSettings.mode){var i=t.columns,r=new le(this.locator,null,this.parent),n=sf.base.extend({},{},t.getRowObjectFromUID(e.uid),!0);t.notify("refresh-virtual-editform-cells",n);var s=e.argsCreator(this.getCurrentEditedData(e.prevData),{},!1);s.isCustomFormValidation=!0,s.row=r.render(n,i),e.renderer.update(s);for(var o={},a=0;a<i.length;a++)i[a].visible&&i[a].validationRules&&Tr(i[a],0,o,{},{},i.length,!0);s.form.classList.add("e-virtual-validation"),t.editModule.virtualFormObj=t.editModule.createFormObj(s.form,o)}},t.prototype.virtualEditFormValidation=function(e){var t=this.parent,i=t.element.querySelector('.e-griderror:not([style*="display: none"])');if(t.editModule.virtualFormObj)if(i&&"none"!==i.style.display){var r=i.getBoundingClientRect(),n=t.element.querySelectorAll(".e-gridform"),s=n[0],o=t.getContent().getBoundingClientRect().left;if(n.length>1&&(s="Right"!==t.getFrozenMode()?n[1]:n[0],o=t.getMovableVirtualContent().getBoundingClientRect().left),r.left<o||r.right>t.element.offsetWidth){var a=s.querySelector('.e-tooltip-wrap:not([style*="display: none"])');this.scrollToEdit(a,{editIdx:e.editIdx,addIdx:e.addIdx},!0)}}else if(t.editModule.virtualFormObj&&(!i||"none"===i.style.display)){for(var l=t.editModule.virtualFormObj.element.querySelectorAll('.e-tooltip-wrap:not([style*="display: none"])'),h=0;h<l.length;h++)sf.base.remove(l[h]);if(this.setEditedDataToValidationForm(t.editModule.virtualFormObj.element,this.getCurrentEditedData(e.prevData)),e.isValid=t.editModule.virtualFormObj.validate(),!e.isValid){a=t.editModule.virtualFormObj.element.querySelector('.e-tooltip-wrap:not([style*="display: none"])');this.scrollToEdit(a,{editIdx:e.editIdx,addIdx:e.addIdx})}}},t.prototype.scrollToEdit=function(e,t,i){var r=this.parent;if(e){var n=r.columnModel,s=Ai(e.id).split("_")[0],o=r.getColumnByField(s),a=this.parent.getContent().firstElementChild.scrollTop,l=r.getRowByIndex(t.editIdx);if(i||!o||!sf.base.isNullOrUndefined(t.addIdx)&&a>0||!sf.base.isNullOrUndefined(t.editIdx)&&!l){for(var h=void 0,d=0;d<n.length&&!o;d++)if(n[d].field===s){h=n[d];break}i&&(h=o),this.parent.notify("scroll-to-edit",h)}}},t.prototype.setEditedDataToValidationForm=function(e,t){for(var i=[].slice.call(e.getElementsByClassName("e-field")),r=0,n=i.length;r<n;r++){var s=Lr(this.parent,i[r].getAttribute("e-mappinguid")),o=sf.base.getValue(s.field,t);o=sf.base.isNullOrUndefined(o)?"":o,i[r].value=o}},t.prototype.refreshVirtualElement=function(t){this.parent.enableColumnVirtualization&&"resize"===t.module&&this.locator.getService("rendererFactory").getRenderer(e.RenderType.Content).refreshVirtualElement()},t.prototype.destroy=function(){this.removeEventListener()},t}(),Zn=function(){function e(e){this.parent=e}return e.prototype.addNew=function(e,t){var i;this.isEdit=!1;var r=zr(this.parent),n=Dr(this.parent),s=this.parent.isFrozenGrid(),o=s&&this.parent.enableColumnVirtualization&&t.isScroll;if(i=this.parent.frozenRows&&"Top"===this.parent.editSettings.newRowPosition?o?this.parent.getMovableHeaderTbody():this.parent.getHeaderTable().querySelector(se):o?this.parent.getMovableContentTbody():this.parent.getContentTable().querySelector(se),t.row=this.parent.createElement("tr",{className:"e-row e-addedrow"}),i.querySelector(".e-emptyrow")){var a=i.querySelector(".e-emptyrow");if(a.parentNode.removeChild(a),s&&!o){var l=this.parent.getContent().querySelector("."+G).querySelector(se);if(l.firstElementChild.parentNode.removeChild(l.firstElementChild),this.parent.getFrozenMode()===ee){var h=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(se);h.firstElementChild.parentNode.removeChild(h.firstElementChild)}}}if("Top"===this.parent.editSettings.newRowPosition?i.insertBefore(t.row,i.firstChild):i.appendChild(t.row),t.row.appendChild(this.getEditElement(e,!1,void 0,t,!0)),this.parent.editModule.checkLastRow(t.row,t),s&&!o){var d=this.renderMovableform(t.row,t);if("Top"===this.parent.editSettings.newRowPosition?r.insertBefore(d,r.firstChild):r.appendChild(d),t.row.querySelector(".e-normaledit").setAttribute("colspan",this.parent.getVisibleFrozenColumns()+""),d.setAttribute("colspan",""+(this.parent.getVisibleColumns().length-this.parent.getVisibleFrozenColumns())),n){var p=this.renderFrozenRightForm(t.row,t);"Top"===this.parent.editSettings.newRowPosition?n.insertBefore(p,n.firstChild):n.appendChild(p);var c=this.parent.getVisibleFrozenColumns()-this.parent.getFrozenRightColumnsCount();t.row.querySelector(".e-normaledit").setAttribute("colspan",c+""),p.querySelector(".e-normaledit").setAttribute("colspan",""+this.parent.getFrozenRightColumnsCount())}"auto"===this.parent.height&&this.parent.notify("frozenHeight",{})}},e.prototype.renderFrozenRightForm=function(e,t){var i=e.cloneNode(!0),r=t.frozenRightForm=i.querySelector("form");return this.parent.editSettings.template?(r.innerHTML="",this.appendChildren(r,t.rowData,!1),i):(this.renderRightFrozen(e,i),i.querySelector(oe).innerHTML=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(oe).innerHTML,i)},e.prototype.renderMovableform=function(e,t){var i=e.cloneNode(!0),r=t.movableForm=i.querySelector("form");return this.parent.editSettings.template?(r.innerHTML="",this.appendChildren(r,t.rowData,!1),i):(this.renderMovable(e,i),i.querySelector(oe).innerHTML=this.parent.getHeaderContent().querySelector("."+_).querySelector(oe).innerHTML,i)},e.prototype.updateFreezeEdit=function(e,t){return t=t.concat([].slice.call(this.getFreezeRow(e).querySelectorAll("td.e-rowcell"))),this.parent.getFrozenMode()===ee&&(t=t.concat([].slice.call(this.getFreezeRightRow(e).querySelectorAll("td.e-rowcell")))),t},e.prototype.getFreezeRightRow=function(e){var t=parseInt(e.getAttribute(ne),10),i=this.parent.getFrozenLeftContentTbody(),r=this.parent.getFrozenHeaderTbody(),n=this.parent.getFrozenRightHeaderTbody(),s=this.parent.getFrozenRightContentTbody();return i.contains(e)||r.contains(e)?this.parent.getFrozenRightRowByIndex(t):s.contains(e)||n.contains(e)?this.parent.getRowByIndex(t):e},e.prototype.getFreezeRow=function(e){if(this.parent.isFrozenGrid()){var t=parseInt(e.getAttribute(ne),10),i=this.parent.getFrozenLeftContentTbody(),r=this.parent.getMovableContentTbody(),n=this.parent.getFrozenHeaderTbody(),s=this.parent.getMovableHeaderTbody();if(i.contains(e)||n.contains(e))return this.parent.getMovableRowByIndex(t);if(r.contains(e)||s.contains(e))return this.parent.getRowByIndex(t)}return e},e.prototype.update=function(e,t){this.isEdit=!0;var i=t.isCustomFormValidation,r=t.isScroll;r||!sf.base.closest(t.row,"."+G)&&!sf.base.closest(t.row,"."+_)||(t.row=this.getFreezeRow(t.row)),(sf.base.closest(t.row,".e-frozen-right-content")||sf.base.closest(t.row,".e-frozen-right-header"))&&(t.row=this.getFreezeRightRow(t.row));var n=this.parent.isFrozenGrid()&&this.parent.enableColumnVirtualization&&r,s=[].slice.call(t.row.querySelectorAll("td.e-rowcell"));t.row.innerHTML="",n||i||(s=this.updateFreezeEdit(t.row,s)),t.row.appendChild(this.getEditElement(e,!0,s,t,!0)),t.row.classList.add(Z),this.parent.editModule.checkLastRow(t.row,t),n||i||this.refreshFreezeEdit(t.row,t)},e.prototype.refreshFreezeEdit=function(e,t){var i,r,n=e.firstChild;this.parent.getVisibleFrozenColumns()&&this.parent.editSettings.template&&(n.querySelector(oe).innerHTML=this.parent.getHeaderContent().querySelector("."+K).querySelector(oe).innerHTML);var s=parseInt(e.getAttribute(ne),10);if(this.parent.isFrozenGrid()){s<this.parent.frozenRows?(r=this.parent.getHeaderContent(),i="."+K):(r=this.parent.getContent(),i="."+W);var o=n.cloneNode(!0),a=n.cloneNode(!0),l=t.movableForm=o.querySelector("form");this.parent.editSettings.template&&this.refreshEditForm(l,t.rowData);var h=void 0,d=void 0;r.querySelector(i).contains(e)?(h=this.parent.getMovableRowByIndex(s),this.updateFrozenCont(h,n,o),this.parent.getFrozenMode()===ee&&(t.frozenRightForm=a.querySelector("form"),this.refreshEditForm(t.frozenRightForm,t.rowData),d=this.parent.getFrozenRightRowByIndex(s),this.updateFrozenRightCont(d,n,a))):(h=this.parent.getRowByIndex(s),this.updateFrozenCont(h,o,n),this.parent.getFrozenMode()===ee&&(t.frozenRightForm=a.querySelector("form"),this.refreshEditForm(t.frozenRightForm,t.rowData),d=this.parent.getFrozenRightRowByIndex(s),this.updateFrozenRightCont(d,a,n))),h.appendChild(o),h.classList.add(Z),this.parent.getFrozenMode()===ee&&(d.appendChild(a),d.classList.add(Z),dr(t.frozenRightForm.querySelector("td:not(.e-hide)"),t.form.querySelector("td:not(.e-hide)"))),dr(t.movableForm.querySelector("td:not(.e-hide)"),t.form.querySelector("td:not(.e-hide)"))}},e.prototype.refreshEditForm=function(e,t){this.parent.editSettings.template&&(e.innerHTML="",this.appendChildren(e,t,!1))},e.prototype.updateFrozenRightCont=function(e,t,i){e.innerHTML="",this.renderRightFrozen(t,i),i.querySelector(oe).innerHTML=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(oe).innerHTML,t.setAttribute("colspan",this.parent.getVisibleFrozenColumns()-this.parent.getFrozenRightColumnsCount()+""),i.setAttribute("colspan",this.parent.getFrozenRightColumnsCount()+"")},e.prototype.updateFrozenCont=function(e,t,i){e.innerHTML="",this.renderMovable(t,i),i.querySelector(oe).innerHTML=this.parent.getHeaderContent().querySelector("."+_).querySelector(oe).innerHTML,t.setAttribute("colspan",this.parent.getVisibleFrozenColumns()+""),i.setAttribute("colspan",this.parent.getCurrentVisibleColumns(this.parent.enableColumnVirtualization).length-this.parent.getVisibleFrozenColumns()+"")},e.prototype.renderRightFrozen=function(e,t){t.querySelector("tr").innerHTML="";for(var i=this.parent.getColumns(),r=0,n=0;n<i.length;n++,r++)if(i[n].getFreezeTableName()===te){var s=r-this.parent.getMovableColumnsCount();t.querySelector("tr").appendChild(e.querySelector("tr").removeChild(e.querySelector("tr").children[s])),r--}},e.prototype.renderMovable=function(e,t){t.querySelector("tr").innerHTML="";for(var i=this.parent.getColumns(),r=0,n=0;n<i.length;n++,r++)"movable"===i[n].getFreezeTableName()&&(t.querySelector("tr").appendChild(e.querySelector("tr").removeChild(e.querySelector("tr").children[r])),r--)},e.prototype.getEditElement=function(e,t,i,r,n){var s=this.parent,o=0,a=sf.base.isNullOrUndefined(s.detailTemplate)&&sf.base.isNullOrUndefined(s.childGrid)?0:1;s.allowGrouping&&(o=s.groupSettings.columns.length);var l=this.parent.createElement("td",{className:"e-editcell e-normaledit",attrs:{colspan:(s.getCurrentVisibleColumns(this.parent.enableColumnVirtualization).length-s.getVisibleFrozenColumns()+this.parent.getIndentCount()).toString()}}),h=r.form=this.parent.createElement("form",{id:s.element.id+"EditForm",className:"e-gridform"});if(this.parent.editSettings.template)return this.appendChildren(h,r.rowData,n),l.appendChild(h),l;var d=this.parent.createElement("table",{className:"e-table e-inline-edit",attrs:{cellspacing:"0.25"}});d.appendChild(s.getContentTable().querySelector(oe).cloneNode(!0));var p=this.parent.createElement(se),c=this.parent.createElement("tr"),u=0;for(a&&c.insertBefore(this.parent.createElement("td",{className:"e-detailrowcollapse"}),c.firstChild),s.isRowDragable()&&c.appendChild(this.parent.createElement("td",{className:"e-dragindentcell"}));u<o;)c.appendChild(this.parent.createElement("td",{className:"e-indentcell"})),u++;var f=0;u=0;for(var g=s.isFrozenGrid()&&s.enableColumnVirtualization&&r.isScroll,m=r.isCustomFormValidation?this.parent.columnModel:s.getColumns();t&&f<i.length&&u<m.length||u<m.length;){var y=t?i[f].getAttribute("colspan"):null,v=m[u];if(g&&"movable"!==v.getFreezeTableName()||r.isCustomFormValidation&&(v.commands||v.commandsTemplate||!v.field))u++;else{var b=this.parent.createElement("td",{className:q,attrs:{style:"text-align:"+(v.textAlign?v.textAlign:""),colspan:y||""}});v.visible?(b.appendChild(e[v.uid]),"Vertical"===this.parent.rowRenderingMode&&(pi(b,{"data-cell":v.headerText}),0===u&&b.classList.add("e-responsive-editcell")),"booleanedit"===v.editType?b.classList.add("e-boolcell"):(v.commands||v.commandsTemplate)&&sf.base.addClass([b],"e-unboundcell")):b.classList.add("e-hide"),c.appendChild(b),u=y?u+parseInt(y,10):u+1,f++}}return p.appendChild(c),d.appendChild(p),h.appendChild(d),l.appendChild(h),l},e.prototype.removeEventListener=function(){},e.prototype.appendChildren=function(e,t,i){var r=sf.base.extend({},t,{isAdd:!this.isEdit,isFrozen:i},!0),n=this.parent.element.id+"editSettingsTemplate";this.parent.isReact&&"string"!=typeof this.parent.editSettings.template?(this.parent.getEditTemplate()(r,this.parent,"editSettingsTemplate",n,null,null,e),this.parent.renderTemplates()):Fi(e,this.parent.getEditTemplate()(r,this.parent,"editSettingsTemplate",n))},e}(),$n=function(){function e(e){this.parent=e}return e.prototype.update=function(e,t){if(this.parent.isReact&&t.columnObject&&t.columnObject.template){var i=t.cell.parentElement,r=t.cell.cloneNode(!0);i.insertBefore(r,t.cell),r.focus(),t.cell.remove(),t.cell=r}t.cell.innerHTML="",t.cell.appendChild(this.getEditElement(e,t)),t.cell.classList.remove("e-ellipsistooltip"),t.cell.classList.add("e-editedbatchcell"),sf.base.classList(t.row,[Z,"e-batchrow"],[])},e.prototype.getEditElement=function(e,t){var i=this.parent,r=this.parent.createElement("form",{id:i.element.id+"EditForm",className:"e-gridform"});return r.appendChild(e[t.columnObject.uid]),"booleanedit"===t.columnObject.editType&&t.cell.classList.add("e-boolcell"),t.columnObject.editType||t.cell.classList.add("e-inputbox"),r},e.prototype.removeEventListener=function(){},e}(),es=function(){function t(e,t){this.parent=e,this.serviceLocator=t,this.parent.isDestroyed||(this.parent.on("dialog-destroy",this.destroy,this),this.parent.on(F,this.destroy,this))}return t.prototype.setLocaleObj=function(){this.l10n=this.serviceLocator.getService("localization")},t.prototype.addNew=function(e,t){this.isEdit=!1,this.createDialog(e,t)},t.prototype.update=function(e,t){this.isEdit=!0,this.createDialog(e,t)},t.prototype.createDialogHeader=function(t){var i=this.parent;if(this.parent.enableAdaptiveUI){var r=new ot(this.parent,this.serviceLocator);return r.action=this.isEdit?e.ResponsiveDialogAction.isEdit:e.ResponsiveDialogAction.isAdd,r.renderResponsiveHeader(void 0,t)}return i.editSettings.headerTemplate?this.getDialogEditTemplateElement("HeaderTemplate",t):this.isEdit?this.l10n.getConstant("EditFormTitle")+t.primaryKeyValue[0]:this.l10n.getConstant("AddFormTitle")},t.prototype.createDialog=function(e,t){var i=this.parent;this.dialog=this.parent.createElement("div",{id:i.element.id+"_dialogEdit_wrapper",styles:"width: auto"}),i.enableAdaptiveUI&&this.dialog.classList.add("e-responsive-dialog"),this.dialog.setAttribute("aria-label","Dialog edit"),i.element.appendChild(this.dialog),this.setLocaleObj(),this.dialogObj=new sf.popups.Dialog(sf.base.extend({header:this.createDialogHeader(t),isModal:!0,visible:!0,cssClass:"e-edit-dialog",content:this.getEditElement(e,t),showCloseIcon:!0,allowDragging:!0,close:this.dialogClose.bind(this),created:this.dialogCreated.bind(this),closeOnEscape:!0,width:i.editSettings.template?"auto":"330px",target:t.target?t.target:document.body,animationSettings:{effect:"None"},footerTemplate:i.editSettings.footerTemplate?this.getDialogEditTemplateElement("FooterTemplate",t):null,buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.l10n.getConstant("SaveButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}]},i.editSettings.dialog&&i.editSettings.dialog.params||{})),t.dialog=this.dialogObj;this.dialogObj.isStringTemplate=!0,this.renderResponsiveDialog(),this.dialogObj.appendTo(this.dialog),hr(this.parent.element,this.dialogObj.element.parentElement),i.enableAdaptiveUI&&this.dialogObj.show(!0)},t.prototype.dialogCreated=function(){kr(this.parent)},t.prototype.renderResponsiveDialog=function(){var e=this;this.parent.enableAdaptiveUI&&(this.parent.adaptiveDlgTarget&&(this.dialogObj.target=this.parent.adaptiveDlgTarget),this.dialogObj.buttons=[{}],this.dialogObj.showCloseIcon=!0,this.dialogObj.visible=!1,this.dialogObj.width="100%",this.dialogObj.open=function(){e.dialogObj.element.style.maxHeight="100%"})},t.prototype.btnClick=function(e){this.l10n.getConstant("CancelButton").toLowerCase()===e.target.innerText.trim().toLowerCase()?this.dialogClose():this.parent.endEdit()},t.prototype.dialogClose=function(){this.parent.closeEdit()},t.prototype.destroy=function(e){for(var t=["template","headerTemplate","footerTemplate"],i=0;i<t.length;i++)if(this.parent.editSettings[t[i]]){var r=t[i].charAt(0).toUpperCase()+t[i].slice(1),n=this.parent.element.id+"editSettings"+r;sf.base.updateBlazorTemplate(n,r,this.parent.editSettings)}this.parent.notify("destroy-form",{}),this.parent.isEdit=!1,this.parent.notify("toolbar-refresh",{}),this.dialog&&!this.dialogObj.isDestroyed&&(this.dialogObj.destroy(),sf.base.remove(this.dialog))},t.prototype.getDialogEditTemplateElement=function(e,t){var i=this.parent.createElement("div",{className:"e-dialog"+e}),r=sf.base.extend({},t.rowData,{isAdd:!this.isEdit},!0),n=this.parent.element.id+"editSettings"+e;return Fi(i,("HeaderTemplate"===e?this.parent.getEditHeaderTemplate():this.parent.getEditFooterTemplate())(r,this.parent,"editSettings"+e,n)),sf.base.updateBlazorTemplate(n,e,this.parent.editSettings),i},t.prototype.getEditElement=function(e,t){var i=this,r=this.parent,n=this.parent.createElement("div",{className:this.isEdit?Z:"e-insertedrow"}),s=t.form=this.parent.createElement("form",{id:r.element.id+"EditForm",className:"e-gridform"});if(this.parent.editSettings.template){var o=this.parent.element.id+"editSettingsTemplate",a=sf.base.extend({},t.rowData,{isAdd:!this.isEdit},!0);this.parent.isReact&&"string"!=typeof this.parent.editSettings.template?(this.parent.getEditTemplate()(a,this.parent,"editSettingsTemplate",o,null,null,s),this.parent.renderTemplates()):Fi(s,this.parent.getEditTemplate()(a,this.parent,"editSettingsTemplate",o));return sf.base.updateBlazorTemplate(o,"Template",this.parent.editSettings,!0,(function(){for(var e=i.parent.getColumns(),t=0;t<e.length;t++)e[t].validationRules&&(i.parent.editModule.formObj.rules[e[t].field]=e[t].validationRules)})),n.appendChild(s),n}for(var l=this.parent.createElement("table",{className:X,attrs:{cellspacing:"6px"}}),h=this.parent.createElement(se),d=r.getColumns(),p=0;p<d.length;p++)if(!(this.parent.editModule.checkColumnIsGrouped(d[p])||d[p].commands||d[p].commandsTemplate||"checkbox"===d[p].type)){var c=this.parent.createElement("tr"),u=this.parent.createElement("td",{className:q,attrs:{style:"text-align:"+(this.parent.enableRtl?"right":"left")+";width:190px"}});e[d[p].uid].classList.remove("e-input"),u.appendChild(e[d[p].uid]),c.appendChild(u),h.appendChild(c)}return l.appendChild(h),s.appendChild(l),n.appendChild(s),n},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("dialog-destroy",this.destroy),this.parent.off(F,this.destroy))},t}(),ts=function(){function t(e,t){this.editType={Inline:Zn,Normal:Zn,Batch:$n,Dialog:es},this.parent=e,this.serviceLocator=t,this.renderer=new this.editType[this.parent.editSettings.mode](e,t),this.focus=t.getService("focus")}return t.prototype.addNew=function(e){this.renderer.addNew(this.getEditElements(e),e),this.convertWidget(e)},t.prototype.update=function(e){this.renderer.update(this.getEditElements(e),e),e.isCustomFormValidation||(this.parent.notify("edit-form",e),this.convertWidget(e))},t.prototype.convertWidget=function(e){var t,i,r,n,s=this.parent,o=s.isFrozenGrid(),a="Right"===s.getFrozenMode()&&"Normal"===s.editSettings.mode?1:0,l="Dialog"===s.editSettings.mode?sf.base.select("#"+s.element.id+"_dialogEdit_wrapper .e-gridform",document):s.element.getElementsByClassName("e-gridform")[a],h=o&&this.parent.enableColumnVirtualization&&e.isScroll;if(o&&"Normal"===s.editSettings.mode){var d=parseInt(e.row.getAttribute(ne),10);s.frozenRows&&("add"===e.requestType&&"Top"===s.editSettings.newRowPosition||d<s.frozenRows)?(r=s.element.querySelector("."+_).querySelector(".e-gridform"),this.parent.getFrozenMode()===ee&&(n=e.frozenRightForm)):(r=s.element.querySelector("."+G).querySelector(".e-gridform"),this.parent.getFrozenMode()===ee&&(n=e.frozenRightForm))}for(var p=0,c="Batch"!==s.editSettings.mode?s.getColumns():[s.getColumnByField(e.columnName)];p<c.length;p++){var u=c[p];if(!h||"movable"===u.getFreezeTableName())if(!this.parent.editSettings.template||sf.base.isNullOrUndefined(u.field)){if(!this.parent.editModule.checkColumnIsGrouped(u)&&!u.commands){u.valueAccessor(u.field,e.rowData,u),i="movable"===u.getFreezeTableName()&&"Normal"===s.editSettings.mode?r.querySelector("[e-mappinguid="+u.uid+"]"):n&&u.getFreezeTableName()===te&&"Normal"===s.editSettings.mode?n.querySelector("[e-mappinguid="+u.uid+"]"):l.querySelector("[e-mappinguid="+u.uid+"]");var f=u.edit.write;sf.base.isNullOrUndefined(i)||("string"==typeof f?(f=$i(f,window))({rowData:e.rowData,element:i,column:u,requestType:e.requestType,row:e.row,foreignKeyData:u.isForeignColumn()&&$i(u.field,e.foreignKeyData)}):u.edit.write({rowData:e.rowData,element:i,column:u,requestType:e.requestType,row:e.row,foreignKeyData:u.isForeignColumn()&&$i(u.field,e.foreignKeyData)}),t||i.getAttribute("disabled")||yi(i,"e-checkbox-disabled")||(this.focusElement(i,e.type),t=!0))}}else{var g=sf.base.extend({},e);g.element=l.querySelector("[name="+ki(u.field)+"]"),sf.base.isNullOrUndefined(g.element)&&o&&(g.element=r.querySelector("[name="+ki(u.field)+"]")),"string"==typeof u.edit.write?$i(u.edit.write,window)(g):u.edit.write(g)}}if(o&&!this.parent.allowTextWrap&&("add"===e.requestType||"beginEdit"===e.requestType)&&"Dialog"!==this.parent.editSettings.mode&&!sf.base.isNullOrUndefined(l)&&!sf.base.isNullOrUndefined(r)){var m=r.querySelector("tr").children[0],y=l.querySelector("tr").children[0];if(y.offsetHeight>m.offsetHeight){if(m.style.height=y.offsetHeight+"px",n)r.querySelector("tr").children[0].style.height=y.offsetHeight+"px"}else if(y.style.height=m.offsetHeight+"px",n)r.querySelector("tr").children[0].style.height=m.offsetHeight+"px"}},t.prototype.focusElement=function(e,t){var i=this.parent.element.querySelector(".e-edit-checkselect");(sf.base.isNullOrUndefined(i)||i.nextElementSibling.classList.add("e-focus"),"Batch"===this.parent.editSettings.mode)?this.focus.onClick({target:sf.base.closest(e,"td")},!0):!this.parent.enableVirtualization||"Normal"!==this.parent.editSettings.mode||this.parent.enableVirtualization&&"Bottom"===this.parent.editSettings.newRowPosition&&yi(e,$)?e.focus():e.focus({preventScroll:!0});e.classList.contains("e-defaultcell")&&e.setSelectionRange(e.value.length,e.value.length)},t.prototype.getEditElements=function(t){var i=this.parent,r={},n="Batch"!==i.editSettings.mode?i.getColumns():[i.getColumnByField(t.columnName)];if(t.isCustomFormValidation&&(n=this.parent.columnModel),this.parent.editSettings.template)return{};for(var s=i.isFrozenGrid()&&i.enableColumnVirtualization&&t.isScroll,o=0,a=n.length;o<a;o++){var l=n[o];if(!(this.parent.editModule.checkColumnIsGrouped(l)||s&&"movable"!==n[o].getFreezeTableName()||t.isCustomFormValidation&&(l.commands||l.commandsTemplate||!l.field)))if(l.commands||l.commandsTemplate){var h=this.serviceLocator.getService("cellRendererFactory"),d=new he(this.parent),p=h.getCellRenderer(e.CellType.CommandColumn),c=d.generateRows(t.rowData)[0].cells.filter((function(e){return e.rowID})),u=p.render(c[o],t.rowData,{index:t.row?t.row.getAttribute(ne):0},this.parent.enableVirtualization);(C=u.firstElementChild).setAttribute("textAlign",u.getAttribute("textAlign")),r[l.uid]=C}else{var f=l.valueAccessor(l.field,t.rowData,l),g={column:l,value:f,type:t.requestType,data:t.rowData},m=l.edit.create,y=void 0;if(l.editTemplate){y=this.parent.createElement("span",{attrs:{"e-mappinguid":l.uid}});var v=this.parent.element.id+l.uid+"editTemplate",b=rr({},t.rowData,{column:l});if(this.parent.isReact&&"string"!=typeof l.editTemplate)l.getEditTemplate()(sf.base.extend({index:t.rowIndex},b),this.parent,"editTemplate",v,null,null,y),this.parent.renderTemplates();else Fi(y,l.getEditTemplate()(sf.base.extend({index:t.rowIndex},b),this.parent,"editTemplate",v))}else{var C;if("string"==typeof(y="string"==typeof m?(m=$i(m,window))(g):l.edit.create(g)))(C=this.parent.createElement("div")).innerHTML=y,y=C.firstChild;var w="input"!==y.tagName&&y.querySelectorAll("input").length,S=ki(l.field);sf.base.attributes(w?y.querySelector("input"):y,{name:S,"e-mappinguid":l.uid,id:i.element.id+S}),sf.base.classList(y,["e-input","e-field"],[]),"Right"===l.textAlign&&y.classList.add("e-ralign"),((l.isPrimaryKey||l.isIdentity)&&"beginEdit"===t.requestType||l.isIdentity&&"add"===t.requestType)&&y.setAttribute("disabled","")}r[l.uid]=y}}return r},t.prototype.destroy=function(){this.renderer.removeEventListener()},t}(),is=function(){function e(e){this.parent=e}return e.prototype.create=function(e){return Pr(this.parent,e.column,"e-field",{type:"text"})},e.prototype.read=function(e){return e.ej2_instances[0].value},e.prototype.destroy=function(){this.obj&&!this.obj.isDestroyed&&(this.removeEventHandler&&this.removeEventHandler(),this.obj.destroy())},e}(),rs=(qn=function(e,t){return(qn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}qn(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ns=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.activeClasses=["e-selectionbackground","e-active"],t}return rs(t,e),t.prototype.create=function(e){var t="e-field e-boolcell";return"checkbox"===e.column.type&&(t="e-field e-boolcell e-edit-checkselect"),this.removeEventHandler=this.removeEventListener,Pr(this.parent,e.column,t,{type:"checkbox",value:e.value})},t.prototype.read=function(e){return e.checked},t.prototype.write=function(e){var t,i;if(sf.base.isNullOrUndefined(e.row)||(t=e.row.querySelector(".e-edit-checkselect")),$i(e.column.field,e.rowData)&&(i=JSON.parse($i(e.column.field,e.rowData).toString().toLowerCase())),!sf.base.isNullOrUndefined(t)&&"checkbox"===e.column.type){if(this.editType=this.parent.editSettings.mode,this.editRow=e.row,"add"!==e.requestType){var r=this.parent.getRowObjectFromUID(e.row.getAttribute("data-uid"));i=!!r&&r.isSelected}qi.apply(void 0,[[].slice.call(e.row.getElementsByClassName(q)),i].concat(this.activeClasses))}this.obj=new sf.buttons.CheckBox(sf.base.extend({label:"Dialog"!==this.parent.editSettings.mode?" ":e.column.headerText,checked:i,disabled:!Bi(e.column,e.requestType,e.element),enableRtl:this.parent.enableRtl},e.column.edit.params)),this.addEventListener(),this.obj.appendTo(e.element)},t.prototype.addEventListener=function(){this.cbChange=this.checkBoxChange.bind(this),this.obj.addEventListener("change",this.cbChange)},t.prototype.removeEventListener=function(){this.obj.isDestroyed||this.obj.removeEventListener("change",this.cbChange)},t.prototype.checkBoxChange=function(e){if(this.editRow&&"Dialog"!==this.editType){var t=!1;e.checked?(t=!0,this.editRow.setAttribute("aria-selected",t.toString())):this.editRow.removeAttribute("aria-selected"),qi.apply(void 0,[[].slice.call(this.editRow.getElementsByClassName(q)),t].concat(this.activeClasses))}},t}(is),ss=(Hn=function(e,t){return(Hn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Hn(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),os=function(e){function t(t){var i=e.call(this)||this;return i.parent=t,i.flag=!1,i.removeEventHandler=i.removeEventListener,i}return ss(t,e),t.prototype.write=function(e){var t="Dialog"!==this.parent.editSettings.mode;this.column=e.column;var i=new sf.data.Predicate(e.column.field,"notequal",null,!0,!1),r={};if(e.column.edit.params)for(var n=Object.keys(e.column.edit.params),s=0;s<n.length;s++)r[n[s]]="query"===n[s]?e.column.edit.params[n[s]].clone():e.column.edit.params[n[s]];this.obj=new sf.dropdowns.DropDownList(sf.base.extend({dataSource:this.parent.dataSource instanceof sf.data.DataManager?this.parent.dataSource:new sf.data.DataManager(this.parent.dataSource),query:(new sf.data.Query).where(i).select(e.column.field),enabled:Bi(e.column,e.requestType,e.element),fields:{value:e.column.field},value:$i(e.column.field,e.rowData),enableRtl:this.parent.enableRtl,placeholder:t?"":e.column.headerText,popupHeight:"200px",floatLabelType:t?"Never":"Always",sortOrder:"Ascending"},r)),this.parent.enableVirtualization&&(this.obj.dataSource=[e.rowData]),this.addEventListener(),this.obj.query.params=this.parent.query.params,this.obj.appendTo(e.element),e.element.setAttribute("name",ki(e.column.field))},t.prototype.addEventListener=function(){this.ddCreated=this.dropdownCreated.bind(this),this.ddOpen=this.dropDownOpen.bind(this),this.ddBeforeOpen=this.dropdownBeforeOpen.bind(this),this.ddComplete=this.ddActionComplete.bind(this),this.obj.addEventListener("created",this.ddCreated),this.obj.addEventListener(ae,this.ddOpen),this.obj.addEventListener("beforeOpen",this.ddBeforeOpen),this.obj.addEventListener(c,this.ddComplete)},t.prototype.removeEventListener=function(){this.obj.isDestroyed||(this.obj.removeEventListener("created",this.ddCreated),this.obj.removeEventListener(ae,this.ddOpen),this.obj.removeEventListener("beforeOpen",this.ddBeforeOpen),this.obj.removeEventListener(c,this.ddComplete))},t.prototype.dropdownCreated=function(e){this.flag=!0},t.prototype.dropdownBeforeOpen=function(){this.parent.enableVirtualization&&(this.obj.dataSource=this.parent.dataSource instanceof sf.data.DataManager?this.parent.dataSource:new sf.data.DataManager(this.parent.dataSource))},t.prototype.ddActionComplete=function(e){e.result=sf.data.DataUtil.distinct(e.result,this.obj.fields.value,!0),this.flag&&this.column.dataSource&&("result"in this.column.dataSource?this.column.dataSource.result=e.result:this.column.dataSource instanceof sf.data.DataManager&&(this.column.dataSource.dataSource.json=e.result)),this.flag=!1},t.prototype.dropDownOpen=function(e){var t=yi(this.obj.element,"e-dialog");if("Dialog"===this.parent.editSettings.mode&&!sf.base.isNullOrUndefined(t)){var i=sf.base.select("#"+t.id,document).ej2_instances[0];e.popup.element.style.zIndex=(i.zIndex+1).toString()}},t}(is),as=function(){function e(e){this.parent=e}return e.prototype.keyEventHandler=function(e){if(13===e.keyCode||9===e.keyCode){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),this.dispatchEvent(t)}},e.prototype.create=function(e){return this.instances=new sf.base.Internationalization(this.parent.locale),Pr(this.parent,e.column,"e-field",{})},e.prototype.read=function(e){return this.obj.value},e.prototype.write=function(e){var t=e.column,i="Dialog"!==this.parent.editSettings.mode;this.obj=new sf.inputs.NumericTextBox(sf.base.extend({value:parseFloat($i(e.column.field,e.rowData)),enableRtl:this.parent.enableRtl,placeholder:i?"":e.column.headerText,enabled:Bi(e.column,e.requestType,e.element),floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always",locale:this.parent.locale},t.edit.params)),e.element.setAttribute("name",ki(e.column.field)),this.obj.appendTo(e.element),this.obj.element.addEventListener("keydown",this.keyEventHandler)},e.prototype.destroy=function(){this.obj&&!this.obj.isDestroyed&&(this.obj.element.removeEventListener("keydown",this.keyEventHandler),this.obj.destroy())},e}(),ls=(Un=function(e,t){return(Un=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Un(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),hs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ls(t,e),t.prototype.create=function(e){var t={type:"text",value:sf.base.isNullOrUndefined(e.value)?"":e.value,style:"text-align:"+e.column.textAlign};return Pr(this.parent,e.column,"e-field e-input e-defaultcell",t)},t.prototype.read=function(e){return e.value},t.prototype.write=function(e){var t=e.column,i="Dialog"!==this.parent.editSettings.mode;this.obj=new sf.inputs.TextBox(sf.base.extend({element:e.element,floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always",enableRtl:this.parent.enableRtl,enabled:Bi(e.column,e.requestType,e.element),placeholder:i?"":e.column.headerText},t.edit.params)),this.obj.appendTo(e.element)},t}(is),ds=function(){function e(e,t,i){this.args={},this.currentVirtualData={},this.parent=e,this.renderer=i,this.serviceLocator=t,this.addEventListener()}return e.prototype.clickHandler=function(e){var t=e.target,i=this.parent;(yi(t,U)&&yi(yi(t,U),"e-grid").id===i.element.id||i.frozenRows&&yi(t,V))&&!yi(t,"e-unboundcelldiv")&&(this.rowIndex=yi(t,q)?parseInt(t.parentElement.getAttribute(ne),10):-1,i.isEdit&&i.editModule.endEdit())},e.prototype.dblClickHandler=function(e){yi(e.target,q)&&this.parent.editSettings.allowEditOnDblClick&&this.parent.editModule.startEdit(yi(e.target,Y))},e.prototype.editComplete=function(e){this.parent.isEdit=!1;switch(e.requestType){case"save":(this.parent.isCheckBoxSelection||"Multiple"===this.parent.selectionSettings.type)&&this.parent.isPersistSelection||"edit"!==e.action&&this.parent.selectRow(0),this.parent.trigger(c,sf.base.extend(e,{requestType:"save",type:c}));break;case"delete":this.parent.trigger(c,sf.base.extend(e,{requestType:"delete",type:c})),this.parent.isCheckBoxSelection||this.parent.selectRow(this.editRowIndex)}},e.prototype.getEditArgs=function(e,t,i){for(var r=this.parent.getPrimaryKeyFieldNames(),n=[],s=0;s<r.length;s++)n.push($i(r[s],e));return{primaryKey:r,primaryKeyValue:n,requestType:"beginEdit",rowData:e,rowIndex:this.rowIndex,type:"edit",cancel:!1,foreignKeyData:t&&t.foreignKeyData,target:void 0,isScroll:i}},e.prototype.startEdit=function(e){var t=this,i=this.parent;if(this.rowIndex=this.editRowIndex=parseInt(e.getAttribute(ne),10),i.enableVirtualization||i.enableInfiniteScrolling){var r='.e-row[aria-rowindex="'+this.rowIndex+'"]';if(!this.parent.element.querySelector(r))return}var n={data:void 0,index:this.rowIndex,isScroll:!1};if(this.parent.notify("virtual-scroll-edit-action-begin",n),Zi(i)){var s=i.getRowObjectFromUID(e.getAttribute("data-uid"));this.previousData=s.data}else this.previousData||!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling?this.parent.enableVirtualization||(this.previousData=sf.base.extend({},{},i.getCurrentViewRecords()[this.rowIndex],!0)):this.previousData=n.data;var o=sf.base.extend({},{},n.data||this.previousData,!0);this.uid=e.getAttribute("data-uid");var a=i.getRowObjectFromUID(this.uid),l=this.getEditArgs(o,a,n.isScroll);l.row=e,l.isScroll?this.inlineEditHandler(l,e):(this.parent.notify("create-virtual-validation-form",{uid:this.uid,prevData:this.previousData,argsCreator:this.getEditArgs.bind(this),renderer:this.renderer}),i.trigger("beginEdit",l,(function(r){r.type="actionBegin",i.trigger(p,r,(function(i){i.cancel||t.inlineEditHandler(i,e)}))})))},e.prototype.inlineEditHandler=function(e,t){var i=this.parent;i.isEdit=!0,e.row=e.row?e.row:t,"Dialog"!==i.editSettings.mode&&i.clearSelection(),"Dialog"===i.editSettings.mode&&i.selectionModule&&(i.selectionModule.preventFocus=!0,e.row.classList.add("e-dlgeditrow")),this.renderer.update(e),this.uid=t.getAttribute("data-uid"),i.editModule.applyFormValidation(),e.type="actionComplete",i.trigger(c,e),this.args=e,this.parent.allowTextWrap&&this.parent.notify("freezerender",{case:"textwrap"})},e.prototype.updateRow=function(e,t){var i=this,r=this.parent;this.editRowIndex=e;var n={requestType:"save",action:"edit",type:p,data:t,cancel:!1,previousData:r.getCurrentViewRecords()[e],row:r.getRowByIndex(e)};r.showSpinner(),r.notify("update-data",n),n.promise?n.promise.then((function(){return r.refresh()})).catch((function(e){return i.edFail(e)})):r.refresh()},e.prototype.editFormValidate=function(){var e=this.parent,t=e.editModule.editFormValidate(),i={prevData:this.previousData,isValid:!0,editIdx:this.editRowIndex,addIdx:this.addedRowIndex};return e.notify("validate-virtual-form",i),t&&i.isValid},e.prototype.endEdit=function(){var e=this.parent;if(this.parent.isEdit&&this.editFormValidate()){var t=sf.base.extend({},{},this.previousData,!0),i=sf.base.extend(this.args,{requestType:"save",type:p,data:t,cancel:!1,previousData:this.previousData,selectedRow:e.selectedRowIndex,foreignKeyData:{}}),r="Right"===e.getFrozenMode()?1:0,n="Dialog"===e.editSettings.mode,s=sf.base.select("#"+e.element.id+"_dialogEdit_wrapper",document),o=n?s.querySelector(".e-gridform"):e.element.getElementsByClassName("e-gridform")[r],a={virtualData:sf.base.extend({},{},this.previousData,!0),isAdd:!1,isScroll:!1,endEdit:!0};if(this.parent.notify(M,a),(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&"Normal"===this.parent.editSettings.mode&&Object.keys(a.virtualData).length?this.parent.isEdit&&(this.currentVirtualData=t=i.data=a.virtualData):t=e.editModule.getCurrentEditedData(o,t),e.isFrozenGrid()&&"Normal"===e.editSettings.mode){var l=e.getMovableVirtualHeader().querySelector(".e-gridform"),h=e.getMovableVirtualContent().querySelector(".e-gridform"),d=[l||h],c=void 0,u=void 0,f=[];e.getFrozenMode()===ee&&(c=e.getFrozenRightHeader().querySelector(".e-gridform"),u=e.getFrozenRightContent().querySelector(".e-gridform"),f=[c||u]),Sr(this.parent,(function(i,r){for(var n=0,s=r;n<s.length;n++){var o=s[n];o&&(t=e.editModule.getCurrentEditedData(o,t))}}),[[],d,f])}var g=[].slice.call(e.element.getElementsByClassName(Z)).length;if(a.isAdd||!Object.keys(this.currentVirtualData).length||g||(g=1),n?s.getElementsByClassName(Z).length:g)i.action="edit",e.trigger(p,i,(function(t){t.cancel||(e.showSpinner(),e.notify("update-data",t))}));else if(i.action="add",i.selectedRow=0,i.index=this.addedRowIndex,e.notify("virtual-scroll-edit-success",{}),e.notify(w,i),this.addedRowIndex=null,i.cancel)return}},e.prototype.destroyElements=function(){var e=this.parent;e.editModule.destroyWidgets(),e.editModule.destroyForm(),this.parent.notify("dialog-destroy",{})},e.prototype.editHandler=function(e){var t=this;e.promise?e.promise.then((function(i){return t.edSucc(i,e)})).catch((function(e){return t.edFail(e)})):this.editSuccess(e.data,e)},e.prototype.edSucc=function(e,t){this.editSuccess(e,t)},e.prototype.edFail=function(e){this.editFailure(e)},e.prototype.updateCurrentViewData=function(e){this.parent.enableVirtualization||this.parent.enableInfiniteScrolling||(this.parent.getCurrentViewRecords()[this.editRowIndex]=e)},e.prototype.requestSuccess=function(e){this.parent.editModule.formObj&&!this.parent.editModule.formObj.isDestroyed&&(this.destroyElements(),this.stopEditStatus(),"Dialog"===this.parent.editSettings.mode&&"add"!==e.action&&this.parent.selectionModule&&this.parent.element.querySelector(".e-dlgeditrow").classList.remove("e-dlgeditrow"))},e.prototype.editSuccess=function(e,t){if(!(sf.base.isNullOrUndefined(e)||e instanceof Array)){t.data=sf.base.extend({},sf.base.extend({},t.rowData,t.data),e)}this.requestSuccess(t),this.parent.trigger("beforeDataBound",t),t.type=c,this.parent.isEdit=!1,this.refreshRow(t.data),this.parent.notify("virtual-scroll-edit-success",t),this.parent.editModule.checkLastRow(t.row),this.parent.editModule.isLastRow=!1,this.updateCurrentViewData(t.data),this.blazorTemplate(),this.editRowIndex=null,this.parent.trigger(c,t),(!this.parent.isCheckBoxSelection&&"Multiple"!==this.parent.selectionSettings.type||!this.parent.isPersistSelection&&!this.parent.selectionSettings.checkboxOnly)&&"Dialog"!==this.parent.editSettings.mode&&this.parent.selectRow(this.rowIndex>-1?this.rowIndex:this.editRowIndex),this.parent.hideSpinner()},e.prototype.closeForm=function(){!this.cloneRow&&this.parent.isEdit&&this.stopEditStatus(),this.cloneRow&&(this.cloneRow.remove(),this.cloneRow=null,this.originalRow.classList.remove("e-hiddenrow")),this.parent.isFrozenGrid()&&this.cloneFrozen&&(this.cloneFrozen.remove(),this.frozen.classList.remove("e-hiddenrow"))},e.prototype.blazorTemplate=function(){var e=this.parent.getColumns();this.parent.editSettings.template&&"Normal"===this.parent.editSettings.mode&&sf.base.updateBlazorTemplate(this.parent.element.id+"editSettingsTemplate","Template",this.parent.editSettings);for(var t=0;t<e.length;t++){var i=e[t];i.template&&sf.base.updateBlazorTemplate(this.parent.element.id+i.uid,"Template",i,!1),i.editTemplate&&sf.base.updateBlazorTemplate(this.parent.element.id+i.uid+"editTemplate","EditTemplate",i)}},e.prototype.editFailure=function(e){this.parent.trigger("actionFailure",{error:e}),this.parent.hideSpinner(),this.parent.log("actionfailure",{error:e})},e.prototype.needRefresh=function(){var e=!0,t=this.parent.element.querySelector(".e-gridform");return!this.parent.enableVirtualization&&!this.parent.infiniteScrollSettings.enableCache||"Normal"!==this.parent.editSettings.mode||t||(e=!1),e},e.prototype.refreshRow=function(e){var t=this.parent.isFrozenGrid(),i=new le(this.serviceLocator,null,this.parent),r=this.parent.getRowObjectFromUID(this.uid);if(r){r.changes=e,this.parent.notify("refresh-virtual-cache",{data:e}),Ki(r,this.parent.getForeignKeyColumns(),r.changes),this.needRefresh()&&i.refresh(r,this.parent.getColumns(),!0);var n=[].slice.call(this.parent.element.querySelectorAll('[aria-rowindex="'+r.index+'"]'));if(t&&n.length)for(var s=0;s<n.length;s++){var o=n[s].getAttribute("data-uid");o!==this.uid&&((r=this.parent.getRowObjectFromUID(o)).changes=e,i.refresh(r,this.parent.getColumns(),!0),this.parent.editModule.checkLastRow(n[s]))}}},e.prototype.closeEdit=function(){var e=this;if(this.parent.isEdit){var t=this.parent,i=sf.base.extend(this.args,{requestType:"cancel",type:p,cancel:!1,data:this.previousData,selectedRow:t.selectedRowIndex});t.notify("virtual-scroll-edit-cancel",i),this.blazorTemplate(),t.trigger(p,i,(function(i){if(!i.cancel){"Dialog"===e.parent.editSettings.mode&&e.parent.notify("dialog-destroy",{}),t.isEdit=!1,e.stopEditStatus(),i.type=c,"Dialog"!==t.editSettings.mode&&e.refreshRow(i.data);var r=t.groupSettings.enableLazyLoading&&t.groupSettings.columns.length&&!t.getContentTable().querySelector("tr.e-emptyrow");t.getContentTable().querySelector("tr.e-emptyrow")||t.getContentTable().querySelector("tr.e-row")||r||t.renderModule.emptyRow(),"Dialog"!==t.editSettings.mode&&t.selectRow(e.rowIndex),t.trigger(c,i)}}))}},e.prototype.addRecord=function(e,t){var i=this,r=this.parent;if(this.addedRowIndex=t=sf.base.isNullOrUndefined(t)?0:t,e)r.notify(w,{requestType:"save",type:p,data:e,selectedRow:0,action:"add",index:t});else if(!r.isEdit){this.previousData={},this.uid="";var n=r.getColumns(),s={virtualData:{},isScroll:!1};this.parent.notify(M,s);for(var o=0;o<n.length;o++)s.isScroll&&"movable"!==n[o].getFreezeTableName()||n[o].field&&sf.data.DataUtil.setValue(n[o].field,n[o].defaultValue,this.previousData);var a={cancel:!1,foreignKeyData:{},requestType:"add",data:this.previousData,type:p,index:t,rowData:this.previousData,target:void 0,isScroll:s.isScroll};(this.parent.enableVirtualization||this.parent.infiniteScrollSettings.enableCache)&&Object.keys(s.virtualData).length&&(a.data=a.rowData=s.virtualData),a.isScroll?this.inlineAddHandler(a):(this.parent.notify("create-virtual-validation-form",{uid:this.uid,prevData:this.previousData,argsCreator:this.getEditArgs.bind(this),renderer:this.renderer}),r.trigger(p,a,(function(e){e.cancel||i.inlineAddHandler(e)})))}},e.prototype.inlineAddHandler=function(e){var t=this.parent;t.isEdit=!0,"Dialog"!==t.editSettings.mode&&t.clearSelection(),this.renderer.addNew(e),t.editModule.applyFormValidation(),e.type=c,e.row=t.element.querySelector("."+$),t.trigger(c,e),this.args=e},e.prototype.deleteRecord=function(e,t){if(this.editRowIndex=this.parent.selectedRowIndex,t){t=t instanceof Array?t:[t];var i=this.parent,r=Object.keys(t).length;e=e||this.parent.getPrimaryKeyFieldNames()[0];for(var n=function(r){var n,s,o=i.currentViewData.some((function(i){return s=i,t[r]===$i(e,i)||t[r]===i}));t[r]=o?s:t[r][e]?t[r]:((n={})[e]=t[r],n)},s=0;s<r;s++)n(s)}var o={requestType:"delete",type:p,foreignKeyData:{},data:t||this.parent.getSelectedRecords(),tr:this.parent.getSelectedRows(),cancel:!1};if(sf.base.isNullOrUndefined(this.parent.commandDelIndex)||(o.data[0]=this.parent.getRowObjectFromUID(this.parent.getRowByIndex(this.parent.commandDelIndex).getAttribute("data-uid")).data),this.parent.enableVirtualization&&o.data.length>1){var a=this.parent.getSelectedRows()[0].getAttribute("data-uid");o.data=[this.parent.getRowObjectFromUID(a).data]}this.parent.notify(w,o)},e.prototype.stopEditStatus=function(){for(var e=this.parent,t=[].slice.call(e.element.getElementsByClassName($)),i=[].slice.call(e.element.getElementsByClassName(Z)),r=0;r<t.length;r++)sf.base.remove(t[r]);for(r=0;r<i.length;r++)i[r].classList.remove(Z)},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:"crud-Action",handler:this.editHandler},{event:"double-tap",handler:this.dblClickHandler},{event:R,handler:this.clickHandler},{event:"recordAdded",handler:this.requestSuccess},{event:"dblclick",handler:this.dblClickHandler},{event:"delete-complete",handler:this.editComplete},{event:"save-complete",handler:this.editComplete},{event:"row-mode-change",handler:this.closeEdit},{event:"closeinline",handler:this.closeForm}],Nr(this.parent,this.evtHandlers,!0,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||Nr(this.parent,this.evtHandlers,!1)},e.prototype.destroy=function(){this.removeEventListener(),this.renderer.destroy()},e}(),ps=(jn=function(e,t){return(jn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}jn(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),cs=function(e){function t(t,i,r){var n=e.call(this,t,i)||this;return n.parent=t,n.serviceLocator=i,n.renderer=r,n}return ps(t,e),t.prototype.closeEdit=function(){e.prototype.closeEdit.call(this)},t.prototype.addRecord=function(t,i){e.prototype.addRecord.call(this,t,i)},t.prototype.endEdit=function(){e.prototype.endEdit.call(this)},t.prototype.updateRow=function(t,i){e.prototype.updateRow.call(this,t,i)},t.prototype.deleteRecord=function(t,i){e.prototype.deleteRecord.call(this,t,i)},t.prototype.startEdit=function(t){e.prototype.startEdit.call(this,t)},t}(ds),us=function(){function t(e,t,i){this.cellDetails={},this.originalCell={},this.cloneCell={},this.editNext=!1,this.preventSaveCell=!1,this.parent=e,this.serviceLocator=t,this.renderer=i,this.focus=t.getService("focus"),this.addEventListener()}return t.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:R,handler:this.clickHandler},{event:"dblclick",handler:this.dblClickHandler},{event:"beforecellfocused",handler:this.onBeforeCellFocused},{event:"cellfocused",handler:this.onCellFocused},{event:"double-tap",handler:this.dblClickHandler},{event:x,handler:this.keyDownHandler},{event:"editNextValCell",handler:this.editNextValCell},{event:"closebatch",handler:this.closeForm},{event:F,handler:this.destroy}],Nr(this.parent,this.evtHandlers,!0,this),this.dataBoundFunction=this.dataBound.bind(this),this.batchCancelFunction=this.batchCancel.bind(this),this.parent.addEventListener(u,this.dataBoundFunction),this.parent.addEventListener("batchCancel",this.batchCancelFunction))},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(Nr(this.parent,this.evtHandlers,!1),this.parent.removeEventListener(u,this.dataBoundFunction),this.parent.removeEventListener("batchCancel",this.batchCancelFunction))},t.prototype.batchCancel=function(){this.parent.focusModule.restoreFocus()},t.prototype.dataBound=function(){this.parent.notify("toolbar-refresh",{})},t.prototype.destroy=function(){this.removeEventListener()},t.prototype.clickHandler=function(e){yi(e.target,this.parent.element.id+"_add",!0)||(this.parent.isEdit&&sf.base.closest(this.form,"td")!==sf.base.closest(e.target,"td")&&(this.saveCell(),this.editNextValCell()),yi(e.target,q)&&!this.parent.isEdit&&this.setCellIdx(e.target))},t.prototype.dblClickHandler=function(e){var t=yi(e.target,q),i=yi(e.target,Y),r=i&&parseInt(i.getAttribute(ne),10),n=t&&parseInt(t.getAttribute(re),10);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(r)||isNaN(n)||t.parentElement.classList.contains(Z)||this.editCell(r,this.parent.getColumns()[n].field,this.isAddRow(r))},t.prototype.onBeforeCellFocused=function(e){this.parent.isEdit&&this.validateFormObj()&&(e.byClick||["tab","shiftTab","enter","shiftEnter"].indexOf(e.keyArgs.action)>-1)&&(e.cancel=!0,e.byClick?e.clickArgs.preventDefault():e.keyArgs.preventDefault())},t.prototype.onCellFocused=function(e){var t=this.parent.getFrozenLeftCount(),i=this.parent.getFrozenRightColumnsCount(),r=this.parent.getContent().querySelector("."+G),n=this.parent.getHeaderContent().querySelector("."+_),s=!(e.container.isContent&&e.container.isDataCell||this.parent.frozenRows&&e.container.isHeader);if(e.byKey&&!s){var o=e.container.indexes,a=o[0],l=o[1];if(t&&(r.contains(e.element)||this.parent.frozenRows&&n.contains(e.element))&&(l+=t),i){var h=this.parent.getHeaderContent().querySelector(".e-frozen-right-header");(this.parent.getContent().querySelector(".e-frozen-right-content").contains(e.element)||this.parent.frozenRows&&h.contains(e.element))&&(l+=t+this.parent.getMovableColumnsCount())}this.parent.frozenRows&&e.container.isContent&&(a+=this.parent.frozenRows);var d=this.parent.isEdit;if(!this.parent.element.getElementsByClassName("e-popup-open").length)switch(d=d&&!this.validateFormObj(),e.keyArgs.action){case"tab":case"shiftTab":var p=this.parent.getColumns()[e.indexes[1]];p&&!this.parent.isEdit&&this.editCell(e.indexes[0],p.field),(d||this.parent.isLastCellPrimaryKey)&&this.editCellFromIndex(a,l);break;case"enter":case"shiftEnter":e.keyArgs.preventDefault();var c={cancel:!1,keyArgs:e.keyArgs};this.parent.notify("beforeFocusCellEdit",c),!c.cancel&&d&&this.editCell(a,this.cellDetails.column.field);break;case"f2":this.editCellFromIndex(a,l),this.focus.focus()}}else this.parent.isEdit&&s&&this.saveCell()},t.prototype.isAddRow=function(e){return this.parent.getDataRows()[e].classList.contains("e-insertedrow")},t.prototype.editCellFromIndex=function(e,t){this.cellDetails.rowIndex=e,this.cellDetails.cellIndex=t,this.editCell(e,this.parent.getColumns()[t].field,this.isAddRow(e))},t.prototype.closeEdit=function(){var e=this,t=this.parent,i=this.parent.getRowsObject(),r={cancel:!1,batchChanges:this.getBatchChanges()};if(t.notify("before-batch-cancel",r),!r.cancel){t.isEdit&&this.saveCell(!0),this.isAdded=!1,t.clearSelection();for(var n,s=xr(this.parent),o=function(t){var r=!1,o=i[t].isDirty;Sr(a.parent,(function(i,n){(r=e.removeBatchElementChanges(n[t],o))&&n.splice(t,1)}),s),r&&t--,n=t},a=this,l=0;l<i.length;l++)o(l),l=n;t.getContentTable().querySelector("tr.e-row")||t.renderModule.renderEmptyRow();var h=this.parent.getRowsObject();t.notify("batchCancel",{rows:this.parent.getRowsObject().length?this.parent.getRowsObject():[new N({isDataRow:!0,cells:[new P({isDataCell:!0,visible:!0})]})]}),t.selectRow(this.cellDetails.rowIndex),this.refreshRowIdx(),t.notify("toolbar-refresh",{}),this.parent.notify("tooltip-destroy",{}),h={requestType:"batchCancel",rows:this.parent.getRowsObject()},t.trigger("batchCancel",h)}},t.prototype.removeBatchElementChanges=function(e,t){var i=this.parent,r=new le(this.serviceLocator,null,this.parent),n=!1;if(t){e.isDirty=t;var s=i.getRowElementByUID(e.uid);if(s&&(s.classList.contains("e-insertedrow")?(sf.base.remove(s),n=!0):(Ki(e,this.parent.getForeignKeyColumns(),e.data),delete e.changes,delete e.edit,e.isDirty=!1,sf.base.classList(s,[],["e-hiddenrow","e-updatedtd"]),r.refresh(e,i.getColumns(),!1)),this.parent.aggregates.length>0)){var o=[];o.type="cancel",this.parent.notify("refresh-footer-rendered",o),this.parent.groupSettings.columns.length>0&&this.parent.notify("group-aggregates",o)}}return n},t.prototype.removeHideAndSelection=function(e){if(e.classList.contains("e-hiddenrow")){e.removeAttribute("aria-selected");for(var t=[].slice.call(e.getElementsByClassName("e-selectionbackground")),i=0;i<t.length;i++)sf.base.removeClass([t[i]],["e-selectionbackground","e-active"])}sf.base.classList(e,[],["e-hiddenrow","e-updatedtd"])},t.prototype.deleteRecord=function(e,t){this.saveCell(),this.validateFormObj()&&this.saveCell(!0),this.isAdded=!1,this.bulkDelete(e,t),this.parent.aggregates.length>0&&(this.parent.notify("refresh-footer-rendered",{}),this.parent.groupSettings.columns.length>0&&this.parent.notify("group-aggregates",{}))},t.prototype.addRecord=function(e){this.bulkAddRow(e)},t.prototype.endEdit=function(){this.parent.isEdit&&this.validateFormObj()||this.batchSave()},t.prototype.closeForm=function(){for(var e=0;e<Object.keys(this.originalCell).length;e++)for(var t=0;t<Object.keys(this.cloneCell).length;t++)Object.keys(this.originalCell)[e]===Object.keys(this.cloneCell)[t]&&(this.cloneCell[Object.keys(this.cloneCell)[t]].replaceWith(this.originalCell[Object.keys(this.originalCell)[e]]),this.originalCell[Object.keys(this.originalCell)[e]].classList.contains("e-selectionbackground")&&this.originalCell[Object.keys(this.originalCell)[e]].classList.remove("e-selectionbackground","e-cellselectionbackground","e-active"));this.cloneCell={},this.originalCell={}},t.prototype.validateFormObj=function(){return this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate()},t.prototype.batchSave=function(){var e=this.parent;if(e.isCheckBoxSelection){var t=e.element.querySelector(".e-checkselectall").parentElement;t.classList.contains("e-checkbox-disabled")&&e.pageSettings.totalRecordsCount>e.currentViewData.length&&sf.base.removeClass([t],["e-checkbox-disabled"])}if(this.saveCell(),!(e.isEdit||this.editNextValCell()||e.isEdit)){var i=this.getBatchChanges();"Multiple"===this.parent.selectionSettings.type&&i.deletedRecords.length&&this.parent.selectionSettings.persistSelection&&(i.deletedRecords=this.removeSelectedData,this.removeSelectedData=[]);var r={changedRecords:this.parent.getRowsObject().filter((function(e){return e.isDirty&&-1===["add","delete"].indexOf(e.edit)})).map((function(e){return e.data}))},n={batchChanges:i,cancel:!1};e.trigger("beforeBatchSave",n,(function(t){t.cancel||(e.showSpinner(),e.notify("bulk-save",{changes:i,original:r}))}))}},t.prototype.getBatchChanges=function(){for(var e={addedRecords:[],deletedRecords:[],changedRecords:[]},t=0,i=this.parent.getRowsObject();t<i.length;t++){var r=i[t];if(r.isDirty)switch(r.edit){case"add":e.addedRecords.push(r.changes);break;case"delete":e.deletedRecords.push(r.data);break;default:e.changedRecords.push(r.changes)}}return e},t.prototype.removeRowObjectFromUID=function(e){for(var t=this.parent.getRowsObject(),i=0,r=t.length;i<r&&t[i].uid!==e;i++);Sr(this.parent,(function(e,t){t.splice(i,1)}),xr(this.parent))},t.prototype.addRowObject=function(e){var t=this.parent,i="Top"===t.editSettings.newRowPosition;Sr(this.parent,(function(r,n){var s=e.clone();s.cells=wr(t,s.cells,r),i?n.unshift(s):n.push(s)}),xr(this.parent),!0)},t.prototype.bulkDelete=function(e,t){var i=this;this.removeSelectedData=[];var r=this.parent,n=r.selectedRowIndex,s=r.getSelectedRows(),o={primaryKey:this.parent.getPrimaryKeyFieldNames(),rowIndex:n,rowData:t||r.getSelectedRecords()[0],cancel:!1};o.row=t?r.editModule.deleteRowUid?r.getRowElementByUID(r.editModule.deleteRowUid):r.getRows()[r.getCurrentViewRecords().indexOf(t)]:t?r.getRows()[n]:s[0],o.row&&r.trigger("beforeBatchDelete",o,(function(e){if(!e.cancel){if(i.removeSelectedData=r.getSelectedRecords(),r.clearSelection(),e.row=e.row?e.row:t?r.getRows()[n]:s[0],i.parent.isFrozenGrid()){t&&(n=parseInt(e.row.getAttribute(ne),10),(s=[]).push(r.getRowByIndex(n)),s.push(r.getMovableRowByIndex(n)),r.getFrozenMode()===ee&&s.push(r.getFrozenRightRowByIndex(n)));for(var o=0;o<s.length;o++){var a=s[o].getAttribute("data-uid");if(s[o].classList.contains("e-insertedrow"))i.removeRowObjectFromUID(a),sf.base.remove(s[o]);else(d=r.getRowObjectFromUID(a)).isDirty=!0,d.edit="delete",sf.base.classList(s[o],["e-hiddenrow","e-updatedtd"],[]),r.frozenRows&&n<r.frozenRows&&r.getMovableDataRows().length>=r.frozenRows&&(r.getMovableHeaderTbody().appendChild(r.getMovableRowByIndex(r.frozenRows-1)),r.getFrozenHeaderTbody().appendChild(r.getRowByIndex(r.frozenRows-1)),r.getFrozenMode()===ee&&r.getFrozenRightHeaderTbody().appendChild(r.getFrozenRightRowByIndex(r.frozenRows-1))),r.frozenRows&&n<r.frozenRows&&r.getDataRows().length>=r.frozenRows&&r.getHeaderTable().querySelector(se).appendChild(r.getRowByIndex(r.frozenRows-1));delete s[o]}}else if(i.parent.isFrozenGrid()||1!==s.length&&!t)for(o=0;o<s.length;o++){var l=s[o].getAttribute("data-uid");if(s[o].classList.contains("e-insertedrow"))i.removeRowObjectFromUID(l),sf.base.remove(s[o]);else{sf.base.classList(s[o],["e-hiddenrow","e-updatedtd"],[]);var h=r.getRowObjectFromUID(l);h.isDirty=!0,h.edit="delete",delete s[o]}}else{var d;a=e.row.getAttribute("data-uid");if(a=t&&i.parent.editModule.deleteRowUid?a=i.parent.editModule.deleteRowUid:a,e.row.classList.contains("e-insertedrow"))i.removeRowObjectFromUID(a),sf.base.remove(e.row);else(d=r.getRowObjectFromUID(a)).isDirty=!0,d.edit="delete",sf.base.classList(e.row,["e-hiddenrow","e-updatedtd"],[]);delete e.row}i.refreshRowIdx(),t&&(r.editModule.deleteRowUid=void 0,r.getSelectedRows().length&&(n=parseInt(r.getSelectedRows()[0].getAttribute(ne),10))),r.isCheckBoxSelection||r.selectRow(n),r.trigger("batchDelete",e),r.notify("batchDelete",{rows:i.parent.getRowsObject()}),r.notify("toolbar-refresh",{})}}))},t.prototype.refreshRowIdx=function(){for(var e,t=this.parent.getAllDataRows(!0),i=Rr(this.parent),r=xr(this.parent),n=function(n,o,a){t[n].classList.contains(Y)&&!t[n].classList.contains("e-hiddenrow")?(Sr(s.parent,(function(e,t,i){t[n].setAttribute(ne,o.toString()),i[n].index=o}),i,null,r),o++):Sr(s.parent,(function(e,t,i){t[n].removeAttribute(ne),i[n].index=-1}),i,null,r),e=o},s=this,o=0,a=0,l=t.length;o<l;o++)n(o,a),a=e},t.prototype.getIndexFromData=function(e){return bi(e,this.parent.getCurrentViewRecords())},t.prototype.bulkAddRow=function(t){var i=this,r=this.parent;if(r.editSettings.allowAdding&&(r.isEdit&&(this.saveCell(),this.parent.notify("editNextValCell",{})),!r.isEdit)){this.parent.element.classList.add("e-editing");var n={defaultData:t||this.getDefaultData(),primaryKey:r.getPrimaryKeyFieldNames(),cancel:!1};r.trigger("beforeBatchAdd",n,(function(n){if(!n.cancel){var s,o;i.isAdded=!0,r.clearSelection();for(var a,l,h=new le(i.serviceLocator,null,i.parent),d=new he(i.parent).generateRows([n.defaultData]),p=h.render(d[0],r.getColumns()),c=0;c<i.parent.groupSettings.columns.length;c++)p.insertBefore(i.parent.createElement("td",{className:"e-indentcell"}),p.firstChild),d[0].cells.unshift(new P({cellType:e.CellType.Indent}));var u=r.getContentTable().querySelector(se);if(p.classList.add("e-insertedrow"),u.querySelector(".e-emptyrow")){var f=u.querySelector(".e-emptyrow");f.parentNode.removeChild(f),i.removeFrozenTbody()}r.isFrozenGrid()&&(o=p.cloneNode(!0),s=i.renderMovable(p,o),p="Right"===r.getFrozenMode()?o:p,i.renderFrozenAddRow(p,s,o)),u=r.frozenRows&&"Top"===r.editSettings.newRowPosition?r.getHeaderTable().querySelector(se):r.getContentTable().querySelector(se),"Top"===i.parent.editSettings.newRowPosition?u.insertBefore(p,u.firstChild):u.appendChild(p),sf.base.addClass([].slice.call(p.getElementsByClassName(q)),["e-updatedtd"]),d[0].isDirty=!0,d[0].changes=sf.base.extend({},{},d[0].data,!0),d[0].edit="add",i.addRowObject(d[0]),i.refreshRowIdx(),i.focus.forgetPrevious(),r.notify("batchAdd",{rows:i.parent.getRowsObject(),args:{isFrozen:i.parent.isFrozenGrid()}});var g=i.getBatchChanges(),m=i.getBottomIndex();"Top"===i.parent.editSettings.newRowPosition?r.selectRow(0):r.selectRow(m),t||(l=i.findNextEditableCell(0,!0),a=r.getColumns()[l],"Top"===i.parent.editSettings.newRowPosition?i.editCell(0,a.field,!0):i.editCell(m,a.field,!0)),i.parent.aggregates.length>0&&(t||g.addedRecords.length)&&i.parent.notify("refresh-footer-rendered",{});var y={defaultData:n.defaultData,row:p,columnObject:a,columnIndex:l,primaryKey:n.primaryKey,cell:p.cells[l]};r.trigger("batchAdd",y),r.isFrozenGrid()&&dr(s.querySelector("td:not(.e-hide)"),p.querySelector("td:not(.e-hide)"))}}))}},t.prototype.renderFrozenAddRow=function(e,t,i){var r=this.parent,n=zr(this.parent),s=Dr(this.parent);"Top"===r.editSettings.newRowPosition?n.insertBefore(t,n.firstChild):n.appendChild(t),sf.base.addClass([].slice.call(t.getElementsByClassName(q)),["e-updatedtd"]),s&&i&&("Top"===r.editSettings.newRowPosition?s.insertBefore(i,s.firstChild):s.appendChild(i),sf.base.addClass([].slice.call(i.getElementsByClassName(q)),["e-updatedtd"]),dr(i.querySelector("td:not(.e-hide)"),e.querySelector("td:not(.e-hide)"))),"auto"===r.height&&r.notify("frozenHeight",{})},t.prototype.removeFrozenTbody=function(){var e=this.parent;if(e.isFrozenGrid()){var t=e.getContent().querySelector("."+G).querySelector(se);if(t.firstElementChild.parentNode.removeChild(t.firstElementChild),e.getFrozenMode()===ee){var i=e.getContent().querySelector(".e-frozen-right-content").querySelector(se);i.firstElementChild.parentNode.removeChild(i.firstElementChild)}}},t.prototype.renderMovable=function(e,t){var i=e.cloneNode(!0),r=this.parent.getMovableColumnsCount(),n=this.parent.getFrozenLeftCount(),s=this.parent.getFrozenRightColumnsCount();return Fr(e,0,n),Fr(i,n,s?i.children.length-s:i.children.length),Fr(t,n+r,t.children.length),i},t.prototype.findNextEditableCell=function(e,t,i){for(var r,n=this.parent.getColumns(),s=n.length,o=e;o<s;o++){if(r=!!i&&sf.base.isNullOrUndefined(n[o].validationRules),!t&&this.checkNPCell(n[o]))return o;if(t&&!n[o].template&&n[o].visible&&n[o].allowEditing&&(!n[o].isIdentity||!n[o].isPrimaryKey)&&!r)return o}return-1},t.prototype.checkNPCell=function(e){return!e.template&&e.visible&&!e.isPrimaryKey&&!e.isIdentity&&e.allowEditing},t.prototype.getDefaultData=function(){for(var e={},t={number:0,string:null,boolean:!1,date:null,datetime:null},i=0,r=this.parent.columnModel;i<r.length;i++){var n=r[i];n.field&&sf.base.setValue(n.field,Object.keys(n).indexOf("defaultValue")>=0?n.defaultValue:t[n.type],e)}return e},t.prototype.setCellIdx=function(e){var t=0;this.parent.allowGrouping&&(t=this.parent.groupSettings.columns.length),this.cellDetails.cellIndex=e.cellIndex-t,this.cellDetails.rowIndex=parseInt(e.getAttribute("index"),10)},t.prototype.editCell=function(e,t,i){var r=this.parent,n=r.getColumnByField(t);this.index=e,this.field=t,this.isAdd=i;var s=r.isEdit&&!(this.cellDetails.column.field===t&&this.cellDetails.rowIndex===e&&this.parent.getDataRows().length-1!==e);r.editSettings.allowEditing&&(!s&&n.allowEditing?this.editCellExtend(e,t,i):s&&(this.editNext=!0,this.saveCell()))},t.prototype.editCellExtend=function(e,t,i){var r=this,n=this.parent,s=n.getColumnByField(t),o=n.getPrimaryKeyFieldNames();if(!n.isEdit){var a,l,h=sf.base.extend({},{},this.getDataByIndex(e),!0);if("movable"===s.getFreezeTableName()||s.getFreezeTableName()===te?(a="movable"===s.getFreezeTableName()?n.getMovableDataRows()[e]:n.getFrozenRightDataRows()[e],l=this.parent.getRowObjectFromUID(a.getAttribute("data-uid")),h=l.changes?sf.base.extend({},{},l.changes,!0):h):(a=n.getDataRows()[e],h=sf.base.extend({},{},this.getDataByIndex(e),!0)),o[0]===s.field&&!a.classList.contains("e-insertedrow")||s.columns||s.isPrimaryKey&&s.isIdentity)this.parent.isLastCellPrimaryKey=!0;else{this.parent.isLastCellPrimaryKey=!1,this.parent.element.classList.add("e-editing");var d=n.getRowObjectFromUID(a.getAttribute("data-uid")),p=[].slice.apply(a.cells),c={columnName:s.field,isForeignKey:!sf.base.isNullOrUndefined(s.foreignKeyValue),primaryKey:o,rowData:h,validationRules:sf.base.extend({},s.validationRules?s.validationRules:{}),value:$i(s.field,h),type:i?"add":"edit",cancel:!1,foreignKeyData:d&&d.foreignKeyData};c.cell=p[this.getColIndex(p,this.getCellIdx(s.uid))],c.row=a,c.columnObject=s,c.cell&&n.trigger("cellEdit",c,(function(t){t.cancel||(t.cell=t.cell?t.cell:p[r.getColIndex(p,r.getCellIdx(s.uid))],t.row=t.row?t.row:a,t.columnObject=t.columnObject?t.columnObject:s,t.columnObject.index=sf.base.isNullOrUndefined(t.columnObject.index)?0:t.columnObject.index,r.cellDetails={rowData:h,column:s,value:t.value,isForeignKey:t.isForeignKey,rowIndex:e,cellIndex:parseInt(t.cell.getAttribute(re),10),foreignKeyData:t.foreignKeyData},t.cell.classList.contains("e-updatedtd")&&(r.isColored=!0,t.cell.classList.remove("e-updatedtd")),n.isEdit=!0,n.clearSelection(),n.isCheckBoxSelection&&n.isPersistSelection||n.selectRow(r.cellDetails.rowIndex,!0),r.renderer.update(t),r.parent.notify("batcheditform-rendered",t),r.form=sf.base.select("#"+n.element.id+"EditForm",n.element),n.editModule.applyFormValidation([s]),r.parent.element.querySelector(".e-gridpopup").style.display="none")}))}}},t.prototype.updateCell=function(e,t,i){var r=this.parent,n=r.getColumnByField(t),s=r.getColumnIndexByField(t);if(n&&!n.isPrimaryKey&&n.allowEditing){var o=Ir(this.parent,n,e,s),a="movable"===n.getFreezeTableName()?this.parent.getMovableRowsObject()[e]:n.getFreezeTableName()===te?r.getFrozenRightRowsObject()[e]:r.getRowObjectFromUID(o.parentElement.getAttribute("data-uid"));this.refreshTD(o,n,a,i),this.parent.trigger("queryCellInfo",{cell:this.newReactTd||o,column:n,data:a.changes})}},t.prototype.setChanges=function(e,t,i){var r;if(this.parent.isFrozenGrid()){var n=this.parent.getRowElementByUID(e.uid),s=parseInt(n.getAttribute(ne),10);(r=this.parent.getRowsObject()[s]).changes||(r.changes=sf.base.extend({},{},e.data,!0)),sf.base.isNullOrUndefined(t)||sf.base.setValue(t,i,r.changes);var o=this.parent.getMovableRowsObject()[s];if(o.changes=sf.base.extend({},{},r.changes,!0),e.data[t]!==i&&(o.isDirty=!0,r.isDirty=!0),this.parent.getFrozenMode()===ee){var a=this.parent.getFrozenRightRowsObject()[s];a.changes=sf.base.extend({},{},r.changes,!0),e.data[t]!==i&&(a.isDirty=!0)}}else if(e.changes||(e.changes=sf.base.extend({},{},e.data,!0)),sf.base.isNullOrUndefined(t)||sf.data.DataUtil.setValue(t,i,e.changes),e.data[t]!==i){var l=this.parent.getColumnByField(t).type;"date"===l||"datetime"===l?new Date(e.data[t]).toString()!==new Date(i).toString()&&(e.isDirty=!0):e.isDirty=!0}},t.prototype.updateRow=function(e,t){for(var i=0,r=Object.keys(t);i<r.length;i++){var n=r[i];this.updateCell(e,n,t[n])}},t.prototype.getCellIdx=function(e){var t=this.parent.getColumnIndexByUid(e)+this.parent.groupSettings.columns.length;return sf.base.isNullOrUndefined(this.parent.detailTemplate)&&sf.base.isNullOrUndefined(this.parent.childGrid)||t++,this.parent.isRowDragable()&&t++,t},t.prototype.refreshTD=function(e,t,i,r){var n,s=new ve(this.parent,this.serviceLocator);r="number"!==t.type||sf.base.isNullOrUndefined(r)?r:parseFloat(r),this.setChanges(i,t.field,r);var o,a,l=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount();l=l&&this.parent.isRowDragable()?l+1:l,Ki(i,this.parent.getForeignKeyColumns(),i.changes),n=l&&"movable"===t.getFreezeTableName()&&this.parent.getColumns().length===i.cells.length?i.cells.slice(l,i.cells.length):i.cells,this.parent.isReact&&(o=e.parentElement,a=e.cellIndex);var h=0;l&&(h="movable"===t.getFreezeTableName()&&"Right"!==this.parent.getFrozenMode()?l:t.getFreezeTableName()===te?this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount():h),s.refreshTD(e,n[this.getCellIdx(t.uid)-h],i.changes,{index:this.getCellIdx(t.uid)}),this.parent.isReact?(this.newReactTd=o.cells[a],o.cells[a].classList.add("e-updatedtd")):e.classList.add("e-updatedtd"),e.classList.add("e-updatedtd"),this.parent.notify("toolbar-refresh",{})},t.prototype.getColIndex=function(e,t){var i=0;this.parent.allowGrouping&&this.parent.groupSettings.columns&&(i=this.parent.groupSettings.columns.length),sf.base.isNullOrUndefined(this.parent.detailTemplate)&&sf.base.isNullOrUndefined(this.parent.childGrid)||i++,this.parent.isRowDragable()&&i++;for(var r=0;r<e.length;r++){if(parseInt(e[r].getAttribute(re),10)===t-i)return r}return-1},t.prototype.editNextValCell=function(){var e=this.parent,t=this.getBottomIndex();if(this.isAdded&&!e.isEdit){for(var i=this.cellDetails.cellIndex;i<e.getColumns().length;i++){if(e.isEdit)return;var r=this.findNextEditableCell(this.cellDetails.cellIndex+1,!0,!0),n=e.getColumns()[r];if(n){if("Bottom"===this.parent.editSettings.newRowPosition)this.editCell(t,n.field,!0);else{var s={index:0,column:n};this.parent.notify("next-cell-index",s),this.editCell(s.index,n.field,!0)}this.saveCell()}}e.isEdit||(this.isAdded=!1)}},t.prototype.escapeCellEdit=function(){var e=this.generateCellArgs();e.value=e.previousValue,this.successCallBack(e,e.cell.parentElement,e.column,!0)(e)},t.prototype.generateCellArgs=function(){var e=this.parent;this.parent.element.classList.remove("e-editing");var t=this.cellDetails.column,i={};i[t.field]=$i(t.field,this.cellDetails.rowData);var r=e.editModule.getCurrentEditedData(this.form,i),n=sf.base.extend({},r);r=sf.base.extend({},r,this.cellDetails.rowData);var s=$i(t.field,n);sf.base.isNullOrUndefined(t.field)||sf.base.isUndefined(s)||sf.base.setValue(t.field,s,r);var o={columnName:t.field,value:$i(t.field,r),rowData:this.cellDetails.rowData,column:t,previousValue:this.cellDetails.value,isForeignKey:this.cellDetails.isForeignKey,cancel:!1};return o.cell=this.form.parentElement,o.columnObject=t,o},t.prototype.saveCell=function(e){if(!this.preventSaveCell&&this.form){var t=this.parent;if(e||t.isEdit&&!this.validateFormObj()){this.preventSaveCell=!0;var i=this.generateCellArgs(),r=i.cell.parentElement,n=i.column;e?this.successCallBack(i,r,n)(i):(t.trigger("cellSave",i,this.successCallBack(i,r,n)),t.notify("batchedit-form",{formObj:this.form}))}}},t.prototype.successCallBack=function(e,t,i,r){var n=this;return function(e){var s=n.parent;if(e.cell=e.cell?e.cell:n.form.parentElement,e.columnObject=e.columnObject?e.columnObject:i,e.columnObject.index=sf.base.isNullOrUndefined(e.columnObject.index)?0:e.columnObject.index,e.cancel){if(n.preventSaveCell=!1,n.editNext){if(n.editNext=!1,n.cellDetails.rowIndex===n.index&&n.cellDetails.column.field===n.field)return;n.editCellExtend(n.index,n.field,n.isAdd)}}else{s.editModule.destroyWidgets([i]),s.isEdit=!1,s.editModule.destroyForm(),n.parent.notify("tooltip-destroy",{});var o=yi(e.cell,G)||yi(e.cell,_)?s.getRowObjectFromUID(t.getAttribute("data-uid"),!0):s.getRowObjectFromUID(t.getAttribute("data-uid"));if(s.getFrozenMode()===ee&&(yi(e.cell,"e-frozen-right-header")||yi(e.cell,"e-frozen-right-content"))&&(o=s.getRowObjectFromUID(t.getAttribute("data-uid"),!1,!0)),n.refreshTD(e.cell,i,o,e.value),n.parent.isReact&&(e.cell=n.newReactTd),sf.base.removeClass([t],[Z,"e-batchrow"]),sf.base.removeClass([e.cell],["e-editedbatchcell","e-boolcell"]),(!sf.base.isNullOrUndefined(e.value)&&e.value.toString()===(sf.base.isNullOrUndefined(n.cellDetails.value)?"":n.cellDetails.value).toString()&&!n.isColored||sf.base.isNullOrUndefined(e.value)&&sf.base.isNullOrUndefined(o.data[i.field])&&sf.base.isNullOrUndefined(n.cellDetails.value)&&!e.cell.parentElement.classList.contains("e-insertedrow"))&&e.cell.classList.remove("e-updatedtd"),sf.base.isNullOrUndefined(r)&&s.trigger("cellSaved",e),s.notify("toolbar-refresh",{}),n.isColored=!1,n.parent.aggregates.length>0&&(n.parent.notify("refresh-footer-rendered",{}),n.parent.groupSettings.columns.length>0&&!n.isAddRow(n.cellDetails.rowIndex)&&n.parent.notify("group-aggregates",{})),n.preventSaveCell=!1,n.editNext){if(n.editNext=!1,n.cellDetails.rowIndex===n.index&&n.cellDetails.column.field===n.field)return;var a=s.getColumnByField(n.field);a&&a.allowEditing&&n.editCellExtend(n.index,n.field,n.isAdd)}r&&s.notify("restore-Focus",{})}}},t.prototype.getDataByIndex=function(e){var t=this.parent.getRowObjectFromUID(this.parent.getDataRows()[e].getAttribute("data-uid"));return t.changes?t.changes:t.data},t.prototype.keyDownHandler=function(e){if(("tab"===e.action||"shiftTab"===e.action)&&this.parent.isEdit){var t=this.parent,i=this.getBottomIndex(),r=yi(e.target,q);if(r){var n=r.querySelector(".e-field");if(n){var s=this.parent.getVisibleColumns();s["tab"===e.action?s.length-1:0].field===n.getAttribute("id").slice(this.parent.element.id.length)&&(this.cellDetails.rowIndex===i&&"tab"===e.action?"Top"===t.editSettings.newRowPosition?(t.editSettings.newRowPosition="Bottom",this.addRecord(),t.editSettings.newRowPosition="Top"):this.addRecord():this.saveCell())}}}},t.prototype.addCancelWhilePaging=function(){this.validateFormObj()&&(this.parent.notify("destroy-form",{}),this.parent.isEdit=!1,this.isColored=!1)},t.prototype.getBottomIndex=function(){var e=this.getBatchChanges();return this.parent.getCurrentViewRecords().length+e.addedRecords.length-e.deletedRecords.length-1},t}(),fs=(Vn=function(e,t){return(Vn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Vn(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),gs=function(e){function t(t,i,r){var n=e.call(this,t,i)||this;return n.parent=t,n.serviceLocator=i,n.renderer=r,n}return fs(t,e),t.prototype.closeEdit=function(){e.prototype.closeEdit.call(this)},t.prototype.addRecord=function(t,i){e.prototype.addRecord.call(this,t,i)},t.prototype.endEdit=function(){e.prototype.endEdit.call(this)},t.prototype.updateRow=function(t,i){e.prototype.updateRow.call(this,t,i)},t.prototype.deleteRecord=function(t,i){e.prototype.deleteRecord.call(this,t,i)},t.prototype.startEdit=function(t){e.prototype.startEdit.call(this,t)},t}(ds),ms=(Gn=function(e,t){return(Gn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Gn(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ys=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ms(t,e),t.prototype.write=function(e){"datepickeredit"===e.column.editType?this.obj=new sf.calendars.DatePicker(sf.base.extend(vs(e,this.parent.editSettings.mode,this.parent.enableRtl),e.column.edit.params)):"datetimepickeredit"===e.column.editType&&(this.obj=new sf.calendars.DateTimePicker(sf.base.extend(vs(e,this.parent.editSettings.mode,this.parent.enableRtl),e.column.edit.params))),this.obj.appendTo(e.element)},t}(is);function vs(e,t,i){var r="Dialog"!==t,n=er(e.column.format,e.column.type),s=$i(e.column.field,e.rowData);return{floatLabelType:r?"Never":"Always",value:s=s?new Date(s):null,format:n,placeholder:r?"":e.column.headerText,enableRtl:i,enabled:Bi(e.column,e.requestType,e.element)}}var bs,Cs,ws,Ss,xs=function(){function e(e){this.parent=e}return e.prototype.read=function(e,t){return t},e.prototype.write=function(){},e.prototype.destroy=function(){},e}(),Rs=function(){function e(e,t){this.editType={Inline:cs,Normal:cs,Batch:us,Dialog:gs},this.parent=e,this.serviceLocator=t,this.l10n=this.serviceLocator.getService("localization"),this.addEventListener(),this.updateEditObj(),this.createAlertDlg(),this.createConfirmDlg()}return e.prototype.updateColTypeObj=function(){for(var t=this.parent.columnModel,i=0;i<t.length;i++)if(this.parent.editSettings.template||t[i].editTemplate){t[i].edit=sf.base.extend(new e.editCellType.templateedit(this.parent),t[i].edit||{})}else t[i].edit=sf.base.extend(new e.editCellType[t[i].editType&&e.editCellType[t[i].editType]?t[i].editType:"defaultedit"](this.parent,this.serviceLocator),t[i].edit||{});this.parent.log("primary_column_missing")},e.prototype.getModuleName=function(){return"edit"},e.prototype.onPropertyChanged=function(e){if(e.module===this.getModuleName())for(var t=this.parent,i=0,r=Object.keys(e.properties);i<r.length;i++){switch(r[i]){case"allowAdding":case"allowDeleting":case"allowEditing":(t.editSettings.allowAdding||t.editSettings.allowEditing||t.editSettings.allowDeleting)&&this.initialEnd();break;case"mode":this.updateEditObj(),t.isEdit=!1,t.refresh()}}},e.prototype.updateEditObj=function(){this.editModule&&this.editModule.destroy(),this.renderer=new ts(this.parent,this.serviceLocator),this.editModule=new this.editType[this.parent.editSettings.mode](this.parent,this.serviceLocator,this.renderer)},e.prototype.initialEnd=function(){this.updateColTypeObj()},e.prototype.startEdit=function(e){var t=this.parent;if(t.editSettings.allowEditing&&!t.isEdit&&"Batch"!==t.editSettings.mode){if(this.parent.element.classList.add("e-editing"),t.getSelectedRows().length)e||(e=t.getSelectedRows()[0]);else if(!e)return void this.showDialog("EditOperationAlert",this.alertDObj);this.isLastRow=e.rowIndex===this.parent.getContent().querySelector("tr:last-child").rowIndex,"none"!==e.style.display&&(this.editModule.startEdit(e),this.refreshToolbar(),t.element.querySelector(".e-gridpopup").style.display="none",this.parent.notify("start-edit",{}))}},e.prototype.checkLastRow=function(e,t){var i=this.isLastRow;"auto"!==this.parent.height&&"Bottom"===this.parent.editSettings.newRowPosition&&t&&"add"===t.requestType&&this.parent.getContent().firstElementChild.offsetHeight>this.parent.getContentTable().scrollHeight?sf.base.addClass([].slice.call(e.getElementsByClassName(q)),"e-lastrowadded"):i&&e&&e.classList&&sf.base.addClass([].slice.call(e.getElementsByClassName(q)),"e-lastrowcell")},e.prototype.closeEdit=function(){"Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&this.parent.element.getElementsByClassName("e-updatedtd").length?this.showDialog("CancelEdit",this.dialogObj):(this.parent.element.classList.remove("e-editing"),this.editModule.closeEdit(),this.refreshToolbar(),this.parent.notify("close-edit",{}))},e.prototype.refreshToolbar=function(){this.parent.notify("toolbar-refresh",{})},e.prototype.addRecord=function(e,t){if(this.parent.editSettings.allowAdding){var i={startEdit:!0};e||this.parent.notify("virtual-scroll-add-action-begin",i),i.startEdit&&(this.parent.element.classList.add("e-editing"),this.editModule.addRecord(e,t),this.refreshToolbar(),this.parent.notify("start-add",{}))}},e.prototype.deleteRecord=function(e,t){var i=this.parent;i.editSettings.allowDeleting&&(t||i.getSelectedRecords().length||!sf.base.isNullOrUndefined(i.commandDelIndex)?i.editSettings.showDeleteConfirmDialog?this.showDialog("ConfirmDelete",this.dialogObj):this.editModule.deleteRecord(e,t):this.showDialog("DeleteOperationAlert",this.alertDObj))},e.prototype.deleteRow=function(e){this.deleteRowUid=e.getAttribute("data-uid");var t=this.parent.getRowObjectFromUID(this.deleteRowUid);sf.base.isNullOrUndefined(t)||this.deleteRecord(null,t.data)},e.prototype.endEdit=function(){"Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&(sf.base.isNullOrUndefined(this.formObj)||this.formObj.validate())&&(this.parent.editModule.saveCell(),this.parent.notify("editNextValCell",{}),sf.base.isNullOrUndefined(this.formObj)||this.formObj.validate())?this.showDialog("BatchSaveConfirm",this.dialogObj):this.endEditing()},e.prototype.updateCell=function(e,t,i){this.editModule.updateCell(e,t,i)},e.prototype.updateRow=function(e,t){this.editModule.updateRow(e,t)},e.prototype.batchCancel=function(){this.closeEdit()},e.prototype.batchSave=function(){this.endEdit()},e.prototype.editCell=function(e,t){this.editModule.editCell(e,t)},e.prototype.editFormValidate=function(){var e=!this.formObj||this.formObj.validate(),t=!this.mFormObj||this.mFormObj.validate(),i=!this.frFormObj||this.frFormObj.validate();return e&&t&&i},e.prototype.getBatchChanges=function(){return this.editModule.getBatchChanges?this.editModule.getBatchChanges():{}},e.prototype.getCurrentEditCellData=function(){var e=this.getCurrentEditedData(this.formObj.element,{});return e[Object.keys(e)[0]]},e.prototype.saveCell=function(){this.editModule.saveCell()},e.prototype.endEditing=function(){this.parent.element.classList.remove("e-editing"),this.editModule.endEdit(),this.refreshToolbar()},e.prototype.showDialog=function(e,t){t.content="<div>"+this.l10n.getConstant(e)+"</div>",t.dataBind(),t.show()},e.prototype.getValueFromType=function(e,t){var i=t;switch(e.type){case"number":i=isNaN(parseFloat(t))?null:parseFloat(t);break;case"boolean":"booleanedit"!==e.editType&&(i=t===this.l10n.getConstant("True")||!0===t);break;case"date":case"datetime":"datepickeredit"!==e.editType&&"datetimepickeredit"!==e.editType&&t&&t.length?i=new Date(t):""===t&&(i=null)}return i},e.prototype.destroyToolTip=function(){for(var e=0,t=[].slice.call(this.parent.element.getElementsByClassName("e-griderror"));e<t.length;e++){var i=t[e];sf.base.remove(i)}this.parent.getContent().firstElementChild.style.position="relative"},e.prototype.createConfirmDlg=function(){this.dialogObj=this.dlgWidget([{click:this.dlgOk.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.dlgCancel.bind(this),buttonModel:{cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}],"EditConfirm")},e.prototype.createAlertDlg=function(){this.alertDObj=this.dlgWidget([{click:this.alertClick.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:"e-flat",isPrimary:!0}}],"EditAlert")},e.prototype.alertClick=function(){this.alertDObj.hide()},e.prototype.dlgWidget=function(e,t){var i=this.parent.createElement("div",{id:this.parent.element.id+t});this.parent.element.appendChild(i);var r={showCloseIcon:!1,isModal:!0,visible:!1,closeOnEscape:!0,target:this.parent.element,width:"320px",animationSettings:{effect:"None"}};r.buttons=e;var n=new sf.popups.Dialog(r);return n.isStringTemplate=!0,n.appendTo(i),n},e.prototype.dlgCancel=function(){this.parent.focusModule.clearIndicator(),this.parent.focusModule.restoreFocus(),this.dialogObj.hide()},e.prototype.dlgOk=function(){switch(this.dialogObj.element.querySelector(".e-dlg-content").firstElementChild.innerText){case this.l10n.getConstant("ConfirmDelete"):this.editModule.deleteRecord();break;case this.l10n.getConstant("CancelEdit"):this.editModule.closeEdit();break;case this.l10n.getConstant("BatchSaveConfirm"):this.endEditing();break;case this.l10n.getConstant("BatchSaveLostChanges"):"Batch"===this.parent.editSettings.mode&&this.editModule.addCancelWhilePaging(),this.executeAction()}this.dlgCancel()},e.prototype.destroyEditComponents=function(){this.parent.isEdit&&(this.destroyWidgets(),this.destroyForm()),this.destroy()},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.eventDetails=[{event:C,handler:this.onPropertyChanged},{event:g,handler:this.initialEnd},{event:x,handler:this.keyPressHandler},{event:E,handler:this.updateColTypeObj},{event:"tooltip-destroy",handler:this.destroyToolTip},{event:I,handler:this.preventBatch},{event:"destroy-form",handler:this.destroyForm},{event:F,handler:this.destroyEditComponents}],Nr(this.parent,this.eventDetails,!0,this),this.actionBeginFunction=this.onActionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.parent.addEventListener(p,this.actionBeginFunction),this.parent.addEventListener(c,this.actionCompleteFunction))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(Nr(this.parent,this.eventDetails,!1),this.parent.removeEventListener(c,this.actionCompleteFunction),this.parent.removeEventListener(p,this.actionBeginFunction))},e.prototype.actionComplete=function(e){["add","beginEdit","save","delete","cancel"].indexOf(e.requestType)<0&&(this.parent.isEdit=!1),"batchsave"===e.requestType&&this.parent.focusModule.restoreFocus(),this.refreshToolbar()},e.prototype.getCurrentEditedData=function(e,t){var i=this.parent;if(i.editSettings.template){for(var r=[].slice.call(e.elements),n=0;n<r.length;n++)if((r[n].hasAttribute("name")&&"e-multi-hidden"!==r[n].className||r[n].classList.contains("e-multiselect"))&&("hidden"!==r[n].type||!yi(r[n],"e-switch-wrapper")&&!yi(r[n],"e-checkbox-wrapper"))){var s=r[n].hasAttribute("name")?Ai(r[n].getAttribute("name")):Ai(r[n].getAttribute("id")),o=i.getColumnByField(s)||{field:s,type:r[n].getAttribute("type")},a=void 0;"checkbox"===o.type||"boolean"===o.type?a=r[n].checked:r[n].value?(a=r[n].value,r[n].ej2_instances&&r[n].ej2_instances.length&&!sf.base.isNullOrUndefined(r[n].ej2_instances[0].value)&&(r[n].blur(),a=r[n].ej2_instances[0].value)):r[n].ej2_instances&&(a=r[n].ej2_instances[0].value),o.edit&&"string"==typeof o.edit.read?a=sf.base.getValue(o.edit.read,window)(r[n],a):o.edit&&o.edit.read&&(a=o.edit.read(r[n],a)),a=i.editModule.getValueFromType(o,a),"radio"===r[n].type?r[n].checked&&sf.data.DataUtil.setValue(o.field,a,t):sf.data.DataUtil.setValue(o.field,a,t)}return t}for(var l=i.columnModel.filter((function(e){return e.editTemplate})),h=0;h<l.length;h++)if(e[ki(l[h].field)]){var d=[].slice.call(e[ki(l[h].field)]),p=(d=d.length?d:[e[ki(l[h].field)]]).filter((function(e){return!sf.base.isNullOrUndefined(e.ej2_instances)}));0===p.length&&(p=d.filter((function(e){return e.hasAttribute("name")})));for(n=0;n<p.length;n++){a=this.getValue(l[h],p[n],t);sf.data.DataUtil.setValue(l[h].field,a,t)}}for(var c=[].slice.call(e.getElementsByClassName("e-field")),u=0,f=c.length;u<f;u++){var g=i.getColumnByUid(c[u].getAttribute("e-mappinguid"));if(g&&g.field){a=this.getValue(g,c[u],t);sf.data.DataUtil.setValue(g.field,a,t)}}return t},e.prototype.getValue=function(e,t,i){var r=t.ej2_instances?t.ej2_instances[0].value:t.value,n=this.parent,s=e.edit.read;return"checkbox"!==e.type&&"boolean"!==e.type||(r=t.checked),"string"==typeof s?(s=sf.base.getValue(s,window),r=n.editModule.getValueFromType(e,s(t,r))):r=n.editModule.getValueFromType(e,e.edit.read(t,r)),sf.base.isNullOrUndefined(i[e.field])&&""===r&&(r=i[e.field]),r},e.prototype.onActionBegin=function(e){if("columnstate"===e.requestType&&this.parent.isEdit&&"Batch"!==this.parent.editSettings.mode)this.closeEdit();else{var t=this.parent.element.querySelector("."+Z),i=this.parent.element.querySelector("."+$);if(t&&this.parent.frozenRows&&"virtualscroll"===e.requestType&&parseInt(yi(t,Y).getAttribute(ne),10)<this.parent.frozenRows)return;var r=-1===["filterafteropen","filterbeforeopen","filterchoicerequest","save","infiniteScroll","virtualscroll"].indexOf(e.requestType),n=this.parent.enableVirtualization&&this.formObj&&!this.formObj.isDestroyed&&(t||i||"cancel"===e.requestType)&&r;(!this.parent.enableVirtualization&&"Batch"!==this.parent.editSettings.mode&&this.formObj&&!this.formObj.isDestroyed&&r&&!e.cancel||n)&&(this.destroyWidgets(),this.destroyForm())}},e.prototype.destroyWidgets=function(e){this.parent.editSettings.template&&(this.parent.destroyTemplate(["editSettingsTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),(e=e||this.parent.getCurrentVisibleColumns(this.parent.enableColumnVirtualization)).some((function(e){return!sf.base.isNullOrUndefined(e.editTemplate)}))&&(this.parent.destroyTemplate(["editTemplate"]),this.parent.isReact&&this.parent.renderTemplates());for(var t=0,i=e;t<i.length;t++){var r=i[t],n=r.edit.destroy;r.edit.destroy&&("string"==typeof n?(n=sf.base.getValue(n,window))():r.edit.destroy())}for(var s=[].slice.call(this.formObj.element.elements),o=0;o<s.length;o++)s[o].hasAttribute("name")&&s[o].ej2_instances&&s[o].ej2_instances.length&&!s[o].ej2_instances[0].isDestroyed&&s[o].ej2_instances[0].destroy()},e.prototype.destroyForm=function(){this.destroyToolTip();for(var e=[this.formObj,this.mFormObj,this.frFormObj,this.virtualFormObj],t=0;t<e.length;t++)e[t]&&e[t].element&&!e[t].isDestroyed&&e[t].destroy();this.destroyToolTip()},e.prototype.destroy=function(){var e=this.parent.element;if(e){var t=!(!e.querySelector("."+H)||!e.querySelector("."+U));t&&this.destroyForm(),this.removeEventListener();var i=this.dialogObj.element;i.childElementCount>0&&(this.dialogObj.destroy(),sf.base.remove(i)),(i=this.alertDObj.element).childElementCount>0&&(this.alertDObj.destroy(),sf.base.remove(i)),t&&this.editModule&&this.editModule.destroy()}},e.prototype.keyPressHandler=function(e){switch(e.action){case"insert":this.addRecord();break;case"delete":"INPUT"===e.target.tagName&&!e.target.classList.contains("e-checkselect")||document.querySelector(".e-popup-open")||this.deleteRecord();break;case"f2":this.startEdit();break;case"enter":yi(e.target,"e-unboundcelldiv")||"Batch"===this.parent.editSettings.mode||!(yi(e.target,U)||this.parent.frozenRows&&yi(e.target,V))||document.getElementsByClassName("e-popup-open").length||(e.preventDefault(),this.endEdit());break;case"escape":this.parent.isEdit&&("Batch"===this.parent.editSettings.mode?this.editModule.escapeCellEdit():this.closeEdit())}},e.prototype.preventBatch=function(e){this.preventObj=e,this.showDialog("BatchSaveLostChanges",this.dialogObj)},e.prototype.executeAction=function(){this.preventObj.handler.call(this.preventObj.instance,this.preventObj.arg1,this.preventObj.arg2,this.preventObj.arg3,this.preventObj.arg4,this.preventObj.arg5,this.preventObj.arg6,this.preventObj.arg7,this.preventObj.arg8)},e.prototype.applyFormValidation=function(e){var t=this.parent,i=t.isFrozenGrid(),r="Normal"===this.parent.editSettings.mode,n="Right"===this.parent.getFrozenMode()&&r?1:0,s="Dialog"!==this.parent.editSettings.mode?t.element.getElementsByClassName("e-gridform")[n]:sf.base.select("#"+t.element.id+"_dialogEdit_wrapper .e-gridform",document),o="Right"===this.parent.getFrozenMode()&&r?0:1,a=t.element.getElementsByClassName("e-gridform")[o],l={},h={},d={};e=e||t.getColumns();for(var p=0;p<e.length;p++)(e[p].visible||"Dialog"===t.editSettings.mode&&(-1!==t.groupSettings.columns.indexOf(e[p].field)||"Dialog"!==t.editSettings.mode))&&e[p].validationRules&&Tr(e[p],o,l,h,d,e.length);if(i&&"Dialog"!==this.parent.editSettings.mode){if(this.parent.editModule.mFormObj=this.createFormObj(a,h),this.parent.getFrozenMode()===ee){var c=t.element.getElementsByClassName("e-gridform")[2];this.parent.editModule.frFormObj=this.createFormObj(c,d)}}else l=sf.base.extend(l,h,d);this.parent.editModule.formObj=this.createFormObj(s,l)},e.prototype.createFormObj=function(e,t){var i=this;return new sf.inputs.FormValidator(e,{rules:t,locale:this.parent.locale,validationComplete:function(e){i.validationComplete(e)},customPlacement:function(e,t){var r=e.getAttribute("e-mappinguid"),n={column:i.parent.getColumnByUid(r),error:t,inputElement:e,value:e.value};i.valErrorPlacement(e,t),i.parent.notify("validation-custom-placement",n)}})},e.prototype.valErrorPlacement=function(e,t){if(this.parent.isEdit){var i=t.getAttribute("for"),r=this.getElemTable(e).querySelector("#"+i+"_Error");r?r.querySelector(".e-tip-content").innerHTML=t.outerHTML:this.createTooltip(e,t,i,"")}},e.prototype.getElemTable=function(e){var t,i,r=this.parent;if("Dialog"!==r.editSettings.mode){t=r.frozenRows&&r.frozenRows>(parseInt(sf.base.closest(e,"."+Y).getAttribute(ne),10)||0);var n=e.name,s=void 0;n&&(s=qr(this.parent,Ai(n))),s&&r.isFrozenGrid()?"frozen-left"===s.getFreezeTableName()?i=t?r.getFrozenVirtualHeader().querySelector("table"):r.getFrozenVirtualContent().querySelector("table"):"frozen-right"===s.getFreezeTableName()?i=t?r.getFrozenRightHeader().querySelector("table"):r.getFrozenRightContent().querySelector("table"):"movable"===s.getFreezeTableName()&&(i=t?r.getMovableVirtualHeader().querySelector("table"):r.getMovableVirtualContent().querySelector("table")):i=t?r.getHeaderTable():r.getContentTable()}else i=sf.base.select("#"+r.element.id+"_dialogEdit_wrapper",document);return i},e.prototype.resetElemPosition=function(e,t){var i=yi(t.element,q);if(i){var r=i.getBoundingClientRect().right,n=e.getBoundingClientRect().right;if(n>r){var s=n-r;e.style.left=e.offsetLeft-s+"px"}}},e.prototype.validationComplete=function(e){if(this.parent.isEdit){var t=this.getElemTable(e.element).querySelector("#"+e.inputName+"_Error");t&&("failure"===e.status?(t.style.display="",this.resetElemPosition(t,e)):t.style.display="none")}},e.prototype.createTooltip=function(e,t,i,r){var n=this.parent.getColumnByField(i),s=this.parent.getFrozenMode()===ee&&"Normal"===this.parent.editSettings.mode&&n.getFreezeTableName()===te?this.frFormObj.element:this.formObj.element,o=yi(e,"e-virtual-validation");o&&(s=this.virtualFormObj.element);var a=this.parent.getContent().firstElementChild,l=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount();l&&(a=this.parent.getMovableVirtualContent());var h,d,p=a.scrollHeight>a.clientHeight||a.scrollWidth>a.clientWidth,c="Dialog"!==this.parent.editSettings.mode,u=sf.base.closest(e,"."+q),f=sf.base.closest(e,"."+Y),g=this.parent.getContent().querySelector("."+W),m=!1,y=!1,v=Math.round(this.parent.getContent().clientHeight/this.parent.getRowHeight())-1,b=g?[].slice.call(this.parent.getFrozenVirtualContent().getElementsByClassName(Y)):[].slice.call(this.parent.getContent().getElementsByClassName(Y));if("Batch"===this.parent.editSettings.mode&&v>1&&b.length>=v&&b[b.length-1].getAttribute(ne)===f.getAttribute(ne)&&(y=!0),c){if(this.parent.frozenRows){var C=l?this.parent.getFrozenVirtualHeader().querySelector(se).children:this.parent.getHeaderTable().querySelector(se).children;m=(h=C.length>(parseInt(f.getAttribute(ne),10)||0))&&parseInt(f.getAttribute(ne),10)===C.length-1}(m||v>1&&b.length>=v&&("Bottom"===this.parent.editSettings.newRowPosition&&this.editModule.args&&"add"===this.editModule.args.requestType||u.classList.contains("e-lastrowcell")&&!f.classList.contains($))||y)&&(d=!0)}var w=c?h?this.parent.getHeaderTable():this.parent.getContentTable():sf.base.select("#"+this.parent.element.id+"_dialogEdit_wrapper .e-dlg-content",document),S=w.getBoundingClientRect(),x=c?this.parent.element.getBoundingClientRect().left:S.left,R=sf.base.closest(e,"td"),F=R?R.getBoundingClientRect():e.parentElement.getBoundingClientRect(),E=this.parent.createElement("div",{className:"e-tooltip-wrap e-lib e-control e-popup e-griderror",id:i+"_Error",styles:"display:"+r+";top:"+((h?F.top+F.height:F.bottom-S.top-(l?g.scrollTop:0))+w.scrollTop+9)+"px;left:"+(F.left-x+w.scrollLeft+F.width/2)+"px;max-width:"+F.width+"px;text-align:center;"});c&&S.left<x&&(E.style.left=parseInt(E.style.left,10)-S.left+x+"px");var I,T=this.parent.createElement("div",{className:"e-tip-content"});(T.appendChild(t),d?((I=this.parent.createElement("div",{className:"e-arrow-tip e-tip-bottom"})).appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-bottom"})),I.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-bottom"}))):((I=this.parent.createElement("div",{className:"e-arrow-tip e-tip-top"})).appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-top"})),I.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-top"}))),E.appendChild(T),E.appendChild(I),o||!l&&!this.parent.frozenRows||"Dialog"===this.parent.editSettings.mode)?o?this.virtualFormObj.element.appendChild(E):this.formObj.element.appendChild(E):(("Normal"===this.parent.editSettings.mode?sf.base.closest(e,".e-editcell"):sf.base.closest(e,"."+X)).style.position="relative",E.style.position="absolute","Batch"===this.parent.editSettings.mode||sf.base.closest(e,"."+W)||sf.base.closest(e,"."+K)||this.parent.frozenRows&&!l?s.appendChild(E):this.mFormObj.element.appendChild(E));!d&&c&&a.getBoundingClientRect().bottom<F.bottom+F.height&&(a.scrollTop=a.scrollTop+E.offsetHeight+I.scrollHeight);var z=parseInt(document.defaultView.getComputedStyle(E,null).getPropertyValue("font-size"),10);if(E.getBoundingClientRect().width<F.width&&E.querySelector("label").getBoundingClientRect().height/(1.2*z)>=2&&(E.style.width=E.style.maxWidth),(l||this.parent.frozenRows)&&"Dialog"!==this.parent.editSettings.mode?E.style.left=R.offsetLeft+(R.offsetWidth/2-E.offsetWidth/2)+"px":E.style.left=parseInt(E.style.left,10)-E.offsetWidth/2+"px",c&&!p&&!this.parent.allowPaging||l||this.parent.frozenRows){a.style.position="static";var D=sf.popups.calculateRelativeBasedPosition(R,E);E.style.top=D.top+F.height+9+"px"}if(d){if(!p||l||"auto"===this.parent.height||this.parent.frozenRows||this.parent.enableVirtualization)E.style.bottom=F.height+9+"px";else{var M=a.scrollWidth>a.offsetWidth?Di():0;E.style.bottom=this.parent.height-a.querySelector("table").offsetHeight-M+F.height+9+"px"}if(b.length<v&&"Bottom"===this.parent.editSettings.newRowPosition&&this.editModule.args&&"add"===this.editModule.args.requestType){var O=(this.parent.frozenRows?this.parent.frozenRows+(b.length-1):b.length-1)*this.parent.getRowHeight(),k=this.parent.getContent().clientHeight-O;E.style.bottom=k+9+"px"}E.style.top=null}},e.prototype.checkColumnIsGrouped=function(e){return!(e.visible||this.parent.groupSettings.columns.indexOf(e.field)>-1)},e.AddEditors=function(t){e.editCellType=sf.base.extend(e.editCellType,t)},e.editCellType={dropdownedit:os,numericedit:as,datepickeredit:ys,datetimepickeredit:ys,booleanedit:ns,defaultedit:hs,templateedit:xs},e}(),Fs=function(){function e(e,t){this.showColumn=[],this.hideColumn=[],this.changedColumns=[],this.unchangedColumns=[],this.isDlgOpen=!1,this.initialOpenDlg=!0,this.stateChangeColumns=[],this.changedStateColumns=[],this.isInitialOpen=!1,this.isCustomizeOpenCC=!1,this.searchOperator="startswith",this.prevShowedCols=[],this.hideDialogFunction=this.hideDialog.bind(this),this.parent=e,this.serviceLocator=t,this.addEventListener(),this.cBoxTrue=sf.buttons.createCheckBox(this.parent.createElement,!0,{checked:!0,label:" "}),this.cBoxFalse=sf.buttons.createCheckBox(this.parent.createElement,!0,{checked:!1,label:" "}),this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden e-cc e-cc-chbox",attrs:{type:"checkbox"}}),this.cBoxTrue.firstChild),this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden e-cc e-cc-chbox",attrs:{type:"checkbox"}}),this.cBoxFalse.firstChild),this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck"),this.parent.enableRtl&&sf.base.addClass([this.cBoxTrue,this.cBoxFalse],["e-rtl"])}return e.prototype.destroy=function(){var e=this.parent.element;e&&(e.querySelector("."+H)||e.querySelector("."+U))&&(this.removeEventListener(),this.unWireEvents(),sf.base.isNullOrUndefined(this.dlgObj)||!this.dlgObj.element||this.dlgObj.isDestroyed||this.dlgObj.destroy())},e.prototype.rtlUpdate=function(){this.parent.enableRtl?sf.base.addClass([].slice.call(this.innerDiv.getElementsByClassName("e-checkbox-wrapper")),["e-rtl"]):sf.base.removeClass([].slice.call(this.innerDiv.getElementsByClassName("e-checkbox-wrapper")),["e-rtl"])},e.prototype.addEventListener=function(){this.parent.isDestroyed||(sf.base.EventHandler.add(document,"click",this.clickHandler,this),this.parent.on(v,this.enableAfterRenderEle,this),this.parent.on(g,this.render,this),this.parent.addEventListener(u,this.hideDialogFunction),this.parent.on(F,this.destroy,this),this.parent.on("rtl-updated",this.rtlUpdate,this),this.parent.on(x,this.keyUpHandler,this),this.parent.on("reset-columns",this.onResetColumns,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(sf.base.EventHandler.remove(document,"click",this.clickHandler),this.parent.off(g,this.render),this.parent.off(F,this.destroy),this.parent.off(v,this.enableAfterRenderEle),this.parent.off("rtl-updated",this.rtlUpdate),this.parent.on(x,this.keyUpHandler,this),this.parent.off("reset-columns",this.onResetColumns),this.parent.removeEventListener(u,this.hideDialogFunction))},e.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization"),this.renderDlgContent(),this.getShowHideService=this.serviceLocator.getService("showHideService")},e.prototype.clickHandler=function(e){var t=e.target;if(!this.isCustomizeOpenCC){if(sf.base.isNullOrUndefined(sf.base.closest(t,".e-cc"))&&sf.base.isNullOrUndefined(sf.base.closest(t,".e-cc-toolbar")))sf.base.isNullOrUndefined(this.dlgObj)||!this.dlgObj.visible||t.classList.contains("e-toolbar-items")||(this.dlgObj.hide(),this.clearActions(),this.refreshCheckboxState(),this.isDlgOpen=!1);else if(t.classList.contains("e-columnchooser-btn")||t.classList.contains("e-cc-toolbar")){if(this.initialOpenDlg&&this.dlgObj.visible||!this.isDlgOpen)return void(this.isDlgOpen=!0)}else t.classList.contains("e-cc-cancel")&&(t.parentElement.querySelector(".e-ccsearch").value="",this.columnChooserSearch(""),this.removeCancelIcon(),this.refreshCheckboxButton());(this.parent.detailTemplate||this.parent.childGrid)&&(this.targetdlg=e.target)}this.isCustomizeOpenCC&&e.target.classList.contains("e-cc-cancel")&&this.refreshCheckboxState(),this.rtlUpdate()},e.prototype.hideDialog=function(){!sf.base.isNullOrUndefined(this.dlgObj)&&this.dlgObj.visible&&(this.dlgObj.hide(),this.isDlgOpen=!1)},e.prototype.renderColumnChooser=function(e,t,i){if(this.dlgObj.visible||!this.parent.detailTemplate&&!this.parent.childGrid||this.hideOpenedDialog(),this.dlgObj.visible)this.hideDialog(),this.addcancelIcon(),this.clearActions(),this.refreshCheckboxState();else{if(this.beforeOpenColumnChooserEvent().cancel)return;i&&(this.targetdlg=i),this.refreshCheckboxState(),this.dlgObj.dataBind(),this.dlgObj.element.style.maxHeight="430px";var r=this.dlgObj.element.style.display;this.dlgObj.element.style.display="block";var n=this.parent.getHeaderContent().classList.contains("e-sticky"),s=sf.base.closest(i,".e-toolbar-item"),o=void 0;n?(o=s.getBoundingClientRect(),this.dlgObj.element.classList.add("e-sticky")):(this.dlgObj.element.classList.remove("e-sticky"),o=sf.popups.calculateRelativeBasedPosition(s,this.dlgObj.element)),this.dlgObj.element.style.display=r,this.dlgObj.element.style.top=o.top+sf.base.closest(i,".e-cc-toolbar").getBoundingClientRect().height+"px";sf.base.isNullOrUndefined(sf.base.closest(i,".e-bigger"))||(this.dlgObj.width=258),sf.base.Browser.isDevice?(this.dlgObj.target=document.body,this.dlgObj.position={X:"center",Y:"center"},this.dlgObj.refreshPosition(),this.dlgObj.open=this.mOpenDlg.bind(this)):this.parent.enableRtl?this.dlgObj.element.style.left=i.offsetLeft+"px":this.dlgObj.element.style.left=o.left-250+sf.base.closest(i,".e-cc-toolbar").clientWidth+2+"px",this.removeCancelIcon(),this.dlgObj.show(),this.parent.notify("columnChooserOpened",{dialog:this.dlgObj})}this.rtlUpdate()},e.prototype.openColumnChooser=function(e,t){(this.isCustomizeOpenCC=!0,this.dlgObj.visible)?this.hideDialog():this.beforeOpenColumnChooserEvent().cancel||(this.isInitialOpen?this.refreshCheckboxState():(this.dlgObj.content=this.renderChooserList(),this.updateIntermediateBtn()),this.dlgObj.dataBind(),this.dlgObj.position={X:"center",Y:"center"},sf.base.isNullOrUndefined(e)?(this.dlgObj.position={X:"center",Y:"center"},this.dlgObj.refreshPosition()):(this.dlgObj.element.style.top="",this.dlgObj.element.style.left="",this.dlgObj.element.style.top=t+"px",this.dlgObj.element.style.left=e+"px"),this.dlgObj.beforeOpen=this.customDialogOpen.bind(this),this.dlgObj.show(),this.isInitialOpen=!0,this.dlgObj.beforeClose=this.customDialogClose.bind(this))},e.prototype.enableAfterRenderEle=function(e){e.module===this.getModuleName()&&e.enable&&this.render()},e.prototype.keyUpHandler=function(e){"escape"===e.action&&this.hideDialog()},e.prototype.customDialogOpen=function(){var e=this.dlgObj.content.querySelector("input.e-ccsearch");sf.base.EventHandler.add(e,"keyup",this.columnChooserManualSearch,this)},e.prototype.customDialogClose=function(){var e=this.dlgObj.content.querySelector("input.e-ccsearch");sf.base.EventHandler.remove(e,"keyup",this.columnChooserManualSearch)},e.prototype.getColumns=function(){return this.parent.getColumns().filter((function(e){return"checkbox"!==e.type&&!0===e.showInColumnChooser||"checkbox"===e.type&&void 0!==e.field}))},e.prototype.renderDlgContent=function(){this.dlgDiv=this.parent.createElement("div",{className:"e-ccdlg e-cc",id:this.parent.element.id+"_ccdlg"}),this.dlgDiv.setAttribute("aria-label",this.l10n.getConstant("ColumnChooserDialogARIA")),this.parent.element.appendChild(this.dlgDiv),this.dlgObj=new sf.popups.Dialog({header:this.l10n.getConstant("ChooseColumns"),showCloseIcon:!1,closeOnEscape:!1,locale:this.parent.locale,visible:!1,enableRtl:this.parent.enableRtl,target:document.getElementById(this.parent.element.id),buttons:[{click:this.confirmDlgBtnClick.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),isPrimary:!0,cssClass:"e-cc e-cc_okbtn"}},{click:this.clearBtnClick.bind(this),buttonModel:{cssClass:"e-flat e-cc e-cc-cnbtn",content:this.l10n.getConstant("CancelButton")}}],content:this.renderChooserList(),width:250,cssClass:"e-cc",animationSettings:{effect:"None"}});this.dlgObj.isStringTemplate=!0,this.dlgObj.appendTo(this.dlgDiv),this.wireEvents()},e.prototype.renderChooserList=function(){this.mainDiv=this.parent.createElement("div",{className:"e-main-div e-cc"});var e=this.parent.createElement("div",{className:"e-cc-searchdiv e-cc e-input-group"}),t=this.parent.createElement("input",{className:"e-ccsearch e-cc e-input",attrs:{placeholder:this.l10n.getConstant("Search")}}),i=this.parent.createElement("span",{className:"e-ccsearch-icon e-icons e-cc e-input-group-icon",attrs:{title:this.l10n.getConstant("Search")}}),r=this.parent.createElement("div",{className:"e-cc-contentdiv"});this.innerDiv=this.parent.createElement("div",{className:"e-innerdiv e-cc"}),e.appendChild(t),e.appendChild(i),this.searchBoxObj=new yt(t);var n=this.refreshCheckboxList(this.parent.getColumns());return this.innerDiv.appendChild(n),r.appendChild(this.innerDiv),this.mainDiv.appendChild(e),this.mainDiv.appendChild(r),this.mainDiv},e.prototype.confirmDlgBtnClick=function(e){this.stateChangeColumns=[],this.changedStateColumns=[],this.changedColumns=this.changedColumns.length>0?this.changedColumns:this.unchangedColumns,this.changedColumnState(this.changedColumns);var t=this.ulElement.querySelector(".e-uncheck")&&this.ulElement.querySelectorAll(".e-uncheck:not(.e-selectall)").length;sf.base.isNullOrUndefined(e)||t<this.parent.getColumns().length&&(this.hideColumn.length&&this.columnStateChange(this.hideColumn,!1),this.showColumn.length&&this.columnStateChange(this.showColumn,!0),this.getShowHideService.setVisible(this.stateChangeColumns,this.changedStateColumns),this.clearActions(),this.parent.notify("tooltip-destroy",{module:"edit"}),0===this.parent.getCurrentViewRecords().length&&this.parent.element.querySelector(".e-emptyrow").querySelector("td").setAttribute("colSpan",this.parent.getVisibleColumns().length.toString()))},e.prototype.onResetColumns=function(e){"columnstate"!==e.requestType||this.resetColumnState()},e.prototype.resetColumnState=function(){this.showColumn=[],this.hideColumn=[],this.hideDialog()},e.prototype.changedColumnState=function(e){for(var t=0;t<e.length;t++){var i=e[t],r=this.parent.getColumnByUid(i);this.changedStateColumns.push(r)}},e.prototype.columnStateChange=function(e,t){for(var i=0;i<e.length;i++){var r=e[i],n=this.parent.getColumnByUid(r);"checkbox"!==n.type&&(n.visible=t),this.stateChangeColumns.push(n)}},e.prototype.clearActions=function(){this.resetColumnState(),this.addcancelIcon()},e.prototype.clearBtnClick=function(){this.clearActions(),this.parent.notify("columnChooserCancelBtnClick",{dialog:this.dlgObj})},e.prototype.checkstatecolumn=function(e,t,i){void 0===i&&(i=!1),e?(-1!==this.hideColumn.indexOf(t)&&this.hideColumn.splice(this.hideColumn.indexOf(t),1),-1===this.showColumn.indexOf(t)&&this.showColumn.push(t)):(-1!==this.showColumn.indexOf(t)&&this.showColumn.splice(this.showColumn.indexOf(t),1),-1===this.hideColumn.indexOf(t)&&this.hideColumn.push(t)),i?e?this.unchangedColumns.push(t):this.changedColumns.push(t):-1!==this.changedColumns.indexOf(t)?this.changedColumns.splice(this.changedColumns.indexOf(t),1):this.changedColumns.push(t)},e.prototype.columnChooserSearch=function(e){var t,i,r=!1,n=this.dlgDiv.querySelector(".e-footer-content"),s=this.ulElement.querySelector(".e-check")&&this.ulElement.querySelectorAll(".e-check:not(.e-selectall)").length;if(this.isInitialOpen=!0,n&&(i=n.querySelector(".e-btn").ej2_instances[0]),""===e?(this.removeCancelIcon(),t=this.getColumns(),r=!0):t=new sf.data.DataManager(this.getColumns()).executeLocal((new sf.data.Query).where("headerText",this.searchOperator,e,!0,this.parent.columnChooserSettings.ignoreAccent)),t.length)this.innerDiv.innerHTML=" ",this.innerDiv.classList.remove("e-ccnmdiv"),this.innerDiv.appendChild(this.refreshCheckboxList(t)),r?i&&s&&(i.disabled=!1):(this.addcancelIcon(),this.refreshCheckboxButton());else{var o=this.parent.createElement("span",{className:"e-cc e-nmatch"});o.innerHTML=this.l10n.getConstant("Matchs"),this.innerDiv.innerHTML=" ",this.innerDiv.appendChild(o),this.innerDiv.classList.add("e-ccnmdiv"),i&&(i.disabled=!0)}this.flag=!0,this.stopTimer()},e.prototype.wireEvents=function(){sf.base.EventHandler.add(this.dlgObj.element,"click",this.checkBoxClickHandler,this),sf.base.EventHandler.add(this.searchBoxObj.searchBox,"keyup",this.columnChooserManualSearch,this),this.searchBoxObj.wireEvent()},e.prototype.unWireEvents=function(){this.parent.isDestroyed||(this.dlgObj.element&&sf.base.EventHandler.remove(this.dlgObj.element,"click",this.checkBoxClickHandler),sf.base.EventHandler.remove(this.searchBoxObj.searchBox,"keyup",this.columnChooserManualSearch),this.searchBoxObj.unWireEvent())},e.prototype.checkBoxClickHandler=function(e){var t,i=yi(e.target,"e-checkbox-wrapper");if(i){if(i.querySelector(".e-selectall")?this.updateSelectAll(!i.querySelector(".e-check")):Vi(i.parentElement),i.querySelector(".e-chk-hidden").focus(),i.querySelector(".e-check"))t=!0;else{if(!i.querySelector(".e-uncheck"))return;t=!1}this.updateIntermediateBtn();var r=yi(i,"e-ccheck").getAttribute("uid"),n=this.parent.getColumns();if("grid-selectAll"===r){this.changedColumns=[],this.unchangedColumns=[];for(var s=0;s<n.length;s++)n[s].showInColumnChooser&&this.checkstatecolumn(t,n[s].uid,!0)}else this.checkstatecolumn(t,r);this.refreshCheckboxButton()}},e.prototype.updateIntermediateBtn=function(){var e=this.ulElement.children.length-1,t=[],i=this.ulElement.children[0].querySelector(".e-frame"),r=this.ulElement.querySelectorAll(".e-check:not(.e-selectall)").length,n=this.dlgObj.btnObj[0];n.disabled=!1,e===r?t=["e-check"]:r?t=["e-stop"]:(t=["e-uncheck"],n.disabled=!0),n.dataBind(),sf.base.removeClass([i],["e-check","e-stop","e-uncheck"]),sf.base.addClass([i],t)},e.prototype.updateSelectAll=function(e){for(var t=0,i=[].slice.call(this.ulElement.getElementsByClassName("e-frame"));t<i.length;t++){Wi(i[t],e)}},e.prototype.refreshCheckboxButton=function(){for(var e=this.parent.getVisibleColumns(),t=0;t<e.length;t++){var i=e[t].uid;-1===this.prevShowedCols.indexOf(i)&&this.prevShowedCols.push(i)}for(t=0;t<this.hideColumn.length;t++){var r=this.prevShowedCols.indexOf(this.hideColumn[t]);-1!==r&&this.prevShowedCols.splice(r,1)}var n=0!==this.showColumn.length?1:this.prevShowedCols.length,s=this.dlgDiv.querySelector(".e-footer-content").querySelector(".e-btn").ej2_instances[0];s.disabled=!1;for(var o=[],a=[].slice.call(this.parent.element.getElementsByClassName("e-cc-chbox")),l=(t=0,a.length);t<l;t++){i=yi(a[t],"e-ccheck").getAttribute("uid");o.push(i)}var h=this.showColumn.filter((function(e){return-1!==o.indexOf(e)}));0===n&&0===h.length&&(s.disabled=!0),s.dataBind()},e.prototype.refreshCheckboxList=function(e){this.ulElement=this.parent.createElement("ul",{className:"e-ccul-ele e-cc"});var t=this.l10n.getConstant("SelectAll"),i=this.parent.createElement("li",{className:"e-cclist e-cc e-cc-selectall"}),r=this.createCheckBox(t,!1,"grid-selectAll");e.length&&(r.querySelector(".e-checkbox-wrapper").firstElementChild.classList.add("e-selectall"),r.querySelector(".e-frame").classList.add("e-selectall"),this.checkState(r.querySelector(".e-icons"),!0),i.appendChild(r),this.ulElement.appendChild(i));for(var n=0;n<e.length;n++){var s=e[n];this.renderCheckbox(s)}return this.ulElement},e.prototype.refreshCheckboxState=function(){this.dlgObj.element.querySelector(".e-cc.e-input").value="",this.columnChooserSearch("");for(var e=this.parent,t=this.dlgObj.element.querySelectorAll(".e-cc-chbox:not(.e-selectall)"),i=0,r=t.length;i<r;i++){var n=t[i],s=void 0;s=this.parent.childGrid||this.parent.detailTemplate?yi(this.dlgObj.element.querySelectorAll(".e-cc-chbox:not(.e-selectall)")[i],"e-ccheck").getAttribute("uid"):yi(n,"e-ccheck").getAttribute("uid");var o=e.getColumnByUid(s),a=[].slice.call(n.parentElement.getElementsByClassName("e-uncheck"));o.visible&&!a.length?(n.checked=!0,this.checkState(n.parentElement.querySelector(".e-icons"),!0)):(n.checked=!1,this.checkState(n.parentElement.querySelector(".e-icons"),!1))}},e.prototype.checkState=function(e,t){t?sf.base.classList(e,["e-check"],["e-uncheck"]):sf.base.classList(e,["e-uncheck"],["e-check"])},e.prototype.createCheckBox=function(e,t,i){var r=t?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0);return r.querySelector(".e-label").innerHTML=e,_i(i,r,"e-ccheck")},e.prototype.renderCheckbox=function(e){var t,i,r;if(e.showInColumnChooser){t=this.parent.createElement("li",{className:"e-cclist e-cc",styles:"list-style:None",id:"e-ccli_"+e.uid}),i=-1!==this.hideColumn.indexOf(e.uid),r=-1!==this.showColumn.indexOf(e.uid);var n=this.createCheckBox(e.headerText,e.visible&&!i||r,e.uid);t.appendChild(n),this.ulElement.appendChild(t)}this.isInitialOpen&&this.updateIntermediateBtn()},e.prototype.columnChooserManualSearch=function(e){this.addcancelIcon(),this.searchValue=e.target.value,this.stopTimer(),this.startTimer(e)},e.prototype.startTimer=function(e){var t=this,i=t.flag||13===e.keyCode?0:500;this.timer=window.setInterval((function(){t.columnChooserSearch(t.searchValue)}),i)},e.prototype.stopTimer=function(){window.clearInterval(this.timer)},e.prototype.addcancelIcon=function(){this.dlgDiv.querySelector(".e-cc.e-ccsearch-icon").classList.add("e-cc-cancel")},e.prototype.removeCancelIcon=function(){this.dlgDiv.querySelector(".e-cc.e-ccsearch-icon").classList.remove("e-cc-cancel")},e.prototype.mOpenDlg=function(){sf.base.Browser.isDevice&&(this.dlgObj.element.querySelector(".e-cc-searchdiv").classList.remove("e-input-focus"),this.dlgObj.element.querySelectorAll(".e-cc-chbox")[0].focus())},e.prototype.getModuleName=function(){return"columnChooser"},e.prototype.hideOpenedDialog=function(){for(var e=[].slice.call(document.getElementsByClassName("e-ccdlg")).filter((function(e){return e.classList.contains("e-popup-open")})),t=0,i=e.length;t<i;t++)(e[t].classList.contains("e-dialog")||this.parent.element.id+"_ccdlg"!==e[t].id)&&e[t].ej2_instances[0].hide()},e.prototype.beforeOpenColumnChooserEvent=function(){var e={requestType:"beforeOpenColumnChooser",element:this.parent.element,columns:this.getColumns(),cancel:!1,searchOperator:this.parent.columnChooserSettings.operator};return this.parent.trigger("beforeOpenColumnChooser",e),this.searchOperator=e.searchOperator,e},e}(),Es=function(){function t(e,t){this.hideColumnInclude=!1,this.foreignKeyData={},this.parent=e,!e.parentDetails&&t&&(this.foreignKeyData=t)}return t.getQuery=function(e,t){var i=t.generateQuery(!0).requiresCount();return t.isRemote()&&(e.groupSettings.enableLazyLoading&&e.groupSettings.columns.length?i.lazyLoad=[]:i.take(e.pageSettings.totalRecordsCount)),i},t.prototype.getFData=function(e,t){return Qi(t,{},e,this.foreignKeyData[t.field])[0]},t.prototype.getGridRowModel=function(e,t,i,r){void 0===r&&(r=0);var n=[],s=t.length;if(s){for(var o=0;o<s;o++,r++){var a={isExpand:!1};a.data=t[o],a.index=r,i.childGrid&&("All"===i.hierarchyPrintMode?a.isExpand=!0:"Expanded"===i.hierarchyPrintMode&&this.parent.expandedRows&&this.parent.expandedRows[r]&&(a.isExpand=i.expandedRows[r].isExpand));var l=new N(a);l.cells=this.generateCells(e,i),n.push(l)}this.processColumns(n)}return n},t.prototype.generateCells=function(t,i){var r=[];if(i.childGridLevel)for(var n=i.childGridLevel,s=0;n>s;s++)r.push(this.generateCell({},e.CellType.Indent));for(var o=0,a=t;o<a.length;o++){var l=a[o];r.push(this.generateCell(l,e.CellType.Data))}return r},t.prototype.getColumnData=function(e){var t,i=this,r=[],n=e.getForeignKeyColumns();if(n.length){for(var s=0;s<n.length;s++){var o="result"in n[s].dataSource?new sf.data.DataManager(n[s].dataSource.result):n[s].dataSource;r.push(o.executeQuery(new sf.data.Query))}t=Promise.all(r).then((function(e){for(var t=0;t<n.length;t++)i.foreignKeyData[n[t].field]=e[t].result}))}return t},t.prototype.getHeaders=function(e,t){this.hideColumnInclude=!!t,this.colDepth=sr(e);for(var i=[],r=0;r<this.colDepth;r++)i[r]=new N({}),i[r].cells=[];return i=this.processColumns(i),{rows:i=this.processHeaderCells(i,e),columns:this.generateActualColumns(e)}},t.prototype.getConvertedWidth=function(e){var t=parseFloat(e);return-1!==e.indexOf("%")?this.parent.element.getBoundingClientRect().width*t/100:t},t.prototype.generateActualColumns=function(e,t){void 0===t&&(t=[]);for(var i=0,r=e;i<r.length;i++){var n=r[i];if(!n.commands)if(n.columns){if(n.visible||this.hideColumnInclude)0!==this.getCellCount(n,0)&&this.generateActualColumns(n.columns,t)}else(n.visible||this.hideColumnInclude)&&t.push(n)}return t},t.prototype.processHeaderCells=function(e,t){for(var i=t,r=0;r<i.length;r++)i[r].commands||(e=this.appendGridCells(i[r],e,0));return e},t.prototype.appendGridCells=function(t,i,r){if(t.columns||!1===t.visible&&!this.hideColumnInclude||t.commands){if(t.columns){var n=this.getCellCount(t,0);n&&i[r].cells.push(new P({cellType:e.CellType.StackedHeader,column:t,colSpan:n}));for(var s=void 0,o=0,a=t.columns.length;o<a;o++)t.columns[o].visible&&!s&&(s=!0),i=this.appendGridCells(t.columns[o],i,r+1)}}else i[r].cells.push(this.generateCell(t,e.CellType.Header,this.colDepth-r,r));return i},t.prototype.generateCell=function(t,i,r,n){var s={visible:t.visible,isDataCell:i===e.CellType.Data,column:t,cellType:i,rowSpan:r,index:n};return(!s.rowSpan||s.rowSpan<2)&&delete s.rowSpan,new P(s)},t.prototype.processColumns=function(t){var i=this.parent,r=[];i.enableColumnVirtualization&&(r=i.getColumnIndexesInView());for(var n=0,s=t.length;n<s;n++)if(i.allowGrouping)for(var o=0,a=i.groupSettings.columns.length;o<a;o++)i.enableColumnVirtualization&&-1===r.indexOf(o)||t[n].cells.splice(0,0,this.generateCell({},e.CellType.HeaderIndent));return t},t.prototype.getCellCount=function(e,t){if(e.columns)for(var i=0;i<e.columns.length;i++)t=this.getCellCount(e.columns[i],t);else(e.visible||this.hideColumnInclude)&&t++;return t},t.prototype.checkAndExport=function(e,t){Object.keys(e).some((function(t){return!e[t]}))||t()},t.prototype.failureHandler=function(e,t,i){var r=this;return function(){e[t.id]=!0,r.checkAndExport(e,i)}},t.prototype.createChildGrid=function(e,t,i,r){var n=new Yt(this.parent.detailRowModule.getGridModel(e,t,i));e.isPrinting=!1;n.parentDetails={parentID:e.element.id,parentPrimaryKeys:e.getPrimaryKeyFieldNames(),parentKeyField:e.childGrid.queryString,parentKeyFieldValue:sf.base.getValue(n.queryString,t.data),parentRowData:t.data};var s=Ri("child-grid"),o=sf.base.createElement("div",{id:s,styles:"display: none"});return document.body.appendChild(o),n.id=s,r[s]=!1,n.isExportGrid=!0,{childGrid:n,element:o}},t.prototype.getGridExportColumns=function(e){for(var t=[],i=0,r=e;i<r.length;i++)"checkbox"!==r[i].type&&t.push(r[i]);return t},t.prototype.getForeignKeyData=function(){return this.foreignKeyData},t}(),Is=function(){function e(e){this.valueFormatter=new a(e),this.internationalization=new sf.base.Internationalization(e)}return e.prototype.returnFormattedValue=function(e,t){return!sf.base.isNullOrUndefined(e.value)&&e.value?this.valueFormatter.getFormatFunction(t)(e.value):""},e.prototype.formatCellValue=function(e){if(e.isForeignKey&&(e.value=sf.base.getValue(e.column.foreignKeyValue,Qi(e.column,{},e.value)[0])),"number"===e.column.type&&void 0!==e.column.format&&""!==e.column.format)return e.value||0===e.value?this.internationalization.getNumberFormat({format:e.column.format})(e.value):"";if("boolean"===e.column.type&&""!==e.value)return e.value?"true":"false";if("date"!==e.column.type&&"datetime"!==e.column.type&&"time"!==e.column.type||void 0===e.column.format)return(sf.base.isNullOrUndefined(e.column.type)||sf.base.isNullOrUndefined(e.value))&&sf.base.isNullOrUndefined(e.value)?"":e.value.toString();if("string"==typeof e.value&&(e.value=new Date(e.value)),"string"==typeof e.column.format){var t=void 0,i=e.column.format;return t="date"===e.column.type?{type:"date",skeleton:i}:"time"===e.column.type?{type:"time",skeleton:i}:{type:"dateTime",skeleton:i},this.returnFormattedValue(e,t)}if(e.column.format instanceof Object&&void 0===e.column.format.type)return e.value.toString();var r=void 0;return r="date"===e.column.type?{type:e.column.format.type,format:e.column.format.format,skeleton:e.column.format.skeleton}:"time"===e.column.type?{type:"time",format:e.column.format.format,skeleton:e.column.format.skeleton}:{type:"dateTime",format:e.column.format.format,skeleton:e.column.format.skeleton},this.returnFormattedValue(e,r)},e}(),Ts=function(){function t(e,t){this.book={},this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.rowLength=1,this.expType="AppendToSheet",this.includeHiddenColumn=!1,this.isCsvExport=!1,this.isElementIdChanged=!1,this.gridPool={},this.sheet={},this.parent=e,this.helper=new Es(e),this.locator=t,this.l10n=this.locator.getService("localization")}return t.prototype.getModuleName=function(){return"ExcelExport"},t.prototype.init=function(e){null!==e.element&&""===e.element.id&&(e.element.id=(new Date).toISOString(),this.isElementIdChanged=!0),this.parent=e,this.parent.isDestroyed||(this.isExporting=void 0,this.book={},this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.rowLength=1,this.footer=void 0,this.expType="AppendToSheet",this.includeHiddenColumn=!1,this.exportValueFormatter=new Is(e.locale),e.id=Ri("main-grid"),this.gridPool[e.id]=!1)},t.prototype.Map=function(e,t,i,r,n,s){var o=e;this.gridPool={},e.childGrid&&(sf.base.isNullOrUndefined(t)||"None"!==t.hierarchyExportMode)&&(e.expandedRows=ir(e).expandedRows);var a={requestType:"beforeExcelExport",gridObject:o,cancel:!1,isMultipleExport:i,workbook:r,isCsv:n,isBlob:s};return o.trigger("beforeExcelExport",a),a.cancel?new Promise((function(e){return e()})):(this.parent.log("exporting_begin",this.getModuleName()),this.data=new B(o),this.isExporting=!0,this.isBlob=a.isBlob,this.isCsvExport=!!a.isCsv&&a.isCsv,ii(t)&&ri(t,o),this.processRecords(o,t,a.isMultipleExport,a.workbook))},t.prototype.exportingSuccess=function(e){this.isExporting=!1,this.parent.trigger("excelExportComplete",this.isBlob?{promise:this.blobPromise}:{}),this.parent.log("exporting_complete",this.getModuleName()),e(this.book),this.sheet.images=[]},t.prototype.processRecords=function(e,t,i,r){var n=this;if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.dataSource)&&t.dataSource instanceof sf.data.DataManager){var s=t.query?t.query:new sf.data.Query;return(sf.base.isNullOrUndefined(s.isCountRequired)||e.aggregates)&&(s.isCountRequired=!0),new Promise((function(o){t.dataSource.executeQuery(s).then((function(s){n.init(e),n.processInnerRecords(e,t,i,r,s).then((function(){n.exportingSuccess(o)}))}))}))}if(sf.base.isNullOrUndefined(t)||"CurrentPage"!==t.exportType){var o=[];return o.push(this.data.getData({},Es.getQuery(e,this.data))),o.push(this.helper.getColumnData(e)),new Promise((function(s,a){Promise.all(o).then((function(o){n.init(e),n.processInnerRecords(e,t,i,r,o[0]).then((function(){n.exportingSuccess(s)}))})).catch((function(e){a(n.book),n.parent.trigger("actionFailure",e)}))}))}return new Promise((function(s){n.init(e),n.processInnerRecords(e,t,i,r,n.parent.getCurrentViewRecords()),n.exportingSuccess(s)}))},t.prototype.processInnerRecords=function(e,t,i,r,n){var s=this;this.groupedColLength=e.groupSettings.columns.length;var o,a=5,l=[],h=sr(e.columns),d=!sf.base.isNullOrUndefined(t);return d&&!sf.base.isNullOrUndefined(t.multipleExport)&&(this.expType=sf.base.isNullOrUndefined(t.multipleExport.type)?"AppendToSheet":t.multipleExport.type,sf.base.isNullOrUndefined(t.multipleExport.blankRows)||(a=t.multipleExport.blankRows)),sf.base.isNullOrUndefined(r)?(this.workSheet=[],this.rows=[],this.columns=[],this.styles=[]):"NewSheet"===this.expType?(this.workSheet=r.worksheets,this.rows=[],this.columns=[],this.styles=r.styles):(this.workSheet=[],this.rows=r.worksheets[0].rows,this.columns=r.worksheets[0].columns,this.styles=r.styles,this.rowLength=this.rows[this.rows.length-1].index+a,this.rowLength++),d&&(sf.base.isNullOrUndefined(i)?(sf.base.isNullOrUndefined(t.header)||this.processExcelHeader(JSON.parse(JSON.stringify(t.header))),sf.base.isNullOrUndefined(t.footer)||(this.footer=JSON.parse(JSON.stringify(t.footer)))):(sf.base.isNullOrUndefined(t.header)||!i&&"NewSheet"!==this.expType||this.processExcelHeader(JSON.parse(JSON.stringify(t.header))),sf.base.isNullOrUndefined(t.footer)||"AppendToSheet"===this.expType&&i||(this.footer=JSON.parse(JSON.stringify(t.footer))))),this.includeHiddenColumn=!!d&&t.includeHiddenColumn,new Promise((function(i,r){e.childGridLevel=0,l=s.processGridExport(e,t,n),s.globalResolve=i,s.gridPool[e.id]=!0,s.helper.checkAndExport(s.gridPool,s.globalResolve)})).then((function(){var n=[];if(s.organiseRows(l,l[0].index,n),s.rows=s.rows.concat(n),sf.base.isNullOrUndefined(s.footer)||("AppendToSheet"===s.expType&&!i||"NewSheet"===s.expType)&&s.processExcelFooter(s.footer),s.columns.length>0&&(s.sheet.columns=s.columns),s.sheet.rows=s.rows,s.sheet.enableRtl=s.parent.enableRtl,s.parent.allowFiltering&&e.getVisibleColumns().length&&d&&t.enableFilter){var a=t.header?t.header.headerRows||t.header.rows.length:0,p={row:h+a,column:s.groupedColLength?s.groupedColLength+1:s.sheet.columns[0].index,lastRow:s.sheet.rows.length,lastColumn:s.sheet.columns.length};s.sheet.autoFilters=p}if(s.workSheet.push(s.sheet),s.book.worksheets=s.workSheet,s.book.styles=s.styles,e.notify("finalPageSetup",s.book),!i){if(s.isCsvExport){d&&!sf.base.isNullOrUndefined(t.separator)&&","!==t.separator&&(o=t.separator);var c=new sf.excelexport.Workbook(s.book,"csv",e.locale,e.currencyCode,o);s.isBlob?s.blobPromise=c.saveAsBlob("text/csv"):d&&t.fileName?c.save(t.fileName):c.save("Export.csv")}else{c=new sf.excelexport.Workbook(s.book,"xlsx",e.locale,e.currencyCode);s.isBlob?s.blobPromise=c.saveAsBlob("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"):d&&t.fileName?c.save(t.fileName):c.save("Export.xlsx")}s.isElementIdChanged&&(e.element.id=""),delete e.expandedRows}return r}))},t.prototype.organiseRows=function(e,t,i){if(!e.length)return t;for(var r=0;r<e.length;r++){var n=e[r],s=n.childRows;s?(n.index=t++,delete n.childRows,i.push(n),t=this.organiseRows(s,t,i)):(n.index=t++,i.push(n))}return t},t.prototype.processGridExport=function(e,t,i){var r=[],n=this.parent.isFrozenGrid()&&!this.parent.getFrozenColumns();sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.theme)||(this.theme=t.theme),e.childGrid&&!sf.base.isNullOrUndefined(t)&&(e.hierarchyPrintMode=t.hierarchyExportMode||"Expanded");var s=new Es(e,this.helper.getForeignKeyData()),o=ii(t)?fi(t.columns,e.enableColumnVirtualization):s.getGridExportColumns(n?e.getColumns():e.columns),a=s.getHeaders(o,this.includeHiddenColumn),l=e.groupSettings.columns.length;return r=this.processHeaderContent(e,a,l,r),r=sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.dataSource)||t.dataSource instanceof sf.data.DataManager?sf.base.isNullOrUndefined(t)||"CurrentPage"!==t.exportType?this.processRecordContent(e,i,a,t,void 0,r,s):this.processRecordContent(e,i,a,t,e.currentViewData,r,s):this.processRecordContent(e,i,a,t,t.dataSource,r,s),e.notify("export-DataBound",{excelRows:r,type:"excel"}),r},t.prototype.processRecordContent=function(e,t,i,r,n,s,o){var a;if(a=!sf.base.isNullOrUndefined(n)&&n.length?n:t.result,sf.base.isNullOrUndefined(a.level)?this.processRecordRows(e,a,i,0,0,r,s,o):this.processGroupedRows(e,a,i,a.level,0,r,s,o),!sf.base.isNullOrUndefined(t.aggregates))if(sf.base.isNullOrUndefined(n)){var l=t.result.GroupGuid?t.result.records:t.result;this.processAggregates(e,l,s)}else this.processAggregates(e,t.result,s,n);return s},t.prototype.processGroupedRows=function(e,t,i,r,n,s,o,a){for(var l=0,h=t;l<h.length;l++){var d=h[l],p=[],c={};c.index=1+r;var u=e.getColumnByField(d.field),f={value:d.key,column:u,style:void 0,isForeignKey:u.isForeignColumn()},g=e.getColumnByField(d.field).headerText+": "+(u.enableGroupByFormat?d.key:this.exportValueFormatter.formatCellValue(f))+" - ";d.count>1?g+=d.count+" items":g+=d.count+" item";var m={captionText:g,type:this.isCsvExport?"CSV":"Excel"};this.parent.trigger("exportGroupCaption",m),c.value=m.captionText,c.style=this.getCaptionThemeStyle(this.theme);var y=new ue(e).generateRows(d);if(this.fillAggregates(e,y,t.level+t.childLevels,o,this.rowLength),p.push(c),o[o.length-1].cells.length>0){for(var v=t.level+t.childLevels+y[0].cells.length,b=0,C=0,w=o[o.length-1].cells;C<w.length;C++){var S=w[C];S.index<v&&(v=S.index),S.index>b&&(b=S.index),p[p.length-1].index!==S.index&&p.push(S)}for(v-c.index>1&&(c.colSpan=v-c.index);b<i.columns.length+r+t.childLevels;){var x={};x.index=b+1,x.style=this.getCaptionThemeStyle(this.theme),p.push(x),b++}}else{for(var R=0,F=0,E=i.columns;F<E.length;F++){E[F].visible&&R++}c.colSpan=t.childLevels+R}if(o[o.length-1].cells=p,this.rowLength++,this.groupedColLength<8&&r>1){var I={outlineLevel:r-1,isCollapsed:!0};o[o.length-1].grouping=I}!sf.base.isNullOrUndefined(t.childLevels)&&t.childLevels>0?(this.processGroupedRows(e,d.items,i,d.items.level,n,s,o,a),this.processAggregates(e,d,o,void 0,r+t.childLevels,!0)):(n=this.processRecordRows(e,d.items,i,r,n,s,o,a),this.processAggregates(e,d,o,void 0,r,!0))}},t.prototype.processRecordRows=function(t,i,r,n,s,o,a,l){for(var h=1,d=[],p=r.columns,c=0,u=l.getGridRowModel(p,i,t,s);c<u.length;c++){var f=u[c];d=[],s++,h=1;for(var g=void 0,m=0,y=f.cells.length;m<y;m++){var v=f.cells[m];if(v.cellType===e.CellType.Data){var b=v.column,C=b.field,w=sf.base.isNullOrUndefined(C)?"":b.valueAccessor(C,f.data,b),S=sf.base.isNullOrUndefined(w)?"":w,x=void 0;if(b.isForeignColumn&&b.isForeignColumn()&&(x=l.getFData(S,b),S=sf.base.getValue(b.foreignKeyValue,x)),!sf.base.isNullOrUndefined(S)){var R={},F=h+n+t.childGridLevel,E={data:f.data,column:b,foreignKeyData:x,value:S,style:void 0,colSpan:1,cell:R};if(t.trigger("excelQueryCellInfo",E),sf.base.isNullOrUndefined(E.image)||sf.base.isNullOrUndefined(E.image.base64)||(g=this.setImage(E,F)),sf.base.isNullOrUndefined(E.hyperLink)||(E.cell.hyperlink={target:E.hyperLink.target},E.value=E.hyperLink.displayText||E.value),(R=E.cell).index=F,R.value=E.value,""===E.data&&t.childGridLevel&&1===h){var I={hAlign:"left"};E={style:I},R.colSpan=t.getVisibleColumns().length,R.value=this.l10n.getConstant("EmptyRecord")}if(E.colSpan>1&&(R.colSpan=E.colSpan),sf.base.isNullOrUndefined(E.style))R.style={name:t.element.id+"column"+(h+n)};else{var T=this.getColumnStyle(t,h+n);R.style=this.mergeOptions(this.styles[T],E.style)}d.push(R)}h++}}var z={index:this.rowLength++,cells:d};if(sf.base.isNullOrUndefined(g)||(z.height=g),this.groupedColLength<8&&n>0?(z.grouping={outlineLevel:n,isCollapsed:!0},a.push(z)):a.push(z),!sf.base.isNullOrUndefined(t.childGrid)){t.isPrinting=!0;var D=!sf.base.isNullOrUndefined(o)&&o.exportType?o.exportType:"AllPages",M=this.helper.createChildGrid(t,f,D,this.gridPool),O=M.childGrid,k=M.element;O.actionFailure=l.failureHandler(this.gridPool,O,this.globalResolve),O.childGridLevel=t.childGridLevel+1;var A={childGrid:O,row:f,exportProperties:o};this.parent.trigger("exportDetailDataBound",A),O.beforeDataBound=this.childGridCell(z,O,o,f),O.appendTo(k)}t.notify("export-RowDataBound",{rowObj:f,type:"excel",excelRows:a})}return s},t.prototype.setImage=function(e,t){sf.base.isNullOrUndefined(this.sheet.images)&&(this.sheet.images=[]);var i={image:e.image.base64,row:this.rowLength,column:t,lastRow:this.rowLength,lastColumn:t};return this.sheet.images.push(i),this.columns[t-1].width=e.image.width||this.columns[t-1].width,e.image.height||50},t.prototype.childGridCell=function(e,t,i,r){var n=this;return function(s){t.beforeDataBound=null,s.cancel=!0,0===s.result.length&&(s.result=[""]),e.childRows=n.processGridExport(t,i,s);for(var o=n.parent.groupSettings.columns.length,a=e.childRows,l=0;l<a.length;l++)a[l].grouping={outlineLevel:o+t.childGridLevel,isCollapsed:!r.isExpand,isHidden:!r.isExpand};return t.destroy(),sf.base.detach(t.element),n.gridPool[t.id]=!0,n.helper.checkAndExport(n.gridPool,n.globalResolve),e}},t.prototype.processAggregates=function(e,t,i,r,n,s){var o=new pe(e),a=o.getColumns();a=a.filter((function(e){return sf.base.isNullOrUndefined(e.commands)&&"checkbox"!==e.type})),e.aggregates.length&&this.parent!==e&&e.aggregateModule.prepareSummaryInfo();var l=void 0;if(l=sf.base.isNullOrUndefined(r)?t:r,void 0===n&&(n=0),e.groupSettings.columns.length>0&&s){var h=new ce(e).generateRows(l,{level:l.level});h.length>0&&(i=this.fillAggregates(e,h,n,i))}else{n=e.groupSettings.columns.length>0&&!s?e.groupSettings.columns.length:n;var d=o.generateRows(l,t.aggregates,null,null,a);d.length>0&&!s&&(i=this.fillAggregates(e,d,n,i))}return i},t.prototype.fillAggregates=function(t,i,r,n,s){for(var o=0,a=i;o<a.length;o++){for(var l=a[o],h=[],d=!0,p=0,c=0,u=l.cells;c<u.length;c++){var f=u[c],g={};if(f.cellType!==e.CellType.DetailFooterIntent&&(f.visible||this.includeHiddenColumn))if(p++,f.isDataCell){d=!1;var m=!sf.base.isNullOrUndefined(f.column.footerTemplate),y=!sf.base.isNullOrUndefined(f.column.groupFooterTemplate),v=!sf.base.isNullOrUndefined(f.column.groupCaptionTemplate);if(g.index=p+r+t.childGridLevel,m)g.value=this.getAggreateValue(e.CellType.Summary,f.column.footerTemplate,f,l);else if(y)g.value=this.getAggreateValue(e.CellType.GroupSummary,f.column.groupFooterTemplate,f,l);else if(v)g.value=this.getAggreateValue(e.CellType.CaptionSummary,f.column.groupCaptionTemplate,f,l);else for(var b=0,C=Object.keys(l.data[f.column.field]);b<C.length;b++){C[b]===f.column.type&&(sf.base.isNullOrUndefined(l.data[f.column.field].Sum)?sf.base.isNullOrUndefined(l.data[f.column.field].Average)?sf.base.isNullOrUndefined(l.data[f.column.field].Max)?sf.base.isNullOrUndefined(l.data[f.column.field].Min)?sf.base.isNullOrUndefined(l.data[f.column.field].Count)?sf.base.isNullOrUndefined(l.data[f.column.field].TrueCount)?sf.base.isNullOrUndefined(l.data[f.column.field].FalseCount)?sf.base.isNullOrUndefined(l.data[f.column.field].Custom)||(g.value=l.data[f.column.field].Custom):g.value=l.data[f.column.field][f.column.field+" - falsecount"]:g.value=l.data[f.column.field][f.column.field+" - truecount"]:g.value=l.data[f.column.field][f.column.field+" - count"]:g.value=l.data[f.column.field][f.column.field+" - min"]:g.value=l.data[f.column.field][f.column.field+" - max"]:g.value=l.data[f.column.field][f.column.field+" - average"]:g.value=l.data[f.column.field][f.column.field+" - sum"])}g.style=this.getCaptionThemeStyle(this.theme),this.aggregateStyle(f.column,g.style,f.column.field);var w=f.attributes.style;w.textAlign&&(g.style.hAlign=w.textAlign.toLowerCase());var S={row:l,type:m?"Footer":y?"GroupFooter":"GroupCaption",style:g};this.parent.trigger("excelAggregateQueryCellInfo",S),h.push(g)}else void 0===s&&(g.index=p+r+t.childGridLevel,g.style=this.getCaptionThemeStyle(this.theme),h.push(g))}if(sf.base.isNullOrUndefined(s)){var x={};if(this.groupedColLength<8&&this.groupedColLength>0){var R={outlineLevel:n[n.length-1].grouping.outlineLevel,isCollapsed:!0};x={index:this.rowLength++,cells:h,grouping:R}}else x={index:this.rowLength++,cells:h};d||n.push(x)}else n.push({index:s,cells:h})}return n},t.prototype.aggregateStyle=function(e,t,r){var n=this.parent.getColumnByField(r);if("object"===i(e.format)){var s=e.format;t.numberFormat=sf.base.isNullOrUndefined(s.format)?s.skeleton:s.format,sf.base.isNullOrUndefined(s.type)||(t.type=s.type.toLowerCase())}else t.numberFormat=e.format;!sf.base.isNullOrUndefined(n)&&sf.base.isNullOrUndefined(t.type)&&(t.type=n.type.toLowerCase())},t.prototype.getAggreateValue=function(t,i,r,n){var s,o={};o[sf.base.getEnumValue(e.CellType,r.cellType)]=sf.base.compile(i);var a=n.data[r.column.field?r.column.field:r.column.columnName];return this.parent.isReact||this.parent.isVue?(s=o[sf.base.getEnumValue(e.CellType,r.cellType)](a,this.parent),this.parent.isReact&&this.parent.renderTemplates()):s=o[sf.base.getEnumValue(e.CellType,r.cellType)](a),s[0].textContent},t.prototype.mergeOptions=function(e,t){for(var i={},r=Object.keys(e),n=0;n<r.length;n++)"name"!==r[n]&&(i[r[n]]=e[r[n]]);r=Object.keys(t);for(n=0;n<r.length;n++)"name"!==r[n]&&(i[r[n]]=t[r[n]]);return i},t.prototype.getColumnStyle=function(e,t){for(var i=0,r=0,n=this.styles;r<n.length;r++){if(n[r].name===e.element.id+"column"+t)return i;i++}},t.prototype.processHeaderContent=function(t,i,r,n){var s,o=i.rows,a=i.columns,l=[];if(r>0)for(var h=0;h!==r;)this.columns.push({index:h+1,width:30}),h++;for(var d=0;d<a.length;d++)this.parseStyles(t,a[d],this.getRecordThemeStyle(this.theme),r+d+1);for(var p=0;p<o.length;p++){for(var c=1+r,u=[],f=0;f<o[p].cells.length;f++){var g={},m={},y=o[p].cells[f];if(y.cellType!==e.CellType.HeaderIndent&&y.cellType!==e.CellType.DetailHeader){for(var v={contains:!0,index:1};v.contains;)if(c=(v=this.getIndex(l,1,c)).index,!v.contains){m.index=v.index+t.childGridLevel;break}if(!sf.base.isNullOrUndefined(y.rowSpan)&&1!==y.rowSpan){m.rowSpan=y.rowSpan;for(var b=1;b<y.rowSpan+1;b++){var C={rowIndex:0,columnIndex:0};C.rowIndex=b,C.columnIndex=c,l.push(C)}}sf.base.isNullOrUndefined(y.colSpan)||1===y.colSpan||(m.colSpan=y.colSpan,c=c+m.colSpan-1),m.value=y.column.headerText,g=this.getHeaderThemeStyle(this.theme),sf.base.isNullOrUndefined(y.column.textAlign)||(g.hAlign=y.column.textAlign.toLowerCase()),sf.base.isNullOrUndefined(y.column.headerTextAlign)||(g.hAlign=y.column.headerTextAlign.toLowerCase());var w={cell:m,gridCell:y,style:g};t.trigger("excelHeaderQueryCellInfo",w),sf.base.isNullOrUndefined(w.image)||sf.base.isNullOrUndefined(w.image.base64)||(s=this.setImage(w,c)),sf.base.isNullOrUndefined(w.hyperLink)||(w.cell.hyperlink={target:w.hyperLink.target},m.value=w.hyperLink.displayText||m.value),m.style=w.style,u.push(m),c++}}var S={index:this.rowLength++,cells:u};sf.base.isNullOrUndefined(s)||(S.height=s),n.push(S)}return n},t.prototype.getHeaderThemeStyle=function(e){var t={fontSize:12,borders:{color:"#E0E0E0"},bold:!0};return sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e.header)||(t=this.updateThemeStyle(e.header,t)),t},t.prototype.updateThemeStyle=function(e,t){return sf.base.extend(t,e)},t.prototype.getCaptionThemeStyle=function(e){var t={fontSize:13,backColor:"#F6F6F6"};return sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e.caption)||(t=this.updateThemeStyle(e.caption,t)),t},t.prototype.getRecordThemeStyle=function(e){var t={fontSize:13,borders:{color:"#E0E0E0"}};return sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e.record)||(t=this.updateThemeStyle(e.record,t)),t},t.prototype.processExcelHeader=function(e){if(!sf.base.isNullOrUndefined(e.rows)&&("NewSheet"===this.expType||1===this.rowLength)){var t=void 0;void 0===e.headerRows?this.rowLength=e.rows.length:this.rowLength=e.headerRows,t=this.rowLength<e.rows.length?this.rowLength:e.rows.length,this.rowLength++;for(var i=0;i<t;i++){var r=e.rows[i];(null===r.index||sf.base.isNullOrUndefined(r.index))&&(r.index=i+1),this.updatedCellIndex(r)}}},t.prototype.updatedCellIndex=function(e){for(var t=e.cells.length,i=0;i<t;i++){var r=e.cells[i];(null===r.index||sf.base.isNullOrUndefined(r.index))&&(r.index=i+1)}this.rows.push(e)},t.prototype.processExcelFooter=function(e){if(!sf.base.isNullOrUndefined(e.rows)){var t=void 0;void 0===e.footerRows?this.rowLength+=e.rows.length:e.footerRows>e.rows.length?(this.rowLength+=e.footerRows-e.rows.length,t=e.rows.length):t=e.footerRows;for(var i=0;i<t;i++){var r=e.rows[i];null===r.index||void 0===r.index?r.index=this.rowLength++:r.index+=this.rowLength,this.updatedCellIndex(r)}}},t.prototype.getIndex=function(e,t,i){for(var r=0,n=e;r<n.length;r++){var s=n[r];if(s.rowIndex===t&&s.columnIndex===i)return{contains:!0,index:i+=1}}return{contains:!1,index:i}},t.prototype.parseStyles=function(e,t,r,n){if(!sf.base.isNullOrUndefined(t.format))if("object"===i(t.format)){var s=t.format;r.numberFormat=sf.base.isNullOrUndefined(s.format)?s.skeleton:s.format,sf.base.isNullOrUndefined(s.type)||(r.type=s.type.toLowerCase())}else r.numberFormat=t.format,r.type=t.type;sf.base.isNullOrUndefined(t.textAlign)||(r.hAlign=t.textAlign.toLowerCase()),Object.keys(r).length>0&&(r.name=e.element.id+"column"+n,this.styles.push(r)),sf.base.isNullOrUndefined(t.width)||"auto"===t.width||this.columns.push({index:n+e.childGridLevel,width:"number"==typeof t.width?t.width:this.helper.getConvertedWidth(t.width)})},t.prototype.destroy=function(){},t}(),zs=function(){function t(e){this.hideColumnInclude=!1,this.currentViewData=!1,this.customDataSource=!1,this.isGrouping=!1,this.headerOnPages=[],this.drawPosition={xPosition:0,yPosition:0},this.parent=e,this.helper=new Es(e),this.gridPool={}}return t.prototype.getModuleName=function(){return"PdfExport"},t.prototype.init=function(e){this.exportValueFormatter=new Is(e.locale),this.pdfDocument=void 0,this.hideColumnInclude=!1,this.currentViewData=!1,this.parent=e,this.isGrouping=!1,this.isExporting=!0,e.id=Ri("main-grid"),this.gridPool[e.id]=!1,this.pdfPageSettings=new sf.pdfexport.PdfPageSettings},t.prototype.exportWithData=function(e,t,i,r,n,s,o){var a=this;this.init(e),sf.base.isNullOrUndefined(t)?this.pdfDocument=new sf.pdfexport.PdfDocument:this.pdfDocument=t,this.processExport(e,r,n,s).then((function(){a.isExporting=!1,e.trigger("pdfExportComplete",a.isBlob?{promise:a.blobPromise}:{}),a.parent.log("exporting_complete",a.getModuleName()),i(a.pdfDocument)})).catch((function(e){o(a.pdfDocument),a.parent.trigger("actionFailure",e)}))},t.prototype.Map=function(e,t,i,r,n){var s=this;this.data=new B(this.parent),this.isBlob=n,this.gridPool={};var o=new sf.data.Query;e.childGrid&&(sf.base.isNullOrUndefined(t)||"None"!==t.hierarchyExportMode)&&(e.expandedRows=ir(e).expandedRows);var a={requestType:"beforePdfExport",cancel:!1,headerPageNumbers:[],gridDrawPosition:{xPosition:0,yPosition:0},generateQuery:!1};a.gridObject=e;if(e.trigger("beforePdfExport",a),!0===a.cancel)return new Promise((function(e,t){return e()}));if(ii(t)&&ri(t,e),a.generateQuery&&(o=Es.getQuery(e,this.data)),this.headerOnPages=a.headerPageNumbers,this.drawPosition=a.gridDrawPosition,this.parent.log("exporting_begin",this.getModuleName()),!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.dataSource)&&t.dataSource instanceof sf.data.DataManager)return new Promise((function(n,a){t.dataSource.executeQuery(o).then((function(o){s.exportWithData(e,r,n,o,t,i,a)}))}));if(sf.base.isNullOrUndefined(t)||"CurrentPage"!==t.exportType){var l=[];return l.push(this.data.getData({},Es.getQuery(e,this.data))),l.push(this.helper.getColumnData(e)),new Promise((function(n,o){Promise.all(l).then((function(a){s.init(e),sf.base.isNullOrUndefined(r)?s.pdfDocument=new sf.pdfexport.PdfDocument:s.pdfDocument=r,s.processExport(e,a[0],t,i).then((function(){s.isExporting=!1,e.trigger("pdfExportComplete",s.isBlob?{promise:s.blobPromise}:{}),s.parent.log("exporting_complete",s.getModuleName()),n(s.pdfDocument)})).catch((function(e){o(s.pdfDocument),s.parent.trigger("actionFailure",e)}))}))}))}return new Promise((function(n,o){s.exportWithData(e,r,n,s.parent.getCurrentViewRecords(),t,i,o)}))},t.prototype.processExport=function(e,t,i,r){var n,s=this,o=this.pdfDocument.sections.add();this.processSectionExportProperties(o,i);var a=o.pages.add();return new Promise((function(r,o){n=s.processGridExport(e,t,i),s.globalResolve=r,s.gridPool[e.id]=!0,s.helper.checkAndExport(s.gridPool,s.globalResolve)})).then((function(){return n.draw(a,s.drawPosition.xPosition,s.drawPosition.yPosition),s.drawHeader(i),r||(s.isBlob?s.blobPromise=s.pdfDocument.save():!sf.base.isNullOrUndefined(i)&&i.fileName?s.pdfDocument.save(i.fileName):s.pdfDocument.save("Export.pdf"),s.pdfDocument.destroy(),delete e.expandedRows),s.pdfDocument}))},t.prototype.processSectionExportProperties=function(e,t){return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.pageOrientation)&&sf.base.isNullOrUndefined(t.pageSize)||(this.pdfPageSettings.orientation="Landscape"===t.pageOrientation?sf.pdfexport.PdfPageOrientation.Landscape:sf.pdfexport.PdfPageOrientation.Portrait,this.pdfPageSettings.size=this.getPageSize(t.pageSize),e.setPageSettings(this.pdfPageSettings)),e},t.prototype.processGridExport=function(e,t,i){var r=!0,n=this.parent.isFrozenGrid()&&!this.parent.getFrozenColumns();sf.base.isNullOrUndefined(i)||(this.gridTheme=i.theme,r=!!sf.base.isNullOrUndefined(i.allowHorizontalOverflow)||i.allowHorizontalOverflow);var s=new Es(e,this.helper.getForeignKeyData()),o=this.processExportProperties(i,t.result),a=ii(i)?fi(i.columns,e.enableColumnVirtualization):s.getGridExportColumns(n?e.getColumns():e.columns);a=a.filter((function(e){return sf.base.isNullOrUndefined(e.commands)}));var l=!1;e.groupSettings.columns.length&&(l=!0),e.childGrid&&!sf.base.isNullOrUndefined(i)&&(e.hierarchyPrintMode=i.hierarchyExportMode||"Expanded");var h=new sf.pdfexport.PdfGrid,d=this.getHeaderThemeStyle(),p=d.border,c=d.font,u=d.brush,f=s.getHeaders(a,this.hideColumnInclude),g=f.columns;h=this.processGridHeaders(e.groupSettings.columns.length,h,f.rows,g,p,c,u,e,r,a),this.setColumnProperties(g,h,s,e,r);var m=this.getSummaryCaptionThemeStyle();if(!sf.base.isNullOrUndefined(o)&&o.length){if(l?(sf.base.isNullOrUndefined(m.border)||(p=m.border),this.processGroupedRecords(h,o,g,e,p,0,m.font,m.brush,m.backgroundBrush,t,i,s,0)):this.processRecord(p,g,e,o,h,0,i,s,0),!sf.base.isNullOrUndefined(t.aggregates)){var y=new pe(e),v=void 0,b=y.getColumns();b=b.filter((function(e){return sf.base.isNullOrUndefined(e.commands)&&"checkbox"!==e.type})),e.aggregates.length&&this.parent!==e&&e.aggregateModule.prepareSummaryInfo(),v=this.customDataSource?y.generateRows(o,t.aggregates):this.currentViewData?y.generateRows(this.parent.getCurrentViewRecords(),t.aggregates):l?y.generateRows(o.records,t.aggregates):y.generateRows(t.result,t.aggregates,null,null,b),this.processAggregates(v,h,p,m.font,m.brush,m.backgroundBrush,!1)}}else h.rows.addRow().style.setBorder(p);return h},t.prototype.getSummaryCaptionThemeStyle=function(){if(sf.base.isNullOrUndefined(this.gridTheme)||sf.base.isNullOrUndefined(this.gridTheme.caption))return{font:new sf.pdfexport.PdfStandardFont(sf.pdfexport.PdfFontFamily.Helvetica,9.75),brush:new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(0,0,0)),backgroundBrush:new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(246,246,246))};var e=sf.base.isNullOrUndefined(this.gridTheme.caption.fontSize)?9.75:this.gridTheme.caption.fontSize,t=sf.base.isNullOrUndefined(this.gridTheme.caption.fontName)?sf.pdfexport.PdfFontFamily.Helvetica:this.getFontFamily(this.gridTheme.caption.fontName),i=this.getFontStyle(this.gridTheme.caption),r=new sf.pdfexport.PdfColor(0,0,0);if(!sf.base.isNullOrUndefined(this.gridTheme.caption.fontColor)){var n=this.hexToRgb(this.gridTheme.caption.fontColor);r=new sf.pdfexport.PdfColor(n.r,n.g,n.b)}var s=this.gridTheme.caption.border?this.getBorderStyle(this.gridTheme.caption.border):null,o=new sf.pdfexport.PdfStandardFont(t,e,i);return sf.base.isNullOrUndefined(this.gridTheme.caption.font)||(o=this.gridTheme.caption.font),{font:o,brush:new sf.pdfexport.PdfSolidBrush(r),backgroundBrush:new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(246,246,246)),border:s}},t.prototype.getGridPdfFont=function(e){var t=0;if(e.header&&e.header.font){var i=e.header.font.fontFamily,r=e.header.font.fontSize,n=e.header.font.fontStyle;if(t=sf.base.isNullOrUndefined(sf.pdfexport.PdfFontStyle[n])?0:sf.pdfexport.PdfFontStyle[n],e.header.font.isTrueType)e.header.font=new sf.pdfexport.PdfTrueTypeFont(i,r,t);else{var s=sf.base.isNullOrUndefined(i)?sf.pdfexport.PdfFontFamily.Helvetica:this.getFontFamily(i);e.header.font=new sf.pdfexport.PdfStandardFont(s,r,t)}}if(e.caption&&e.caption.font){var o=e.caption.font.fontFamily,a=e.caption.font.fontSize,l=e.caption.font.fontStyle;if(t=sf.base.isNullOrUndefined(sf.pdfexport.PdfFontStyle[l])?0:sf.pdfexport.PdfFontStyle[l],e.caption.font.isTrueType)e.caption.font=new sf.pdfexport.PdfTrueTypeFont(o,a,t);else{var h=sf.base.isNullOrUndefined(o)?sf.pdfexport.PdfFontFamily.Helvetica:this.getFontFamily(o);e.caption.font=new sf.pdfexport.PdfStandardFont(h,a,t)}}if(e.record&&e.record.font){var d=e.record.font.fontFamily,p=e.record.font.fontSize,c=e.record.font.fontStyle;if(t=sf.base.isNullOrUndefined(sf.pdfexport.PdfFontStyle[c])?0:sf.pdfexport.PdfFontStyle[c],e.record.font.isTrueType)e.record.font=new sf.pdfexport.PdfTrueTypeFont(d,p,t);else{var u=sf.base.isNullOrUndefined(d)?sf.pdfexport.PdfFontFamily.Helvetica:this.getFontFamily(d);e.record.font=new sf.pdfexport.PdfStandardFont(u,p,t)}}},t.prototype.getHeaderThemeStyle=function(){var e=new sf.pdfexport.PdfBorders;if(sf.base.isNullOrUndefined(this.gridTheme)||sf.base.isNullOrUndefined(this.gridTheme.header))return e.all=new sf.pdfexport.PdfPen(new sf.pdfexport.PdfColor(234,234,234)),{border:e,font:new sf.pdfexport.PdfStandardFont(sf.pdfexport.PdfFontFamily.Helvetica,10.5),brush:new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(102,102,102))};var t=sf.base.isNullOrUndefined(this.gridTheme.header.fontName)?sf.pdfexport.PdfFontFamily.Helvetica:this.getFontFamily(this.gridTheme.header.fontName),i=this.getFontStyle(this.gridTheme.header),r=sf.base.isNullOrUndefined(this.gridTheme.header.fontSize)?10.5:this.gridTheme.header.fontSize,n=new sf.pdfexport.PdfColor;if(!sf.base.isNullOrUndefined(this.gridTheme.header.fontColor)){var s=this.hexToRgb(this.gridTheme.header.fontColor);n=new sf.pdfexport.PdfColor(s.r,s.g,s.b)}var o=new sf.pdfexport.PdfStandardFont(t,r,i);return sf.base.isNullOrUndefined(this.gridTheme.header.font)||(o=this.gridTheme.header.font),{border:this.getBorderStyle(this.gridTheme.header.border),font:o,brush:new sf.pdfexport.PdfSolidBrush(n)}},t.prototype.processGroupedRecords=function(e,t,i,r,n,s,o,a,l,h,d,p,c){for(var u=this,f=s,g=function(s){var g=e.rows.addRow(),y=r.getColumnByField(s.field),v={value:s.key,column:y,style:void 0,isForeignKey:y.isForeignColumn()},b={captionText:m.parent.getColumnByField(s.field).headerText+": "+(y.enableGroupByFormat?s.key:m.exportValueFormatter.formatCellValue(v))+" - "+s.count+(t.count>1?" items":" item"),type:"PDF"};m.parent.trigger("exportGroupCaption",b,(function(m){var y;g.cells.getCell(f).value=m.captionText,g.cells.getCell(f+1).style.stringFormat=new sf.pdfexport.PdfStringFormat(sf.pdfexport.PdfTextAlignment.Left),g.style.setBorder(n),g.style.setFont(o),g.style.setTextBrush(a),g.style.setBackgroundBrush(l);var v=new ue(r);if(y=sf.base.isNullOrUndefined(s.items.records)?v.generateRows(s.items,s):v.generateRows(s.items.records,s),sf.base.isNullOrUndefined(y)||0!==y.length||(g.cells.getCell(f+1).columnSpan=e.columns.count-(f+1)),!sf.base.isNullOrUndefined(t.childLevels)&&t.childLevels>0){u.processAggregates(y,e,n,o,a,l,!0,g,f),u.processGroupedRecords(e,s.items,i,r,n,f+1,o,a,l,h,d,p,c),y=new ce(r).generateRows(s.items.records,s),u.processAggregates(y,e,n,o,a,l,!1)}else{u.processAggregates(y,e,n,o,a,l,!0,g,f),c=u.processRecord(n,i,r,s.items,e,f+1,d,p,c),y=new ce(r).generateRows(s.items,s);u.processAggregates(y,e,n,o,a,l,!1,null,null,!0)}}))},m=this,y=0,v=t;y<v.length;y++){g(v[y])}},t.prototype.processGridHeaders=function(t,i,r,n,s,o,a,l,h,d){var p=this,c=n.length+t,u=sr(d),f=d,g=0;this.parent.allowGrouping&&(g=this.parent.groupSettings.columns.length),i.columns.add(c),i.headers.add(r.length);var m=function(t,n,l,h,d){var c=i.headers.getHeader(t),u=c.cells.getCell(n),f=r[t].cells[n];sf.base.isNullOrUndefined(l.headerTextAlign)||(u.style.stringFormat=p.getHorizontalAlignment(l.headerTextAlign)),h>0&&(u.rowSpan=h,u.style.stringFormat=p.getVerticalAlignment("Bottom",u.style.stringFormat,l.textAlign)),d>0&&(u.columnSpan=d),c.style.setBorder(s),c.style.setFont(o),c.style.setTextBrush(a),u.value=l.headerText,sf.base.isNullOrUndefined(f)||f.cellType!==e.CellType.HeaderIndent&&f.cellType!==e.CellType.DetailHeader||(u.value="",u.width=20);var g={cell:u,gridCell:f,style:u.style};p.parent.trigger("pdfHeaderQueryCellInfo",g);var m=g;sf.base.isNullOrUndefined(m.image)||(u.value=new sf.pdfexport.PdfBitmap(m.image.base64)),sf.base.isNullOrUndefined(m.hyperLink)||(u.value=p.setHyperLink(m))};return function e(t,i,r,n,s,o){for(var a=0,l=0;l<t.length;l++)if(o&&(n=a=a+r+(0===l?0:-1),r=0),o||t[l].visible||(n-=1),t[l].columns&&t[l].columns.length){var h=e(t[l].columns,i-1,0,l+n,s+1,!1);m(s,l+n+g,t[l],0,h),r+=h,n=n+h-1}else(t[l].visible||p.hideColumnInclude)&&(r++,m(s,l+n+g,t[l],i,0));return r}(f,u,0,0,0,!0),i.columns.count>=6&&h&&(i.style.allowHorizontalOverflow=!0),i},t.prototype.processExportProperties=function(e,t){if(sf.base.isNullOrUndefined(e))this.currentViewData=!1,this.customDataSource=!1;else{sf.base.isNullOrUndefined(e.theme)||(this.gridTheme=e.theme);var i=this.pdfPageSettings.size;if(this.drawHeader(e),!sf.base.isNullOrUndefined(e.footer)){var r=e.footer,n=new sf.pdfexport.PointF(0,i.width-80-.75*r.fromBottom),s=new sf.pdfexport.SizeF(i.width-80,.75*r.height),o=new sf.pdfexport.RectangleF(n,s);this.pdfDocument.template.bottom=this.drawPageTemplate(new sf.pdfexport.PdfPageTemplateElement(o),r)}sf.base.isNullOrUndefined(e.includeHiddenColumn)||this.isGrouping||(this.hideColumnInclude=e.includeHiddenColumn),sf.base.isNullOrUndefined(e.dataSource)?sf.base.isNullOrUndefined(e.exportType)?(this.currentViewData=!1,this.customDataSource=!1):"CurrentPage"===e.exportType?(t=this.parent.currentViewData,this.currentViewData=!0,this.customDataSource=!1):(this.currentViewData=!1,this.customDataSource=!1):(e.dataSource instanceof sf.data.DataManager||(t=e.dataSource),this.customDataSource=!0,this.currentViewData=!1)}return t},t.prototype.drawHeader=function(e){var t=this,i=this.pdfPageSettings.size;if(!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(e.header)){var r=e.header,n=new sf.pdfexport.PointF(0,r.fromTop),s=new sf.pdfexport.SizeF(i.width-80,.75*r.height),o=new sf.pdfexport.RectangleF(n,s);if(this.headerOnPages.length){var a=this.drawPageTemplate(new sf.pdfexport.PdfPageTemplateElement(o),r);this.headerOnPages.filter((function(e){e-1>=0&&e-1<t.pdfDocument.pages.count-1&&t.pdfDocument.pages.getPageByIndex(e-1).graphics.drawPdfTemplate(a.template,new sf.pdfexport.PointF(0,0))}))}else this.pdfDocument.template.top=this.drawPageTemplate(new sf.pdfexport.PdfPageTemplateElement(o),r)}},t.prototype.drawPageTemplate=function(e,t){for(var i=0,r=t.contents;i<r.length;i++){var n=r[i];switch(this.processContentValidation(n),n.type){case"Text":if(""===n.value||void 0===n.value||null===n.value||"string"!=typeof n.value)throw new Error("please enter the valid input value in text content...");this.drawText(e,n);break;case"PageNumber":this.drawPageNumber(e,n);break;case"Image":if(void 0===n.src||null===n.src||""===n.src)throw new Error("please enter the valid base64 string in image content...");this.drawImage(e,n);break;case"Line":this.drawLine(e,n);break;default:throw new Error("Please set valid content type...")}}return e},t.prototype.processContentValidation=function(e){if(void 0===e.type||null===e.type)throw new Error("please set valid content type...");if("Line"===e.type){if(void 0===e.points||null===e.points)throw new Error("please enter valid points in "+e.type+" content...");if(void 0===e.points.x1||null===e.points.x1||"number"!=typeof e.points.x1)throw new Error("please enter valid x1 co-ordinate in "+e.type+" points...");if(void 0===e.points.y1||null===e.points.y1||"number"!=typeof e.points.y1)throw new Error("please enter valid y1 co-ordinate in "+e.type+" points...");if(void 0===e.points.x2||null===e.points.x2||"number"!=typeof e.points.x2)throw new Error("please enter valid x2 co-ordinate in "+e.type+" points...");if(void 0===e.points.y2||null===e.points.y2||"number"!=typeof e.points.y2)throw new Error("please enter valid y2 co-ordinate in "+e.type+" points...")}else{if(void 0===e.position||null===e.position)throw new Error("please enter valid position in "+e.type+" content...");if(void 0===e.position.x||null===e.position.x||"number"!=typeof e.position.x)throw new Error("please enter valid x co-ordinate in "+e.type+" position...");if(void 0===e.position.y||null===e.position.y||"number"!=typeof e.position.y)throw new Error("please enter valid y co-ordinate in "+e.type+" position...")}},t.prototype.drawText=function(e,t){var i=this.getFont(t),r=this.getBrushFromContent(t),n=null;if(!sf.base.isNullOrUndefined(t.style.textPenColor)){var s=this.hexToRgb(t.style.textPenColor);n=new sf.pdfexport.PdfPen(new sf.pdfexport.PdfColor(s.r,s.g,s.b))}null==r&&null==n&&(r=new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(0,0,0)));var o=t.value.toString(),a=.75*t.position.x,l=.75*t.position.y,h=new sf.pdfexport.PdfStringFormat,d=this.setContentFormat(t,h);null===d||sf.base.isNullOrUndefined(d.format)||sf.base.isNullOrUndefined(d.size)?e.graphics.drawString(o,i,n,r,a,l,h):e.graphics.drawString(o,i,n,r,a,l,d.size.width,d.size.height,d.format)},t.prototype.drawPageNumber=function(e,t){var i=this.getFont(t),r=null;if(sf.base.isNullOrUndefined(t.style.textBrushColor))r=new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(0,0,0));else{var n=this.hexToRgb(t.style.textBrushColor);r=new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(n.r,n.g,n.b))}var s,o,a=new sf.pdfexport.PdfPageNumberField(i,r);if(a.numberStyle=this.getPageNumberStyle(t.pageNumberType),sf.base.isNullOrUndefined(t.format))o="{0}",s=new sf.pdfexport.PdfCompositeField(i,r,o,a);else{var l="$total";if(-1!==t.format.indexOf(l)&&-1!==t.format.indexOf("$current"))(h=new sf.pdfexport.PdfPageCountField(i)).numberStyle=this.getPageNumberStyle(t.pageNumberType),o=t.format.indexOf(l)>t.format.indexOf("$current")?(o=t.format.replace("$current","0")).replace(l,"1"):(o=t.format.replace("$current","1")).replace(l,"0"),s=new sf.pdfexport.PdfCompositeField(i,r,o,a,h);else if(-1!==t.format.indexOf("$current")&&-1===t.format.indexOf(l))o=t.format.replace("$current","0"),s=new sf.pdfexport.PdfCompositeField(i,r,o,a);else{var h=new sf.pdfexport.PdfPageCountField(i);o=t.format.replace(l,"0"),s=new sf.pdfexport.PdfCompositeField(i,r,o,h)}}var d=.75*t.position.x,p=.75*t.position.y,c=this.setContentFormat(t,s.stringFormat);null===c||sf.base.isNullOrUndefined(c.format)||sf.base.isNullOrUndefined(c.size)||(s.stringFormat=c.format,s.bounds=new sf.pdfexport.RectangleF(d,p,c.size.width,c.size.height)),s.draw(e.graphics,d,p)},t.prototype.drawImage=function(e,t){var i=.75*t.position.x,r=.75*t.position.y,n=sf.base.isNullOrUndefined(t.size)?void 0:.75*t.size.width,s=sf.base.isNullOrUndefined(t.size)?void 0:.75*t.size.height,o=new sf.pdfexport.PdfBitmap(t.src);sf.base.isNullOrUndefined(n)?e.graphics.drawImage(o,i,r):e.graphics.drawImage(o,i,r,n,s)},t.prototype.drawLine=function(e,t){var i=.75*t.points.x1,r=.75*t.points.y1,n=.75*t.points.x2,s=.75*t.points.y2,o=this.getPenFromContent(t);sf.base.isNullOrUndefined(t.style)||null===t.style||(sf.base.isNullOrUndefined(t.style.penSize)||null===t.style.penSize||"number"!=typeof t.style.penSize||(o.width=.75*t.style.penSize),o.dashStyle=this.getDashStyle(t.style.dashStyle)),e.graphics.drawLine(o,i,r,n,s)},t.prototype.processAggregates=function(t,i,r,n,s,o,a,l,h,d){for(var p=0,c=t;p<c.length;p++){for(var u=c[p],f=-1,g=0,m=!0,y=[],v=0;v<i.columns.count;v++){var b=u.cells[g];if(b.cellType!==e.CellType.DetailFooterIntent){if(!this.hideColumnInclude){for(;void 0===b.visible;)if(b.cellType!==e.CellType.DetailFooterIntent){if(sf.base.isNullOrUndefined(l))y.push("");else if(sf.base.isNullOrUndefined(l.cells.getCell(v).value))y.push("");else{var C={row:u,type:"GroupCaption",style:l.cells};this.parent.trigger("pdfAggregateQueryCellInfo",C),y.push(""),y.push(l.cells.getCell(v).value),m=!1,a||(v+=1)}v+=1,g+=1,b=u.cells[g]}for(;!sf.base.isNullOrUndefined(b.visible)&&!b.visible;)g+=1,b=u.cells[g]}if(b.isDataCell){var w={};if(sf.base.isNullOrUndefined(b.column.footerTemplate)&&sf.base.isNullOrUndefined(b.column.groupCaptionTemplate)&&sf.base.isNullOrUndefined(b.column.groupFooterTemplate)){S=this.getSummaryWithoutTemplate(u.data[b.column.field]);sf.base.isNullOrUndefined(S)||y.push(S)}else{var S;w=(S=this.getTemplateFunction(w,v,f,b)).templateFunction,f=S.leastCaptionSummaryIndex;var x=void 0,R=u.data[b.column.field?b.column.field:b.column.columnName];this.parent.isReact||this.parent.isVue?(x=w[sf.base.getEnumValue(e.CellType,b.cellType)](R,this.parent),this.parent.isReact&&this.parent.renderTemplates()):x=w[sf.base.getEnumValue(e.CellType,b.cellType)](R),y.push(x[0].textContent),m=!1}}else y.push("");m&&""!==y[v]&&!sf.base.isNullOrUndefined(y[v])&&null!==y[v]&&(m=!1),g+=1}else v--,g++}if(a)for(v=this.parent.groupSettings.columns.length+1;v<y.length-1;v++)y[v]=y[v+1];if(!m)if(a)for(v=0;v<i.columns.count;v++)l.cells.getCell(v).value=y[v].toString(),v===h+1&&-1!==f&&1!==f?l.cells.getCell(v).columnSpan=f-(h+1):v===h+1&&-1===f&&(l.cells.getCell(v).columnSpan=i.columns.count-(h+1));else{var F=i.rows.addRow();F.style.setBorder(r),F.style.setFont(n),F.style.setTextBrush(s),F.style.setBackgroundBrush(o);C={row:u,type:d?"GroupFooter":"Footer",style:F.cells};this.parent.trigger("pdfAggregateQueryCellInfo",C);for(var v=0;v<i.columns.count;v++)F.cells.getCell(v).value=y[v].toString()}}},t.prototype.getTemplateFunction=function(t,i,r,n){return sf.base.isNullOrUndefined(n.column.footerTemplate)||n.cellType!==e.CellType.Summary?sf.base.isNullOrUndefined(n.column.groupCaptionTemplate)?t[sf.base.getEnumValue(e.CellType,e.CellType.GroupSummary)]=sf.base.compile(n.column.groupFooterTemplate):(-1===r&&(r=i),t[sf.base.getEnumValue(e.CellType,e.CellType.CaptionSummary)]=sf.base.compile(n.column.groupCaptionTemplate)):t[sf.base.getEnumValue(e.CellType,e.CellType.Summary)]=sf.base.compile(n.column.footerTemplate),{templateFunction:t,leastCaptionSummaryIndex:r}},t.prototype.getSummaryWithoutTemplate=function(e){return sf.base.isNullOrUndefined(e.Sum)?sf.base.isNullOrUndefined(e.Average)?sf.base.isNullOrUndefined(e.Max)?sf.base.isNullOrUndefined(e.Min)?sf.base.isNullOrUndefined(e.Count)?sf.base.isNullOrUndefined(e.TrueCount)?sf.base.isNullOrUndefined(e.FalseCount)?sf.base.isNullOrUndefined(e.Custom)?void 0:e.Custom:e.FalseCount:e.TrueCount:e.Count:e.Min:e.Max:e.Average:e.Sum},t.prototype.setColumnProperties=function(e,t,i,r,n){for(var s=r.groupSettings.columns.length,o=0;o<s;o++)t.columns.getColumn(o).width=20;for(o=0;o<e.length;o++)sf.base.isNullOrUndefined(e[o].textAlign)||(t.columns.getColumn(o+s).format=this.getHorizontalAlignment(e[o].textAlign)),t.style.allowHorizontalOverflow&&!sf.base.isNullOrUndefined(e[o].width)&&n&&(t.columns.getColumn(o+s).width="number"==typeof e[o].width?.75*e[o].width:.75*i.getConvertedWidth(e[o].width))},t.prototype.setRecordThemeStyle=function(e,t){if(sf.base.isNullOrUndefined(this.gridTheme)||sf.base.isNullOrUndefined(this.gridTheme.record))e.style.setTextBrush(new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(0,0,0)));else{var i=sf.base.isNullOrUndefined(this.gridTheme.record.fontName)?sf.pdfexport.PdfFontFamily.Helvetica:this.getFontFamily(this.gridTheme.record.fontName),r=sf.base.isNullOrUndefined(this.gridTheme.record.fontSize)?9.75:this.gridTheme.record.fontSize,n=this.getFontStyle(this.gridTheme.record),s=new sf.pdfexport.PdfStandardFont(i,r,n);sf.base.isNullOrUndefined(this.gridTheme.record.font)||(s=this.gridTheme.record.font),e.style.setFont(s);var o=new sf.pdfexport.PdfColor;if(!sf.base.isNullOrUndefined(this.gridTheme.record.fontColor)){var a=this.hexToRgb(this.gridTheme.record.fontColor);o=new sf.pdfexport.PdfColor(a.r,a.g,a.b)}e.style.setTextBrush(new sf.pdfexport.PdfSolidBrush(o))}var l=this.gridTheme&&this.gridTheme.record&&this.gridTheme.record.border?this.getBorderStyle(this.gridTheme.record.border):t;return e.style.setBorder(l),e},t.prototype.processRecord=function(t,i,r,n,s,o,a,l,h){for(var d=0,p=l.getGridRowModel(i,n,r,h);d<p.length;d++){var c=p[d];h++;for(var u=this.setRecordThemeStyle(s.rows.addRow(),t),f=c.cells.length,g=0;g<f;g++){var m=c.cells[g];if(m.cellType===e.CellType.Data){var y=m.column,v=y.field,b=sf.base.isNullOrUndefined(v)?"":y.valueAccessor(v,c.data,y),C=sf.base.isNullOrUndefined(b)?"":b,w=void 0;if(y.isForeignColumn&&y.isForeignColumn()&&(w=l.getFData(C,y),C=sf.base.getValue(y.foreignKeyValue,w)),(z={data:c.data,value:C,column:y,style:void 0,colSpan:1,cell:x=u.cells.getCell(g)}).value="boolean"===z.column.type&&"string"==typeof z.value?z.value:this.exportValueFormatter.formatCellValue(z),this.parent.trigger("pdfQueryCellInfo",z),sf.base.isNullOrUndefined(z.image)||(z.value=new sf.pdfexport.PdfBitmap(z.image.base64)),x.value=z.value,sf.base.isNullOrUndefined(z.hyperLink)||(x.value=this.setHyperLink(z)),sf.base.isNullOrUndefined(z.style)||this.processCellStyle(x,z),z.colSpan>1){g+1+z.colSpan>u.cells.count&&(z.colSpan=u.cells.count-(g+1)),x.columnSpan=z.colSpan;for(var S=1;S<x.columnSpan;S++){u.cells.getCell(g+S).value=""}g+=z.colSpan-1}}}if(c.isExpand){var x,R=this.setRecordThemeStyle(s.rows.addRow(),t);(x=R.cells.getCell(o)).columnSpan=R.cells.count-o,x.style.cellPadding=new sf.pdfexport.PdfPaddings(10,10,10,10),r.isPrinting=!0;var F=!sf.base.isNullOrUndefined(a)&&a.exportType?a.exportType:"AllPages",E=this.helper.createChildGrid(r,c,F,this.gridPool),I=E.childGrid,T=E.element;I.actionFailure=l.failureHandler(this.gridPool,I,this.globalResolve);var z={childGrid:I,row:c,cell:x,exportProperties:a};this.parent.trigger("exportDetailDataBound",z),I.beforeDataBound=this.childGridCell(x,I,a),I.appendTo(T)}this.parent.notify("export-RowDataBound",{type:"pdf",rowObj:c})}return h},t.prototype.setHyperLink=function(e){var t=new sf.pdfexport.PdfTextWebLink;return t.url=e.hyperLink.target,t.text=e.hyperLink.displayText||e.hyperLink.target,t.font=new sf.pdfexport.PdfStandardFont(sf.pdfexport.PdfFontFamily.Helvetica,9.75),t.brush=new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(51,102,187)),t},t.prototype.childGridCell=function(e,t,i){var r=this;return function(n){return t.beforeDataBound=null,n.cancel=!0,e.value=r.processGridExport(t,n,i),t.destroy(),sf.base.detach(t.element),r.gridPool[t.id]=!0,r.helper.checkAndExport(r.gridPool,r.globalResolve),e}},t.prototype.processCellStyle=function(e,t){if(!sf.base.isNullOrUndefined(t.style.backgroundColor)){var i=this.hexToRgb(t.style.backgroundColor);e.style.backgroundBrush=new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(i.r,i.g,i.b))}if(sf.base.isNullOrUndefined(t.style.textAlignment)||(e.style.stringFormat=this.getHorizontalAlignment(t.style.textAlignment)),sf.base.isNullOrUndefined(t.style.cellPadding)||(e.style.cellPadding=t.style.cellPadding),sf.base.isNullOrUndefined(t.style.verticalAlignment)||(e.style.stringFormat=this.getVerticalAlignment(t.style.verticalAlignment,e.style.stringFormat)),!sf.base.isNullOrUndefined(t.style.textBrushColor)){var r=this.hexToRgb(t.style.textBrushColor);e.style.textBrush=new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(r.r,r.g,r.b))}if(!sf.base.isNullOrUndefined(t.style.textPenColor)){var n=this.hexToRgb(t.style.textPenColor);e.style.textPen=new sf.pdfexport.PdfPen(new sf.pdfexport.PdfColor(n.r,n.g,n.b))}if(sf.base.isNullOrUndefined(t.style.fontFamily)&&sf.base.isNullOrUndefined(t.style.fontSize)&&sf.base.isNullOrUndefined(t.style.bold)&&sf.base.isNullOrUndefined(t.style.italic)&&sf.base.isNullOrUndefined(t.style.underline)&&sf.base.isNullOrUndefined(t.style.strikeout)||(e.style.font=this.getFont(t)),!sf.base.isNullOrUndefined(t.style.border)){var s=new sf.pdfexport.PdfBorders,o=t.style.border.width,a=sf.base.isNullOrUndefined(o)||"number"!=typeof o?void 0:.75*o,l=new sf.pdfexport.PdfColor(196,196,196);if(!sf.base.isNullOrUndefined(t.style.border.color)){var h=this.hexToRgb(t.style.border.color);l=new sf.pdfexport.PdfColor(h.r,h.g,h.b)}var d=new sf.pdfexport.PdfPen(l,a);sf.base.isNullOrUndefined(t.style.border.dashStyle)||(d.dashStyle=this.getDashStyle(t.style.border.dashStyle)),s.all=d,e.style.borders=s}sf.base.isNullOrUndefined(t.style.paragraphIndent)||(e.style.stringFormat=new sf.pdfexport.PdfStringFormat,e.style.stringFormat.paragraphIndent=t.style.paragraphIndent)},t.prototype.getHorizontalAlignment=function(e,t){switch(void 0===t&&(t=new sf.pdfexport.PdfStringFormat),e){case"Right":t.alignment=sf.pdfexport.PdfTextAlignment.Right;break;case"Center":t.alignment=sf.pdfexport.PdfTextAlignment.Center;break;case"Justify":t.alignment=sf.pdfexport.PdfTextAlignment.Justify;break;case"Left":t.alignment=sf.pdfexport.PdfTextAlignment.Left}return t},t.prototype.getVerticalAlignment=function(e,t,i){switch(void 0===t&&(t=new sf.pdfexport.PdfStringFormat,t=this.getHorizontalAlignment(i,t)),e){case"Bottom":t.lineAlignment=sf.pdfexport.PdfVerticalAlignment.Bottom;break;case"Middle":t.lineAlignment=sf.pdfexport.PdfVerticalAlignment.Middle;break;case"Top":t.lineAlignment=sf.pdfexport.PdfVerticalAlignment.Top}return t},t.prototype.getFontFamily=function(e){switch(e){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}},t.prototype.getFont=function(e){if(e.font)return e.font;var t=sf.base.isNullOrUndefined(e.style.fontSize)?9.75:.75*e.style.fontSize,i=sf.base.isNullOrUndefined(e.style.fontFamily)?sf.pdfexport.PdfFontFamily.TimesRoman:this.getFontFamily(e.style.fontFamily),r=sf.pdfexport.PdfFontStyle.Regular;return!sf.base.isNullOrUndefined(e.style.bold)&&e.style.bold&&(r|=sf.pdfexport.PdfFontStyle.Bold),!sf.base.isNullOrUndefined(e.style.italic)&&e.style.italic&&(r|=sf.pdfexport.PdfFontStyle.Italic),!sf.base.isNullOrUndefined(e.style.underline)&&e.style.underline&&(r|=sf.pdfexport.PdfFontStyle.Underline),!sf.base.isNullOrUndefined(e.style.strikeout)&&e.style.strikeout&&(r|=sf.pdfexport.PdfFontStyle.Strikeout),new sf.pdfexport.PdfStandardFont(i,t,r)},t.prototype.getPageNumberStyle=function(e){switch(e){case"LowerLatin":return 2;case"LowerRoman":return 3;case"UpperLatin":return 4;case"UpperRoman":return 5;default:return 1}},t.prototype.setContentFormat=function(e,t){if(!sf.base.isNullOrUndefined(e.size)){var i=.75*e.size.width,r=.75*e.size.height;if(t=new sf.pdfexport.PdfStringFormat(sf.pdfexport.PdfTextAlignment.Left,sf.pdfexport.PdfVerticalAlignment.Middle),!sf.base.isNullOrUndefined(e.style.hAlign))switch(e.style.hAlign){case"Right":t.alignment=sf.pdfexport.PdfTextAlignment.Right;break;case"Center":t.alignment=sf.pdfexport.PdfTextAlignment.Center;break;case"Justify":t.alignment=sf.pdfexport.PdfTextAlignment.Justify;break;default:t.alignment=sf.pdfexport.PdfTextAlignment.Left}return sf.base.isNullOrUndefined(e.style.vAlign)||(t=this.getVerticalAlignment(e.style.vAlign,t)),{format:t,size:new sf.pdfexport.SizeF(i,r)}}return null},t.prototype.getPageSize=function(e){switch(e){case"Letter":return new sf.pdfexport.SizeF(612,792);case"Note":return new sf.pdfexport.SizeF(540,720);case"Legal":return new sf.pdfexport.SizeF(612,1008);case"A0":return new sf.pdfexport.SizeF(2380,3368);case"A1":return new sf.pdfexport.SizeF(1684,2380);case"A2":return new sf.pdfexport.SizeF(1190,1684);case"A3":return new sf.pdfexport.SizeF(842,1190);case"A5":return new sf.pdfexport.SizeF(421,595);case"A6":return new sf.pdfexport.SizeF(297,421);case"A7":return new sf.pdfexport.SizeF(210,297);case"A8":return new sf.pdfexport.SizeF(148,210);case"A9":return new sf.pdfexport.SizeF(105,148);case"B0":return new sf.pdfexport.SizeF(2836,4008);case"B1":return new sf.pdfexport.SizeF(2004,2836);case"B2":return new sf.pdfexport.SizeF(1418,2004);case"B3":return new sf.pdfexport.SizeF(1002,1418);case"B4":return new sf.pdfexport.SizeF(709,1002);case"B5":return new sf.pdfexport.SizeF(501,709);case"Archa":return new sf.pdfexport.SizeF(648,864);case"Archb":return new sf.pdfexport.SizeF(864,1296);case"Archc":return new sf.pdfexport.SizeF(1296,1728);case"Archd":return new sf.pdfexport.SizeF(1728,2592);case"Arche":return new sf.pdfexport.SizeF(2592,3456);case"Flsa":return new sf.pdfexport.SizeF(612,936);case"HalfLetter":return new sf.pdfexport.SizeF(396,612);case"Letter11x17":return new sf.pdfexport.SizeF(792,1224);case"Ledger":return new sf.pdfexport.SizeF(1224,792);default:return new sf.pdfexport.SizeF(595,842)}},t.prototype.getDashStyle=function(e){switch(e){case"Dash":return 1;case"Dot":return 2;case"DashDot":return 3;case"DashDotDot":return 4;default:return 0}},t.prototype.getPenFromContent=function(e){var t=new sf.pdfexport.PdfPen(new sf.pdfexport.PdfColor(0,0,0));if(!sf.base.isNullOrUndefined(e.style)&&null!==e.style&&!sf.base.isNullOrUndefined(e.style.penColor)){var i=this.hexToRgb(e.style.penColor);t=new sf.pdfexport.PdfPen(new sf.pdfexport.PdfColor(i.r,i.g,i.b))}return t},t.prototype.getBrushFromContent=function(e){var t=null;if(!sf.base.isNullOrUndefined(e.style.textBrushColor)){var i=this.hexToRgb(e.style.textBrushColor);t=new sf.pdfexport.PdfSolidBrush(new sf.pdfexport.PdfColor(i.r,i.g,i.b))}return t},t.prototype.hexToRgb=function(e){if(null===e||""===e||7!==e.length)throw new Error("please set valid hex value for color...");e=e.substring(1);var t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}},t.prototype.getFontStyle=function(e){var t=sf.pdfexport.PdfFontStyle.Regular;return!sf.base.isNullOrUndefined(e)&&e.bold&&(t|=sf.pdfexport.PdfFontStyle.Bold),!sf.base.isNullOrUndefined(e)&&e.italic&&(t|=sf.pdfexport.PdfFontStyle.Italic),!sf.base.isNullOrUndefined(e)&&e.underline&&(t|=sf.pdfexport.PdfFontStyle.Underline),!sf.base.isNullOrUndefined(e)&&e.strikeout&&(t|=sf.pdfexport.PdfFontStyle.Strikeout),t},t.prototype.getBorderStyle=function(e){var t=new sf.pdfexport.PdfBorders;if(sf.base.isNullOrUndefined(e))t.all=new sf.pdfexport.PdfPen(new sf.pdfexport.PdfColor(234,234,234));else{var i=e.width,r=sf.base.isNullOrUndefined(i)||"number"!=typeof i?void 0:.75*i,n=new sf.pdfexport.PdfColor(196,196,196);if(!sf.base.isNullOrUndefined(e.color)){var s=this.hexToRgb(e.color);n=new sf.pdfexport.PdfColor(s.r,s.g,s.b)}var o=new sf.pdfexport.PdfPen(n,r);sf.base.isNullOrUndefined(e.dashStyle)||(o.dashStyle=this.getDashStyle(e.dashStyle)),t.all=o}return t},t.prototype.destroy=function(){},t}(),Ds=(bs=function(e,t){return(bs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}bs(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ms=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.buttonElement=r.parent.createElement("button",{}),r.unbounDiv=r.parent.createElement("div",{className:"e-unboundcelldiv",styles:"display: inline-block"}),r.childRefs=[],r.element=r.parent.createElement("TD",{className:"e-rowcell e-unboundcell",attrs:{role:"gridcell",tabindex:"-1"}}),r.parent.on(F,r.destroyButtons,r),r}return Ds(t,e),t.prototype.destroyButtons=function(){for(var e=0;e<this.childRefs.length;e++)this.childRefs[e]&&!this.childRefs[e].isDestroyed&&this.childRefs[e].destroy();this.parent.off(F,this.destroyButtons)},t.prototype.render=function(e,t,i,r){var n=this.element.cloneNode();if(n.appendChild(this.unbounDiv.cloneNode()),n.setAttribute("aria-label","is Command column column header "+e.column.headerText),e.column.commandsTemplate)if(this.parent.isReact&&"string"!=typeof e.column.commandsTemplate){var s=this.parent+"commandsTemplate";e.column.getColumnTemplate()(t,this.parent,"commandsTemplate",s,null,null,n.firstElementChild),this.parent.renderTemplates()}else Fi(n.firstElementChild,e.column.getColumnTemplate()(t));else for(var o=0,a=e.commands;o<a.length;o++){var l=a[o];n=this.renderButton(n,l,i.index,l.uid)}return this.setAttributes(n,e,i),!this.parent.enableVirtualization&&this.parent.isEdit||r?(sf.base.addClass([].slice.call(n.getElementsByClassName("e-edit-delete")),"e-hide"),sf.base.removeClass([].slice.call(n.getElementsByClassName("e-save-cancel")),"e-hide")):(sf.base.addClass([].slice.call(n.getElementsByClassName("e-save-cancel")),"e-hide"),sf.base.removeClass([].slice.call(n.getElementsByClassName("e-edit-delete")),"e-hide")),n},t.prototype.renderButton=function(e,t,i,r){var n=this.buttonElement.cloneNode();sf.base.attributes(n,{id:this.parent.element.id+(t.type||"")+"_"+i+"_"+r,type:"button",title:sf.base.isNullOrUndefined(t.title)?t.buttonOption.content||this.localizer.getConstant(t.type)||t.type:t.title,"data-uid":r}),n.onclick=t.buttonOption.click;var s=new sf.buttons.Button(t.buttonOption,n);switch(this.childRefs.push(s),s.commandType=t.type,e.firstElementChild.appendChild(s.element),t.type){case"Edit":case"Delete":sf.base.addClass([n],["e-edit-delete","e-"+t.type.toLowerCase()+"button"]);break;case"Cancel":case"Save":sf.base.addClass([n],["e-save-cancel","e-"+t.type.toLowerCase()+"button"])}return e},t}(ve),Os=function(){function t(e,t){this.parent=e,this.locator=t,this.initiateRender(),this.addEventListener()}return t.prototype.initiateRender=function(){this.locator.getService("cellRendererFactory").addCellRenderer(e.CellType.CommandColumn,new Ms(this.parent,this.locator))},t.prototype.commandClickHandler=function(e){var t=this.parent,i=sf.base.closest(e.target,"button");if(i&&sf.base.closest(e.target,".e-unboundcell")){for(var r,n=i.ej2_instances[0],s=n.commandType,o=i.getAttribute("data-uid"),a=t.getRowObjectFromUID(sf.base.closest(i,"."+Y).getAttribute("data-uid")),l=this.parent.columnModel,h=0;h<l.length;h++)if(l[h].commands)for(var d=l[h].commands,p=0;p<d.length;p++){d[p].uid===o&&d[p].type===s&&(r=d[p])}var c={cancel:!1,target:i,commandColumn:r,rowData:sf.base.isNullOrUndefined(a)?void 0:a.data};this.parent.trigger("commandClick",c,(function(e){if(!n.disabled&&t.editModule&&!e.cancel)switch(s){case"Edit":t.editModule.endEdit(),t.editModule.startEdit(sf.base.closest(i,"tr"));break;case"Cancel":t.editModule.closeEdit();break;case"Save":t.editModule.endEdit();break;case"Delete":"Batch"!==t.editSettings.mode&&t.editModule.endEdit(),t.commandDelIndex=parseInt(sf.base.closest(i,"tr").getAttribute(ne),10),t.clearSelection(),t.selectRow(t.commandDelIndex,!1),t.editModule.deleteRecord(),t.commandDelIndex=void 0}}))}},t.prototype.getModuleName=function(){return"commandColumn"},t.prototype.destroy=function(){this.parent.isDestroyed||this.removeEventListener()},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(R,this.commandClickHandler),this.parent.off(x,this.keyPressHandler),this.parent.off(g,this.load),this.parent.off(F,this.destroy))},t.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(R,this.commandClickHandler,this),this.parent.on(x,this.keyPressHandler,this),this.parent.on(g,this.load,this),this.parent.on(F,this.destroy,this))},t.prototype.keyPressHandler=function(e){"enter"===e.action&&sf.base.closest(e.target,".e-unboundcelldiv")&&(this.commandClickHandler(e),e.preventDefault())},t.prototype.load=function(){for(var e=this.parent.columnModel,t=0;t<e.length;t++)if(e[t].commands)for(var i=e[t].commands,r=0;r<i.length;r++)i[r].uid=Ri("gridcommand")},t}(),ks={header:"."+H,content:"."+U,edit:".e-inline-edit",batchEdit:".e-editedbatchcell",editIcon:"e-edit",pager:".e-gridpager",delete:"e-delete",save:"e-save",cancel:"e-cancel",copy:"e-copy",pdf:"e-pdfexport",group:"e-icon-group",ungroup:"e-icon-ungroup",csv:"e-csvexport",excel:"e-excelexport",fPage:"e-icon-first",nPage:"e-icon-next",lPage:"e-icon-last",pPage:"e-icon-prev",ascending:"e-icon-ascending",descending:"e-icon-descending",groupHeader:"e-groupdroparea",touchPop:"e-gridpopup"},As=function(){function e(e,t){this.defaultItems={},this.disableItems=[],this.hiddenItems=[],this.localeText=this.setLocaleKey(),this.parent=e,this.gridID=e.element.id,this.serviceLocator=t,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(v,this.enableAfterRenderMenu,this),this.parent.on(f,this.render,this),this.parent.on(F,this.destroy,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(f,this.render),this.parent.off(v,this.enableAfterRenderMenu),this.parent.off(F,this.destroy),sf.base.EventHandler.remove(this.element,"keydown",this.keyDownHandler.bind(this)))},e.prototype.keyDownHandler=function(e){"Tab"!==e.code&&9!==e.which||this.contextMenu.close(),"Escape"===e.code&&(this.contextMenu.close(),this.parent.notify("restore-Focus",{}))},e.prototype.render=function(){this.parent.element.classList.add("e-noselect"),this.l10n=this.serviceLocator.getService("localization"),this.element=this.parent.createElement("ul",{id:this.gridID+"_cmenu"}),sf.base.EventHandler.add(this.element,"keydown",this.keyDownHandler.bind(this)),this.parent.element.appendChild(this.element);var e="#"+this.gridID;this.contextMenu=new sf.navigations.ContextMenu({items:this.getMenuItems(),enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,target:e,select:this.contextMenuItemClick.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this),onOpen:this.contextMenuOpen.bind(this),onClose:this.contextMenuOnClose.bind(this),cssClass:"e-grid-menu"}),this.contextMenu.appendTo(this.element)},e.prototype.enableAfterRenderMenu=function(e){e.module===this.getModuleName()&&e.enable&&(this.contextMenu&&(this.contextMenu.destroy(),sf.base.remove(this.element),this.parent.element.classList.remove("e-noselect")),this.render())},e.prototype.getMenuItems=function(){for(var e=[],t=[],i=0,r=this.parent.contextMenuItems;i<r.length;i++){var n=r[i];"string"==typeof n&&-1!==this.getDefaultItems().indexOf(n)?-1!==n.toLocaleLowerCase().indexOf("export")?t.push(this.buildDefaultItems(n)):e.push(this.buildDefaultItems(n)):"string"!=typeof n&&e.push(n)}if(t.length>0){var s=this.buildDefaultItems("export");s.items=t,e.push(s)}return e},e.prototype.getLastPage=function(){var e=Math.floor(this.parent.pageSettings.totalRecordsCount/this.parent.pageSettings.pageSize);return this.parent.pageSettings.totalRecordsCount%this.parent.pageSettings.pageSize&&(e+=1),e},e.prototype.contextMenuOpen=function(){this.isOpen=!0},e.prototype.contextMenuItemClick=function(e){switch(this.getKeyFromId(e.item.id)){case"AutoFitAll":this.parent.autoFitColumns([]);break;case"AutoFit":this.parent.autoFitColumns(this.targetColumn.field);break;case"Group":this.parent.groupColumn(this.targetColumn.field);break;case"Ungroup":this.parent.ungroupColumn(this.targetColumn.field);break;case"Edit":this.parent.editModule&&("Batch"===this.parent.editSettings.mode?this.row&&this.cell&&!isNaN(parseInt(this.cell.getAttribute(re),10))&&this.parent.editModule.editCell(parseInt(this.row.getAttribute(ne),10),this.parent.getColumns()[parseInt(this.cell.getAttribute(re),10)].field):(this.parent.editModule.endEdit(),this.parent.editModule.startEdit(this.row)));break;case"Delete":this.parent.editModule&&("Batch"!==this.parent.editSettings.mode&&this.parent.editModule.endEdit(),1===this.parent.getSelectedRecords().length?this.parent.editModule.deleteRow(this.row):this.parent.deleteRecord());break;case"Save":this.parent.editModule&&this.parent.editModule.endEdit();break;case"Cancel":this.parent.editModule&&this.parent.editModule.closeEdit();break;case"Copy":this.parent.copy();break;case"PdfExport":this.parent.pdfExport();break;case"ExcelExport":this.parent.excelExport();break;case"CsvExport":this.parent.csvExport();break;case"SortAscending":this.isOpen=!1,this.parent.sortColumn(this.targetColumn.field,"Ascending");break;case"SortDescending":this.isOpen=!1,this.parent.sortColumn(this.targetColumn.field,"Descending");break;case"FirstPage":this.parent.goToPage(1);break;case"PrevPage":this.parent.goToPage(this.parent.pageSettings.currentPage-1);break;case"LastPage":this.parent.goToPage(this.getLastPage());break;case"NextPage":this.parent.goToPage(this.parent.pageSettings.currentPage+1)}e.column=this.targetColumn,e.rowInfo=this.targetRowdata,this.parent.trigger("contextMenuClick",e)},e.prototype.contextMenuOnClose=function(e){e.items.length>0&&e.items[0].parentObj instanceof sf.navigations.ContextMenu&&this.updateItemStatus(),this.parent.notify("select-row-on-context-open",{isOpen:!1})},e.prototype.getLocaleText=function(e){return this.l10n.getConstant(this.localeText[e])},e.prototype.updateItemStatus=function(){this.contextMenu.showItems(this.hiddenItems),this.contextMenu.enableItems(this.disableItems),this.hiddenItems=[],this.disableItems=[],this.isOpen=!1},e.prototype.contextMenuBeforeOpen=function(e){var t=sf.base.closest(e.event.target,".e-grid");if(e.event&&t&&t!==this.parent.element)e.cancel=!0;else if(e.event&&(sf.base.closest(e.event.target,"."+ks.groupHeader)||sf.base.closest(e.event.target,"."+ks.touchPop)||sf.base.closest(e.event.target,".e-summarycell")||sf.base.closest(e.event.target,".e-groupcaption")||sf.base.closest(e.event.target,".e-filterbarcell")))e.cancel=!0;else{this.targetColumn=this.getColumn(e.event),this.targetRowdata=this.parent.getRowInfo(e.event.target),sf.base.isNullOrUndefined(e.parentItem)&&this.targetColumn&&this.targetRowdata.cell&&(this.parent.notify("select-row-on-context-open",{isOpen:!0}),this.selectRow(e.event,!this.targetRowdata.cell.classList.contains("e-selectionbackground")||"Multiple"!==this.parent.selectionSettings.type));for(var i=[],r=[],n=0,s=e.items;n<s.length;n++){var o=s[n],a=this.getKeyFromId(o.id),l=this.defaultItems[a];if(-1!==this.getDefaultItems().indexOf(a))if(this.ensureDisabledStatus(a)&&this.disableItems.push(o.text),e.event&&(this.ensureTarget(e.event.target,ks.edit)||this.ensureTarget(e.event.target,ks.batchEdit)))"Save"!==a&&"Cancel"!==a&&this.hiddenItems.push(o.text);else{if(this.parent.editModule&&"Batch"===this.parent.editSettings.mode&&(sf.base.closest(e.event.target,".e-gridform")||this.parent.editModule.getBatchChanges().changedRecords.length||this.parent.editModule.getBatchChanges().addedRecords.length||this.parent.editModule.getBatchChanges().deletedRecords.length)&&("Save"===a||"Cancel"===a))continue;sf.base.isNullOrUndefined(e.parentItem)&&e.event&&!this.ensureTarget(e.event.target,l.target)&&this.hiddenItems.push(o.text)}else o.target&&e.event&&!this.ensureTarget(e.event.target,o.target)?o.separator?i.push(o.id):this.hiddenItems.push(o.text):this.ensureTarget(e.event.target,o.target)&&o.separator&&r.push(o.id)}r.length>0&&this.contextMenu.showItems(r,!0),this.contextMenu.enableItems(this.disableItems,!1),this.contextMenu.hideItems(this.hiddenItems),i.length>0&&this.contextMenu.hideItems(i,!0),this.eventArgs=e.event,e.column=this.targetColumn,e.rowInfo=this.targetRowdata,this.parent.trigger("contextMenuOpen",e),(e.cancel||this.hiddenItems.length===e.items.length&&!e.parentItem)&&(this.updateItemStatus(),e.cancel=!0)}hr(this.parent.element,this.contextMenu.element.parentElement)},e.prototype.ensureTarget=function(e,t){var i=e;return(i=!this.ensureFrozenHeader(e)||t!==ks.header&&t!==ks.content?t===ks.content||t===ks.header?yi(sf.base.closest(e,"."+X),t.substr(1,t.length)):sf.base.closest(e,t):sf.base.closest(e,t===ks.header?"thead":se))&&yi(i,"e-grid")===this.parent.element},e.prototype.ensureFrozenHeader=function(e){return!(!this.parent.isFrozenGrid()&&!this.parent.frozenRows||!sf.base.closest(e,ks.header))},e.prototype.ensureDisabledStatus=function(e){var t=!1;switch(e){case"AutoFitAll":case"AutoFit":t=!(this.parent.ensureModuleInjected(En)&&!this.parent.isEdit)||this.targetColumn&&!this.targetColumn.field&&"AutoFit"===e;break;case"Group":(!this.parent.allowGrouping||this.parent.ensureModuleInjected(zn)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)>=0||this.targetColumn&&!this.targetColumn.field)&&(t=!0);break;case"Ungroup":(!this.parent.allowGrouping||!this.parent.ensureModuleInjected(zn)||this.parent.ensureModuleInjected(zn)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)<0)&&(t=!0);break;case"Edit":case"Delete":case"Save":case"Cancel":this.parent.editModule&&0!==this.parent.getDataRows().length||(t=!0);break;case"Copy":(0===this.parent.getSelectedRowIndexes().length&&0===this.parent.getSelectedRowCellIndexes().length||0===this.parent.getCurrentViewRecords().length)&&(t=!0);break;case"export":this.parent.allowExcelExport&&this.parent.excelExport&&(this.parent.ensureModuleInjected(zs)||this.parent.ensureModuleInjected(Ts))||(t=!0);break;case"PdfExport":this.parent.allowPdfExport&&this.parent.ensureModuleInjected(zs)||(t=!0);break;case"ExcelExport":case"CsvExport":this.parent.allowExcelExport&&this.parent.ensureModuleInjected(Ts)||(t=!0);break;case"SortAscending":case"SortDescending":if(!this.parent.allowSorting||!this.parent.ensureModuleInjected(rn)||this.targetColumn&&!this.targetColumn.field)t=!0;else if(this.parent.ensureModuleInjected(rn)&&this.parent.sortSettings.columns.length>0&&this.targetColumn)for(var i=this.parent.sortSettings.columns,r=0;r<i.length;r++)i[r].field===this.targetColumn.field&&i[r].direction.toLowerCase()===e.toLowerCase().replace("sort","").toLocaleLowerCase()&&(t=!0);break;case"FirstPage":case"PrevPage":(!this.parent.allowPaging||!this.parent.ensureModuleInjected(pn)||0===this.parent.getCurrentViewRecords().length||this.parent.ensureModuleInjected(pn)&&1===this.parent.pageSettings.currentPage)&&(t=!0);break;case"LastPage":case"NextPage":(!this.parent.allowPaging||!this.parent.ensureModuleInjected(pn)||0===this.parent.getCurrentViewRecords().length||this.parent.ensureModuleInjected(pn)&&this.parent.pageSettings.currentPage===this.getLastPage())&&(t=!0)}return t},e.prototype.getContextMenu=function(){return this.element},e.prototype.destroy=function(){var e=this.parent.element;e&&(e.querySelector("."+H)||e.querySelector("."+U))&&(this.contextMenu.destroy(),this.element.parentNode&&sf.base.remove(this.element),this.removeEventListener(),this.parent.element.classList.remove("e-noselect"))},e.prototype.getModuleName=function(){return"contextMenu"},e.prototype.generateID=function(e){return this.gridID+"_cmenu_"+e},e.prototype.getKeyFromId=function(e){return e.replace(this.gridID+"_cmenu_","")},e.prototype.buildDefaultItems=function(e){var t;switch(e){case"AutoFitAll":case"AutoFit":t={target:ks.header};break;case"Group":t={target:ks.header,iconCss:ks.group};break;case"Ungroup":t={target:ks.header,iconCss:ks.ungroup};break;case"Edit":t={target:ks.content,iconCss:ks.editIcon};break;case"Delete":t={target:ks.content,iconCss:ks.delete};break;case"Save":t={target:ks.edit,iconCss:ks.save};break;case"Cancel":t={target:ks.edit,iconCss:ks.cancel};break;case"Copy":t={target:ks.content,iconCss:ks.copy};break;case"export":t={target:ks.content};break;case"PdfExport":t={target:ks.content,iconCss:ks.pdf};break;case"ExcelExport":t={target:ks.content,iconCss:ks.excel};break;case"CsvExport":t={target:ks.content,iconCss:ks.csv};break;case"SortAscending":t={target:ks.header,iconCss:ks.ascending};break;case"SortDescending":t={target:ks.header,iconCss:ks.descending};break;case"FirstPage":t={target:ks.pager,iconCss:ks.fPage};break;case"PrevPage":t={target:ks.pager,iconCss:ks.pPage};break;case"LastPage":t={target:ks.pager,iconCss:ks.lPage};break;case"NextPage":t={target:ks.pager,iconCss:ks.nPage}}return this.defaultItems[e]={text:this.getLocaleText(e),id:this.generateID(e),target:t.target,iconCss:t.iconCss?"e-icons "+t.iconCss:""},this.defaultItems[e]},e.prototype.getDefaultItems=function(){return["AutoFitAll","AutoFit","Group","Ungroup","Edit","Delete","Save","Cancel","Copy","export","PdfExport","ExcelExport","CsvExport","SortAscending","SortDescending","FirstPage","PrevPage","LastPage","NextPage"]},e.prototype.setLocaleKey=function(){return{AutoFitAll:"autoFitAll",AutoFit:"autoFit",Copy:"Copy",Group:"Group",Ungroup:"Ungroup",Edit:"EditRecord",Delete:"DeleteRecord",Save:"Save",Cancel:"CancelButton",PdfExport:"Pdfexport",ExcelExport:"Excelexport",CsvExport:"Csvexport",export:"Export",SortAscending:"SortAscending",SortDescending:"SortDescending",FirstPage:"FirstPage",LastPage:"LastPage",PrevPage:"PreviousPage",NextPage:"NextPage"}},e.prototype.getColumn=function(e){var t=sf.base.closest(e.target,"th.e-headercell");if(t){var i=t.querySelector(".e-headercelldiv, .e-stackedheadercelldiv").getAttribute("e-mappinguid");return this.parent.getColumnByUid(i)}return this.parent.getRowInfo(e.target).column||null},e.prototype.selectRow=function(e,t){this.cell=e.target,this.row=sf.base.closest(e.target,"tr.e-row")||this.row,this.row&&t&&!yi(e.target,"e-gridpager")&&this.parent.selectRow(parseInt(this.row.getAttribute(ne),10))},e}(),Bs=function(){function e(e){this.parent=e,this.rowModelGenerator=new he(this.parent)}return e.prototype.generateRows=function(e,t,i){var r;if(r=t.renderFrozenRightContent||t.renderMovableContent&&!this.parent.enableVirtualization?"frozen-right":t.renderMovableContent||t.isFrozen?"movable":this.parent.getFrozenLeftCount()?"frozen-left":"frozen-right","virtualscroll"===t.requestType&&"X"===t.virtualInfo.sentinelInfo.axis&&"movable"!==r)return null;for(var n=this.parent.enableVirtualization&&!t.isFrozenRowsRender?i:this.rowModelGenerator.generateRows(e,t),s=0,o=n.length;s<o;s++)n[s].cells=wr(this.parent,n[s].cells,r);return n},e}(),Ns=(Cs=function(e,t){return(Cs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Cs(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ps=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.isInitialRender=!0,r.widthService=i.getService("widthService"),r.addEventListener(),r}return Ns(t,e),t.prototype.addEventListener=function(){this.parent.addEventListener(c,this.actionComplete.bind(this)),this.parent.addEventListener("batchAdd",this.batchAdd.bind(this)),this.parent.on("batchCancel",this.batchAdd.bind(this)),this.parent.addEventListener("batchDelete",this.batchAdd.bind(this)),this.parent.on("set-height-to-frozen-element",this.refreshScrollOffset),this.parent.on("column-visible-changed",this.widthService.refreshFrozenScrollbar,this)},t.prototype.batchAdd=function(e){var t="batchCancel"!==e.name&&!(this.parent.frozenRows&&"Top"===this.parent.editSettings.newRowPosition);if("auto"!==this.parent.height&&(t||"batchCancel"===e.name||"batchDelete"===e.name)){this.refreshScrollOffset();var i=this.getTable().offsetHeight;"add"===e.name&&"Bottom"===this.parent.editSettings.newRowPosition&&this.parent.getContent().firstChild.scroll(0,i)}},t.prototype.setHeightToContent=function(e){this.getFrozenContent().style.height=e.toString()+"px",this.getMovableContent().style.height=e.toString()+"px"},t.prototype.actionComplete=function(e){if("Dialog"!==this.parent.editSettings.mode&&("add"===e.requestType||"cancel"===e.requestType&&e.row.classList.contains($))&&(!this.parent.frozenRows||"Bottom"===this.parent.editSettings.newRowPosition)&&"auto"!==this.parent.height){this.refreshScrollOffset();var t=this.getTable().offsetHeight;"add"===e.requestType&&"Bottom"===this.parent.editSettings.newRowPosition&&this.parent.getContent().firstChild.scroll(0,t)}},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.removeEventListener(c,this.actionComplete),this.parent.removeEventListener("batchAdd",this.batchAdd),this.parent.off("column-visible-changed",this.widthService.refreshFrozenScrollbar))},t.prototype.renderPanel=function(){e.prototype.renderPanel.call(this);var t=this.parent.element.querySelector("."+W),i=this.parent.element.querySelector("."+G);sf.base.isNullOrUndefined(t)&&(t=this.parent.createElement("div",{className:"e-frozencontent e-frozen-left-content"}),i=this.parent.createElement("div",{className:G}),this.getPanel().querySelector("."+Q).appendChild(t),this.getPanel().querySelector("."+Q).appendChild(i),i.style.scrollbarWidth="none"),this.setFrozenContent(t),this.setMovableContent(i),sf.base.Browser.userAgent.indexOf("Mac OS")>-1&&"safari"===sf.base.Browser.info.name&&!this.parent.enableVirtualization&&this.getPanel().firstElementChild.classList.add("e-mac-safari")},t.prototype.renderFrozenRigthPanel=function(){e.prototype.renderPanel.call(this)},t.prototype.renderEmpty=function(t){e.prototype.renderEmpty.call(this,t),this.getMovableContent().querySelector(se).innerHTML="<tr><td></td></tr>",sf.base.addClass([this.getMovableContent().querySelector(se).querySelector("tr")],["e-emptyrow"]),this.getFrozenContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getVisibleFrozenColumns(),this.getFrozenContent().style.borderRightWidth="0px",this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector("."+K).querySelector(se).innerHTML="",this.parent.getHeaderContent().querySelector("."+_).querySelector(se).innerHTML="")},t.prototype.renderFrozenRightEmpty=function(t){e.prototype.renderEmpty.call(this,t)},t.prototype.setFrozenContent=function(e){this.frozenContent=e},t.prototype.setMovableContent=function(e){this.movableContent=e},t.prototype.getFrozenContent=function(){return this.frozenContent},t.prototype.getMovableContent=function(){return this.movableContent},t.prototype.getModelGenerator=function(){return new Bs(this.parent)},t.prototype.renderFrozenRightTable=function(){e.prototype.renderTable.call(this)},t.prototype.renderTable=function(){var t;null==this.getFrozenContent().querySelector("."+X)?(e.prototype.renderTable.call(this),this.getFrozenContent().appendChild(this.getTable()),t=this.getTable().cloneNode(!0),this.getMovableContent().appendChild(t)):(this.setTable(this.getFrozenContent().querySelector("."+X)),this.setColGroup(this.parent.element.querySelector("."+H).querySelector(oe).cloneNode(!0)),this.getFrozenContent().querySelector("."+X).appendChild(this.getColGroup()),t=this.getMovableContent().querySelector("."+X),this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont")),this.getMovableContent().querySelector(oe)&&sf.base.remove(this.getMovableContent().querySelector(oe));var i=this.parent.getHeaderContent().querySelector("."+_).querySelector(oe).cloneNode(!0);t.insertBefore(i,t.querySelector(se));var r=this.parent.enableVirtualization?"":"flex";this.getPanel().firstChild.style.display=r,this.renderHorizontalScrollbar("e-frozenscrollbar e-frozen-left-scrollbar",this.getScrollbarDisplay())},t.prototype.getScrollbarDisplay=function(){var e="";return(this.parent.getFrozenColumns()&&!this.parent.getVisibleFrozenColumns()||this.parent.getFrozenLeftColumnsCount()&&!this.parent.getVisibleFrozenLeftCount())&&(e="none"),e},t.prototype.renderHorizontalScrollbar=function(e,t,i){var r=this.parent.createElement("div",{className:e,styles:"display:"+t}),n=this.parent.createElement("div",{className:"e-movablescrollbar"}),s=this.parent.createElement("div",{className:"e-movablechild"}),o=Di().toString();this.setScrollbarHeight(n,o),this.setScrollbarHeight(s,o),n.appendChild(s),this.appendScrollbar(r,n,i)},t.prototype.appendScrollbar=function(e,t,i){var r=this.parent.createElement("div",{className:"e-scrollbar",styles:"display: flex"});r.appendChild(e),r.appendChild(t),this.parent.getContent().appendChild(r)},t.prototype.setScrollbarHeight=function(e,t){e.style.minHeight=t+"px",e.style.maxHeight=t+"px"},t.prototype.setIsFrozen=function(e,t){e.isFrozen=!e.isFrozen},t.prototype.setTbody=function(e,t){var i;sf.base.isNullOrUndefined(e[0].cells[0])&&(this.getMovableContent().querySelector(se).innerHTML="");var r=e[0].cells[0],n=r.index;return sf.base.isUndefined(n)&&this.parent.isRowDragable()&&(n=(r=e[0].cells[1]).index),0===n&&(this.getPanel().firstChild.style.overflowX="hidden",this.parent.enableColumnVirtualization&&(this.getMovableContent().style.overflowX="hidden")),this.parent.enableColumnVirtualization&&t.renderMovableContent&&"virtualscroll"===t.requestType&&this.getMovableContent().scrollLeft>0&&0!==t.virtualInfo.columnIndexes[0]&&(n=this.parent.getFrozenColumns()),r&&r.column&&(i=r.column.getFreezeTableName()),this.setIdx(n),t.tableName=i,i},t.prototype.splitRows=function(e){e===ie?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):this.movableRows=this.rows},t.prototype.renderNextFrozentPart=function(e,t){var i=this.parent.enableVirtualization;t===ie&&(i&&(e.renderMovableContent=!0),this.refreshContentRows(sf.base.extend({},e)))},t.prototype.appendContent=function(e,t,i,r){this.parent.isReact&&!sf.base.isNullOrUndefined(this.parent.rowTemplate)?e=t:e.appendChild(t),r===ie?(this.isLoaded=!1,this.getFrozenContent().querySelector("table").appendChild(e)):(this.refreshTbody(e),this.isLoaded=!0,this.getMovableContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset(),this.widthService.refreshFrozenScrollbar()),this.isInitialRender&&(this.parent.scrollModule.setHeight(),this.isInitialRender=!1)},t.prototype.refreshScrollOffset=function(){if("auto"!==this.parent.height){var e=this.getTable().offsetHeight+1;this.setHeightToContent(e)}this.parent.notify("refresh-frozen-height",{})},t.prototype.getFrozenHeader=function(e){return e===ie?this.parent.getHeaderContent().querySelector("."+K).querySelector(se):this.parent.getHeaderContent().querySelector("."+_).querySelector(se)},t.prototype.refreshTbody=function(e){e.childElementCount<1&&e.appendChild(this.parent.createElement("tr").appendChild(this.parent.createElement("td")))},t.prototype.refreshHeight=function(){this.parent.allowTextWrap||this.parent.notify("freezerender",{case:"refreshHeight"}),this.getFrozenContent().style.borderRightWidth="1px"},t.prototype.setIdx=function(e){this.idx=e},t.prototype.getIdx=function(){return this.idx},t.prototype.getTbody=function(e){return e===ie?this.getTable().querySelector(se):this.getMovableContent().querySelector(se)},t}(me),Ls=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.addEventListener(),r}return Ns(t,e),t.prototype.addEventListener=function(){this.eventHandler=[{event:"freezerender",handler:this.refreshFreeze},{event:"frozenHeight",handler:this.setFrozenHeight},{event:v,handler:this.enableAfterRender}],Nr(this.parent,this.eventHandler,!0,this)},t.prototype.removeEventListener=function(){this.parent.isDestroyed||Nr(this.parent,this.eventHandler,!1)},t.prototype.renderTable=function(){e.prototype.renderTable.call(this),this.rfshMovable(),this.updateColgroup(),this.initializeHeaderDrag(),this.initializeHeaderDrop(),this.parent.notify(S,{rows:this.rows,args:{isFrozen:!1}})},t.prototype.renderPanel=function(){var t=this.parent.element.querySelector("."+K),i=this.parent.element.querySelector("."+_);e.prototype.renderPanel.call(this),sf.base.isNullOrUndefined(t)&&(t=this.parent.createElement("div",{className:"e-frozenheader e-frozen-left-header"}),i=this.parent.createElement("div",{className:_}),this.getPanel().querySelector("."+V).appendChild(t),this.getPanel().querySelector("."+V).appendChild(i)),this.setFrozenHeader(t),this.setMovableHeader(i)},t.prototype.renderFrozenRightPanel=function(){e.prototype.renderPanel.call(this)},t.prototype.renderFrozenRightTable=function(){e.prototype.renderTable.call(this)},t.prototype.refreshUI=function(){var t=this.getMovableHeader().querySelector(se);sf.base.remove(this.getMovableHeader().querySelector("table")),e.prototype.refreshUI.call(this),this.rfshMovable(),this.getMovableHeader().querySelector(se).innerHTML=t.innerHTML,this.updateColgroup(),this.widthService.setWidthToColumns(),this.parent.enableVirtualization||this.widthService.setWidthToTable(),this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&Pi([].slice.call(this.movableHeader.querySelectorAll("tr.e-columnheader")),!0),this.parent.updateDefaultCursor(),Ji(this.parent.getContentTable().querySelector(oe),this.parent.getFrozenColumns(),this.parent),this.widthService.refreshFrozenScrollbar(),this.initializeHeaderDrag(),this.parent.notify(S,{rows:this.rows,args:{isFrozen:!1}})},t.prototype.refreshFrozenLeftUI=function(){e.prototype.refreshUI.call(this)},t.prototype.rfshMovable=function(){this.getFrozenHeader().appendChild(this.getTable()),this.getMovableHeader().appendChild(this.createHeader(void 0,"movable")),this.refreshStackedHdrHgt(),this.addMovableFirstCls()},t.prototype.addMovableFirstCls=function(){if(this.parent.getVisibleFrozenColumns())for(var e=[].slice.call(this.parent.element.querySelector("."+_).querySelector("thead").getElementsByClassName("e-columnheader")),t=e.length,i=0;i<t;i++){var r=e[i].cells[0];r&&(sf.base.addClass([r],["e-movablefirst"]),e[i].cells[0].rowSpan>1&&(i+=e[i].cells[0].rowSpan-1))}},t.prototype.refreshFreeze=function(e){if("filter"===e.case){var t=this.getTable().querySelector(".e-filterbar");if(this.parent.allowFiltering&&t&&this.getMovableHeader().querySelector("thead")){this.getMovableHeader().querySelector("thead").appendChild(this.filterRenderer(t,this.parent.getFrozenColumns()));for(var i=0,r=[].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input"));i<r.length;i++){var n={element:r[i],floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}};sf.inputs.Input.bindInitialEvent(n)}}}else"textwrap"!==e.case&&"refreshHeight"!==e.case||(this.refreshHeight(e),this.parent.contentModule.refreshScrollOffset())},t.prototype.refreshHeight=function(e){var t,i,r=this.getFrozenHeader(),n=this.getMovableHeader(),s=this.parent.getContent(),o=this.parent.textWrapSettings.wrapMode,a=this.parent.getHeaderContent().querySelector("."+V).classList;"textwrap"===e.case?(("Header"!==o||e.isModeChg)&&(t=s.querySelector("."+W).querySelectorAll("tr"),i=s.querySelector("."+G).querySelectorAll("tr"),this.setWrapHeight(t,i,e.isModeChg,!0)),"Content"===o&&this.parent.allowTextWrap?a.add("e-wrap"):a.remove("e-wrap"),"Both"===o||e.isModeChg?(t=r.querySelectorAll("tr"),i=n.querySelectorAll("tr")):(i=n.querySelector("Content"===o?se:"thead").querySelectorAll("tr"),t=r.querySelector("Content"===o?se:"thead").querySelectorAll("tr")),this.parent.getHeaderContent().getElementsByClassName("e-stackedheadercell").length||this.setWrapHeight(t,i,e.isModeChg,!1,this.colDepth>1),this.refreshStackedHdrHgt()):"refreshHeight"===e.case&&(this.setWrapHeight(s.querySelector("."+W).querySelectorAll("tr"),s.querySelector("."+G).querySelectorAll("tr"),e.isModeChg),this.parent.getHeaderContent().getElementsByClassName("e-stackedheadercell").length||this.setWrapHeight(r.querySelectorAll("tr"),n.querySelectorAll("tr"),e.isModeChg))},t.prototype.enableAfterRender=function(e){"scroll"===e.module&&this.setFrozenHeight()},t.prototype.updateResizeHandler=function(){for(var e=[].slice.call(this.parent.getHeaderContent().getElementsByClassName("e-rhandler")),t=0;t<e.length;t++)e[t].style.height=e[t].parentElement.offsetHeight+"px"},t.prototype.setWrapHeight=function(e,t,i,r,n){for(var s,o,a=this.parent.allowTextWrap,l=this.parent.textWrapSettings.wrapMode,h=this.parent.getHeaderContent().querySelector("thead"),d=this.parent.getHeaderContent().querySelector(se),p=[],c=[],u=0,f=e.length;u<f;u++)sf.base.isNullOrUndefined(e[u])||sf.base.isNullOrUndefined(t[u])||(p[u]=e[u].getBoundingClientRect().height,c[u]=t[u].getBoundingClientRect().height);for(u=0,f=e.length;u<f;u++)(i&&("Header"===l&&r||"Content"===l&&h.contains(e[u])||"Header"===l&&d.contains(e[u]))||n)&&(e[u].style.height=null,t[u].style.height=null),s=p[u],o=c[u],!sf.base.isNullOrUndefined(e[u])&&e[u].childElementCount&&(a&&s<o||!a&&s<o||this.parent.allowResizing&&this.parent.resizeModule&&!1===this.parent.resizeModule.isFrozenColResized)&&(e[u].style.height=o+"px"),t&&!sf.base.isNullOrUndefined(t[u])&&t[u].childElementCount&&(a&&s>o||!a&&s>o||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(t[u].style.height=s+"px");a&&"auto"!==this.parent.height&&this.setFrozenHeight()},t.prototype.setFrozenHeight=function(e){void 0===e&&(e=Di());var t=this.parent.element.querySelector("."+G).getBoundingClientRect().height,i=this.parent.element.querySelector("."+G),r=this.parent.element.querySelector("."+W),n=this.parent.getContent().scrollWidth,s=this.parent.element.querySelector(".e-movablecontent table").scrollWidth+this.parent.getContentTable().scrollWidth;i.scrollWidth-i.clientWidth?(r.style.height=t-e+"px",r.style.borderBottom=""):(r.style.height=t+"px",(r.scrollHeight<=r.clientHeight||i.scrollHeight<=i.clientHeight)&&n===s&&this.parent.scrollModule.removePadding(),r.style.borderBottom="0px")},t.prototype.refreshStackedHdrHgt=function(){for(var e,t,i=[].slice.call(this.getFrozenHeader().getElementsByClassName("e-columnheader")),r=[].slice.call(this.getMovableHeader().getElementsByClassName("e-columnheader")),n=0,s=i.length;n<s;n++)e=this.getRowSpan(i[n]),t=this.getRowSpan(r[n]),e.min>1?this.updateStackedHdrRowHgt(n,e.max,i[n],r):t.min>1&&this.updateStackedHdrRowHgt(n,t.max,r[n],i);this.parent.allowResizing&&this.updateResizeHandler()},t.prototype.getRowSpan=function(e){for(var t,i,r,n=0,s=e.childElementCount;n<s;n++)0===n&&(i=e.children[0].rowSpan),t=e.children[n].rowSpan,i=Math.min(t,i),r=Math.max(t,i);return{min:i,max:r}},t.prototype.updateStackedHdrRowHgt=function(e,t,i,r){for(var n=0,s=0;s<t;s++)n+=r[e+s].style.height?parseInt(r[e+s].style.height,10):r[e+s].offsetHeight;i.style.height=n+"px"},t.prototype.setFrozenHeader=function(e){this.frozenHeader=e},t.prototype.setMovableHeader=function(e){this.movableHeader=e},t.prototype.getFrozenHeader=function(){return this.frozenHeader},t.prototype.getMovableHeader=function(){return this.movableHeader},t.prototype.updateColgroup=function(){var e=this.getMovableHeader().querySelector("table");sf.base.remove(this.getMovableHeader().querySelector(oe)),e.insertBefore(Ji(this.getFrozenHeader().querySelector(oe),this.parent.getFrozenColumns(),this.parent),e.querySelector("thead"))},t.prototype.filterRenderer=function(e,t,i){var r=e.cloneNode(!0);r.innerHTML="";for(var n=i||this.parent.getColumns().length,s=t;s<n;s++)r.appendChild(e.removeChild(e.children[t]));return r},t}(ye),qs=(ws=function(e,t){return(ws=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ws(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Hs=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.addEventListener(),r}return qs(t,e),t.prototype.addEventListener=function(){this.evtHandlers=[{event:"freezerender",handler:this.refreshFreeze},{event:"refresh-frozen-columns",handler:this.refreshFrozenColumns},{event:"set-reorder-destination-element",handler:this.setReorderElement},{event:"column-visible-changed",handler:this.setVisible}],Nr(this.parent,this.evtHandlers,!0,this)},t.prototype.removeEventListener=function(){this.parent.isDestroyed||Nr(this.parent,this.evtHandlers,!1)},t.prototype.setReorderElement=function(e){this.destEle=e.ele},t.prototype.refreshFrozenColumns=function(e){e.parent||this.parent.setProperties({columns:e.columns},!0);var t=yi(this.destEle,"e-frozen-left-header"),i=yi(this.destEle,"e-frozen-right-header"),r=this.parent.getFrozenLeftColumnsCount(),n=this.parent.getFrozenRightColumnsCount();e.column.freeze=null,t?e.column.freeze="Left":i&&(e.column.freeze="Right"),this.parent.setFrozenCount(),e.cancel=r!==this.parent.getFrozenLeftColumnsCount()||n!==this.parent.getFrozenRightColumnsCount(),e.cancel&&this.parent.refreshColumns()},t.prototype.setWrapHeight=function(e,t,i,r,n,s){for(var o,a,l,h=this.parent.allowTextWrap,d=this.parent.getHeaderContent().querySelector(se),p=this.parent.textWrapSettings.wrapMode,c=this.parent.getHeaderContent().querySelector("thead"),u=[],f=[],g=[],m=0,y=e.length;m<y;m++)sf.base.isNullOrUndefined(e[m])||sf.base.isNullOrUndefined(t[m])||(s&&(g[m]=s[m].getBoundingClientRect().height),f[m]=t[m].getBoundingClientRect().height,u[m]=e[m].getBoundingClientRect().height);for(m=0,y=e.length;m<y;m++){(i&&("Content"===p&&c.contains(e[m])||"Header"===p&&d.contains(e[m])||"Header"===p&&r)||n)&&(s[m]&&(s[m].style.height=null),e[m].style.height=null,t[m].style.height=null),o=u[m],a=f[m],l=g[m]?g[m]:0;var v=Math.max(o,a,l);!sf.base.isNullOrUndefined(e[m])&&e[m].childElementCount&&(h&&o<v||!h&&o<v||this.parent.allowResizing&&this.parent.resizeModule&&!1===this.parent.resizeModule.isFrozenColResized)&&(e[m].style.height=v+"px"),t&&!sf.base.isNullOrUndefined(t[m])&&t[m].childElementCount&&(h&&v>a||!h&&v>a||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(t[m].style.height=v+"px"),s&&!sf.base.isNullOrUndefined(s[m])&&s[m].childElementCount&&(h&&v>l||!h&&v>l||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(s[m].style.height=v+"px")}h&&this.setFrozenHeight()},t.prototype.refreshHeight=function(e){var t,i,r,n=this.parent.getFrozenMode()===ee,s=this.getFrozenRightHeader(),o=this.parent.getHeaderContent().querySelector("."+K),a=this.parent.getContent(),l=this.getMovableHeader(),h=this.parent.getHeaderContent().querySelector("."+V).classList,d=this.parent.textWrapSettings.wrapMode;"textwrap"===e.case?(("Header"!==d||e.isModeChg)&&(n&&(i=a.querySelector(".e-frozen-right-content").querySelectorAll("tr")),r=a.querySelector("."+G).querySelectorAll("tr"),t=a.querySelector("."+W).querySelectorAll("tr"),this.setWrapHeight(t,r,e.isModeChg,!0,!1,i)),"Content"===d&&this.parent.allowTextWrap?h.add("e-wrap"):h.remove("e-wrap"),"Both"===d||e.isModeChg?(n&&(i=s.querySelectorAll("tr")),t=o.querySelectorAll("tr"),r=l.querySelectorAll("tr")):(n&&(i=s.querySelector("Content"===d?se:"thead").querySelectorAll("tr")),t=o.querySelector("Content"===d?se:"thead").querySelectorAll("tr"),r=l.querySelector("Content"===d?se:"thead").querySelectorAll("tr")),this.parent.getHeaderContent().getElementsByClassName("e-stackedheadercell").length||this.setWrapHeight(t,r,e.isModeChg,!1,this.colDepth>1,i),this.refreshStackedHdrHgt()):"refreshHeight"===e.case&&(r=a.querySelector("."+G).querySelectorAll("tr"),t=a.querySelector("."+W).querySelectorAll("tr"),n&&(i=a.querySelector(".e-frozen-right-content").querySelectorAll("tr")),this.setWrapHeight(t,r,e.isModeChg,!1,!1,i),this.parent.getHeaderContent().getElementsByClassName("e-stackedheadercell").length||(n&&(i=s.querySelectorAll("tr")),t=o.querySelectorAll("tr"),r=l.querySelectorAll("tr"),this.setWrapHeight(t,r,e.isModeChg,!1,!1,i)))},t.prototype.setVisible=function(e){for(var t,i,r=this.parent,n=this.parent.getFrozenLeftColumnsCount(),s=this.parent.getFrozenRightColumnsCount(),o=this.parent.getMovableColumnsCount(),a=0,l=e.length;a<l;a++){var h=e[a];if(i=r.getNormalizedColumnIndex(h.uid),t=h.visible?"":"none","Left"===h.freeze||"Right"===h.freeze){if(n&&!s){var d=r.getHeaderContent().querySelector(".e-frozen-left-header").querySelector(oe);sf.base.setStyleAttribute(d.children[i],{display:t})}else if(!n&&s){var p=r.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(oe);sf.base.setStyleAttribute(p.children[i-o],{display:t})}}else{var c=r.getHeaderContent().querySelector("."+_).querySelector(oe);sf.base.setStyleAttribute(c.children[i-n],{display:t})}}this.refreshUI()},t.prototype.filterRenderer=function(t,i,r){return e.prototype.filterRenderer.call(this,t,i,r)},t.prototype.refreshUI=function(){var t,i=this.getMovableHeader().querySelector(se);sf.base.remove(this.getMovableHeader().querySelector("table")),this.parent.getFrozenMode()===ee&&(t=this.getFrozenRightHeader().querySelector(se),sf.base.remove(this.getFrozenRightHeader().querySelector("table"))),e.prototype.refreshFrozenLeftUI.call(this),this.rfshMovable(),this.getMovableHeader().querySelector(se).innerHTML=i.innerHTML,t&&(this.getFrozenRightHeader().querySelector(se).innerHTML=t.innerHTML),this.updateColgroup(),this.widthService.setWidthToColumns(),this.parent.notify("colgroup-refresh",{}),this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&Pi([].slice.call(this.getMovableHeader().querySelectorAll("tr.e-columnheader")),!0),this.parent.updateDefaultCursor();var r=this.parent.getContent().querySelector("."+G).querySelector("."+X);sf.base.remove(r.querySelector(oe));var n=this.getMovableHeader().querySelector(oe).cloneNode(!0);if(r.insertBefore(n,r.querySelector(se)),t){var s=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("."+X);sf.base.remove(s.querySelector(oe));var o=this.getFrozenRightHeader().querySelector(oe).cloneNode(!0);s.insertBefore(o,s.querySelector(se))}this.widthService.refreshFrozenScrollbar(),this.initializeHeaderDrag(),this.parent.notify(S,{rows:this.rows,args:{isFrozen:!1}})},t.prototype.refreshFreeze=function(e){var t=this.parent.getFrozenLeftColumnsCount(),i=this.parent.getFrozenRightColumnsCount(),r=this.parent.getMovableColumnsCount();if("filter"===e.case){var n=this.getTable().querySelector(".e-filterbar");if(this.parent.allowFiltering&&n&&this.getMovableHeader().querySelector("thead")){var s=this.parent.isRowDragable(),o=t?s?t+1:t:0,a=t+r+(t&&s?1:0);if(this.getMovableHeader().querySelector("thead").appendChild(this.filterRenderer(n,o,a)),this.parent.getFrozenMode()===ee){var l=[].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input"));this.getFrozenRightHeader().querySelector("thead").appendChild(this.filterRenderer(n,o,o+i)),this.adjudtFilterBarCell(l)}var h=[].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input"));this.adjudtFilterBarCell(h)}}else"textwrap"!==e.case&&"refreshHeight"!==e.case||(this.refreshHeight(e),this.parent.contentModule.refreshScrollOffset())},t.prototype.updateFrozenColGroup=function(e,t){e&&!1===e.visible&&sf.base.setStyleAttribute(t,{display:"none"})},t.prototype.adjudtFilterBarCell=function(e){for(var t=0,i=e;t<i.length;t++){var r={element:i[t],floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}};sf.inputs.Input.bindInitialEvent(r)}},t.prototype.renderPanel=function(){this.parent.getFrozenLeftColumnsCount()?(e.prototype.renderPanel.call(this),this.parent.getFrozenRightColumnsCount()&&this.renderLeftWithRightFrozenPanel()):this.renderRightFrozenPanelAlone(),this.getPanel().firstChild.style.display="flex",this.getMovableHeader().style.flex="1"},t.prototype.renderTable=function(){this.parent.getFrozenLeftColumnsCount()?e.prototype.renderTable.call(this):this.renderFrozenRightTableAlone()},t.prototype.rfshMovable=function(){if(this.parent.getFrozenLeftColumnsCount()){if(e.prototype.rfshMovable.call(this),this.parent.getFrozenRightColumnsCount()){var t=this.rows;this.getFrozenRightHeader().appendChild(this.createHeader(void 0,"frozen-right")),this.refreshStackedHdrHgt(),this.parent.notify(S,{rows:this.rows,args:{renderFrozenRightContent:!0}}),this.rows=t}}else this.getFrozenRightHeader().appendChild(this.getTable()),this.getMovableHeader().appendChild(this.createHeader(void 0,"movable")),this.refreshStackedHdrHgt(),this.addMovableFirstCls()},t.prototype.refreshStackedHdrHgt=function(){this.parent.getFrozenLeftColumnsCount()?(e.prototype.refreshStackedHdrHgt.call(this),this.parent.getFrozenRightColumnsCount()&&this.refreshFrozenRightStackedHdrHgt()):this.refreshFrozenRightStackedHdrHgt()},t.prototype.refreshFrozenRightStackedHdrHgt=function(){for(var e,t=[].slice.call(this.getFrozenRightHeader().getElementsByClassName("e-columnheader")),i=[].slice.call(this.getMovableHeader().getElementsByClassName("e-columnheader")),r=0,n=t.length;r<n;r++)(e=this.getRowSpan(t[r])).min>1&&this.updateStackedHdrRowHgt(r,e.max,t[r],i)},t.prototype.updateColgroup=function(){this.updateMovableColGroup(),this.parent.getFrozenLeftColumnsCount()&&this.updateFrozenLeftColGroup(),this.parent.getFrozenRightColumnsCount()&&this.updateFrozenRightColGroup()},t.prototype.renderRightFrozenPanelAlone=function(){var t=this.parent.element.querySelector("."+_),i=this.parent.element.querySelector(".e-frozen-right-header");e.prototype.renderFrozenRightPanel.call(this),sf.base.isNullOrUndefined(i)&&(t=this.parent.createElement("div",{className:_}),i=this.parent.createElement("div",{className:"e-frozenheader e-frozen-right-header"}),this.getPanel().querySelector("."+V).appendChild(t),this.getPanel().querySelector("."+V).appendChild(i)),e.prototype.setMovableHeader.call(this,t),this.setFrozenRightHeader(i)},t.prototype.renderLeftWithRightFrozenPanel=function(){var t=this.parent.element.querySelector(".e-frozen-right-header");e.prototype.renderFrozenRightPanel.call(this),sf.base.isNullOrUndefined(t)&&(t=this.parent.createElement("div",{className:"e-frozenheader e-frozen-right-header"}),this.getPanel().querySelector("."+V).appendChild(t)),this.setFrozenRightHeader(t)},t.prototype.renderFrozenRightTableAlone=function(){e.prototype.renderFrozenRightTable.call(this),this.rfshMovable(),this.updateColgroup(),this.initializeHeaderDrag(),this.initializeHeaderDrop(),this.parent.notify(S,{rows:this.rows,args:{isFrozen:!1}})},t.prototype.updateFrozenLeftColGroup=function(){for(var e=this.getFrozenHeader().querySelector(oe).children,t=this.parent.isRowDragable()?1:0,i=this.parent.isRowDragable()?this.parent.getFrozenLeftColumnsCount()+1:this.parent.getFrozenLeftColumnsCount(),r=t;r<e.length;r++)r>=i&&(sf.base.remove(e[r]),r--)},t.prototype.updateMovableColGroup=function(){var e=this.getMovableHeader().querySelector(oe).children;this.parent.isRowDragable()&&sf.base.remove(e[0]);for(var t=e.length,i=this.parent.getFrozenLeftColumnsCount(),r=this.parent.getMovableColumnsCount(),n=0,s=0;s<t;s++,n++)(s<i||s>=i+r)&&(sf.base.remove(e[n]),n--)},t.prototype.updateFrozenRightColGroup=function(){var e=this.parent.isRowDragable(),t=this.parent.getFrozenRightColumns(),i=this.getFrozenRightHeader().querySelector(oe).children;this.parent.getFrozenMode()===ee&&e&&sf.base.remove(i[0]);for(var r=i.length,n=this.parent.getFrozenLeftColumnsCount(),s=this.parent.getMovableColumnsCount(),o=0,a=0;a<r;a++)a<n+s?sf.base.remove(i[0]):(this.updateFrozenColGroup(t[o],i[o]),o++)},t.prototype.setFrozenRightHeader=function(e){this.frozenRightHeader=e},t.prototype.getFrozenRightHeader=function(){return this.frozenRightHeader},t}(Ls),Us=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.frzCount=0,r.isColGroupRefresh=!1,r.widthService=i.getService("widthService"),r}return qs(t,e),t.prototype.renderPanel=function(){this.parent.getFrozenLeftColumnsCount()?(e.prototype.renderPanel.call(this),this.parent.getFrozenRightColumnsCount()&&this.renderFrozenLeftWithRightPanel()):this.renderFrozenRightPanelAlone();var t=this.parent.enableVirtualization?"":"flex";this.getPanel().firstChild.style.display=t},t.prototype.renderTable=function(){if(this.parent.getFrozenLeftColumnsCount()){if(e.prototype.renderTable.call(this),this.parent.getFrozenRightColumnsCount()){this.renderFrozenLeftWithRightTable();var t=this.parent.getVisibleFrozenRightCount()?"":"none";this.renderHorizontalScrollbar("e-frozenscrollbar e-frozen-right-scrollbar",t,!0)}}else{this.renderFrozenRightTableAlone();t=this.parent.getVisibleFrozenRightCount()?"":"none";this.renderHorizontalScrollbar("e-frozenscrollbar e-frozen-right-scrollbar",t)}this.getMovableContent().style.flex="1"},t.prototype.appendScrollbar=function(e,t,i){var r=this.parent.createElement("div",{className:"e-scrollbar",styles:"display: flex"});if(this.parent.getFrozenLeftColumnsCount()){if(i)return void this.parent.getContent().querySelector(".e-scrollbar").appendChild(e);r.appendChild(e),r.appendChild(t)}else r.appendChild(t),r.appendChild(e);this.parent.getContent().appendChild(r)},t.prototype.renderFrozenRightPanelAlone=function(){this.renderFrozenRigthPanel();var t=this.parent.element.querySelector("."+G),i=this.parent.element.querySelector(".e-frozen-right-content");sf.base.isNullOrUndefined(i)&&(t=this.parent.createElement("div",{className:G}),i=this.parent.createElement("div",{className:"e-frozencontent e-frozen-right-content"}),this.getPanel().querySelector("."+Q).appendChild(t),this.getPanel().querySelector("."+Q).appendChild(i)),e.prototype.setMovableContent.call(this,t),this.setFrozenRightContent(i)},t.prototype.renderFrozenLeftWithRightPanel=function(){this.renderFrozenRigthPanel();var e=this.parent.element.querySelector(".e-frozen-right-content");sf.base.isNullOrUndefined(e)&&(e=this.parent.createElement("div",{className:"e-frozencontent e-frozen-right-content"}),this.getPanel().querySelector("."+Q).appendChild(e)),this.setFrozenRightContent(e)},t.prototype.renderFrozenRightTableAlone=function(){var t;null==this.getFrozenRightContent().querySelector("."+X)?(e.prototype.renderFrozenRightTable.call(this),this.getFrozenRightContent().appendChild(this.getTable()),t=this.getTable().cloneNode(!0),this.getMovableContent().appendChild(t)):(this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont"),this.setTable(this.getFrozenRightContent().querySelector("."+X)),this.setColGroup(this.getFrozenRightHeaderColGroup()),t=this.getMovableContent().querySelector("."+X),this.getFrozenRightContent().querySelector("."+X).appendChild(this.getColGroup())),this.getMovableContent().querySelector(oe)&&sf.base.remove(this.getMovableContent().querySelector(oe));var i=this.parent.getHeaderContent().querySelector("."+_).querySelector(oe).cloneNode(!0);t.insertBefore(i,t.querySelector(se))},t.prototype.renderFrozenLeftWithRightTable=function(){var e=this.getTable().cloneNode(!0);this.getFrozenRightContent().appendChild(e);var t=this.getFrozenRightContent().querySelector(oe);t&&sf.base.remove(t);var i=this.getFrozenRightContent().querySelector("."+X);i.insertBefore(this.getFrozenRightHeaderColGroup(),i.querySelector(se))},t.prototype.renderFrozenRightEmptyRowAlone=function(t){e.prototype.renderFrozenRightEmpty.call(this,t),this.getMovableContent().querySelector(se).innerHTML="<tr><td></td></tr>",sf.base.addClass([this.parent.getMovableContentTbody().querySelector("tr")],["e-emptyrow"]),this.getFrozenRightContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getVisibleFrozenRightCount(),this.parent.frozenRows&&(this.parent.getFrozenRightHeaderTbody().innerHTML="",this.parent.getMovableHeaderTbody().innerHTML="")},t.prototype.getFrozenHeader=function(e){return e===ie?this.parent.getHeaderContent().querySelector(".e-frozen-left-header").querySelector(se):"movable"===e?this.parent.getHeaderContent().querySelector("."+_).querySelector(se):this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(se)},t.prototype.renderFrozenLeftWithRightEmptyRow=function(){this.getFrozenRightContent().querySelector(se).innerHTML="<tr><td></td></tr>",sf.base.addClass([this.getFrozenRightContent().querySelector(se).querySelector("tr")],["e-emptyrow"]),this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(se).innerHTML="")},t.prototype.setFrozenRightContent=function(e){this.frozenRigthContent=e},t.prototype.getFrozenRightContent=function(){return this.frozenRigthContent},t.prototype.getHeaderColGroup=function(){var e=this.parent.element.querySelector("."+H).querySelector(oe).cloneNode(!0);if(!this.parent.getFrozenLeftColumnsCount()){var t=this.getFrozenRightHeaderColGroup();e=t&&this.frzCount?t.cloneNode(!0):e,this.frzCount++,this.isColGroupRefresh=!0}return e},t.prototype.getFrozenRightHeaderColGroup=function(){var e=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(oe);return e||(e=this.parent.getHeaderContent().querySelector(oe)),e.cloneNode(!0)},t.prototype.setColGroup=function(t){return this.parent.getFrozenLeftColumnsCount()?e.prototype.setColGroup.call(this,t):(t=this.isColGroupRefresh?t:this.getFrozenRightHeaderColGroup(),sf.base.isNullOrUndefined(t)||(t.id="content-"+t.id),this.isColGroupRefresh=!1,2===this.frzCount&&(this.frzCount=0),this.colgroup=t)},t.prototype.renderEmpty=function(t){this.parent.getFrozenLeftColumnsCount()?(e.prototype.renderEmpty.call(this,t),this.getFrozenContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getVisibleFrozenLeftCount(),this.parent.getFrozenRightColumnsCount()&&this.renderFrozenLeftWithRightEmptyRow()):this.renderFrozenRightEmptyRowAlone(t),this.parent.notify("freezerender",{case:"refreshHeight"})},t.prototype.setHeightToContent=function(e){this.parent.getFrozenRightColumnsCount()&&(this.getFrozenRightContent().style.height=e.toString()+"px"),this.parent.getFrozenLeftColumnsCount()&&(this.getFrozenContent().style.height=e.toString()+"px"),this.getMovableContent().style.height=e.toString()+"px"},t.prototype.actionComplete=function(t){e.prototype.actionComplete.call(this,t)},t.prototype.batchAdd=function(t){e.prototype.batchAdd.call(this,t)},t.prototype.getTbody=function(e){var t;return e===ie?t=this.parent.getFrozenLeftContentTbody():"movable"===e?t=this.parent.getMovableContentTbody():e===te&&(t=this.parent.getFrozenRightContentTbody()),t},t.prototype.setIsFrozen=function(e,t){e.isFrozen=t===ie||"Right"===this.parent.getFrozenMode()&&t===te,e.renderFrozenRightContent=this.parent.getFrozenMode()===ee&&t===te,e.renderMovableContent="movable"===t},t.prototype.appendContent=function(e,t,i,r){!sf.base.isNullOrUndefined(this.parent.rowTemplate)&&this.parent.isReact?e=t:e.appendChild(t),"Left"===this.parent.getFrozenMode()?r===ie?(this.isLoaded=!1,this.getFrozenContent().querySelector("table").appendChild(e),this.refreshContentRows(sf.base.extend({},i))):(this.refreshTbody(e),this.isLoaded=!0,this.getMovableContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset()):"Right"===this.parent.getFrozenMode()?"movable"===r?(this.refreshTbody(e),this.isLoaded=!0,this.getMovableContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset()):(this.isLoaded=!1,this.getFrozenRightContent().querySelector("table").appendChild(e),this.refreshContentRows(sf.base.extend({},i))):this.parent.getFrozenMode()===ee&&(r===ie?(this.isLoaded=!1,this.getFrozenContent().querySelector("table").appendChild(e),this.refreshContentRows(sf.base.extend({},i))):"movable"===r?(this.refreshTbody(e),this.isLoaded=!1,this.getMovableContent().querySelector("table").appendChild(e),this.refreshContentRows(sf.base.extend({},i))):(this.isLoaded=!0,this.getFrozenRightContent().querySelector("table").appendChild(e),this.refreshHeight(),this.refreshScrollOffset())),this.isInitialRender&&(this.parent.scrollModule.setHeight(),this.isInitialRender=!1),this.widthService.refreshFrozenScrollbar()},t.prototype.refreshHeight=function(){this.parent.allowTextWrap||this.parent.notify("freezerender",{case:"refreshHeight"})},t.prototype.splitRows=function(e){var t=this.parent.getFrozenLeftColumnsCount(),i=this.parent.getFrozenRightColumnsCount();t&&!i?e===ie?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):this.movableRows=this.rows:!t&&i?"movable"===e?this.movableRows=this.rows:(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):t&&i&&(e===ie?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):"movable"===e?(this.movableRows=this.rows,this.movableRowElements=this.rowElements):(this.frozenRightRows=this.rows,this.frozenRightRowElements=this.rowElements))},t.prototype.getMovableRowElements=function(){return this.parent.getFrozenMode()!==ee?this.rowElements:this.movableRowElements},t.prototype.getFrozenRightRowElements=function(){return this.parent.getFrozenMode()!==ee?this.freezeRowElements:this.frozenRightRowElements},t.prototype.getFrozenRightRows=function(){return this.parent.getFrozenMode()===ee?this.parent.enableInfiniteScrolling?this.rightFreezeRows:this.frozenRightRows:this.getRows()},t.prototype.getFrozenRightRowByIndex=function(e){return this.parent.getFrozenRightDataRows()[e]},t.prototype.getRows=function(){var e=this.getInfiniteRows();return e.length?e:this.freezeRows},t.prototype.getRowElements=function(){return this.freezeRowElements},t}(Ps),js=(Ss=function(e,t){return(Ss=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ss(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Vs=function(t){function i(e,i){var r=t.call(this,e,i)||this;return r.frzRows=[],r.mvblRows=[],r.frRows=[],r.serviceLoc=i,r.eventListener("on"),r.rowModelGenerator=new he(r.parent),r}return js(i,t),i.prototype.eventListener=function(e){this.parent[e](M,this.getVirtualData,this),this.parent[e]("set-freeze-selection",this.setFreezeSelection,this),this.parent[e]("refresh-virtual-frozenrows",this.refreshVirtualFrozenRows,this),this.parent.addEventListener(c,this.actionComplete.bind(this))},i.prototype.actionComplete=function(e){if("delete"===e.requestType&&this.parent.frozenRows)for(var t=0;t<this.parent.frozenRows;t++)no(this,t)},i.prototype.refreshVirtualFrozenRows=function(e){var t=this,i=this.parent;if("delete"===e.requestType&&i.frozenRows){e.isFrozenRowsRender=!0;var r=i.renderModule.data.generateQuery(!0).clone();r.page(1,i.pageSettings.pageSize),i.renderModule.data.getData({},r).then((function(r){_s(e,r.result,i.getSelectedRowIndexes(),i,t.rowModelGenerator,t.serviceLoc,t.virtualRenderer,t)}))}},i.prototype.getVirtualData=function(e){this.virtualRenderer.getVirtualData(e)},i.prototype.setFreezeSelection=function(e){Qs(e,this.virtualRenderer)},i.prototype.renderTable=function(){this.freezeRowGenerator=new Bs(this.parent),this.virtualRenderer=new Qn(this.parent,this.serviceLoc),this.virtualRenderer.header=this.serviceLoc.getService("rendererFactory").getRenderer(e.RenderType.Header).virtualHdrRenderer,t.prototype.renderTable.call(this),this.virtualRenderer.setPanel(this.parent.getContent()),this.scrollbar=this.parent.getContent().querySelector(".e-movablescrollbar");var i=this.getMovableContent(),r=this.parent.height;if(this.virtualRenderer.virtualEle.content=this.virtualRenderer.content=this.getPanel().querySelector("."+Q),this.virtualRenderer.virtualEle.content.style.overflowX="hidden",this.virtualRenderer.virtualEle.renderFrozenWrapper(r),this.virtualRenderer.virtualEle.renderFrozenPlaceHolder(),this.parent.enableColumnVirtualization){this.virtualRenderer.virtualEle.movableContent=this.virtualRenderer.movableContent=this.getPanel().querySelector("."+G),this.virtualRenderer.virtualEle.renderMovableWrapper(r),this.virtualRenderer.virtualEle.renderMovablePlaceHolder();var n=i.querySelector("table");this.virtualRenderer.virtualEle.movableTable=n,this.virtualRenderer.virtualEle.movableWrapper.appendChild(n),i.appendChild(this.virtualRenderer.virtualEle.movableWrapper),i.appendChild(this.virtualRenderer.virtualEle.movablePlaceholder)}this.virtualRenderer.virtualEle.wrapper.appendChild(this.getFrozenContent()),this.virtualRenderer.virtualEle.wrapper.appendChild(i),this.virtualRenderer.virtualEle.table=this.getTable(),so(this.parent,this.virtualRenderer,this.scrollbar,this.getMovableContent())},i.prototype.appendContent=function(e,t,i){Ys(this.virtualRenderer,this.widthService,e,t,i)},i.prototype.generateRows=function(e,t){return this.firstPageRecords||(this.firstPageRecords=e),Js(this.virtualRenderer,e,t,this.freezeRowGenerator,this.parent)},i.prototype.getRowByIndex=function(e){return this.virtualRenderer.getRowByIndex(e)},i.prototype.getMovableRowByIndex=function(e){return this.virtualRenderer.getMovableVirtualRowByIndex(e)},i.prototype.collectRows=function(e){return Ks(e,this.virtualRenderer,this.parent)},i.prototype.getMovableRows=function(){return this.collectRows("movable")},i.prototype.getRows=function(){return this.collectRows("frozen-left")},i.prototype.getColGroup=function(){var e=this.parent.getMovableVirtualContent();return this.isXaxis()?e.querySelector(oe):this.colgroup},i.prototype.getReorderedFrozenRows=function(e){return Zs(e,this.virtualRenderer,this.parent,this.freezeRowGenerator,this.firstPageRecords)},i.prototype.isXaxis=function(){return $s(this.virtualRenderer)},i.prototype.getHeaderCells=function(){return eo(this.virtualRenderer,this.parent)},i.prototype.getVirtualFreezeHeader=function(){return to(this.virtualRenderer,this.parent)},i.prototype.ensureFrozenCols=function(e){return io(e,this.parent)},i.prototype.getRowObjectByIndex=function(e){return this.virtualRenderer.getRowObjectByIndex(e)},i.prototype.setColGroup=function(e){return ro(e,this.virtualRenderer,this)},i}(Ps),Gs=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.serviceLoc=i,r}return js(t,e),t.prototype.renderTable=function(){this.virtualHdrRenderer=new Xn(this.parent,this.serviceLoc),this.virtualHdrRenderer.gen.refreshColOffsets(),this.parent.setColumnIndexesInView(this.virtualHdrRenderer.gen.getColumnIndexes(this.getPanel().querySelector("."+V))),this.virtualHdrRenderer.virtualEle.content=this.getPanel().querySelector("."+V),this.virtualHdrRenderer.virtualEle.renderFrozenWrapper(),this.virtualHdrRenderer.virtualEle.renderFrozenPlaceHolder(),this.parent.enableColumnVirtualization&&(this.virtualHdrRenderer.virtualEle.movableContent=this.getPanel().querySelector("."+_),this.virtualHdrRenderer.virtualEle.renderMovableWrapper(),this.virtualHdrRenderer.virtualEle.renderMovablePlaceHolder()),e.prototype.renderTable.call(this),this.virtualHdrRenderer.setPanel(this.parent.getHeaderContent())},t.prototype.rfshMovable=function(){this.getFrozenHeader().appendChild(this.getTable()),this.virtualHdrRenderer.virtualEle.wrapper.appendChild(this.getFrozenHeader()),this.parent.enableColumnVirtualization?this.virtualHdrRenderer.virtualEle.movableWrapper.appendChild(this.createHeader(void 0,"movable")):this.getMovableHeader().appendChild(this.createTable()),this.virtualHdrRenderer.virtualEle.wrapper.appendChild(this.getMovableHeader())},t}(Ls);function _s(e,t,i,r,n,s,o,a){r.clearSelection(),e.startIndex=0;var l=new le(s,null,r),h=n.generateRows(t,e);e.renderMovableContent?(o.vgenerator.movableCache[1]=h,h=r.getMovableRowsObject()):e.renderFrozenRightContent||e.renderMovableContent?e.renderFrozenRightContent&&(o.vgenerator.frozenRightCache[1]=h,h=r.getFrozenRightRowsObject()):(o.vgenerator.cache[1]=h,h=r.getRowsObject());var d=e.renderMovableContent||e.renderFrozenRightContent?e.renderMovableContent?r.getHeaderContent().querySelector("."+_).querySelector(se):r.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(se):r.getHeaderContent().querySelector("."+K).querySelector(se);d.innerHTML="";for(var p=0;p<r.frozenRows;p++)if(d.appendChild(l.render(h[p],r.getColumns())),i.indexOf(p)>-1){h[p].isSelected=!0;for(var c=0;c<h[p].cells.length;c++)h[p].cells[c].isSelected=!0}e.renderMovableContent?a.mvblRows=o.vgenerator.movableCache[1]:e.renderMovableContent||e.renderFrozenRightContent?e.renderFrozenRightContent&&(a.frRows=o.vgenerator.frozenRightCache[1]):a.frzRows=o.vgenerator.cache[1],e.renderMovableContent=!e.renderMovableContent&&!e.renderFrozenRightContent,e.renderFrozenRightContent=r.getFrozenMode()===ee&&!e.renderMovableContent&&!e.renderFrozenRightContent,(e.renderMovableContent||e.renderFrozenRightContent)&&(_s(e,t,i,r,n,s,o,a),e.renderMovableContent||e.renderFrozenRightContent||(e.isFrozenRowsRender=!1))}function Ws(e,t,i){for(var r=[],n=0;n<e.length;n++)r.push(sf.base.extend({},e[n])),r[n].cells=wr(i,r[n].cells,t);return r}function Ks(e,t,i){var r,n=[];e===ie?r=t.vgenerator.cache:"movable"===e?r=t.vgenerator.movableCache:e===te&&(r="Right"===i.getFrozenMode()?t.vgenerator.cache:t.vgenerator.frozenRightCache);for(var s=Object.keys(r),o=0;o<s.length;o++)n=n.concat(Ws(r[s[o]],e,i));return n}function Qs(e,t){for(var i=Object.keys(t.vgenerator.cache),r=Object.keys(t.vgenerator.movableCache),n=Object.keys(t.vgenerator.frozenRightCache),s=0;s<i.length;s++)Xs(e,t.vgenerator.cache[i[s]]);for(s=0;s<r.length;s++)Xs(e,t.vgenerator.movableCache[r[s]]);for(s=0;s<n.length;s++)Xs(e,t.vgenerator.frozenRightCache[n[s]])}function Xs(e,t){for(var i=t.filter((function(t){return e.clearAll||e.uid===t.uid})),r=0;r<i.length;r++){i[r].isSelected=e.set;for(var n=i[r].cells,s=0;s<n.length;s++)n[s].isSelected=e.set}}function Ys(e,t,i,r,n){e.appendContent(i,r,n),t.refreshFrozenScrollbar()}function Js(e,t,i,r,n){var s;s=e.vgenerator.generateRows(t,i).map((function(e){return sf.base.extend({},e)}));var o=r.generateRows(t,i,s);return n.frozenRows&&"delete"===i.requestType&&1===n.pageSettings.currentPage&&(o=o.slice(n.frozenRows)),o}function Zs(e,t,i,r,n){var s=e.virtualInfo.blockIndexes,o=e.virtualInfo.columnIndexes,a=e.virtualInfo.page;e.virtualInfo.blockIndexes=[1,2],e.virtualInfo.page=1,e.renderMovableContent||(e.virtualInfo.columnIndexes=[]);var l=i.getCurrentViewRecords().length;n=i.renderModule.data.dataManager.dataSource.json.slice(0,l);var h=function(e,t,i,r){var n;n=i.renderMovableContent?"movable":i.renderFrozenRightContent?"frozen-right":"frozen-left";for(var s=0,o=e.length;s<o;s++)e[s].cells=wr(t,e[s].cells,n);return e}(t.vgenerator.generateRows(n,e),i,e);return e.virtualInfo.blockIndexes=s,e.virtualInfo.columnIndexes=o,e.virtualInfo.page=a,h.splice(0,i.frozenRows)}function $s(e){var t=!1;return e&&(t="virtualscroll"===e.requestType&&"X"===e.currentInfo.sentinelInfo.axis),t}function eo(e,t){var i=$s(e)?t.getMovableVirtualHeader():t.getHeaderContent();return i?[].slice.call(i.querySelectorAll(".e-headercell:not(.e-stackedheadercell)")):[]}function to(e,t){return $s(e)?t.getMovableVirtualHeader().querySelector("."+X):t.getFrozenVirtualHeader().querySelector("."+X)}function io(e,t){return e=t.columns.slice(0,t.getFrozenColumns()).concat(e)}function ro(e,t,i){return $s(t)||(sf.base.isNullOrUndefined(e)||(e.id="content-"+e.id),i.colgroup=e),i.colgroup}function no(e,t){e.virtualRenderer.vgenerator.cache[1]?e.virtualRenderer.vgenerator.cache[1][t]=e.frzRows[t]:e.virtualRenderer.vgenerator.cache[1]=e.frzRows,e.virtualRenderer.vgenerator.movableCache[1]?e.virtualRenderer.vgenerator.movableCache[1][t]=e.mvblRows[t]:e.virtualRenderer.vgenerator.movableCache[1]=e.mvblRows}function so(e,t,i,r){var n=e.dataSource instanceof sf.data.DataManager&&!e.dataSource.dataSource.offline,s={container:t.content,pageHeight:2*t.getBlockHeight(),debounceEvent:n,axes:e.enableColumnVirtualization?["X","Y"]:["Y"],scrollbar:i,movableContainer:r};t.observer=new _n(t.virtualEle.wrapper,s,t.virtualEle.movableWrapper)}var oo,ao,lo,ho,po,co,uo,fo,go=function(t){function i(e,i){var r=t.call(this,e,i)||this;return r.frRows=[],r.frzRows=[],r.mvblRows=[],r.serviceLoc=i,r.eventListener("on"),r.rowModelGenerator=new he(r.parent),r}return js(i,t),i.prototype.actionComplete=function(e){if("delete"===e.requestType&&this.parent.frozenRows)for(var t=0;t<this.parent.frozenRows;t++){if(!this.virtualRenderer.vgenerator.frozenRightCache[1]){this.virtualRenderer.vgenerator.frozenRightCache[1]=this.frRows.length?this.frRows:this.frzRows;break}this.virtualRenderer.vgenerator.frozenRightCache[1][t]=this.frRows.length?this.frRows[t]:this.frzRows[t],no(this,t)}},i.prototype.eventListener=function(e){this.parent.addEventListener(c,this.actionComplete.bind(this)),this.parent[e]("refresh-virtual-frozenrows",this.refreshVirtualFrozenRows,this),this.parent[e](M,this.getVirtualData,this),this.parent[e]("set-freeze-selection",this.setFreezeSelection,this)},i.prototype.refreshVirtualFrozenRows=function(e){var t=this;if("delete"===e.requestType&&this.parent.frozenRows){e.isFrozenRowsRender=!0;var i=this.parent.renderModule.data.generateQuery(!0).clone();i.page(1,this.parent.pageSettings.pageSize);var r=this.parent.getSelectedRowIndexes();this.parent.renderModule.data.getData({},i).then((function(i){_s(e,i.result,r,t.parent,t.rowModelGenerator,t.serviceLoc,t.virtualRenderer,t)}))}},i.prototype.setFreezeSelection=function(e){Qs(e,this.virtualRenderer)},i.prototype.getVirtualData=function(e){this.virtualRenderer.getVirtualData(e)},i.prototype.renderNextFrozentPart=function(e,t){e.renderMovableContent=this.parent.getFrozenLeftCount()?t===ie:t===te,e.renderFrozenRightContent=this.parent.getFrozenMode()===ee&&"movable"===t,(e.renderMovableContent||e.renderFrozenRightContent)&&this.refreshContentRows(sf.base.extend({},e))},i.prototype.renderTable=function(){this.virtualRenderer=new Qn(this.parent,this.serviceLoc),this.virtualRenderer.header=this.serviceLoc.getService("rendererFactory").getRenderer(e.RenderType.Header).virtualHdrRenderer,this.freezeRowGenerator=new Bs(this.parent),t.prototype.renderTable.call(this),this.virtualRenderer.setPanel(this.parent.getContent()),this.scrollbar=this.parent.getContent().querySelector(".e-movablescrollbar");var i=this.getFrozenRightContent(),r=this.getFrozenContent(),n=this.getMovableContent();"Right"===this.parent.getFrozenMode()&&(r=i),this.virtualRenderer.virtualEle.content=this.virtualRenderer.content=this.getPanel().querySelector("."+Q),this.virtualRenderer.virtualEle.content.style.overflowX="hidden";var s=this.parent.height;this.virtualRenderer.virtualEle.renderFrozenWrapper(s),this.virtualRenderer.virtualEle.renderFrozenPlaceHolder(),this.renderVirtualFrozenLeft(r,n),this.renderVirtualFrozenRight(r,n),this.renderVirtualFrozenLeftRight(r,n,i),this.virtualRenderer.virtualEle.table=this.getTable(),so(this.parent,this.virtualRenderer,this.scrollbar,this.getMovableContent())},i.prototype.renderVirtualFrozenLeft=function(e,t){"Left"===this.parent.getFrozenMode()&&(this.virtualRenderer.virtualEle.wrapper.appendChild(e),this.virtualRenderer.virtualEle.wrapper.appendChild(t))},i.prototype.renderVirtualFrozenRight=function(e,t){"Right"===this.parent.getFrozenMode()&&(this.virtualRenderer.virtualEle.wrapper.appendChild(t),this.virtualRenderer.virtualEle.wrapper.appendChild(e))},i.prototype.renderVirtualFrozenLeftRight=function(e,t,i){this.parent.getFrozenMode()===ee&&(this.virtualRenderer.virtualEle.wrapper.appendChild(e),this.virtualRenderer.virtualEle.wrapper.appendChild(t),this.virtualRenderer.virtualEle.wrapper.appendChild(i))},i.prototype.appendContent=function(e,t,i){Ys(this.virtualRenderer,this.widthService,e,t,i),this.refreshScrollOffset()},i.prototype.generateRows=function(e,t){return this.firstPageRecords||(this.firstPageRecords=e),Js(this.virtualRenderer,e,t,this.freezeRowGenerator,this.parent)},i.prototype.getRowByIndex=function(e){return this.virtualRenderer.getRowByIndex(e)},i.prototype.getFrozenRightRowByIndex=function(e){return this.virtualRenderer.getFrozenRightVirtualRowByIndex(e)},i.prototype.collectRows=function(e){return Ks(e,this.virtualRenderer,this.parent)},i.prototype.getMovableRowByIndex=function(e){return this.virtualRenderer.getMovableVirtualRowByIndex(e)},i.prototype.getFrozenRightRows=function(){return this.collectRows("frozen-right")},i.prototype.getMovableRows=function(){return this.collectRows("movable")},i.prototype.getColGroup=function(){var e=this.parent.getMovableVirtualContent();return $s(this.virtualRenderer)?e.querySelector(oe):this.colgroup},i.prototype.getRows=function(){return this.collectRows("Right"===this.parent.getFrozenMode()?"frozen-right":"frozen-left")},i.prototype.getReorderedFrozenRows=function(e){return Zs(e,this.virtualRenderer,this.parent,this.freezeRowGenerator,this.firstPageRecords)},i.prototype.getHeaderCells=function(){return eo(this.virtualRenderer,this.parent)},i.prototype.isXaxis=function(){return $s(this.virtualRenderer)},i.prototype.getVirtualFreezeHeader=function(){return to(this.virtualRenderer,this.parent)},i.prototype.getRowObjectByIndex=function(e){return this.virtualRenderer.getRowObjectByIndex(e)},i.prototype.ensureFrozenCols=function(e){return io(e,this.parent)},i.prototype.setColGroup=function(e){return ro(e,this.virtualRenderer,this)},i}(Us),mo=function(){function t(e,t){this.parent=e,this.locator=t,this.addEventListener()}return t.prototype.getModuleName=function(){return"freeze"},t.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(f,this.instantiateRenderer,this),this.parent.on(F,this.destroy,this))},t.prototype.instantiateRenderer=function(){this.parent.log("limitation",this.getModuleName());var t=this.locator.getService("rendererFactory");this.parent.getFrozenColumns()&&(this.parent.enableColumnVirtualization?t.addRenderer(e.RenderType.Header,new Gs(this.parent,this.locator)):t.addRenderer(e.RenderType.Header,new Ls(this.parent,this.locator)),this.parent.enableVirtualization?t.addRenderer(e.RenderType.Content,new Vs(this.parent,this.locator)):t.addRenderer(e.RenderType.Content,new Ps(this.parent,this.locator))),(this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount())&&(t.addRenderer(e.RenderType.Header,new Hs(this.parent,this.locator)),this.parent.enableVirtualization?t.addRenderer(e.RenderType.Content,new go(this.parent,this.locator)):t.addRenderer(e.RenderType.Content,new Us(this.parent,this.locator)))},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(f,this.instantiateRenderer),this.parent.off(F,this.destroy))},t.prototype.destroy=function(){this.removeEventListener()},t}(),yo=function(){function e(e,t){this.defaultItems={},this.localeText=this.setLocaleKey(),this.disableItems=[],this.hiddenItems=[],this.isOpen=!1,this.GROUP="e-icon-group",this.UNGROUP="e-icon-ungroup",this.ASCENDING="e-icon-ascending",this.DESCENDING="e-icon-descending",this.ROOT="e-columnmenu",this.FILTER="e-icon-filter",this.POP="e-filter-popup",this.WRAP="e-col-menu",this.CHOOSER="_chooser_",this.parent=e,this.gridID=e.element.id,this.serviceLocator=t,this.addEventListener()}return e.prototype.wireEvents=function(){for(var e=this.getColumnMenuHandlers(),t=0;t<e.length;t++)sf.base.EventHandler.add(e[t],"mousedown",this.columnMenuHandlerDown,this)},e.prototype.unwireEvents=function(){for(var e=this.getColumnMenuHandlers(),t=0;t<e.length;t++)sf.base.EventHandler.remove(e[t],"mousedown",this.columnMenuHandlerDown)},e.prototype.destroy=function(){var e=this.parent.element;e&&(e.querySelector("."+H)||e.querySelector("."+U))&&(this.columnMenu.destroy(),this.removeEventListener(),this.unwireFilterEvents(),this.unwireEvents(),this.element.parentNode&&sf.base.remove(this.element))},e.prototype.columnMenuHandlerClick=function(e){e.target.classList.contains("e-columnmenu")&&(this.columnMenu.items=this.getItems(),this.columnMenu.dataBind(),this.isOpen&&this.headerCell!==this.getHeaderCell(e)||document.querySelector(".e-grid-menu .e-menu-parent.e-ul")?(this.columnMenu.close(),this.openColumnMenu(e)):this.isOpen?this.columnMenu.close():this.openColumnMenu(e))},e.prototype.openColumnMenuByField=function(e){this.openColumnMenu({target:this.parent.getColumnHeaderByField(e).querySelector(".e-columnmenu")})},e.prototype.openColumnMenu=function(e){var t={top:0,left:0};this.element.style.cssText="display:block;visibility:hidden";var i=this.element.getBoundingClientRect();this.element.style.cssText="display:none;visibility:visible",this.headerCell=this.getHeaderCell(e),sf.base.Browser.isDevice?(t.top=window.innerHeight/2-i.height/2,t.left=window.innerWidth/2-i.width/2):this.parent.enableRtl?t=sf.popups.calculatePosition(this.headerCell,"left","bottom"):(t=sf.popups.calculatePosition(this.headerCell,"right","bottom")).left-=i.width,this.columnMenu.open(t.top,t.left),e.preventDefault&&e.preventDefault(),hr(this.parent.element,this.columnMenu.element.parentElement)},e.prototype.columnMenuHandlerDown=function(){this.isOpen=!("none"===this.element.style.display||""===this.element.style.display)},e.prototype.getColumnMenuHandlers=function(){return[].slice.call(this.parent.getHeaderTable().getElementsByClassName(this.ROOT))},e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(S,this.wireEvents,this),this.parent.on(v,this.enableAfterRenderMenu,this),this.parent.on(g,this.render,this),this.isFilterItemAdded()&&this.parent.on("filterDialogCreated",this.filterPosition,this),this.parent.on(R,this.columnMenuHandlerClick,this),this.parent.on(x,this.keyPressHandler,this),this.parent.on(F,this.destroy,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(S,this.unwireEvents),this.parent.off(v,this.enableAfterRenderMenu),this.parent.off(g,this.render),this.isFilterItemAdded()&&this.parent.off("filterDialogCreated",this.filterPosition),this.parent.off(R,this.columnMenuHandlerClick),this.parent.off(x,this.keyPressHandler),this.parent.off(F,this.destroy))},e.prototype.keyPressHandler=function(e){var t=this.parent;if("altDownArrow"===e.action){var i=t.focusModule.currentInfo.element;if(i&&i.classList.contains("e-headercell")){var r=t.getColumnByUid(i.firstElementChild.getAttribute("e-mappinguid"));this.openColumnMenuByField(r.field)}}},e.prototype.enableAfterRenderMenu=function(e){e.module===this.getModuleName()&&e.enable&&(this.columnMenu&&(this.columnMenu.destroy(),sf.base.remove(this.element)),this.render())},e.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization"),this.element=this.parent.createElement("ul",{id:this.gridID+"_columnmenu",className:"e-colmenu"}),this.element.setAttribute("aria-label",this.l10n.getConstant("ColumnMenuDialogARIA")),this.parent.element.appendChild(this.element),this.columnMenu=new sf.navigations.ContextMenu({cssClass:"e-grid-menu",enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,items:this.getItems(),select:this.columnMenuItemClick.bind(this),beforeOpen:this.columnMenuBeforeOpen.bind(this),onOpen:this.columnMenuOnOpen.bind(this),onClose:this.columnMenuOnClose.bind(this),beforeItemRender:this.beforeMenuItemRender.bind(this),beforeClose:this.columnMenuBeforeClose.bind(this)}),this.columnMenu.appendTo(this.element),this.wireFilterEvents()},e.prototype.wireFilterEvents=function(){!sf.base.Browser.isDevice&&this.isFilterItemAdded()&&sf.base.EventHandler.add(this.element,"mouseover",this.appendFilter,this)},e.prototype.unwireFilterEvents=function(){!sf.base.Browser.isDevice&&this.isFilterItemAdded()&&sf.base.EventHandler.remove(this.element,"mouseover",this.appendFilter)},e.prototype.beforeMenuItemRender=function(e){if(this.isChooserItem(e.item)){var t=this.getKeyFromId(e.item.id,this.CHOOSER),i=this.parent.columnModel.filter((function(e){return e.field===t})),r=sf.buttons.createCheckBox(this.parent.createElement,!1,{label:e.item.text,checked:i[0].visible});this.parent.enableRtl&&r.classList.add("e-rtl"),e.element.innerHTML="",e.element.appendChild(r)}else e.item.id&&"Filter"===this.getKeyFromId(e.item.id)&&(e.element.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),e.element.className+="e-filter-item e-menu-caret-icon")},e.prototype.columnMenuBeforeClose=function(e){var t=e.event?sf.base.closest(e.event.target,".e-menu-item"):null;(!sf.base.isNullOrUndefined(e.parentItem)&&"ColumnChooser"===this.getKeyFromId(e.parentItem.id)&&t&&this.isChooserItem(t)||e.event&&(sf.base.closest(e.event.target,"."+this.POP)||e.event.currentTarget&&e.event.currentTarget.activeElement&&yi(e.event.currentTarget.activeElement,"e-filter-popup")||yi(e.event.target,"e-popup")||yi(e.event.target,"e-popup-wrapper"))&&!sf.base.Browser.isDevice)&&(e.cancel=!0)},e.prototype.isChooserItem=function(e){return e.id&&e.id.indexOf("_colmenu_")>=0&&-1===this.getKeyFromId(e.id,this.CHOOSER).indexOf("_colmenu_")},e.prototype.columnMenuBeforeOpen=function(e){e.column=this.targetColumn=this.getColumn(),this.parent.trigger("columnMenuOpen",e);for(var t=0,i=e.items;t<i.length;t++){var r=i[t],n=this.getKeyFromId(r.id),s=this.defaultItems[n];-1!==this.getDefaultItems().indexOf(n)&&this.ensureDisabledStatus(n)&&!s.hide&&this.disableItems.push(r.text),r.hide&&this.hiddenItems.push(r.text)}this.columnMenu.enableItems(this.disableItems,!1),this.columnMenu.hideItems(this.hiddenItems)},e.prototype.columnMenuOnOpen=function(e){"e-menu-parent e-ul "===e.element.className&&(e.element.offsetHeight>window.innerHeight||this.parent.element.offsetHeight>window.innerHeight)&&(e.element.style.maxHeight=.8*window.innerHeight+"px",e.element.style.overflowY="auto")},e.prototype.ensureDisabledStatus=function(e){var t=!1;switch(e){case"Group":(!this.parent.allowGrouping||this.parent.ensureModuleInjected(zn)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)>=0||this.targetColumn&&!this.targetColumn.allowGrouping)&&(t=!0);break;case"AutoFitAll":case"AutoFit":t=!this.parent.ensureModuleInjected(En);break;case"Ungroup":(!this.parent.ensureModuleInjected(zn)||this.parent.ensureModuleInjected(zn)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)<0)&&(t=!0);break;case"SortDescending":case"SortAscending":if(this.parent.allowSorting&&this.parent.ensureModuleInjected(rn)&&this.parent.sortSettings.columns.length>0&&this.targetColumn&&this.targetColumn.allowSorting)for(var i=this.parent.sortSettings.columns,r=0;r<i.length;r++)i[r].field===this.targetColumn.field&&i[r].direction.toLocaleLowerCase()===e.toLocaleLowerCase().replace("sort","")&&(t=!0);else(!this.parent.allowSorting||!this.parent.ensureModuleInjected(rn)||this.parent.allowSorting&&this.targetColumn&&!this.targetColumn.allowSorting)&&(t=!0);break;case"Filter":this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&this.parent.ensureModuleInjected(Rn)&&this.targetColumn&&this.targetColumn.allowFiltering?t=!1:this.parent.ensureModuleInjected(Rn)&&this.parent.allowFiltering&&this.targetColumn&&(!this.targetColumn.allowFiltering||"FilterBar"===this.parent.filterSettings.type)&&(t=!0)}return t},e.prototype.columnMenuItemClick=function(e){switch(this.isChooserItem(e.item)?"ColumnChooser":this.getKeyFromId(e.item.id)){case"AutoFit":this.parent.autoFitColumns(this.targetColumn.field);break;case"AutoFitAll":this.parent.autoFitColumns([]);break;case"Ungroup":this.parent.ungroupColumn(this.targetColumn.field);break;case"Group":this.parent.groupColumn(this.targetColumn.field);break;case"SortAscending":this.parent.sortColumn(this.targetColumn.field,"Ascending");break;case"SortDescending":this.parent.sortColumn(this.targetColumn.field,"Descending");break;case"ColumnChooser":var t=this.getKeyFromId(e.item.id,this.CHOOSER),i=e.element.querySelector(".e-checkbox-wrapper .e-frame");i&&i.classList.contains("e-check")?(i.classList.remove("e-check"),this.parent.hideColumns(t,"field")):i&&(this.parent.showColumns(t,"field"),i.classList.add("e-check"));break;case"Filter":this.getFilter(e.element,e.item.id)}e.column=this.targetColumn,this.parent.trigger("columnMenuClick",e)},e.prototype.columnMenuOnClose=function(e){e.items.length>0&&e.items[0].parentObj instanceof sf.navigations.ContextMenu&&(this.columnMenu.enableItems(this.disableItems,!1),this.disableItems=[],this.columnMenu.showItems(this.hiddenItems),this.hiddenItems=[],this.isFilterPopupOpen()&&this.getFilter(e.element,e.element.id,!0)),this.parent.isFrozenGrid()||this.parent.notify("restore-Focus",{})},e.prototype.getDefaultItems=function(){return["AutoFitAll","AutoFit","SortAscending","SortDescending","Group","Ungroup","ColumnChooser","Filter"]},e.prototype.getItems=function(){for(var e=[],t=0,i=this.parent.columnMenuItems?this.parent.columnMenuItems:this.getDefault();t<i.length;t++){var r=i[t];if("string"==typeof r)if("ColumnChooser"===r){var n=this.getDefaultItem(r);n.items=this.createChooserItems(),e.push(n)}else e.push(this.getDefaultItem(r));else e.push(r)}return e},e.prototype.getDefaultItem=function(e){var t={};switch(e){case"SortAscending":t={iconCss:this.ASCENDING};break;case"SortDescending":t={iconCss:this.DESCENDING};break;case"Group":t={iconCss:this.GROUP};break;case"Ungroup":t={iconCss:this.UNGROUP};break;case"Filter":t={iconCss:this.FILTER}}return this.defaultItems[e]={text:this.getLocaleText(e),id:this.generateID(e),iconCss:t.iconCss?"e-icons "+t.iconCss:null},this.defaultItems[e]},e.prototype.getLocaleText=function(e){return this.l10n.getConstant(this.localeText[e])},e.prototype.generateID=function(e,t){return this.gridID+"_colmenu_"+(t?t+e:e)},e.prototype.getKeyFromId=function(e,t){return e.indexOf("_colmenu_")>0&&e.replace(this.gridID+"_colmenu_"+(t||""),"")},e.prototype.getColumnMenu=function(){return this.element},e.prototype.getModuleName=function(){return"columnMenu"},e.prototype.setLocaleKey=function(){return{AutoFitAll:"autoFitAll",AutoFit:"autoFit",Group:"Group",Ungroup:"Ungroup",SortAscending:"SortAscending",SortDescending:"SortDescending",ColumnChooser:"Columnchooser",Filter:"FilterMenu"}},e.prototype.getHeaderCell=function(e){return sf.base.closest(e.target,"th.e-headercell")},e.prototype.getColumn=function(){if(this.headerCell){var e=this.headerCell.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");return this.parent.getColumnByUid(e)}return null},e.prototype.createChooserItems=function(){for(var e=[],t=0,i=this.parent.columnModel;t<i.length;t++){var r=i[t];r.showInColumnChooser&&r.field&&e.push({id:this.generateID(r.field,this.CHOOSER),text:r.headerText?r.headerText:r.field})}return e},e.prototype.appendFilter=function(e){if(this.defaultItems.Filter){var t=this.defaultItems.Filter.id;sf.base.closest(e.target,"#"+t)&&!this.isFilterPopupOpen()?this.getFilter(e.target,t):!sf.base.closest(e.target,"#"+t)&&this.isFilterPopupOpen()&&this.getFilter(e.target,t,!0)}},e.prototype.getFilter=function(e,t,i){var r=this.getFilterPop();r?r.style.display=!sf.base.Browser.isDevice&&i?"none":"block":this.parent.notify("filterOpen",{col:this.targetColumn,target:e,isClose:i,id:t})},e.prototype.setPosition=function(e,t){var i=this.parent.element.getBoundingClientRect(),r=e.getBoundingClientRect(),n=r.left-i.left,s=r.top-i.top;i.height<s?s=s-t.offsetHeight+r.height:i.height<s+t.offsetHeight&&(s=i.height-t.offsetHeight),window.innerHeight<t.offsetHeight+s+i.top&&(s=window.innerHeight-t.offsetHeight-i.top),s+i.top<0&&(s=0),n+=this.parent.enableRtl?-t.offsetWidth:r.width,i.width<=n+t.offsetWidth?(n-=r.width+t.offsetWidth,r.left<t.offsetWidth&&(n=r.left+t.offsetWidth/2)):n<0&&(n+=t.offsetWidth+r.width),t.style.top=s+"px",t.style.left=n+"px"},e.prototype.filterPosition=function(){var e=this.getFilterPop();if(e.classList.add(this.WRAP),!sf.base.Browser.isDevice){var t=e.style.display;e.style.cssText+="display:block;visibility:hidden";var i=this.element.querySelector("."+this.FILTER);i&&(this.setPosition(i.parentElement,e),e.style.cssText+="display:"+t+";visibility:visible")}},e.prototype.getDefault=function(){var e=[];return this.parent.ensureModuleInjected(En)&&(e.push("AutoFitAll"),e.push("AutoFit")),this.parent.allowGrouping&&this.parent.ensureModuleInjected(zn)&&(e.push("Group"),e.push("Ungroup")),this.parent.allowSorting&&this.parent.ensureModuleInjected(rn)&&(e.push("SortAscending"),e.push("SortDescending")),e.push("ColumnChooser"),this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&this.parent.ensureModuleInjected(Rn)&&e.push("Filter"),e},e.prototype.isFilterPopupOpen=function(){var e=this.getFilterPop();return e&&"none"!==e.style.display},e.prototype.getFilterPop=function(){return sf.base.Browser.isDevice&&null!==this.targetColumn&&"Menu"===this.parent.filterSettings.type?document.getElementById(this.targetColumn.uid+"-flmdlg"):this.parent.element.querySelector("."+this.POP)},e.prototype.isFilterItemAdded=function(){return this.parent.columnMenuItems&&this.parent.columnMenuItems.indexOf("Filter")>=0||!this.parent.columnMenuItems},e}(),vo=(oo=function(e,t){return(oo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}oo(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),bo=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.parent=t,r.serviceLocator=i,r.initEvent(),r}return vo(t,e),t.prototype.initEvent=function(){this.parent.isDestroyed||(this.parent.on("initForeignKeyColumn",this.initForeignKeyColumns,this),this.parent.on("getForeignKeyData",this.getForeignKeyData,this),this.parent.on("generateQuery",this.generateQueryFormData,this))},t.prototype.initForeignKeyColumns=function(e){for(var t=0;t<e.length;t++)e[t].dataSource=e[t].dataSource instanceof sf.data.DataManager?e[t].dataSource:sf.base.isNullOrUndefined(e[t].dataSource)?new sf.data.DataManager:"result"in e[t].dataSource?e[t].dataSource:new sf.data.DataManager(e[t].dataSource)},t.prototype.eventfPromise=function(e,t,i,r){var n=this.getStateEventArgument(t),s=new sf.data.Deferred,o=new sf.data.Deferred;n.action=e.action;var a=this.parent.getDataModule();return!sf.base.isNullOrUndefined(e.action)&&e.action.requestType&&!1!==a.foreignKeyDataState.isDataChanged?(a.setForeignKeyDataState({isPending:!0,resolver:o.resolve}),o.promise.then((function(){s.resolve(r.dataSource)})),n.setColumnData=this.parent.setForeignKeyData.bind(this.parent),this.parent.trigger("columnDataStateChange",n)):(a.setForeignKeyDataState({}),s.resolve(i)),s},t.prototype.getForeignKeyData=function(e){for(var t=this,i=e.column?[e.column]:this.parent.getForeignKeyColumns(),r=[],n=function(t){var n=void 0,o=e.isComplex?s.genarateColumnQuery(i[t]):s.genarateQuery(i[t],e.result.result,!1,!0);o.params=s.parent.query.params;var a=i[t].dataSource;a&&"result"in a?n=s.eventfPromise(e,o,a,i[t]).promise:n=!a.ready||a.dataSource.offline?a.executeQuery(o):a.ready.then((function(){return a.executeQuery(o)}));r.push(n)},s=this,o=0;o<i.length;o++)n(o);Promise.all(r).then((function(t){for(var r=0;r<t.length;r++)i[r].columnData=t[r].result,"dropdownedit"===i[r].editType&&"result"in i[r].dataSource&&(i[r].edit.params=sf.base.extend(i[r].edit.params,{dataSource:t[r].result,query:new sf.data.Query,fields:{value:i[r].foreignKeyField||i[r].field,text:i[r].foreignKeyValue}}));e.promise.resolve(e.result)})).catch((function(i){return t.parent.log(["actionfailure","foreign_key_failure"]),e.promise&&e.promise.reject&&e.promise.reject(i),i}))},t.prototype.generateQueryFormData=function(e){e.predicate.predicate=this.genarateQuery(e.column,e.column.columnData,!0)},t.prototype.genarateQuery=function(e,t,i,r){var n=this.parent,s=[],o=new sf.data.Query,a=i?e.foreignKeyField:e.field;if(n.allowPaging||n.enableVirtualization||i){t=new sf.data.DataManager(n.allowGrouping&&n.groupSettings.columns.length&&!i?t.records:t).executeLocal((new sf.data.Query).select(a));var l=sf.data.DataUtil.distinct(t,a,!1);a=i?e.field:e.foreignKeyField;for(var h=0;h<l.length;h++)l[h]&&l[h].getDay?s.push(Yi({field:a,operator:"equal",value:l[h],matchCase:!1})):s.push(new sf.data.Predicate(a,"equal",l[h],!1))}return r?s.length?o.where(sf.data.Predicate.or(s)):o:s.length?sf.data.Predicate.or(s):{predicates:[]}},t.prototype.genarateColumnQuery=function(e){var t=this.parent,i=new sf.data.Query,r=this.isFiltered(e);if(r.isTrue&&(i=this.filterQuery(i,r.column,!0)),t.searchSettings.key.length){var n=t.searchSettings;e.dataSource instanceof sf.data.DataManager&&e.dataSource.adaptor.getModuleName&&"ODataV4Adaptor"===e.dataSource.adaptor.getModuleName()?i=this.searchQuery(i,e,!0):i.search(n.key,e.foreignKeyValue,n.operator,n.ignoreCase)}return i},t.prototype.isFiltered=function(e){var t=this.parent.filterSettings.columns.filter((function(t){return t.field===e.foreignKeyValue&&t.uid===e.uid}));return{column:t,isTrue:!!t.length}},t.prototype.getModuleName=function(){return"foreignKey"},t.prototype.destroy=function(){this.destroyEvent()},t.prototype.destroyEvent=function(){this.parent.isDestroyed||(this.parent.off("initForeignKeyColumn",this.initForeignKeyColumns),this.parent.off("getForeignKeyData",this.getForeignKeyData),this.parent.off("generateQuery",this.generateQueryFormData))},t}(B),Co="https://ej2.syncfusion.com/documentation/grid",wo="https://ej2.syncfusion.com/documentation/",So="[EJ2Grid.Warning]",xo="[EJ2Grid.Error]",Ro="[EJ2Grid.Info]",Fo=function(){function e(e){this.parent=e,this.parent.on("initial-end",this.patchadaptor,this)}return e.prototype.getModuleName=function(){return"logger"},e.prototype.log=function(e,t){e instanceof Array||(e=[e]);for(var i=e,r=0;r<i.length;r++){var n=Eo[i[r]],s=n.check(t,this.parent);s.success&&console[n.logType](n.generateMessage(t,this.parent,s.options))}},e.prototype.patchadaptor=function(){var e=this.parent.getDataModule().dataManager.adaptor,t=e.beforeSend;t&&(e.beforeSend=function(i,r,n){t.call(e,i,r,n)})},e.prototype.destroy=function(){this.parent.isDestroyed||this.parent.off("initial-end",this.patchadaptor)},e}(),Eo={module_missing:{type:"module_missing",logType:"warn",check:function(e,t){var i=t.getInjectedModules().map((function(e){return e.prototype.getModuleName()})),r=t.requiredModules().map((function(e){return e.member})).filter((function(e){return-1===i.indexOf(e)}));return{success:r.filter((function(e){return"resize"!==e})).length>0,options:r}},generateMessage:function(e,t,i){return i=i.filter((function(e){return"resize"!==e})).reduce((function(e,t){return e+"* "+t+"\n"}),""),So+": MODULES MISSING\nThe following modules are not injected:.\n"+i+"Refer to "+Co+"/module.html for documentation on importing feature modules."}},promise_enabled:{type:"promise_enabled",logType:"error",check:function(){return{success:"undefined"==typeof Promise}},generateMessage:function(){return xo+": PROMISE UNDEFINED\nPromise object is not present in the global environment,please use polyfil to support Promise object in your environment.\nRefer to "+wo+"/base/browser.html?#required-polyfills for more information."}},primary_column_missing:{type:"primary_column_missing",logType:"warn",check:function(e,t){return{success:0===t.getColumns().filter((function(e){return e.isPrimaryKey})).length}},generateMessage:function(){return So+": PRIMARY KEY MISSING\nEditing is enabled but primary key column is not specified.\nRefer to "+Co+"/api-column.html?#isprimarykey for documentation on providing primary key columns."}},selection_key_missing:{type:"selection_key_missing",logType:"warn",check:function(e,t){return{success:t.selectionSettings.persistSelection&&0===t.getColumns().filter((function(e){return e.isPrimaryKey})).length}},generateMessage:function(){return So+": PRIMARY KEY MISSING\nselectionSettings.persistSelection property is enabled. It requires one primary key column to persist selection.\nRefer to "+Co+"/api-column.html?#isprimarykey for documentation on providing primary key columns."}},actionfailure:{type:"actionfailure",logType:"error",check:function(){return{success:!0}},generateMessage:function(e,t){var i="",r=Io(e,t),n=To(e,t);return i=""!==n?n:""!==r?r:e.error,So+": "+i}},locale_missing:{type:"locale_missing",logType:"warn",check:function(e,t){var i=sf.data.DataUtil.getObject("locale."+t.locale+".grid",sf.base.L10n);return{success:"en-US"!==t.locale&&sf.base.isNullOrUndefined(i)}},generateMessage:function(e,t){return So+": LOCALE CONFIG MISSING\nLocale configuration for '"+t.locale+"' is not provided.\nRefer to "+Co+"/globalization-and-localization.html?#localization \n             for documentation on setting locale configuration."}},limitation:{type:"limitation",logType:"warn",check:function(e,t){var i;switch(e){case"freeze":i={success:t.allowGrouping||!sf.base.isUndefined(t.detailTemplate)||!sf.base.isUndefined(t.childGrid)||!sf.base.isUndefined(t.rowTemplate)||t.enableVirtualization,options:{name:"freeze"}};break;case"virtualization":i={success:!sf.base.isUndefined(t.detailTemplate)||!sf.base.isUndefined(t.childGrid)||0!==t.frozenRows||0!==t.frozenColumns,options:{name:"virtualization"}};break;default:i={success:!1}}return i},generateMessage:function(e,t,i){var r,n=i.name;switch(n){case"freeze":r="Frozen rows and columns do not support the following features:\n* Virtualization\n* Row Template\n* Details Template\n* Hierarchy Grid\n* Grouping";break;case"virtualization":r="Virtualization does not support the following features.\n* Freeze rows and columns.\n* Details Template.\n* Hierarchy Grid.\n";break;default:r=""}return So+": "+n.toUpperCase()+" LIMITATIONS\n"+r}},check_datasource_columns:{type:"check_datasource_columns",logType:"warn",check:function(e,t){return{success:!(t.columns.length||t.dataSource instanceof sf.data.DataManager||t.dataSource.length)}},generateMessage:function(){return So+": GRID CONFIG MISSING\ndataSource and columns are not provided in the grid. At least one of either must be provided for grid configuration.\nRefer to "+Co+"/columns.html for documentation on configuring the grid data and columns."}},virtual_height:{type:"virtual_height",logType:"error",check:function(e,t){return{success:sf.base.isNullOrUndefined(t.height)||"auto"===t.height}},generateMessage:function(){return xo+": GRID HEIGHT MISSING \nheight property is required to use virtualization.\nRefer to "+Co+"/virtual.html for documentation on configuring the virtual grid."}},grid_remote_edit:{type:"grid_remote_edit",logType:"error",check:function(e){return{success:Array.isArray(e)||Array.isArray(e.result)}},generateMessage:function(){return xo+": RETRUN VALUE MISSING  \nRemote service returns invalid data. \nRefer to "+Co+"/edit.html for documentation on configuring editing with remote data."}},grid_sort_comparer:{type:"grid_sort_comparer",logType:"warn",check:function(e,t){return{success:t.getDataModule().isRemote()}},generateMessage:function(){return So+": SORT COMPARER NOT WORKING  \nSort comparer will not work with remote data.Refer to "+Co+"/sorting/#custom-sort-comparer for documentation on using the sort comparer."}},resize_min_max:{type:"resize_min_max",logType:"info",check:function(e){return{success:e.column.minWidth&&e.column.minWidth>=e.width||e.column.maxWidth&&e.column.maxWidth<=e.width}},generateMessage:function(){return Ro+": RESIZING COLUMN REACHED MIN OR MAX  \nThe column resizing width is at its min or max."}},action_disabled_column:{type:"action_disabled_column",logType:"info",check:function(e){var t;switch(e.moduleName){case"reorder":t=sf.base.isNullOrUndefined(e.destColumn)?"reordering action is disabled for the "+e.column.headerText+" column":"reordering action is disabled for the "+(e.column.allowReordering?e.destColumn.headerText:e.column.headerText)+" column";break;case"group":t="grouping action is disabled for the "+e.columnName+" column.";break;case"filter":t="filtering action is disabled for the "+e.columnName+" column.";break;case"sort":t="sorting action is disabled for the "+e.columnName+" column."}return{success:!0,options:{fn:t}}},generateMessage:function(e,t,i){return Ro+": ACTION DISABLED \n "+i.fn}},exporting_begin:{type:"exporting_begin",logType:"info",check:function(e){return{success:!0,options:{args:e}}},generateMessage:function(e,t,i){return Ro+": EXPORTNIG INPROGRESS \n Grid "+i.args+"ing is in progress"}},exporting_complete:{type:"exporting_complete",logType:"info",check:function(e){return{success:!0,options:{args:e}}},generateMessage:function(e,t,i){return Ro+": EXPORTNIG COMPLETED \n Grid "+i.args+"ing is complete"}},foreign_key_failure:{type:"foreign_key_failure",logType:"error",check:function(){return{success:!0}},generateMessage:function(){return xo+": FOREIGNKEY CONFIG \n  Grid foreign key column needs a valid data source/service.Refer to "+Co+"/columns/#foreign-key-column for documentation on configuring foreign key columns."}},initial_action:{type:"initial_action",logType:"error",check:function(e){var t;switch(e.moduleName){case"group":t="The "+e.columnName+" column is not available in the grid's column model.Please provide a valid field name to group the column";break;case"filter":t="The "+e.columnName+" column is not available in the grid's column model.Please provide a valid field name to filter the column.";break;case"sort":t="The "+e.columnName+" column is not available in the grid's column model.Please provide a valid field name to sort the column."}return{success:!0,options:{fn:t}}},generateMessage:function(e,t,i){return xo+": INITIAL ACTION FAILURE \n "+i.fn}},frozen_rows_columns:{type:"frozen_rows_columns",logType:"error",check:function(e,t){return{success:t.getColumns().length<=t.frozenColumns||t.frozenRows>=t.currentViewData.length}},generateMessage:function(e,t){return xo+": OUT OF RANGE ERROR-\n "+(t.getColumns().length<=t.frozenColumns?"FROZEN COLUMNS,":"")+(t.frozenRows>=t.currentViewData.length?"FROZEN ROWS":"")+" invalid"}},column_type_missing:{type:"column_type_missing",logType:"error",check:function(e){return{success:sf.base.isNullOrUndefined(e.column.type),options:e.column.headerText}},generateMessage:function(e,t,i){return xo+": COLUMN TYPE MISSING-\n  "+i+" column type was invalid or not defined.Please go through below help link: "+wo+"/grid/columns/#column-type"}},datasource_syntax_mismatch:{type:"datasource_syntax_mismatch",logType:"warn",check:function(e){return{success:e.dataState.dataSource&&!(e.dataState.dataSource instanceof sf.data.DataManager||"result"in e.dataState.dataSource||e.dataState.dataSource instanceof Array)&&!sf.base.isNullOrUndefined(e.dataState.dataStateChange)}},generateMessage:function(){return So+": DATASOURCE SYNTAX WARNING\nDataSource should be in the form of {result: Object[], count: number}when dataStateChangeEvent used"}}},Io=function(e){var t=e.error;return t.indexOf&&0!==t.indexOf("Format options")?"":"INVALID FORMAT\nFor more information, refer to the following documentation links:\nNumber format: "+wo+"/base/intl.html?#supported-format-string.\nDate format: "+wo+"/base/intl.html?#manipulating-datetime.\nMessage: "+t},To=function(e){var t=sf.data.DataUtil.getObject("error.error",e);if(sf.base.isNullOrUndefined(t))return"";var i="";try{i=JSON.parse(t.responseText)}catch(e){i=""}return"XMLHTTPREQUEST FAILED\nUrl: "+t.responseURL+"\nStatus: "+t.status+" - "+t.statusText+"\n"+(""!==i?"Message: "+i:"")},zo=function(){function e(e,t){this.infiniteCache={},this.infiniteCurrentViewData={},this.infiniteFrozenCache={},this.isDownScroll=!1,this.isUpScroll=!1,this.isScroll=!0,this.enableContinuousScroll=!1,this.initialRender=!0,this.isRemove=!1,this.isInitialCollapse=!1,this.prevScrollTop=0,this.actions=["filtering","searching","grouping","ungrouping","reorder","sorting","refresh"],this.keys=["downArrow","upArrow","enter","shiftEnter"],this.rowTop=0,this.isInitialMovableRender=!0,this.virtualInfiniteData={},this.isCancel=!1,this.emptyRowData={},this.isNormaledit=!1,this.isInfiniteScroll=!1,this.isLastPage=!1,this.isInitialRender=!0,this.isFocusScroll=!1,this.isGroupCollapse=!1,this.parent=e,this.serviceLocator=t,this.isNormaledit="Normal"===this.parent.editSettings.mode,this.addEventListener(),this.widthService=t.getService("widthService"),this.rowModelGenerator=this.parent.isFrozenGrid()?new Bs(this.parent):new he(this.parent)}return e.prototype.getModuleName=function(){return"infiniteScroll"},e.prototype.addEventListener=function(){this.parent.on(m,this.onDataReady,this),this.parent.on("datasource-modified",this.dataSourceModified,this),this.parent.on("infinite-page-query",this.infinitePageQuery,this),this.parent.on("infinite-scroll-handler",this.infiniteScrollHandler,this),this.parent.on("beforecellfocused",this.infiniteCellFocus,this),this.parent.on("append-infinite-content",this.appendInfiniteRows,this),this.parent.on("remove-infinite-rows",this.removeInfiniteCacheRows,this),this.parent.on("reset-infinite-blocks",this.resetInfiniteBlocks,this),this.parent.on("set-infinite-cache",this.setCache,this),this.parent.on("initial-collapse",this.ensureIntialCollapse,this),this.parent.on(x,this.infiniteCellFocus,this),this.parent.on("infinite-show-hide",this.setDisplayNone,this),this.parent.on("virtual-scroll-edit-action-begin",this.editActionBegin,this),this.parent.on(M,this.getVirtualInfiniteData,this),this.parent.on("edit-reset",this.resetInfiniteEdit,this),this.parent.on("virtual-scroll-edit-success",this.infiniteEditSuccess,this),this.parent.on("refresh-virtual-cache",this.refreshInfiniteCache,this),this.parent.on("infinite-edit-handler",this.infiniteEditHandler,this),this.parent.on("virtual-scroll-add-action-begin",this.infiniteAddActionBegin,this),this.parent.on(w,this.modelChanged,this),this.parent.on("refresh-infinite-current-view-data",this.refreshInfiniteCurrentViewData,this),this.parent.on(F,this.destroy,this),this.parent.on(y,this.selectNewRow,this),this.parent.on("infinite-group-collapse",this.captionActionComplete,this),this.parent.on("set-virtual-page-query",this.setGroupCollapsePageQuery,this),this.actionBeginFunction=this.actionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.dataBoundFunction=this.dataBound.bind(this),this.parent.on("delete-complete",this.deleteComplate,this),this.parent.addEventListener(p,this.actionBeginFunction),this.parent.addEventListener(c,this.actionCompleteFunction),this.parent.addEventListener(u,this.dataBoundFunction)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(m,this.onDataReady),this.parent.off("datasource-modified",this.dataSourceModified),this.parent.off("infinite-page-query",this.infinitePageQuery),this.parent.off("infinite-scroll-handler",this.infiniteScrollHandler),this.parent.off("beforecellfocused",this.infiniteCellFocus),this.parent.off("append-infinite-content",this.appendInfiniteRows),this.parent.off("remove-infinite-rows",this.removeInfiniteCacheRows),this.parent.off("reset-infinite-blocks",this.resetInfiniteBlocks),this.parent.off("set-infinite-cache",this.setCache),this.parent.off("initial-collapse",this.ensureIntialCollapse),this.parent.off(x,this.infiniteCellFocus),this.parent.off("infinite-show-hide",this.setDisplayNone),this.parent.off("virtual-scroll-edit-action-begin",this.editActionBegin),this.parent.off(M,this.getVirtualInfiniteData),this.parent.off("edit-reset",this.resetInfiniteEdit),this.parent.off("virtual-scroll-edit-success",this.infiniteEditSuccess),this.parent.off("refresh-virtual-cache",this.refreshInfiniteCache),this.parent.off("infinite-edit-handler",this.infiniteEditHandler),this.parent.off("virtual-scroll-add-action-begin",this.infiniteAddActionBegin),this.parent.off(w,this.modelChanged),this.parent.off("refresh-infinite-current-view-data",this.refreshInfiniteCurrentViewData),this.parent.off(F,this.destroy),this.parent.off(y,this.selectNewRow),this.parent.off("infinite-group-collapse",this.captionActionComplete),this.parent.off("set-virtual-page-query",this.setGroupCollapsePageQuery),this.parent.removeEventListener(p,this.actionBeginFunction),this.parent.removeEventListener(c,this.actionCompleteFunction),this.parent.removeEventListener(u,this.dataBoundFunction))},e.prototype.dataBound=function(){"collapse"===this.groupCaptionAction?(this.groupCaptionAction="refresh",this.makeGroupCollapseRequest()):"refresh"===this.groupCaptionAction&&(this.parent.hideSpinner(),this.groupCaptionAction=this.empty)},e.prototype.setGroupCollapsePageQuery=function(e){var t=this.parent;if(!t.infiniteScrollSettings.enableCache&&this.isGroupCollapse)if(e.skipPage=!0,this.isGroupCollapse=!1,"collapse"===this.groupCaptionAction){for(var i=t.getRowObjectFromUID(this.parentCapUid),r=t.getRowsObject(),n=0,s=r.length-1;s>=0&&r[s].indent!==i.indent;s--)r[s].isDataRow&&n++;var o=Wr(r.indexOf(i),r),a=Gr(o.fields,o.keys,this),l=_r(a);a=l[l.length-1];for(s=l.length-2;s>=0;s--)a=a.and(l[s]);e.query.where(a),e.query.skip(n),this.parentCapUid=this.empty}else{var h=t.getRows(),d=t.pageSettings.pageSize,p=Vr(h[h.length-1])+1,c=p-p%d+d-p;p%d==0&&(c=0),e.query.skip(p),e.query.take(t.infiniteScrollSettings.initialBlocks*t.pageSettings.pageSize+c)}},e.prototype.captionActionComplete=function(e){var t=this.parent;if(!t.infiniteScrollSettings.enableCache&&e.isCollapse){var i=t.getContent().firstElementChild.getBoundingClientRect(),r=t.contentModule.getTable().getBoundingClientRect();if(Math.round(r.bottom-t.getRowHeight())<=Math.round(i.bottom)){this.parentCapUid=e.parentUid,this.groupCaptionAction="collapse",t.showSpinner();var n=t.getRowObjectFromUID(e.parentUid);this.getCaptionChildCount(n)?this.makeGroupCollapseRequest(e.parentUid):(this.groupCaptionAction="refresh",this.makeGroupCollapseRequest())}}},e.prototype.makeGroupCollapseRequest=function(e){var t=this.parent,i=t.getRows(),r=Vr(i[i.length-1]),n=this.parent.pageSettings.currentPage;if(this.parent.pageSettings.currentPage=Math.ceil(r/this.parent.pageSettings.pageSize)+1,this.parent.pageSettings.currentPage>this.maxPage)t.hideSpinner();else{var s={requestType:"infiniteScroll",currentPage:this.parent.pageSettings.currentPage,prevPage:n,startIndex:r+1,direction:"down",isCaptionCollapse:!0,parentUid:e};this.isGroupCollapse=!0,this.parent.notify("model-changed",s)}},e.prototype.getCaptionChildCount=function(e){for(var t=this.parent.getRowsObject(),i=!1,r=t.indexOf(e);r<t.length&&(!(t[r].indent===e.indent||t[r].indent<e.indent)||t[r].data.key===e.data.key);r++)if(t[r].isCaptionRow&&!this.childCheck(t,t[r],r)){i=!0;break}return i},e.prototype.childCheck=function(e,t,i){for(var r=0,n=i+1;n<e.length&&e[n].indent!==t.indent;n++)e[n].indent===t.indent+1&&e[n].parentUid===t.uid&&r++;return t.data.count===r},e.prototype.updateCurrentViewData=function(){var e=this.parent;if(!e.groupSettings.columns.length){var t=Object.keys(this.infiniteCurrentViewData);e.currentViewData=[];for(var i=e.pageSettings.currentPage,r=e.infiniteScrollSettings.enableCache,n=e.infiniteScrollSettings.maxBlocks,s=r&&(i>n||this.isUpScroll&&i>1),o=s?this.isUpScroll?i:i-n+1:1,a=s?o+n-1:r?n:t.length,l=o;l<=a;l++)this.infiniteCurrentViewData[l]&&(e.currentViewData=e.currentViewData.concat(this.infiniteCurrentViewData[l]))}},e.prototype.refreshInfiniteCurrentViewData=function(e){var t=this.parent.pageSettings.currentPage,i=this.parent.pageSettings.pageSize,r=this.parent.infiniteScrollSettings.initialBlocks,n=Object.keys(this.infiniteCurrentViewData),s=this.parent.infiniteScrollSettings.enableCache;if(!this.parent.groupSettings.columns.length){var o="save"===e.args.requestType,a="delete"===e.args.requestType;s||!o&&!a?r>1&&e.data.length===r*i?this.setInitialCache(e.data.slice(),{},s&&"delete"===e.args.requestType,!0):this.infiniteCurrentViewData[t]=e.data.slice():o?this.infiniteCurrentViewData[1]=e.data.concat(this.infiniteCurrentViewData[1]):this.infiniteCurrentViewData[n[n.length-1]].push(e.data[0])}},e.prototype.deleteComplate=function(){this.parent.isFrozenGrid()&&!this.parent.infiniteScrollSettings.enableCache&&this.parent.contentModule.refreshScrollOffset()},e.prototype.modelChanged=function(e){var t=this.parent.getRows();if(t.length&&"infiniteScroll"!==e.requestType&&("delete"===e.requestType||"add"===this.requestType)){if(this.firstIndex=Vr(t[0]),this.firstBlock=Math.ceil((this.firstIndex+1)/this.parent.pageSettings.pageSize),this.lastIndex=Vr(t[t.length-1]),"delete"===e.requestType){var i=this.parent.getRowsObject();e.startIndex=this.parent.infiniteScrollSettings.enableCache?(this.firstBlock-1)*this.parent.pageSettings.pageSize:i[i.length-1].index}else e.startIndex=this.firstIndex;this.parent.infiniteScrollSettings.enableCache||this.parent.pageSettings.currentPage!==this.maxPage||"delete"!==e.requestType||(this.isLastPage=!0,this.lastIndex=this.lastIndex-1)}},e.prototype.infiniteAddActionBegin=function(e){this.isNormaledit&&(this.isAdd=!0,this.parent.infiniteScrollSettings.enableCache&&(Object.keys(this.emptyRowData).length||this.createEmptyRowdata(),this.parent.pageSettings.currentPage>1&&(e.startEdit=!1,this.resetInfiniteBlocks({},!0),this.makeRequest({currentPage:1}))))},e.prototype.infiniteEditHandler=function(e){if(!this.parent.infiniteScrollSettings.enableCache&&("delete"===e.e.requestType||"save"===e.e.requestType&&"add"===this.requestType)){var t=this.parent.isFrozenGrid(),i=this.parent.getRows(),r=this.parent.getRowsObject();if(this.ensureRowAvailability(r,e.result[0])){if(i.length&&(this.resetRowIndex(r,e.e,i,"add"===this.requestType,!0),t)){var n=this.parent.getMovableRowsObject();if(this.resetRowIndex(n,e.e,this.parent.getMovableDataRows(),"add"===this.requestType),this.parent.getFrozenMode()===ee){var s=this.parent.getFrozenRightRowsObject();this.resetRowIndex(s,e.e,this.parent.getFrozenRightRows(),"add"===this.requestType)}}if(this.isLastPage){if(this.isLastPage=!1,this.parent.pageSettings.currentPage=this.maxPage,this.parent.selectionModule.index<this.parent.frozenRows){if(sf.base.remove(i[this.parent.frozenRows-1]),this.createRow([r[this.parent.frozenRows-1]],e,!1,!0),t){var o=this.parent.getMovableDataRows();if(sf.base.remove(o[this.parent.frozenRows]),this.createRow([this.parent.getMovableRowsObject()[this.parent.frozenRows-1]],e,!0,!0),this.parent.getFrozenMode()===ee){var a=this.parent.getFrozenRightDataRows();sf.base.remove(a[this.parent.frozenRows]),this.createRow([this.parent.getFrozenRightRowsObject()[this.parent.frozenRows-1]],e,!1,!0,!0)}}Cr(this.parent)}}else this.createRow(r,e)}this.parent.hideSpinner(),this.parent.notify("refresh-infinite-persist-selection",{}),"delete"===this.requestType?this.parent.notify("delete-complete",e.e):this.parent.notify("save-complete",e.e)}this.parent.notify("freezerender",{case:"refreshHeight"})},e.prototype.createRow=function(e,t,i,r,n){var s,o=r?e:this.generateRows(t.result,t.e),a=new le(this.serviceLocator,null,this.parent);s=n?this.parent.element.querySelector(".e-frozen-right-content").querySelector(se):this.parent.isFrozenGrid()?i?this.parent.getMovableVirtualContent().querySelector(se):this.parent.getFrozenVirtualContent().querySelector(se):this.parent.getContent().querySelector(se),this.parent.frozenRows&&(s=r&&"add"!==this.requestType||!r&&"add"===this.requestType?this.parent.isFrozenGrid()?i?this.parent.getMovableVirtualHeader().querySelector(se):n?this.parent.element.querySelector(".e-frozen-right-header").querySelector(se):this.parent.getFrozenVirtualHeader().querySelector(se):this.parent.getHeaderContent().querySelector(se):s);var l={rows:e,cancel:!1,args:t,isMovable:i,isFrozenRows:r,isFrozenRight:r,row:o};if(this.parent.notify("infinite-crud-cancel",l),!l.cancel)for(var h=o.length-1;h>=0;h--)"delete"===this.requestType?s.appendChild(a.render(o[h],this.parent.getColumns())):s.insertBefore(a.render(o[h],this.parent.getColumns()),s.firstElementChild);if(!r&&this.parent.frozenRows&&(this.parent.selectionModule.index<this.parent.frozenRows||"add"===this.requestType)){var d=i?this.parent.getMovableDataRows():n?this.parent.getFrozenRightDataRows():this.parent.getRows(),p=(i||n)&&"add"===this.requestType?this.parent.frozenRows:this.parent.frozenRows-1;sf.base.remove(d[p]),this.createRow([e[this.parent.frozenRows-1]],t,i,!0,n)}this.parent.infiniteScrollSettings.enableCache||r||(n?(Cr(this.parent),this.parent.contentModule.rightFreezeRows="add"===this.requestType?o.concat(e):e.concat(o)):!this.parent.isFrozenGrid()||i?(Cr(this.parent),this.parent.contentModule.visibleRows="add"===this.requestType?o.concat(e):e.concat(o),this.parent.getFrozenMode()===ee&&(t.e.renderMovableContent=!0,this.createRow(this.parent.getFrozenRightRowsObject(),t,!1,!1,!0))):(this.parent.contentModule.visibleFrozenRows="add"===this.requestType?o.concat(e):e.concat(o),t.e.isFrozen=!0,this.createRow(this.parent.getMovableRowsObject(),t,!0)))},e.prototype.ensureRowAvailability=function(e,t){var i=!0;if(this.parent.frozenRows&&!this.parent.infiniteScrollSettings.enableCache&&this.parent.sortSettings.columns&&"add"===this.requestType)for(var r=this.parent.getPrimaryKeyFieldNames()[0],n=0;n<e.length;n++)if(e[n].data[r]===t[r]){i=!1;break}return i},e.prototype.generateRows=function(e,t){return this.rowModelGenerator.generateRows(e,t)},e.prototype.resetRowIndex=function(e,t,i,r,n){var s=this,o=this.parent.getPrimaryKeyFieldNames()[0],a=!(i.length%this.parent.pageSettings.pageSize);r?a&&(n&&!this.parent.groupSettings.columns.length&&this.swapCurrentViewData(1,!0),sf.base.remove(i[e.length-1]),i.splice(e.length-1,1),e.splice(e.length-1,1)):e.filter((function(r,a){if(r.data[o]===t.data[0][o]){if(n&&!s.parent.groupSettings.columns.length){var l=Math.ceil((a+1)/s.parent.pageSettings.pageSize);s.resetInfiniteCurrentViewData(l,a)}e.splice(a,1),sf.base.remove(i[a]),i.splice(a,1)}}));var l=r?1:0;vr(this.parent,e,i,l)},e.prototype.resetInfiniteCurrentViewData=function(e,t){t-=(e-1)*this.parent.pageSettings.pageSize,this.infiniteCurrentViewData[e].splice(t,1),this.swapCurrentViewData(e,!1)},e.prototype.swapCurrentViewData=function(e,t){for(var i=Object.keys(this.infiniteCurrentViewData),r=t?i.length+1:i.length,n=e;n<r;n++)if(this.infiniteCurrentViewData[n+1]){var s=t?n:n+1,o=t?this.infiniteCurrentViewData[n].length-1:0,a=this.infiniteCurrentViewData[s].splice(o,1);t?(this.infiniteCurrentViewData[n+1]=a.concat(this.infiniteCurrentViewData[n+1]),n+1===r-1&&this.infiniteCurrentViewData[n+1].splice(this.infiniteCurrentViewData[n+1].length-1,1)):this.infiniteCurrentViewData[n].push(a[0])}this.updateCurrentViewData()},e.prototype.setDisplayNone=function(e){if(this.parent.infiniteScrollSettings.enableCache){for(var t=this.parent.isFrozenGrid(),i=t?Object.keys(this.infiniteFrozenCache):Object.keys(this.infiniteCache),r=1;r<=i.length;r++){(t?e.isFreeze?this.infiniteFrozenCache[r][0]:this.infiniteFrozenCache[r][1]:this.infiniteCache[r]).filter((function(t){t.cells[e.index].visible=""===e.visible}))}this.resetContentModuleCache(t?this.infiniteFrozenCache:this.infiniteCache)}},e.prototype.refreshInfiniteCache=function(e){this.getEditedRowObject().data=e.data},e.prototype.getEditedRowObject=function(){for(var e,t=this.parent.getRowsObject(),i=0;i<t.length;i++)t[i].index===this.editRowIndex&&(e=t[i]);return e},e.prototype.infiniteEditSuccess=function(e){this.isNormaledit&&(!this.isAdd&&e.data&&this.updateCurrentViewRecords(e.data),this.isAdd=!1)},e.prototype.updateCurrentViewRecords=function(e){var t=fr(this.parent,e);sf.base.isNullOrUndefined(t)||(this.parent.getCurrentViewRecords()[t]=e)},e.prototype.actionBegin=function(e){"add"===e.requestType||"delete"===e.requestType?this.requestType=e.requestType:"add"===e.action&&"save"===e.requestType&&(this.requestType=e.action),(this.parent.isFrozenGrid()&&!e.cancel&&"searching"===e.requestType||"sorting"===e.requestType||"filtering"===e.requestType)&&(this.isInitialRender=!0)},e.prototype.actionComplete=function(e){"delete"!==e.requestType&&"save"!==e.requestType&&"cancel"!==e.requestType||(this.requestType=this.empty,this.isCancel="cancel"===e.requestType||"save"===e.requestType,this.isAdd=this.isEdit=!1,this.isNormaledit&&(this.editRowIndex=this.empty,this.virtualInfiniteData={},this.parent.editModule.previousVirtualData={}))},e.prototype.resetInfiniteEdit=function(){this.parent.enableInfiniteScrolling&&this.isNormaledit&&(this.parent.editSettings.allowEditing&&this.isEdit||this.parent.editSettings.allowAdding&&this.isAdd)&&(this.parent.isEdit=!0)},e.prototype.getVirtualInfiniteData=function(e){e.virtualData=this.virtualInfiniteData,e.isAdd=this.isAdd,e.isCancel=this.isCancel},e.prototype.editActionBegin=function(e){this.isEdit=!0,this.editRowIndex=e.index;var t=sf.base.extend({},this.getEditedRowObject().data);e.data=Object.keys(this.virtualInfiniteData).length?this.virtualInfiniteData:t},e.prototype.dataSourceModified=function(){this.resetInfiniteBlocks({requestType:this.empty},!0)},e.prototype.onDataReady=function(e){sf.base.isNullOrUndefined(e.count)||"infiniteScroll"===e.requestType||(this.maxPage=Math.ceil(e.count/this.parent.pageSettings.pageSize))},e.prototype.ensureIntialCollapse=function(e){this.isInitialCollapse=!e},e.prototype.infiniteScrollHandler=function(e){this.restoreInfiniteEdit(),this.restoreInfiniteAdd();var t=e.target;if(t.classList.contains(Q)&&this.parent.enableInfiniteScrolling&&!e.isLeft){var i=this.parent.getContent().firstElementChild;this.prevScrollTop=i.scrollTop;var r=this.parent.getRows(),n=Vr(r[r.length-1])+1,s=this.parent.pageSettings.currentPage,o=void 0,a=t.scrollHeight-t.scrollTop,l=Math.round(t.scrollHeight-t.scrollTop),h=a<t.clientHeight?Math.ceil(a):Math.floor(a);h>t.clientHeight&&(h-=1);var d=h===t.clientHeight||l===t.clientHeight;if(!sf.base.isNullOrUndefined(this.groupCaptionAction))return;if(this.isScroll&&d&&(this.parent.pageSettings.currentPage<=this.maxPage-1||this.enableContinuousScroll)){this.parent.infiniteScrollSettings.enableCache&&(this.isUpScroll=!1,this.isDownScroll=!0);var p=[].slice.call(i.querySelectorAll(".e-row:not(.e-addedrow)")),c=Vr(u=p[p.length-1]);this.parent.pageSettings.currentPage=Math.ceil(c/this.parent.pageSettings.pageSize)+1,o={requestType:"infiniteScroll",currentPage:this.parent.pageSettings.currentPage,prevPage:s,startIndex:n,direction:"down"},this.makeRequest(o)}if(this.isScroll&&this.parent.infiniteScrollSettings.enableCache&&0===t.scrollTop&&1!==this.parent.pageSettings.currentPage){this.parent.infiniteScrollSettings.enableCache&&(this.isDownScroll=!1,this.isUpScroll=!0);c=Vr((u=[].slice.call(i.getElementsByClassName(Y)))[this.parent.pageSettings.pageSize-1]);var u,f=Vr(u[0])-this.parent.pageSettings.pageSize;this.parent.pageSettings.currentPage=Math.ceil(c/this.parent.pageSettings.pageSize)-1,this.parent.pageSettings.currentPage&&(o={requestType:"infiniteScroll",currentPage:this.parent.pageSettings.currentPage,prevPage:s,startIndex:f,direction:"up"},this.makeRequest(o))}this.parent.infiniteScrollSettings.enableCache&&!this.isScroll&&sf.base.isNullOrUndefined(o)&&(this.isDownScroll||this.isUpScroll)&&(i.scrollTop=this.top)}},e.prototype.makeRequest=function(e){var t=this;this.parent.pageSettings.currentPage!==e.prevPage&&(this.parent.pageSettings.currentPage<=this.maxPage?(this.isInfiniteScroll=!0,sf.base.isNullOrUndefined(this.infiniteCache[e.currentPage])?setTimeout((function(){t.getVirtualInfiniteEditedData(),t.parent.notify("model-changed",e)}),100):setTimeout((function(){t.getVirtualInfiniteEditedData(),t.parent.notify("refresh-infinite-mode-blocks",e)}),100)):this.parent.pageSettings.currentPage=this.maxPage)},e.prototype.infinitePageQuery=function(e){this.initialRender?(this.initialRender=!1,this.intialPageQuery(e)):this.isInfiniteScroll||"delete"!==this.requestType&&"add"!==this.requestType?e.page(this.parent.pageSettings.currentPage,this.parent.pageSettings.pageSize):this.editPageQuery(e)},e.prototype.editPageQuery=function(e){var t=this.parent.infiniteScrollSettings.initialBlocks;if(this.parent.infiniteScrollSettings.enableCache)this.infiniteCache={},this.infiniteFrozenCache={},this.infiniteCurrentViewData={},e.skip(this.firstIndex),e.take(t*this.parent.pageSettings.pageSize);else{"Dialog"===this.parent.editSettings.mode&&this.parent.clearSelection();var i="delete"===this.requestType?this.lastIndex:this.firstIndex;e.skip(i),e.take(1)}},e.prototype.intialPageQuery=function(e){this.parent.infiniteScrollSettings.enableCache&&this.parent.infiniteScrollSettings.initialBlocks>this.parent.infiniteScrollSettings.maxBlocks&&(this.parent.infiniteScrollSettings.initialBlocks=this.parent.infiniteScrollSettings.maxBlocks);var t=this.parent.pageSettings.pageSize*this.parent.infiniteScrollSettings.initialBlocks;e.page(1,t)},e.prototype.scrollToLastFocusedCell=function(e){var t=this.parent,i=this.lastFocusInfo.rowIdx+("upArrow"===e.keyArgs.action?-1:1),r=this.lastFocusInfo.cellIdx,n=t.getRowByIndex(i);t.getContent().firstElementChild;if(!n){var s=new le(this.serviceLocator,null,this.parent),o=Math.floor(i/this.parent.pageSettings.pageSize)+1;t.pageSettings.currentPage=o;var a=t.getColumns();sf.base.remove(t.getContent().querySelector("tbody")),t.getContent().querySelector("table").appendChild(t.createElement("tbody"));for(var l=[],h=1===o||this.maxPage===o?0:-1,d=0;d<t.infiniteScrollSettings.maxBlocks;this.maxPage===o?h--:h++,d++){var p=this.infiniteCache[o+h];if(p){l=l.concat(p);for(var c=0;c<p.length;c++)t.getContent().querySelector("tbody").appendChild(s.render(p[c],a))}}t.notify(y,{rows:l,args:{}}),Cr(t)}var u=(n=t.getRowByIndex(i)).cells[r];t.focusModule.isInfiniteScroll=!0,t.focusModule.onClick({target:u},!0),t.selectRow(i),u.focus(),this.isFocusScroll=!1,e.cancel=!0},e.prototype.setLastCellFocusInfo=function(e){var t=e.byClick&&e.clickArgs.target||e.byKey&&e.keyArgs.target||(!this.isFocusScroll&&e).target;if(t&&t.classList.contains("e-rowcell")){var i=parseInt(t.getAttribute("aria-colindex"),10),r=parseInt(t.parentElement.getAttribute("aria-rowindex"));this.lastFocusInfo={rowIdx:r,cellIdx:i}}},e.prototype.infiniteCellFocus=function(e){var t=this.parent,i=t.infiniteScrollSettings.enableCache;if(e.byKey){if(i&&this.isFocusScroll)return void this.scrollToLastFocusedCell(e);var r=document.activeElement,n=Vr(r.parentElement);this.cellIndex=parseInt(r.getAttribute(re),10);var s=t.getContent().firstElementChild,o=this.maxPage*t.pageSettings.pageSize-1,a=Math.floor(s.offsetHeight/this.parent.getRowHeight()),l=s.getBoundingClientRect();if(!isNaN(n))if("downArrow"===e.keyArgs.action||"enter"===e.keyArgs.action){this.rowIndex=n+=1;var h=(d=t.getRowByIndex(n))&&d.getBoundingClientRect();i&&(n=r.parentElement.rowIndex+1),this.isFocusScroll||!d&&n<o||h&&h.bottom>=l.bottom?(this.isFocusScroll||(this.pressedKey=e.keyArgs.action),this.isFocusScroll=!1,s.scrollTop=(n-a+1)*this.parent.getRowHeight()):!i&&d&&h&&(h.bottom>=l.bottom||h.top<l.top)&&d.cells[this.cellIndex].scrollIntoView()}else if("upArrow"===e.keyArgs.action||"shiftEnter"===e.keyArgs.action){this.rowIndex=n-=1;var d;h=(d=t.getRowByIndex(n))&&d.getBoundingClientRect();i&&(n=r.parentElement.rowIndex-1),(!d||h.top<=l.top)&&(this.pressedKey=e.keyArgs.action,s.scrollTop=n*this.parent.getRowHeight())}}else"PageDown"!==e.key&&"PageUp"!==e.key||(this.pressedKey=e.key);this.setLastCellFocusInfo(e)},e.prototype.createEmptyRowdata=function(){var e=this;this.parent.getColumns().filter((function(t){e.emptyRowData[t.field]=e.empty}))},e.prototype.getVirtualInfiniteEditedData=function(){var e=this.parent.element.querySelector("."+Z),t=this.parent.element.querySelector("."+$),i=this.parent.element.querySelector(".e-gridform");if(this.parent.infiniteScrollSettings.enableCache&&(e||t)){var r=e?sf.base.extend({},this.getEditedRowObject().data):sf.base.extend({},this.emptyRowData);this.virtualInfiniteData=this.parent.editModule.getCurrentEditedData(i,r),this.parent.isFrozenGrid()&&(this.virtualInfiniteData=this.parent.editModule.getCurrentEditedData(this.parent.getMovableVirtualContent().querySelector(".e-gridform"),r))}},e.prototype.restoreInfiniteEdit=function(){var e=this.parent.getContent().firstElementChild,t=!this.parent.frozenRows||this.editRowIndex>=this.parent.frozenRows;if(this.isNormaledit&&this.parent.infiniteScrollSettings.enableCache&&t&&this.parent.editSettings.allowEditing&&!sf.base.isNullOrUndefined(this.editRowIndex)){var i=this.parent.getRowByIndex(this.editRowIndex);if(Object.keys(this.virtualInfiniteData).length&&i&&!this.parent.getContent().querySelector("."+Z)){var r=i.getBoundingClientRect().top;r<e.offsetHeight&&r>this.parent.getRowHeight()&&(this.parent.isEdit=!1,this.parent.editModule.startEdit(i))}}},e.prototype.restoreInfiniteAdd=function(){var e=this.parent.getContent().firstElementChild;this.parent.getCurrentViewRecords().length&&this.parent.getRowByIndex(0)&&this.isNormaledit&&this.parent.infiniteScrollSettings.enableCache&&this.isAdd&&!e.querySelector("."+$)&&(e.scrollTop<this.parent.getRowHeight()&&(this.parent.isEdit=!1,this.parent.addRecord()))},e.prototype.appendInfiniteRows=function(e){var t=this.parent.isFrozenGrid(),i=this.parent.getContent().firstElementChild,r=this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.args.requestType,n=this.parent.getFrozenMode()===ee&&"movable"===e.tableName;if((!r||e.args.isFrozen||n)&&r||(r&&"up"===e.args.direction?e.tbody.insertBefore(e.frag,e.tbody.firstElementChild):e.tbody.appendChild(e.frag)),t)if(r)if(e.tableName===ie||"Right"===this.parent.getFrozenMode()&&e.tableName===te)this.frozenFrag=e.frag;else if(this.parent.getFrozenMode()===ee&&"movable"===e.tableName)this.movableFrag=e.frag;else{var s=this.parent.getFrozenVirtualContent().querySelector(se);"up"===e.args.direction?s.insertBefore(this.frozenFrag,s.firstElementChild):s.appendChild(this.frozenFrag),e.tableName===te?(this.parent.getMovableVirtualContent().querySelector(se).appendChild(this.movableFrag),this.parent.element.querySelector(".e-frozen-right-content").querySelector(se).appendChild(e.frag)):this.parent.getMovableVirtualContent().querySelector("."+X).appendChild(e.tbody),this.parent.contentModule.refreshScrollOffset(),this.updateCurrentViewData()}else{var o=void 0;e.tableName===ie?o=this.parent.getFrozenVirtualContent().querySelector("."+X):"movable"===e.tableName?(o=this.parent.getMovableVirtualContent().querySelector("."+X),this.parent.getFrozenMode()!==ee&&(this.parent.contentModule.refreshScrollOffset(),this.updateCurrentViewData())):(o=this.parent.element.querySelector(".e-frozen-right-content").querySelector("."+X),this.parent.getFrozenMode()===ee&&(this.parent.contentModule.refreshScrollOffset(),this.updateCurrentViewData())),o.appendChild(e.tbody),this.widthService.refreshFrozenScrollbar()}else this.parent.contentModule.getTable().appendChild(e.tbody),this.updateCurrentViewData();this.isInitialRender&&!e.args.isFrozen&&(this.isInitialRender=!1,this.parent.scrollModule.setHeight()),e.args.isFrozen||(this.rowTop=this.rowTop?this.rowTop:this.parent.getRows()[0].getBoundingClientRect().top,r&&(this.parent.infiniteScrollSettings.enableCache&&this.isRemove&&(i.scrollTop=this.top),Cr(this.parent)),this.restoreInfiniteAdd(),this.isScroll=!0),this.isInfiniteScroll=!1},e.prototype.selectNewRow=function(e){var t=this,i=this.parent,r=i.getRowByIndex(this.rowIndex),n=i.infiniteScrollSettings.enableCache;if(r&&this.keys.some((function(e){return e===t.pressedKey}))){var s=i.getContent().firstElementChild,o=i.getRowHeight(),a=r.cells[this.cellIndex];("downArrow"===this.pressedKey||"enter"===this.pressedKey||n&&("upArrow"===this.pressedKey||"shiftEnter"===this.pressedKey))&&(n||"upArrow"===this.pressedKey||"shiftEnter"===this.pressedKey||(s.scrollTop=s.scrollTop+o),i.focusModule.isInfiniteScroll=!0,i.focusModule.onClick({target:a},!0),i.selectRow(this.rowIndex))}else if(this.lastFocusInfo||"PageDown"===this.pressedKey||"PageUp"===this.pressedKey){var l=n?0:this.lastFocusInfo.rowIdx;(a=i.getCellFromIndex(l,this.lastFocusInfo.cellIdx))&&(this.isFocusScroll=!0,n?a.focus({preventScroll:!0}):(i.focusModule.isInfiniteScroll=!0,i.focusModule.onClick({target:a},!0)))}this.pressedKey=void 0},e.prototype.removeInfiniteCacheRows=function(e){var t=this.parent.enableInfiniteScrolling&&"infiniteScroll"===e.args.requestType;if(!e.args.isFrozen&&t&&this.parent.infiniteScrollSettings.enableCache&&this.isRemove){var i=[].slice.call(this.parent.getContentTable().getElementsByClassName(Y));if("down"===e.args.direction){if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length){var r=[].slice.call(this.parent.getContentTable().querySelectorAll("tr"));this.removeCaptionRows(r,e.args)}var n=this.parent.element.querySelector("."+$)?0:1;this.removeTopRows(i,this.parent.pageSettings.pageSize-n)}if("up"===e.args.direction)if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length){r=[].slice.call(this.parent.getContentTable().querySelectorAll("tr"));this.removeCaptionRows(r,e.args)}else this.removeBottomRows(i,i.length-1,e.args);this.isScroll=!1,this.top=this.calculateScrollTop(e.args)}},e.prototype.calculateScrollTop=function(e){var t=0,i=this.parent.getContent().firstElementChild;if("down"===e.direction){this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!this.isInitialCollapse&&(t=this.captionRowHeight());var r=[].slice.call(this.parent.getContent().firstElementChild.querySelectorAll("tr:not(.e-row)")),n=0;this.isInitialCollapse&&!sf.base.isNullOrUndefined(r)&&(n=Math.round((r.length-1)/this.parent.groupSettings.columns.length));for(var s=n||this.parent.pageSettings.pageSize*(this.parent.infiniteScrollSettings.maxBlocks-1),o=0,a=0;o<i.clientHeight;)o=++a*this.parent.getRowHeight();t+=(s-(a-=1))*this.parent.getRowHeight()}if("up"===e.direction)if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!this.isInitialCollapse)t=this.infiniteCache[this.parent.pageSettings.currentPage].length*this.parent.getRowHeight();else if(this.isInitialCollapse){var l=this.infiniteCache[this.parent.pageSettings.currentPage],h=0;for(a=0;a<l.length;a++)l[a].isCaptionRow&&h++;t+=Math.round(h/this.parent.groupSettings.columns.length)*this.parent.getRowHeight()}else t+=this.parent.pageSettings.pageSize*this.parent.getRowHeight()+Di();return t},e.prototype.captionRowHeight=function(){return[].slice.call(this.parent.getContent().querySelectorAll("tr:not(.e-row)")).length*this.parent.getRowHeight()},e.prototype.removeTopRows=function(e,t){for(var i=this.parent.isFrozenGrid(),r=this.parent.getFrozenMode()===ee?[].slice.call(this.parent.element.querySelector(".e-frozen-right-content").getElementsByClassName(Y)):null,n=i?[].slice.call(this.parent.getMovableVirtualContent().getElementsByClassName(Y)):null,s=0;s<=t;s++)this.parent.frozenRows&&this.parent.pageSettings.currentPage===this.parent.infiniteScrollSettings.maxBlocks+1&&s>t-this.parent.frozenRows||(sf.base.remove(e[s]),n&&sf.base.remove(n[s]),r&&sf.base.remove(r[s]))},e.prototype.removeBottomRows=function(e,t,i){var r=0,n=this.parent.isFrozenGrid(),s=n?[].slice.call(this.parent.getMovableVirtualContent().getElementsByClassName(Y)):null,o=this.parent.getFrozenMode()===ee?[].slice.call(this.parent.element.querySelector(".e-frozen-right-content").getElementsByClassName(Y)):null,a=this.parent.pageSettings.pageSize;!n&&this.infiniteCache[i.prevPage].length<a&&(r=this.parent.pageSettings.pageSize-this.infiniteCache[i.prevPage].length),n&&this.infiniteFrozenCache[i.prevPage][1].length<a&&(r=this.parent.pageSettings.pageSize-this.infiniteFrozenCache[i.prevPage][1].length);for(var l=t;r<a;l--)r++,sf.base.remove(e[l]),s&&sf.base.remove(s[l]),o&&sf.base.remove(o[l])},e.prototype.removeCaptionRows=function(e,t){var i=[].slice.call(this.parent.getContent().getElementsByClassName(Y));if("down"===t.direction)for(var r=Vr(i[this.parent.pageSettings.pageSize-1])-1,n=0,s=0;n<r;s++)e[s].classList.contains(Y)?n=Vr(e[s]):sf.base.remove(e[s]);if("up"===t.direction){var o=Vr(i[i.length-1]),a=Math.ceil(o/this.parent.pageSettings.pageSize),l=0;for(s=this.parent.pageSettings.currentPage+1;s<a;s++)l+=this.infiniteCache[s].length;for(s=l;s<e.length;s++)sf.base.remove(e[s])}},e.prototype.resetInfiniteBlocks=function(e,t){var i=this.parent.enableInfiniteScrolling&&"infiniteScroll"!==e.requestType;if(!this.initialRender&&!sf.base.isNullOrUndefined(this.parent.infiniteScrollModule)&&i&&(this.actions.some((function(t){return t===e.requestType}))||t)){var r=this.parent.getContent().firstElementChild;this.initialRender=!0,r.scrollTop=0,this.parent.pageSettings.currentPage=1,this.infiniteCache=this.infiniteFrozenCache={},this.infiniteCurrentViewData={},this.resetContentModuleCache({}),this.isRemove=!1,this.top=0,this.isInitialMovableRender=!0,this.isInitialCollapse=!1,this.parent.contentModule.isRemove=this.isRemove,this.parent.contentModule.isAddRows=this.isRemove,this.parent.contentModule.visibleRows=[],this.parent.contentModule.visibleFrozenRows=[]}},e.prototype.setCache=function(e){if(this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache){var t=this.parent.isFrozenGrid(),i=e.args.isFrozen?1:0,r="infiniteScroll"!==e.args.requestType&&("delete"===this.requestType||"add"===this.requestType),n=this.parent.pageSettings.currentPage;(t&&this.isInitialMovableRender||!t&&!Object.keys(this.infiniteCache).length||r)&&(this.isInitialMovableRender=!e.args.isFrozen,this.setInitialCache(e.modelData,e.args,r)),!t&&sf.base.isNullOrUndefined(this.infiniteCache[this.parent.pageSettings.currentPage])&&(this.infiniteCache[this.parent.pageSettings.currentPage]=e.modelData,this.resetContentModuleCache(this.infiniteCache)),t&&(0===i&&sf.base.isNullOrUndefined(this.infiniteFrozenCache[n])||!this.infiniteFrozenCache[n][i].length)&&(this.createFrozenCache(n),this.infiniteFrozenCache[n][i]=e.modelData,1===i&&this.resetContentModuleCache(this.infiniteFrozenCache)),e.isInfiniteScroll&&!this.isRemove&&(this.isRemove=(n-1)%this.parent.infiniteScrollSettings.maxBlocks==0,this.parent.contentModule.isRemove=this.isRemove)}},e.prototype.setInitialCache=function(e,t,i,r){for(var n=this.parent.isFrozenGrid(),s=t.isFrozen?1:0,o=i?this.firstBlock:1,a=1;a<=this.parent.infiniteScrollSettings.initialBlocks;a++){var l=(a-1)*this.parent.pageSettings.pageSize,h=a*this.parent.pageSettings.pageSize;this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!r?this.setInitialGroupCache(e,o,l,h):r?this.infiniteCurrentViewData[o]=e.slice(l,h):n?(this.createFrozenCache(o),this.infiniteFrozenCache[o][s]=e.slice(l,h),this.resetContentModuleCache(this.infiniteFrozenCache)):(this.infiniteCache[o]=e.slice(l,h),this.resetContentModuleCache(this.infiniteCache)),o++}},e.prototype.createFrozenCache=function(e){this.infiniteFrozenCache[e]||(this.infiniteFrozenCache[e]=[[],[]])},e.prototype.setInitialGroupCache=function(e,t,i,r){for(var n=[],s=0,o=1;o<=Object.keys(this.infiniteCache).length;o++)s+=this.infiniteCache[o].length;var a=i;for(o=s;o<e.length&&a<r&&((e[o].index<r||e[o].isCaptionRow)&&(a=e[o].isCaptionRow?a:e[o].index,n.push(e[o])),!(e[o].index>=r||e[o].index===r-1));o++);this.infiniteCache[t]=n,this.resetContentModuleCache(this.infiniteCache)},e.prototype.resetContentModuleCache=function(e){this.parent.contentModule.infiniteCache=e},e.prototype.destroy=function(){this.removeEventListener()},e}(),Do=(ao=function(e,t){return(ao=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ao(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Mo=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.childCount=0,r.scrollData=[],r.isFirstChildRow=!1,r.groupCache={},r.startIndexes={},r.captionCounts={},r.rowsByUid={},r.objIdxByUid={},r.initialGroupCaptions={},r.requestType=["paging","columnstate","reorder","cancel","save","beginEdit","add","delete","filterbeforeopen","filterchoicerequest"],r.cacheMode=!1,r.cacheBlockSize=5,r.ignoreAccent=!!r.parent.allowFiltering&&r.parent.filterSettings.ignoreAccent,r.allowCaseSensitive=!1,r.locator=i,r.groupGenerator=new ge(r.parent),r.summaryModelGen=new ce(r.parent),r.captionModelGen=new ue(r.parent),r.rowRenderer=new le(r.locator,null,r.parent),r.eventListener(),r}return Do(t,e),t.prototype.eventListener=function(){this.parent.addEventListener(p,this.actionBegin.bind(this)),this.parent.addEventListener(c,this.actionComplete.bind(this)),this.parent.on(g,this.setLazyLoadPageSize,this),this.parent.on("group-cache",this.setCache,this),this.parent.on("lazy-load-scroll-handler",this.scrollHandler,this),this.parent.on("column-visible-changed",this.setVisible,this),this.parent.on("group-collapse",this.collapseShortcut,this)},t.prototype.captionExpand=function(e){var t=this,i=this.parent.pageSettings.currentPage,r=this.groupCache[i],n=e.getAttribute("data-uid"),s=this.getRowObjectIndexByUid(n),o=!!r[s+1]&&r[s].indent<r[s+1].indent,a=r[s],l=Wr(s,r),h={captionRowElement:e,groupInfo:a,enableCaching:!0,cancel:!1};this.parent.trigger("lazyLoadGroupExpand",h,(function(r){r.cancel||(r.keys=l.keys,r.fields=l.fields,r.rowIndex=e.rowIndex,r.makeRequest=!r.enableCaching||!o,!r.enableCaching&&o&&t.clearCache([n]),r.skip=0,r.take=t.pageSize,a.isExpand=t.rowsByUid[i][a.uid].isExpand=!0,t.captionRowExpand(r))}))},t.prototype.captionCollapse=function(e){var t=this,i=this.groupCache[this.parent.pageSettings.currentPage],r=e.rowIndex,n=e.getAttribute("data-uid"),s=this.getRowObjectIndexByUid(n),o={captionRowElement:e,groupInfo:i[s],cancel:!1};this.parent.trigger("lazyLoadGroupCollapse",o,(function(e){e.cancel||(e.isExpand=!1,t.removeRows(s,r))}))},t.prototype.setLazyLoadPageSize=function(){var e=this.parent.getContent().firstElementChild,t=Math.floor(e.offsetHeight/this.parent.getRowHeight())-1;this.pageSize=this.pageSize?this.pageSize:3*t,this.blockSize=Math.ceil(this.pageSize/2)},t.prototype.clearLazyGroupCache=function(){this.clearCache()},t.prototype.clearCache=function(e){e=e||this.getInitialCaptionIndexes();var t=this.groupCache[this.parent.pageSettings.currentPage];if(e.length)for(var i=0;i<e.length;i++){var r=this.getRowObjectIndexByUid(e[i]),n=t[r];if(n){if(this.captionCounts[this.parent.pageSettings.currentPage][n.uid])for(var s=r+1;s<t.length;s++){if(t[s].indent===n.indent||t[s].indent<n.indent){delete this.captionCounts[this.parent.pageSettings.currentPage][n.uid];break}t[s].isCaptionRow&&delete this.captionCounts[this.parent.pageSettings.currentPage][t[s].uid]}if(n.isExpand){var o=this.parent.getRowElementByUID(n.uid);if(!o)return;this.parent.groupModule.expandCollapseRows(o.querySelector(".e-recordplusexpand"))}var a=this.getNextChilds(r);if(a.length){var l=[];a[a.length-1].isCaptionRow&&(l=this.getChildRowsByParentIndex(t.indexOf(a[a.length-1]),!1,!1,null,!0,!0));var h=t.indexOf(a[0]),d=l.length?t.indexOf(l[l.length-1]):t.indexOf(a[a.length-1]);t.splice(h,d-(h-1)),this.refreshCaches()}}}},t.prototype.refreshCaches=function(){var e=this.parent.pageSettings.currentPage,t=this.groupCache[e];this.rowsByUid={},this.objIdxByUid={};for(var i=0;i<t.length;i++)this.maintainRows(t[i],i)},t.prototype.getInitialCaptionIndexes=function(){for(var e=this.parent.pageSettings.currentPage,t=[],i=0;i<this.initialGroupCaptions[e].length;i++)t.push(this.initialGroupCaptions[e][i].uid);return t},t.prototype.getRowObjectIndexByUid=function(e){return this.objIdxByUid[this.parent.pageSettings.currentPage][e]},t.prototype.collapseShortcut=function(e){if(this.parent.groupSettings.columns.length&&e.target&&yi(e.target,Q)&&"TR"===e.target.parentElement.tagName){if(!e.collapse&&yi(e.target,Y))return;var t=e.target.parentElement.getAttribute("data-uid");if(e.collapse){var i=this.getRowByUid(t);if((n=this.getRowByUid(i.parentUid)).isCaptionRow&&n.isExpand){var r=this.getRowElementByUid(i.parentUid);this.parent.groupModule.expandCollapseRows(r.cells[i.indent-1])}}else{var n;if((n=this.getRowByUid(t)).isCaptionRow&&!n.isExpand){r=this.getRowElementByUid(t);this.parent.groupModule.expandCollapseRows(r.cells[n.indent])}}}},t.prototype.getRowByUid=function(e){return this.rowsByUid[this.parent.pageSettings.currentPage][e]},t.prototype.actionBegin=function(e){if(!e.cancel){if(this.requestType.some((function(t){return t===e.requestType}))||(this.groupCache={},this.resetRowMaintenance()),"reorder"===e.requestType&&this.parent.groupSettings.columns.length)for(var t=Object.keys(this.groupCache),i=0;i<t.length;i++)for(var r=this.groupCache[t[i]],n=0;n<r.length;n++)if(r[n].isCaptionRow&&!this.captionModelGen.isEmpty()&&this.changeCaptionRow(r[n],null,t[i]),r[n].isDataRow){var s=e.fromIndex+r[n].indent,o=e.toIndex+r[n].indent;this.moveCells(r[n].cells,s,o)}("delete"===e.requestType||"add"===e.action&&"save"===e.requestType)&&(this.groupCache={},this.resetRowMaintenance())}},t.prototype.actionComplete=function(e){e.cancel||"columnstate"===e.requestType||"beginEdit"===e.requestType||"delete"===e.requestType||"save"===e.requestType||"reorder"===e.requestType||this.scrollReset()},t.prototype.resetRowMaintenance=function(){this.startIndexes={},this.captionCounts={},this.rowsByUid={},this.objIdxByUid={},this.initialGroupCaptions={}},t.prototype.moveCells=function(e,t,i){if(t>=e.length)for(var r=t-e.length;1+r--;)e.push(void 0);e.splice(t,0,e.splice(i,1)[0])},t.prototype.removeRows=function(e,t){var i,r=this.parent.pageSettings.currentPage,n=this.groupCache[r],s=[].slice.call(this.parent.getContent().querySelectorAll("tr"));if(this.parent.aggregates.length){var o=this.getAggregateByCaptionIndex(e);i=o.length?o[o.length-1].uid:void 0}var a,l=n[e].indent;this.addClass(this.getNextChilds(e)),n[e].isExpand=this.rowsByUid[r][n[e].uid].isExpand=!1;for(var h=e+1;h<n.length;h++){if(n[h].indent===l||n[h].indent<l){a=n[h].uid;break}n[h].isCaptionRow&&n[h].isExpand&&this.addClass(this.getNextChilds(h))}for(h=t+1;h<s.length&&s[h].getAttribute("data-uid")!==a;h++){if(s[h].getAttribute("data-uid")===i){sf.base.remove(s[h]);break}sf.base.remove(s[h])}},t.prototype.addClass=function(e){var t=e[this.blockSize];t&&(t.lazyLoadCssClass="e-lazyload-middle-down")},t.prototype.getNextChilds=function(e,t){for(var i=this.groupCache[this.parent.pageSettings.currentPage],r=t||i,n=i[e].indent+1,s=[],o=t?0:e+1;o<r.length&&!(r[o].indent<n);o++)r[o].indent===n&&s.push(r[o]);return s},t.prototype.lazyLoadHandler=function(e){this.setStartIndexes();var t=this.parent.getContent().querySelectorAll("tr")[e.index].getAttribute("data-uid"),i=this.getRowObjectIndexByUid(t),r=this.groupCache[this.parent.pageSettings.currentPage][i],n=e.isRowExist?e.isScroll?this.scrollData:this.getChildRowsByParentIndex(i,!0,!0,null,!0):[];if(this.scrollData=[],!e.isRowExist)if(this.setRowIndexes(i,r),this.refreshCaptionRowCount(this.groupCache[this.parent.pageSettings.currentPage][i],e.count),-1!==Object.keys(e.data).indexOf("GroupGuid"))for(var s=0;s<e.data.length;s++){var o=this.groupGenerator.generateCaptionRow(e.data[s],e.level,r.parentGid,void 0,0,r.uid);n.push(o),this.parent.aggregates.length&&(n=n.concat(this.summaryModelGen.generateRows(e.data[s],{level:e.level+1,parentUid:o.uid})))}else this.groupGenerator.index=this.getStartIndex(i,e.isScroll),n=this.groupGenerator.generateDataRows(e.data,e.level,r.parentGid,0,r.uid);var a=e.isScroll?this.rowIndex:e.index,l=this.getNextChilds(i,n),h=!!e.up||this.hasLastChildRow(e.isScroll,e.count,l.length);e.isRowExist||h||(l[this.blockSize].lazyLoadCssClass="e-lazyload-middle-down"),h||(l[l.length-1].lazyLoadCssClass="e-not-lazyload-end");var d=e.isScroll||e.isRowExist?[]:this.getAggregateByCaptionIndex(i);e.up||e.isRowExist||this.refreshRowObjects(n,e.isScroll?this.rowObjectIndex:i),this.render(a,n,h,d),this.isFirstChildRow&&!e.up&&(this.parent.getContent().firstElementChild.scrollTop=n.length*this.parent.getRowHeight()),this.isFirstChildRow=!1,this.rowIndex=void 0,this.rowObjectIndex=void 0,this.childCount=0},t.prototype.setRowIndexes=function(e,t){this.captionCounts[this.parent.pageSettings.currentPage]||(this.captionCounts[this.parent.pageSettings.currentPage]={}),t.isCaptionRow&&(this.captionCounts[this.parent.pageSettings.currentPage][t.uid]=t.data.count)},t.prototype.getStartIndex=function(e,t){var i=this.parent.pageSettings.currentPage,r=this.groupCache[i];if(t)return r[this.rowObjectIndex].index+1;var n=0,s=0,o=this.getRowByUid(r[e].parentUid);if(o&&(s=this.prevCaptionCount(o)),r[e].indent>0)for(var a=e-1;a>=0&&!(r[a].indent<r[e].indent);a--)r[a].isCaptionRow&&r[a].indent===r[e].indent&&(n+=r[a].data.count);return n+s+this.startIndexes[i][r[e].parentGid]},t.prototype.prevCaptionCount=function(e){for(var t=this.parent.pageSettings.currentPage,i=this.groupCache[t],r=0,n=i.indexOf(e)-1;n>=0&&0!==i[n].indent&&!(i[n].indent<e.indent);n--)if(i[n].isCaptionRow&&i[n].indent===e.indent){var s=this.captionCounts[t][i[n].uid];r+=s||i[n].data.count}var o=this.getRowByUid(e.parentUid);return o&&(r+=this.prevCaptionCount(o)),r},t.prototype.setStartIndexes=function(){var e=this.groupCache[this.parent.pageSettings.currentPage];if(!this.startIndexes[this.parent.pageSettings.currentPage]){for(var t=[],i=void 0,r=0;r<e.length;r++)e[r].isCaptionRow&&(t.length?t.push(e[i].data.count+t[t.length-1]):t.push(0),i=r);this.startIndexes[this.parent.pageSettings.currentPage]=t}},t.prototype.hasLastChildRow=function(e,t,i){return e?t===this.childCount+i:t===i},t.prototype.refreshCaptionRowCount=function(e,t){e.data.count=t},t.prototype.render=function(e,t,i,r){var n=this.parent.getContent().querySelectorAll("tr")[e];if(n&&r.length)for(var s=r.length-1;s>=0;s--)n.insertAdjacentElement("afterend",this.rowRenderer.render(r[s],this.parent.getColumns()));if(n&&t.length)for(s=t.length-1;s>=0;s--)this.confirmRowRendering(t[s])&&n.insertAdjacentElement("afterend",this.rowRenderer.render(t[s],this.parent.getColumns()))},t.prototype.maintainRows=function(e,t){var i=this.parent.pageSettings.currentPage;this.rowsByUid[i]||(this.rowsByUid[i]={},this.objIdxByUid[i]={}),e.uid&&(this.rowsByUid[i][e.uid]=e),this.objIdxByUid[i][e.uid]=t},t.prototype.confirmRowRendering=function(e){var t=!0;if(sf.base.isNullOrUndefined(e.indent)&&!e.isDataRow&&!e.isCaptionRow){var i=this.getRowByUid(e.parentUid);i.isCaptionRow&&!i.isExpand&&(t=!1)}return t},t.prototype.refreshRowObjects=function(e,t){var i=this.parent.pageSettings.currentPage,r=this.groupCache[i];this.rowsByUid[i]={},this.objIdxByUid[i]={};for(var n=[],s=0,o=0;o<r.length;o++)if(o===t){this.maintainRows(r[o],s),n.push(r[o]),s++;for(var a=0;a<e.length;a++)this.maintainRows(e[a],s),n.push(e[a]),s++}else this.maintainRows(r[o],s),n.push(r[o]),s++;this.groupCache[this.parent.pageSettings.currentPage]=sf.base.extend([],n),this.updateCurrentViewData()},t.prototype.getAggregateByCaptionIndex=function(e){for(var t=this.groupCache[this.parent.pageSettings.currentPage],i=t[e],r=i.indent,n=i.uid,s=[],o=e+1;o<t.length&&t[o].indent!==r;o++)sf.base.isNullOrUndefined(t[o].indent)&&t[o].parentUid===n&&s.push(t[o]);return s},t.prototype.getChildRowsByParentIndex=function(e,t,i,r,n,s){var o=r||this.groupCache[this.parent.pageSettings.currentPage],a=o[e],l=[];if(!a.isCaptionRow||a.isCaptionRow&&!a.isExpand&&!s)return[];n&&this.parent.aggregates.length&&(l=this.getAggregateByCaptionIndex(e));for(var h=a.indent,d=a.uid,p=[],c=0,u=e+1;u<o.length;u++){if(o[u].parentUid===d){if(sf.base.isNullOrUndefined(o[u].indent))continue;if(c++,p.push(o[u]),t&&o[u].isCaptionRow&&(p=p.concat(this.getChildRowsByParentIndex(u,t,i,r,n))),i&&c===this.pageSize)break}if(o[u].indent===h)break}return p.concat(l)},t.prototype.initialGroupRows=function(e){var t=[],i=this.groupCache[this.parent.pageSettings.currentPage];if(e)return this.getRenderedRowsObject();for(var r=0;r<i.length;r++)0===i[r].indent&&(t.push(i[r]),t=t.concat(this.getChildRowsByParentIndex(r,!0,!0,i,!0)));return t},t.prototype.getRenderedRowsObject=function(){for(var e=[],t=[].slice.call(this.parent.getContent().querySelectorAll("tr")),i=0;i<t.length;i++)e.push(this.getRowByUid(t[i].getAttribute("data-uid")));return e},t.prototype.getCacheRowsOnDownScroll=function(e){for(var t=[],i=this.groupCache[this.parent.pageSettings.currentPage],r=e,n=0;n<this.pageSize&&(i[r]&&!(i[r].indent<i[e].indent));n++)i[r].indent===i[e].indent&&(t.push(i[r]),i[r].isCaptionRow&&i[r].isExpand&&(t=t.concat(this.getChildRowsByParentIndex(r,!0,!0,null,!0)))),(i[r].indent>i[e].indent||sf.base.isNullOrUndefined(i[r].indent))&&n--,r++;return t},t.prototype.getCacheRowsOnUpScroll=function(e,t,i){for(var r=[],n=this.groupCache[this.parent.pageSettings.currentPage],s=!1,o=0;o<n.length&&(!s||n[o]&&!(n[o].indent<n[i].indent)&&n[o].uid!==t);o++)s||n[o].uid!==e||(s=!0),s&&n[o].indent===n[i].indent&&(r.push(n[o]),n[o].isCaptionRow&&n[o].isExpand&&(r=r.concat(this.getChildRowsByParentIndex(o,!0,!0,null,!0))));return r},t.prototype.scrollHandler=function(e){if(!this.parent.isDestroyed&&!this.childCount){var t,i,r=[].slice.call(this.parent.getContent().getElementsByClassName("e-lazyload-middle-down")),n=[].slice.call(this.parent.getContent().getElementsByClassName("e-lazyload-middle-up")),s=[].slice.call(this.parent.getContent().getElementsByClassName("e-not-lazyload-end")),o=!1,a=!1,l=!1;if(e.scrollDown&&r.length)t=(i=this.findRowElements(r)).tr,o=i.entered;if(!e.scrollDown&&s)for(var h=0;h<s.length;h++){var d=s[h].getBoundingClientRect().top,p=this.parent.getContent().scrollHeight;if(d>0&&d<p){t=s[h],l=!0,this.rowIndex=t.rowIndex;break}}if(!e.scrollDown&&n.length&&!l)t=(i=this.findRowElements(n)).tr,a=i.entered;t&&(o&&e.scrollDown&&o&&t&&this.scrollDownHandler(t),!e.scrollDown&&l&&t&&this.scrollUpEndRowHandler(t),this.cacheMode&&!e.scrollDown&&!l&&a&&t&&this.scrollUpHandler(t))}},t.prototype.scrollUpEndRowHandler=function(e){var t=this.parent.pageSettings.currentPage,i=this.groupCache[t],r=e.getAttribute("data-uid"),n=this.rowObjectIndex=this.getRowObjectIndexByUid(r),s=n,o=i[n],a=this.getRowByUid(o.parentUid),l=this.getRowObjectIndexByUid(a.uid),h=this.parent.getContent().querySelector("tr[data-uid="+a.uid+"]").rowIndex,d=this.getChildRowsByParentIndex(l).indexOf(o),p=Math.ceil(d/this.pageSize);if(1!==p)if(this.childCount=p*this.pageSize,n=this.getCurrentBlockEndIndex(o,n),this.childCount<a.data.count){e.classList.remove("e-not-lazyload-end"),o.lazyLoadCssClass="";var c=!!i[n+1]&&o.indent===i[n+1].indent;this.scrollData=c?this.getCacheRowsOnDownScroll(n+1):[];var u=Wr(l,i),f={rowIndex:h,makeRequest:!c,groupInfo:a,fields:u.fields,keys:u.keys,skip:this.childCount,take:this.pageSize,isScroll:!0};if(this.cacheMode&&this.childCount>=this.pageSize*this.cacheBlockSize){var g=this.getChildRowsByParentIndex(l),m=Math.ceil(g.indexOf(i[s])/this.pageSize)-(this.cacheBlockSize-1);this.removeBlock(r,c,m,g),f.cachedRowIndex=m*this.pageSize}this.captionRowExpand(f)}else this.childCount=0},t.prototype.scrollDownHandler=function(e){var t=this.parent.pageSettings.currentPage,i=this.groupCache[t],r=e.getAttribute("data-uid"),n=this.getRowObjectIndexByUid(r),s=n,o=i[n],a=this.getRowByUid(o.parentUid),l=this.getRowObjectIndexByUid(a.uid),h=this.getRowElementByUid(a.uid).rowIndex,d=this.getChildRowsByParentIndex(l),p=d.indexOf(o),c=Math.ceil(p/this.pageSize);this.childCount=c*this.pageSize;var u=i[n=this.rowObjectIndex=this.getRowObjectIndexByUid(d[this.childCount-1].uid)],f=this.getRowElementByUid(u.uid);if(this.rowIndex=f.rowIndex,n=this.getCurrentBlockEndIndex(u,n),this.childCount<a.data.count){var g=!!i[n+1]&&o.indent===i[n+1].indent;if(g&&!sf.base.isNullOrUndefined(this.getRowElementByUid(i[n+1].uid)))return void(this.childCount=0);(c>1||!this.cacheMode)&&(e.classList.remove("e-lazyload-middle-down"),f.classList.remove("e-not-lazyload-end"),u.lazyLoadCssClass=""),this.scrollData=g?this.getCacheRowsOnDownScroll(this.rowObjectIndex+1):[];var m=Wr(l,i),y={rowIndex:h,makeRequest:!g,groupInfo:a,fields:m.fields,keys:m.keys,skip:this.childCount,take:this.pageSize,isScroll:!0};if(this.cacheMode&&this.childCount-this.pageSize>=this.pageSize*this.cacheBlockSize){var v=this.getChildRowsByParentIndex(l),b=Math.ceil(v.indexOf(i[s])/this.pageSize)-1-(this.cacheBlockSize-1)+1;this.removeBlock(r,g,b,v,u),y.cachedRowIndex=b*this.pageSize}this.captionRowExpand(y)}else this.childCount=0},t.prototype.getCurrentBlockEndIndex=function(e,t){var i=this.parent.pageSettings.currentPage,r=this.groupCache[i];if(e.isCaptionRow){if(e.isExpand){var n=this.getChildRowsByParentIndex(t,!0).length;this.rowIndex=this.rowIndex+n}var s=this.getAggregateByCaptionIndex(t);this.rowObjectIndex=this.rowObjectIndex+s.length;for(var o=t,a=o+1;a<r.length;a++){if(r[a].indent===r[t].indent||r[a].indent<r[t].indent){t=o;break}o++}}return t},t.prototype.removeBlock=function(e,t,i,r,n){var s=this.parent.pageSettings.currentPage,o=this.groupCache[s],a=r[(i+1)*this.pageSize-1-this.blockSize].uid,l=r[i*this.pageSize-this.pageSize].uid,h=r[i*this.pageSize].uid;o[this.getRowObjectIndexByUid(a)].lazyLoadCssClass="e-lazyload-middle-up",this.getRowElementByUid(a).classList.add("e-lazyload-middle-up"),n&&(this.getRowElementByUid(h).classList.add("e-not-lazyload-first"),this.getRowByUid(h).lazyLoadCssClass="e-not-lazyload-first",this.getRowByUid(l).lazyLoadCssClass=""),t?this.removeTopRows(n?n.uid:e,l,h):(this.uid1=l,this.uid2=h,this.uid3=n?n.uid:e)},t.prototype.scrollUpHandler=function(e){var t=this.parent.pageSettings.currentPage,i=this.groupCache[t],r=e.getAttribute("data-uid"),n=this.getRowByUid(r),s=this.rowObjectIndex=this.getRowObjectIndexByUid(r),o=this.getRowByUid(n.parentUid),a=this.rowIndex=this.getRowObjectIndexByUid(o.uid),l=this.parent.getRowElementByUID(o.uid).rowIndex,h=this.getChildRowsByParentIndex(a),d=h.indexOf(i[s]),p=Math.floor(d/this.pageSize),c=this.blockSize;2*this.blockSize>this.pageSize&&(c=2*this.blockSize-this.pageSize,c=this.blockSize-c);var u=h[d-(c-1)-this.pageSize].uid,f=h[d-(c-1)].uid;this.scrollData=this.getCacheRowsOnUpScroll(u,f,s-(c-1)),this.isFirstChildRow=p>1,this.isFirstChildRow&&(this.scrollData[0].lazyLoadCssClass="e-not-lazyload-first"),this.getRowByUid(f).lazyLoadCssClass="",this.getRowElementByUid(f).classList.remove("e-not-lazyload-first");var g=p+this.cacheBlockSize;if(h.length!==o.data.count&&g*this.pageSize>h.length)return this.isFirstChildRow=!1,this.scrollData[0].lazyLoadCssClass="",void this.getRowElementByUid(f).classList.add("e-not-lazyload-first");var m=g*this.pageSize>o.data.count?o.data.count:g*this.pageSize,y=g*this.pageSize>o.data.count?this.pageSize-(this.pageSize*g-o.data.count):this.pageSize,v=this.getChildRowsByParentIndex(i.indexOf(h[m-1]),!0,!1,null,!0),b=v.length?v[v.length-1].uid:h[m-1].uid,C=h[m-y].uid,w=h[m-y-1].uid,S=this.objIdxByUid[t][C]-c;if("e-lazyload-middle-down"===i[S].lazyLoadCssClass){var x=this.getRowElementByUid(i[S].uid);x&&x.classList.add("e-lazyload-middle-down")}if(this.getRowByUid(b).lazyLoadCssClass="",this.getRowByUid(w).lazyLoadCssClass="e-not-lazyload-end",this.getRowElementByUid(w).classList.add("e-not-lazyload-end"),this.removeBottomRows(b,C,w),this.rowIndex=e.rowIndex-c,e.classList.length>1?e.classList.remove("e-lazyload-middle-up"):e.removeAttribute("class"),!sf.base.isNullOrUndefined(this.getRowElementByUid(u)))return this.childCount=0,void(this.scrollData=[]);var R=Wr(this.getRowObjectIndexByUid(o.uid),i),F={rowIndex:l,makeRequest:!1,groupInfo:o,fields:R.fields,keys:R.keys,skip:this.childCount,take:this.pageSize,isScroll:!0,scrollUp:!0};this.captionRowExpand(F)},t.prototype.findRowElements=function(e){for(var t,i=!1,r=0;r<e.length;r++){var n=e[r].rowIndex;if(ur(n,this.parent)){i=!0,this.rowIndex=n,t=e[r];break}}return{entered:i,tr:t}},t.prototype.getRowElementByUid=function(e){return this.parent.getContent().querySelector("tr[data-uid="+e+"]")},t.prototype.removeTopRows=function(e,t,i){for(var r=[].slice.call(this.parent.getContent().querySelectorAll("tr")),n=!1,s=0;s<r.length;s++){if(r[s].getAttribute("data-uid")===i){var o=this.parent.getContent().querySelector("tr[data-uid="+e+"]");o&&(this.rowIndex=o.rowIndex);break}r[s].getAttribute("data-uid")===t&&(n=!0),n&&sf.base.remove(r[s])}},t.prototype.removeBottomRows=function(e,t,i){for(var r=[].slice.call(this.parent.getContent().querySelectorAll("tr")),n=!1,s=0;s<r.length&&(r[s].getAttribute("data-uid")===t&&(n=!0),!n||(sf.base.remove(r[s]),r[s].getAttribute("data-uid")!==e));s++);},t.prototype.setCache=function(e){var t=this.parent.pageSettings.currentPage;this.groupCache[t]=this.initialGroupCaptions[t]=sf.base.extend([],e.data)},t.prototype.captionRowExpand=function(e){var t=this,i=e.groupInfo,r=this.parent.groupSettings.columns.indexOf(i.data.field)+1,n=_r(Gr(e.fields,e.keys,this)),s={level:r,skip:e.skip,take:e.take,where:n};if(e.makeRequest){var o=this.parent.renderModule.data.generateQuery(!0);o.isCountRequired||(o.isCountRequired=!0),o.lazyLoad.push({key:"onDemandGroupInfo",value:s}),this.parent.showSpinner(),this.parent.renderModule.data.getData({},o).then((function(i){t.parent.hideSpinner(),0!==i.result.length&&(t.cacheMode&&t.uid1&&t.uid2&&(t.removeTopRows(t.uid3,t.uid1,t.uid2),t.uid1=t.uid2=t.uid3=void 0),t.lazyLoadHandler({data:i.result,count:i.count,level:r,index:e.rowIndex,isRowExist:!1,isScroll:e.isScroll,up:!1,rowIndex:e.cachedRowIndex}))})).catch((function(e){return t.parent.renderModule.dataManagerFailure(e,{requestType:"grouping"})}))}else this.lazyLoadHandler({data:null,count:e.groupInfo.data.count,level:r,index:e.rowIndex,isRowExist:!0,isScroll:e.isScroll,up:e.scrollUp,rowIndex:e.cachedRowIndex})},t.prototype.scrollReset=function(e){this.parent.getContent().firstElementChild.scrollTop=e?this.parent.getContent().firstElementChild.scrollTop+e:0},t.prototype.updateCurrentViewData=function(){var e=[];this.getRows().filter((function(t){t.isDataRow&&(e[t.index]=t.data)})),this.parent.currentViewData=e.length?e:this.parent.currentViewData},t.prototype.getGroupCache=function(){return this.groupCache},t.prototype.getRows=function(){return this.groupCache[this.parent.pageSettings.currentPage]||[]},t.prototype.getRowElements=function(){return[].slice.call(this.parent.getContent().getElementsByClassName(Y))},t.prototype.getRowByIndex=function(e){for(var t,i=[].slice.call(this.parent.getContent().getElementsByClassName(Y)),r=0;!sf.base.isNullOrUndefined(e)&&r<i.length;r++)if(i[r].getAttribute(ne)===e.toString()){t=i[r];break}return t},t.prototype.setVisible=function(e){var t,i=this.parent;this.getRows().some((function(e){return e.isDataRow&&(t=e),e.isDataRow}));for(var r=this.getRows().filter((function(e){return!e.isDetailRow})),n=0;n<e.length;n++){var s=e[n],o=this.parent.getNormalizedColumnIndex(s.uid),a=this.parent.getColumnIndexByUid(s.uid),l=!0===s.visible?"":"none";-1!==o&&t&&o<t.cells.length&&sf.base.setStyleAttribute(this.getColGroup().childNodes[o],{display:l}),this.setDisplayNone(i.getDataRows(),a,l,r,o),!this.parent.invokedFromMedia&&s.hideAtMedia&&this.parent.updateMediaColumns(s),this.parent.invokedFromMedia=!1}},t.prototype.setDisplayNone=function(e,t,i,r,n){if(this.parent.groupSettings.columns.length)for(var s=Object.keys(this.groupCache),o=0;o<s.length;o++)for(var a=this.rowsByUid[s[o]],l=Object.keys(a),h=0;h<l.length;h++){var d=this.parent.getContent().querySelector("tr[data-uid="+l[h]+"]"),p=a[l[h]];p.isCaptionRow&&(this.captionModelGen.isEmpty()?(p.cells[p.indent+1].colSpan=""===i?p.cells[p.indent+1].colSpan+1:p.cells[p.indent+1].colSpan-1,d&&(d.cells[p.indent+1].colSpan=p.cells[p.indent+1].colSpan)):this.changeCaptionRow(p,d,s[o])),p.isDataRow&&(this.showAndHideCells(d,t,i,!1),p.cells[n].visible=""===i),p.isCaptionRow||p.isDataRow||!sf.base.isNullOrUndefined(p.indent)||(p.cells[n].visible=""===i,p.visible=p.cells.some((function(e){return e.isDataCell&&e.visible})),this.showAndHideCells(d,t,i,!0,p))}else Br(e,t,i,r)},t.prototype.changeCaptionRow=function(e,t,i){var r=e,n=e.data,s=this.groupGenerator.generateCaptionRow(n,r.indent,r.parentGid,void 0,r.tIndex,r.parentUid);(s.uid=e.uid,s.isExpand=e.isExpand,s.lazyLoadCssClass=e.lazyLoadCssClass,this.rowsByUid[i][e.uid]=s,this.groupCache[i][this.objIdxByUid[i][e.uid]]=s,t)&&this.parent.getContentTable().querySelector(se).replaceChild(this.rowRenderer.render(s,this.parent.getColumns()),t)},t.prototype.showAndHideCells=function(e,t,i,r,n){if(e){var s=r?"td.e-summarycell":"td.e-rowcell";sf.base.setStyleAttribute(e.querySelectorAll(s)[t],{display:i}),e.querySelectorAll(s)[t].classList.contains("e-hide")&&sf.base.removeClass([e.querySelectorAll(s)[t]],["e-hide"]),r&&(n.visible&&e.classList.contains("e-hide")?sf.base.removeClass([e],["e-hide"]):n.visible||sf.base.addClass([e],["e-hide"]))}},t}(me),Oo=function(){function t(e,t){this.parent=e,this.serviceLocator=t,this.addEventListener()}return t.prototype.getModuleName=function(){return"lazyLoadGroup"},t.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(f,this.instantiateRenderer,this),this.parent.on(F,this.destroy,this))},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(f,this.instantiateRenderer),this.parent.off(F,this.destroy))},t.prototype.instantiateRenderer=function(){"auto"===this.parent.height&&(this.parent.height=this.parent.pageSettings.pageSize*this.parent.getRowHeight());var t=this.serviceLocator.getService("rendererFactory");this.parent.groupSettings.enableLazyLoading&&t.addRenderer(e.RenderType.Content,new Mo(this.parent,this.serviceLocator))},t.prototype.destroy=function(){this.removeEventListener()},t}(),ko=(lo=function(e,t){return(lo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}lo(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ao=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ko(t,e),t.prototype.write=function(e){this.column=e.column;var t="Dialog"!==this.parent.editSettings.mode;this.object=new sf.dropdowns.AutoComplete(sf.base.extend({dataSource:this.parent.dataSource instanceof sf.data.DataManager?this.parent.dataSource:new sf.data.DataManager(this.parent.dataSource),query:(new sf.data.Query).select(e.column.field),enabled:Bi(e.column,e.requestType,e.element),fields:{value:e.column.field},value:$i(e.column.field,e.rowData),actionComplete:this.selectedValues.bind(this),placeholder:t?"":e.column.headerText,floatLabelType:t?"Never":"Always"},e.column.edit.params)),this.object.appendTo(e.element),e.element.setAttribute("name",ki(e.column.field))},t.prototype.selectedValues=function(e){e.result=sf.data.DataUtil.distinct(e.result,this.object.fields.value,!0),this.column.dataSource&&(this.column.dataSource.dataSource.json=e.result)},t}(is),Bo=(ho=function(e,t){return(ho=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ho(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),No=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Bo(t,e),t.prototype.write=function(e){this.column=e.column;var t="Dialog"!==this.parent.editSettings.mode;this.obj=new sf.dropdowns.ComboBox(sf.base.extend({dataSource:this.parent.dataSource instanceof sf.data.DataManager?this.parent.dataSource:new sf.data.DataManager(this.parent.dataSource),query:(new sf.data.Query).select(e.column.field),fields:{value:e.column.field},value:$i(e.column.field,e.rowData),enableRtl:this.parent.enableRtl,actionComplete:this.finalValue.bind(this),placeholder:t?"":e.column.headerText,floatLabelType:t?"Never":"Always",enabled:Bi(e.column,e.requestType,e.element)},e.column.edit.params)),this.obj.appendTo(e.element)},t.prototype.finalValue=function(e){e.result=sf.data.DataUtil.distinct(e.result,this.obj.fields.value,!0),this.column.dataSource&&(this.column.dataSource.dataSource.json=e.result)},t}(is),Po=(po=function(e,t){return(po=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}po(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Lo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Po(t,e),t.prototype.write=function(e){this.column=e.column;var t="Dialog"!==this.parent.editSettings.mode;this.obj=new sf.dropdowns.MultiSelect(sf.base.extend({fields:{text:e.column.field,value:e.column.field},value:sf.base.getValue(e.column.field,e.rowData),enableRtl:this.parent.enableRtl,placeholder:t?"":e.column.headerText,popupHeight:"200px",floatLabelType:t?"Never":"Always"},e.column.edit.params)),this.obj.appendTo(e.element),e.element.setAttribute("name",ki(e.column.field))},t}(is),qo=(co=function(e,t){return(co=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}co(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Ho=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qo(t,e),t.prototype.write=function(e){var t="Dialog"!==this.parent.editSettings.mode,i=$i(e.column.field,e.rowData);i=i?new Date(i):null,this.obj=new sf.calendars.TimePicker(sf.base.extend({floatLabelType:t?"Never":"Always",value:i,placeholder:t?"":e.column.headerText,enableRtl:this.parent.enableRtl,enabled:Bi(e.column,e.requestType,e.element)},e.column.edit.params)),this.obj.appendTo(e.element)},t}(is),Uo=(uo=function(e,t){return(uo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}uo(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),jo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.activeClasses=["e-selectionbackground","e-active"],t}return Uo(t,e),t.prototype.create=function(e){var t="e-field e-boolcell";return"checkbox"===e.column.type&&(t="e-field e-boolcell e-edit-checkselect"),Pr(this.parent,e.column,t,{type:"checkbox",value:e.value})},t.prototype.read=function(e){return e.checked},t.prototype.write=function(e){var t=!sf.base.isNullOrUndefined(e.row)&&e.row.querySelector(".e-edit-checkselect"),i=$i(e.column.field,e.rowData),r=i&&JSON.parse(i.toString().toLowerCase());if(!sf.base.isNullOrUndefined(t)){if(this.editType=this.parent.editSettings.mode,this.editRow=e.row,"add"!==e.requestType){var n=this.parent.getRowObjectFromUID(e.row.getAttribute("data-uid"));r=!!n&&n.isSelected}qi.apply(void 0,[[].slice.call(e.row.getElementsByClassName(q)),r].concat(this.activeClasses))}this.obj=new sf.buttons.Switch(sf.base.extend({label:"Dialog"!==this.parent.editSettings.mode?" ":e.column.headerText,checked:r,disabled:!Bi(e.column,e.requestType,e.element),enableRtl:this.parent.enableRtl,change:this.switchModeChange.bind(this)},e.column.edit.params)),this.obj.appendTo(e.element)},t.prototype.switchModeChange=function(e){if(this.editRow&&"Dialog"!==this.editType){var t=!1;e.checked?(t=!0,this.editRow.setAttribute("aria-selected",t.toString())):this.editRow.removeAttribute("aria-selected"),qi.apply(void 0,[[].slice.call(this.editRow.getElementsByClassName(q)),t].concat(this.activeClasses))}},t}(is),Vo=(fo=function(e,t){return(fo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}fo(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Go=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Vo(t,e),t.prototype.write=function(e){this.column=e.column;var t="Dialog"!==this.parent.editSettings.mode;this.obj=new sf.inputs.MaskedTextBox(sf.base.extend({fields:{value:e.column.field},value:$i(e.column.field,e.rowData),floatLabelType:t?"Never":"Always",mask:"000-000-0000",enabled:Bi(e.column,e.requestType,e.element)},e.column.edit.params)),this.obj.appendTo(e.element)},t}(is);return Yt.Inject(Rn,pn,It,rn,zn,In,Tn,Dn,Mn,Nn,Tt,Jn,Rs,En,Ts,zs,Os,As,mo,yo,Fs,bo,zo,Oo),e.CheckBoxFilterBase=$r,e.ExcelFilterBase=tn,e.SortDescriptor=Lt,e.SortSettings=qt,e.Predicate=Ht,e.InfiniteScrollSettings=Ut,e.FilterSettings=jt,e.SelectionSettings=Vt,e.SearchSettings=Gt,e.RowDropSettings=_t,e.TextWrapSettings=Wt,e.ResizeSettings=Kt,e.GroupSettings=Qt,e.EditSettings=Xt,e.Grid=Yt,e.doesImplementInterface=$t,e.valueAccessor=ei,e.headerValueAccessor=function(e,t){return sf.base.isNullOrUndefined(e)||""===e?"":sf.data.DataUtil.getObject(e,t)},e.getUpdateUsingRaf=ti,e.isExportColumns=ii,e.updateColumnTypeForExportColumns=ri,e.updatecloneRow=ni,e.getCollapsedRowsCount=oi,e.recursive=ai,e.iterateArrayOrObject=li,e.iterateExtend=hi,e.templateCompiler=di,e.setStyleAndAttributes=pi,e.extend=ci,e.setColumnIndex=ui,e.prepareColumns=fi,e.setCssInGridPopUp=gi,e.getActualProperties=mi,e.parentsUntil=yi,e.getElementIndex=vi,e.inArray=bi,e.getActualPropFromColl=Ci,e.removeElement=wi,e.getPosition=Si,e.getUid=Ri,e.appendChildren=Fi,e.parents=Ei,e.calculateAggregate=Ii,e.getScrollBarWidth=Di,e.getRowHeight=Mi,e.getActualRowHeight=function(e){var t=sf.base.createElement("table",{className:X,styles:"visibility: hidden"});t.innerHTML='<tr><td class="e-rowcell">A<td></tr>',e.appendChild(t);var i=t.querySelector("tr").getBoundingClientRect();return e.removeChild(t),i.height},e.isComplexField=Oi,e.getComplexFieldID=ki,e.setComplexFieldID=Ai,e.isEditable=Bi,e.isActionPrevent=Ni,e.wrap=Pi,e.setFormatter=Li,e.addRemoveActiveClasses=qi,e.distinctStringValues=Hi,e.getFilterMenuPostion=Ui,e.getZIndexCalcualtion=ji,e.toogleCheckbox=Vi,e.setChecked=Gi,e.createCboxWithWrap=_i,e.removeAddCboxClasses=Wi,e.refreshForeignData=Ki,e.getForeignData=Qi,e.getColumnByForeignKeyValue=Xi,e.getDatePredicate=Yi,e.renderMovable=Ji,e.isGroupAdaptive=Zi,e.getObject=$i,e.getCustomDateFormat=er,e.getExpandedState=tr,e.getPrintGridModel=ir,e.extendObjWithFn=rr,e.measureColumnDepth=sr,e.checkDepth=or,e.refreshFilteredColsUid=ar,e.getTransformValues=lr,e.applyBiggerTheme=hr,e.alignFrozenEditForm=dr,e.ensureLastRow=pr,e.ensureFirstRow=cr,e.isRowEnteredInGrid=ur,e.getEditedDataIndex=fr,e.eventPromise=gr,e.getStateEventArgument=mr,e.ispercentageWidth=yr,e.resetRowIndex=vr,e.compareChanges=br,e.setRowElements=Cr,e.splitFrozenRowObjectCells=wr,e.gridActionHandler=Sr,e.getGridRowObjects=xr,e.getGridRowElements=Rr,e.sliceElements=Fr,e.getCellsByTableName=Er,e.getCellByColAndRowIndex=Ir,e.setValidationRuels=Tr,e.getMovableTbody=zr,e.getFrozenRightTbody=Dr,e.setRowsInTbody=Mr,e.getNumberFormat=Or,e.addBiggerDialog=kr,e.performComplexDataOperation=Ar,e.setDisplayValue=Br,e.addRemoveEventListener=Nr,e.createEditElement=Pr,e.getColumnModelByUid=Lr,e.getColumnModelByFieldName=qr,e.registerEventHandlers=Hr,e.removeEventHandlers=Ur,e.clearReactVueTemplates=jr,e.getRowIndexFromElement=Vr,e.generateExpandPredicates=Gr,e.getPredicates=_r,e.getGroupKeysAndFields=Wr,e.created="create",e.destroyed="destroy",e.load="load",e.rowDataBound="rowDataBound",e.queryCellInfo="queryCellInfo",e.headerCellInfo="headerCellInfo",e.actionBegin=p,e.actionComplete=c,e.actionFailure="actionFailure",e.dataBound=u,e.rowSelecting="rowSelecting",e.rowSelected="rowSelected",e.rowDeselecting="rowDeselecting",e.rowDeselected="rowDeselected",e.cellSelecting="cellSelecting",e.cellSelected="cellSelected",e.cellDeselecting="cellDeselecting",e.cellDeselected="cellDeselected",e.columnSelecting="columnSelecting",e.columnSelected="columnSelected",e.columnDeselecting="columnDeselecting",e.columnDeselected="columnDeselected",e.columnDragStart="columnDragStart",e.columnDrag="columnDrag",e.columnDrop="columnDrop",e.rowDragStartHelper="rowDragStartHelper",e.rowDragStart="rowDragStart",e.rowDrag="rowDrag",e.rowDrop="rowDrop",e.beforePrint="beforePrint",e.printComplete="printComplete",e.detailDataBound="detailDataBound",e.toolbarClick="toolbarClick",e.batchAdd="batchAdd",e.batchCancel="batchCancel",e.batchDelete="batchDelete",e.beforeBatchAdd="beforeBatchAdd",e.beforeBatchDelete="beforeBatchDelete",e.beforeBatchSave="beforeBatchSave",e.beginEdit="beginEdit",e.cellEdit="cellEdit",e.cellSave="cellSave",e.cellSaved="cellSaved",e.endAdd="endAdd",e.endDelete="endDelete",e.endEdit="endEdit",e.recordDoubleClick="recordDoubleClick",e.recordClick="recordClick",e.beforeDataBound="beforeDataBound",e.beforeOpenColumnChooser="beforeOpenColumnChooser",e.beforeOpenAdaptiveDialog="beforeOpenAdaptiveDialog",e.resizeStart="resizeStart",e.onResize="resizing",e.resizeStop="resizeStop",e.checkBoxChange="checkBoxChange",e.beforeCopy="beforeCopy",e.beforePaste="beforePaste",e.beforeAutoFill="beforeAutoFill",e.filterChoiceRequest="filterchoicerequest",e.filterAfterOpen="filterafteropen",e.filterBeforeOpen="filterbeforeopen",e.filterSearchBegin="filtersearchbegin",e.commandClick="commandClick",e.exportGroupCaption="exportGroupCaption",e.lazyLoadGroupExpand="lazyLoadGroupExpand",e.lazyLoadGroupCollapse="lazyLoadGroupCollapse",e.initialLoad=f,e.initialEnd=g,e.dataReady=m,e.contentReady=y,e.uiUpdate=v,e.onEmpty=b,e.inBoundModelChanged=C,e.modelChanged=w,e.colGroupRefresh="colgroup-refresh",e.headerRefreshed=S,e.pageBegin="paging-begin",e.pageComplete="paging-complete",e.sortBegin="sorting-begin",e.sortComplete="sorting-complete",e.filterBegin="filtering-begin",e.filterComplete="filtering-complete",e.searchBegin="searching-begin",e.searchComplete="searching-complete",e.reorderBegin="reorder-begin",e.reorderComplete="reorder-complete",e.rowDragAndDropBegin="rowdraganddrop-begin",e.rowDragAndDropComplete="rowdraganddrop-complete",e.groupBegin="grouping-begin",e.groupComplete="grouping-complete",e.ungroupBegin="ungrouping-begin",e.ungroupComplete="ungrouping-complete",e.groupAggregates="group-aggregates",e.refreshFooterRenderer="refresh-footer-rendered",e.refreshAggregateCell="refresh-aggregate-cell",e.refreshAggregates="refresh-aggregates",e.rowSelectionBegin="rowselecting",e.rowSelectionComplete="rowselected",e.columnSelectionBegin="columnselecting",e.columnSelectionComplete="columnselected",e.cellSelectionBegin="cellselecting",e.cellSelectionComplete="cellselected",e.beforeCellFocused="beforecellfocused",e.cellFocused="cellfocused",e.keyPressed=x,e.click=R,e.destroy=F,e.columnVisibilityChanged="column-visible-changed",e.scroll="scroll",e.columnWidthChanged="column-width-changed",e.columnPositionChanged="column-position-changed",e.rowDragAndDrop="row-drag-and-drop",e.rowsAdded="rows-added",e.rowsRemoved="rows-removed",e.columnDragStop="column-drag-stop",e.headerDrop="header-drop",e.dataSourceModified="datasource-modified",e.refreshComplete="refresh-complete",e.refreshVirtualBlock="refresh-virtual-block",e.dblclick="dblclick",e.toolbarRefresh="toolbar-refresh",e.bulkSave="bulk-save",e.autoCol=E,e.tooltipDestroy="tooltip-destroy",e.updateData="update-data",e.editBegin="edit-begin",e.editComplete="edit-complete",e.addBegin="add-begin",e.addComplete="add-complete",e.saveComplete="save-complete",e.deleteBegin="delete-begin",e.deleteComplete="delete-complete",e.preventBatch=I,e.dialogDestroy="dialog-destroy",e.crudAction="crud-Action",e.addDeleteAction="add-delete-Action",e.destroyForm="destroy-form",e.doubleTap="double-tap",e.beforeExcelExport="beforeExcelExport",e.excelExportComplete="excelExportComplete",e.excelQueryCellInfo="excelQueryCellInfo",e.excelHeaderQueryCellInfo="excelHeaderQueryCellInfo",e.exportDetailDataBound="exportDetailDataBound",e.beforePdfExport="beforePdfExport",e.pdfExportComplete="pdfExportComplete",e.pdfQueryCellInfo="pdfQueryCellInfo",e.pdfHeaderQueryCellInfo="pdfHeaderQueryCellInfo",e.accessPredicate="access-predicate",e.contextMenuClick="contextMenuClick",e.freezeRender="freezerender",e.freezeRefresh="freezerefresh",e.contextMenuOpen="contextMenuOpen",e.columnMenuClick="columnMenuClick",e.columnMenuOpen="columnMenuOpen",e.filterOpen="filterOpen",e.filterDialogCreated="filterDialogCreated",e.filterMenuClose=T,e.initForeignKeyColumn="initForeignKeyColumn",e.getForeignKeyData="getForeignKeyData",e.generateQuery="generateQuery",e.showEmptyGrid="showEmptyGrid",e.foreignKeyData="foreignKeyData",e.columnDataStateChange="columnDataStateChange",e.dataStateChange="dataStateChange",e.dataSourceChanged="dataSourceChanged",e.rtlUpdated="rtl-updated",e.beforeFragAppend="beforeFragAppend",e.frozenHeight="frozenHeight",e.textWrapRefresh="textWrapRefresh",e.recordAdded="recordAdded",e.cancelBegin="cancel-Begin",e.editNextValCell="editNextValCell",e.hierarchyPrint="hierarchyprint",e.expandChildGrid="expandchildgrid",e.printGridInit="printGrid-Init",e.exportRowDataBound="export-RowDataBound",e.exportDataBound="export-DataBound",e.rowPositionChanged="row-position-changed",e.columnChooserOpened="columnChooserOpened",e.batchForm="batchedit-form",e.beforeStartEdit="edit-form",e.beforeBatchCancel="before-batch-cancel",e.batchEditFormRendered="batcheditform-rendered",e.partialRefresh="partial-refresh",e.beforeCustomFilterOpen="beforeCustomFilterOpen",e.selectVirtualRow="select-virtual-Row",e.columnsPrepared="columns-prepared",e.cBoxFltrBegin="cbox-filter-begin",e.cBoxFltrComplete=z,e.fltrPrevent=D,e.beforeFltrcMenuOpen="before-filter-cmenu-open",e.valCustomPlacement="validation-custom-placement",e.filterCboxValue="filter-cbox-value",e.componentRendered="component-rendered",e.restoreFocus="restore-Focus",e.detailStateChange="detail-state-change",e.detailIndentCellInfo="detail-indentcell-info",e.virtaulKeyHandler="virtaul-key-handler",e.virtaulCellFocus="virtaul-cell-focus",e.virtualScrollEditActionBegin="virtual-scroll-edit-action-begin",e.virtualScrollEditSuccess="virtual-scroll-edit-success",e.virtualScrollEditCancel="virtual-scroll-edit-cancel",e.virtualScrollEdit="virtual-scroll-edit",e.refreshVirtualCache="refresh-virtual-cache",e.editReset="edit-reset",e.virtualScrollAddActionBegin="virtual-scroll-add-action-begin",e.getVirtualData=M,e.refreshInfiniteModeBlocks="refresh-infinite-mode-blocks",e.resetInfiniteBlocks="reset-infinite-blocks",e.infiniteScrollHandler="infinite-scroll-handler",e.infinitePageQuery="infinite-page-query",e.infiniteShowHide="infinite-show-hide",e.appendInfiniteContent="append-infinite-content",e.removeInfiniteRows="remove-infinite-rows",e.setInfiniteCache="set-infinite-cache",e.infiniteEditHandler="infinite-edit-handler",e.initialCollapse="initial-collapse",e.getAggregateQuery="get-aggregate-query",e.closeFilterDialog="close-filter-dialog",e.columnChooserCancelBtnClick="columnChooserCancelBtnClick",e.getFilterBarOperator="get-filterbar-operator",e.resetColumns="reset-columns",e.pdfAggregateQueryCellInfo="pdfAggregateQueryCellInfo",e.excelAggregateQueryCellInfo="excelAggregateQueryCellInfo",e.setGroupCache="group-cache",e.lazyLoadScrollHandler="lazy-load-scroll-handler",e.groupCollapse="group-collapse",e.beforeCheckboxRenderer="beforeCheckboxRenderer",e.refreshHandlers=O,e.refreshFrozenColumns="refresh-frozen-columns",e.setReorderDestinationElement="set-reorder-destination-element",e.refreshVirtualFrozenHeight="refresh-virtual-frozen-height",e.setFreezeSelection="set-freeze-selection",e.setInfiniteFrozenHeight="set-infinite-frozen-height",e.setInfiniteColFrozenHeight="set-infinite-col-frozen-height",e.beforeRefreshOnDataChange="before-refresh-on-data-change",e.immutableBatchCancel="immutable-batch-cancel",e.refreshVirtualFrozenRows="refresh-virtual-frozenrows",e.checkScrollReset="check-scroll-reset",e.refreshFrozenHeight="refresh-frozen-height",e.setHeightToFrozenElement="set-height-to-frozen-element",e.preventFrozenScrollRefresh="prevent-frozen-scroll-refresh",e.nextCellIndex="next-cell-index",e.refreshInfiniteCurrentViewData="refresh-infinite-current-view-data",e.infiniteCrudCancel="infinite-crud-cancel",e.filterDialogClose="filter-dialog-close",e.refreshCustomFilterOkBtn="refresh-cutsom-filter-ok-button",e.refreshCustomFilterClearBtn="refresh-cutsom-filter-clear-button",e.renderResponsiveCmenu="render-responsive-cmenu",e.filterCmenuSelect="filter-cmenu-select",e.customFilterClose="custom-filter-close",e.setFullScreenDialog="set-fullscreen-dialog",e.refreshExpandandCollapse="refresh-Expand-and-Collapse",e.rowModeChange="row-mode-change",e.enterKeyHandler="enter-key-handler",e.refreshVirtualMaxPage="refresh-virtual-max-page",e.setVirtualPageQuery="set-virtual-page-query",e.selectRowOnContextOpen="select-row-on-context-open",e.pagerRefresh="pager-refresh",e.closeInline="closeinline",e.closeBatch="closebatch",e.closeEdit="close-edit",e.resetVirtualFocus="reset-virtual-focus",e.afterContentRender="after-content-renderer",e.refreshVirtualEditFormCells="refresh-virtual-editform-cells",e.scrollToEdit="scroll-to-edit",e.beforeCheckboxRendererQuery="before-checkbox-renderer-query",e.createVirtualValidationForm="create-virtual-validation-form",e.validateVirtualForm="validate-virtual-form",e.destroyChildGrid="destroy-child-grid",e.stickyScrollComplete="sticky-scroll-complete",e.captionActionComplete="infinite-group-collapse",e.refreshInfinitePersistSelection="refresh-infinite-persist-selection",e.rowCell=q,e.gridHeader=H,e.gridContent=U,e.gridFooter=j,e.headerContent=V,e.movableContent=G,e.movableHeader=_,e.frozenContent=W,e.frozenHeader=K,e.content=Q,e.table=X,e.row=Y,e.gridChkBox=J,e.editedRow=Z,e.addedRow=$,e.changedRecords="changedRecords",e.addedRecords="addedRecords",e.deletedRecords="deletedRecords",e.leftRight=ee,e.frozenRight=te,e.frozenLeft=ie,e.ariaColIndex=re,e.ariaRowIndex=ne,e.tbody=se,e.colGroup=oe,e.open=ae,e.change="change",e.focus="focus",e.create="created",e.beforeOpen="beforeOpen",e.downArrow="downArrow",e.upArrow="upArrow",e.pageUp="PageUp",e.pageDown="PageDown",e.enter="enter",e.shiftEnter="shiftEnter",e.tab="tab",e.shiftTab="shiftTab",e.Data=B,e.Sort=rn,e.Page=pn,e.Selection=It,e.Filter=Rn,e.Search=Tt,e.Scroll=Dt,e.resizeClassList=Fn,e.Resize=En,e.Reorder=In,e.RowDD=Tn,e.Group=zn,e.getCloneProperties=Jt,e.Print=Zt,e.DetailRow=Dn,e.Toolbar=Mn,e.Aggregate=Nn,e.summaryIterator=Pn,e.VirtualScroll=Jn,e.Edit=Rs,e.BatchEdit=us,e.InlineEdit=cs,e.NormalEdit=ds,e.DialogEdit=gs,e.ColumnChooser=Fs,e.ExcelExport=Ts,e.PdfExport=zs,e.ExportHelper=Es,e.ExportValueFormatter=Is,e.Clipboard=Bt,e.CommandColumn=Os,e.CheckBoxFilter=wn,e.menuClass=ks,e.ContextMenu=As,e.Freeze=mo,e.ColumnMenu=yo,e.ExcelFilter=xn,e.ForeignKey=bo,e.Logger=Fo,e.detailLists=Eo,e.InfiniteScroll=zo,e.LazyLoadGroup=Oo,e.Column=h,e.CommandColumnModel=d,e.Row=N,e.Cell=P,e.HeaderRender=ye,e.ContentRender=me,e.RowRenderer=le,e.CellRenderer=ve,e.HeaderCellRenderer=Le,e.FilterCellRenderer=fn,e.StackedHeaderCellRenderer=He,e.Render=nt,e.IndentCellRenderer=je,e.GroupCaptionCellRenderer=Ge,e.GroupCaptionEmptyCellRenderer=_e,e.BatchEditRender=$n,e.DialogEditRender=es,e.InlineEditRender=Zn,e.EditRender=ts,e.BooleanEditCell=ns,e.DefaultEditCell=hs,e.DropDownEditCell=os,e.NumericEditCell=as,e.DatePickerEditCell=ys,e.CommandColumnRenderer=Ms,e.FreezeContentRender=Ps,e.FreezeRender=Ls,e.StringFilterUI=mn,e.NumberFilterUI=yn,e.DateFilterUI=bn,e.BooleanFilterUI=vn,e.FlMenuOptrUI=gn,e.AutoCompleteEditCell=Ao,e.ComboboxEditCell=No,e.MultiSelectEditCell=Lo,e.TimePickerEditCell=Ho,e.ToggleEditCell=jo,e.MaskedTextBoxCellEdit=Go,e.VirtualContentRenderer=Qn,e.VirtualHeaderRenderer=Xn,e.VirtualElementHandler=Yn,e.GroupLazyLoadRenderer=Mo,e.ColumnFreezeHeaderRenderer=Hs,e.ColumnFreezeContentRenderer=Us,e.ResponsiveDialogRenderer=ot,e.EditCellBase=is,e.CellRendererFactory=st,e.ServiceLocator=at,e.RowModelGenerator=he,e.GroupModelGenerator=ge,e.FreezeRowModelGenerator=Bs,e.ValueFormatter=a,e.VirtualRowModelGenerator=Wn,e.InterSectionObserver=_n,e.Pager=ln,e.ExternalMessage=dn,e.NumericContainer=nn,e.PagerMessage=sn,e.PagerDropDown=hn,e},sf.grids=sf.grids({})}});