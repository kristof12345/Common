(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{"./bundles/sf-mention.js":function(t,e,n){"use strict";n.r(e);n("./modules/sf-mention.js")},"./modules/sf-mention.js":function(t,e){window.sfBlazor=window.sfBlazor||{},window.sfBlazor.Mention=function(){"use strict";var t="HidePopupAsync",e="ShowPopupAsync",n="OnSearchAsync",i=function(){function i(t,e,n,i,s){this.activeIndex=null,window.sfBlazor=window.sfBlazor,this.dataId=t;var o=document.querySelector(e);this.inputElement=n?o.firstElementChild:this.checkAndUpdateInternalComponent(o),n&&(o.insertAdjacentElement("beforebegin",o.firstElementChild),sf.base.detach(o)),this.isContentEditable(this.inputElement)&&(this.inputElement.setAttribute("contenteditable","true"),sf.base.addClass([this.inputElement],["e-mention"])),this.inputElement.setAttribute("role","textbox"),this.options=s,window.sfBlazor.setCompInstance(this),this.dotNetRef=i}return i.prototype.initialize=function(t){this.keyConfigure={tab:"tab",enter:"13",escape:"27",end:"35",home:"36",down:"40",up:"38",pageUp:"33",pageDown:"34",open:"alt+40",close:"shift+tab",hide:"alt+38",space:"32"},sf.base.EventHandler.add(t,"keyup",this.onKeyUp,this),sf.base.Browser.isDevice||new sf.base.KeyboardEvents(t,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"})},i.prototype.checkAndUpdateInternalComponent=function(t){return t&&t.classList.contains("e-richtexteditor")?t.querySelector(".e-content"):t},i.prototype.keyActionHandler=function(t){var e={Action:t.action,Key:t.key,Events:t,Type:t.type};this.isDisposed||this.dotNetRef.invokeMethodAsync("KeyActionHandlerAsync",e),("tab"!==t.action&&"up"!==t.action&&"down"!==t.action&&"close"!==t.action&&"space"!==t.action&&"enter"!==t.action&&"open"!==t.action&&("SfMention"===this.options.moduleName||"home"!==t.action&&"end"!==t.action)||"enter"===t.action&&!sf.base.isNullOrUndefined(this.isPopupOpen())||("up"===t.action||"down"===t.action)&&this.isPopupOpen())&&t.preventDefault()},i.prototype.onPropertyChanged=function(t){for(var e=0,n=Object.keys(t);e<n.length;e++){var i=n[e];switch(i){case"MinLength":this.options.minLength=t[i];break;case"SuffixText":this.options.suffixText=t[i];break;case"AllowSpaces":this.options.allowSpaces=t[i];break;case"MentionChar":this.options.mentionChar=t[i];break;case"ShowMentionChar":this.options.showMentionChar=t[i]}}},i.prototype.getItems=function(){return this.list?this.list.querySelectorAll(".e-list-item"):[]},i.prototype.onKeyUp=function(i){var s,o={Key:i.key,Code:i.code,Location:i.location,CtrlKey:i.ctrlKey,ShiftKey:i.shiftKey,AltKey:i.altKey,MetaKey:i.metaKey,Repeat:i.repeat,Type:i.type};this.isContentEditable(this.inputElement)&&(this.range=this.getCurrentRange(),s=this.range.startContainer.textContent.split(""));var r=this.getTextRange(),a=this.getLastLetter(r),l=new RegExp("\\".concat(this.options.mentionChar),"g"),p=new RegExp("[a-zA-Z]","g");"Shift"!==i.key&&37!==i.keyCode&&39!==i.keyCode&&(!r||!a||"Enter"===i.code||27===i.keyCode||a.match(l)&&a.match(l).length>1||this.isContentEditable(this.inputElement)&&this.range.startContainer&&this.range.startContainer.previousElementSibling&&"BR"!==this.range.startContainer.previousElementSibling.nodeName&&this.range.startContainer.textContent.split("").length>0&&(1===s.length||-1===s[s.length-2].indexOf("")||1===this.range.startContainer.nodeType)?this.options.allowSpaces&&this.isPopupOpen()&&r&&""!==r.trim()&&p.test(r)&&-1!==r.indexOf(this.options.mentionChar)&&!this.isMatchedText()&&r.length>1&&" "!==r.replace(/\u00A0/g," ").charAt(r.length-2)&&this.list&&this.list.querySelectorAll("ul").length>0?(this.queryString=r.substring(r.lastIndexOf(this.options.mentionChar)+1).replace(" "," "),this.dotNetRef.invokeMethodAsync(n,o,this.queryString)):!this.isPopupOpen()||this.options.allowSpaces&&a?"Backspace"!==i.key&&"Delete"!==i.key||this.range.startOffset===this.range.endOffset||this.range.deleteContents():(this.dotNetRef.invokeMethodAsync(t),this.lineBreak=!0):(this.queryString=a.replace(this.options.mentionChar,""),this.options.mentionChar.charCodeAt(0)===a.charCodeAt(0)&&""!==this.queryString&&!this.lineBreak||""===this.queryString&&this.isPopupOpen()&&38!==i.keyCode&&40!==i.keyCode?this.dotNetRef.invokeMethodAsync(n,o,this.queryString):0!==a.indexOf(this.options.mentionChar)||this.isPopupOpen()||8===i.keyCode?this.options.allowSpaces&&this.isPopupOpen()&&""!==this.queryString&&r&&""!==r.trim()&&r.replace(" "," ").lastIndexOf(" ")<r.length-1&&38!==i.keyCode&&40!==i.keyCode&&8!==i.keyCode&&(this.queryString=r.substring(r.lastIndexOf(this.options.mentionChar)+1).replace(" "," "),this.dotNetRef.invokeMethodAsync(n,o,this.queryString)):(this.dotNetRef.invokeMethodAsync(n,o,this.queryString),this.isPopupOpen()||38===i.keyCode||40===i.keyCode||(this.dotNetRef.invokeMethodAsync(e),this.lineBreak=!1))))},i.prototype.isMatchedText=function(){for(var t=!1,e=0;e<(this.liCollections&&this.liCollections.length);e++)this.getTextRange()&&this.getTextRange().substring(this.getTextRange().lastIndexOf(this.options.mentionChar)+1).replace(" "," ").trim()===this.liCollections[e].getAttribute("data-value").toLowerCase()&&(t=!0);return t},i.prototype.getCurrentRange=function(){return this.range=this.inputElement.ownerDocument.getSelection().getRangeAt(0),this.range},i.prototype.getTextRange=function(){var t;if(this.isContentEditable(this.inputElement)){var e=this.range.startContainer;if(!sf.base.isNullOrUndefined(e)){var n=e.textContent,i=this.range.startOffset;n&&i>=0&&(t=n.substring(0,i))}}else{var s=this.inputElement;if(!sf.base.isNullOrUndefined(s)){var o=s.selectionStart;s.value&&o>=0&&(t=s.value.substring(0,o))}}return t},i.prototype.getLastLetter=function(t){if(sf.base.isNullOrUndefined(t))return"";var e=t.replace(/\u00A0/g," ").split(/\s+/);return e[e.length-1].trim()},i.prototype.renderPopup=function(t,e,n){if(!this.isPopupOpen()){var i;this.isContentEditable(this.inputElement)&&(this.range=this.getCurrentRange()),this.options=e,this.list=t.querySelector(".e-content"),this.list.querySelector(".e-active")&&sf.base.attributes(this.inputElement,{"aria-activedescendant":this.list.querySelector(".e-active").id}),sf.base.attributes(this.inputElement,{"aria-owns":this.dataId+"_options"}),this.liCollections=this.getItems();var s=sf.base.formatUnit(this.options.popupHeight);if(this.wireListEvents(),t){var o=document.getElementById(t.id);o&&sf.base.remove(o)}document.body.appendChild(t),t.style.visibility="hidden",this.initializePopup(t,0,0),this.checkCollision(t),t.style.visibility="visible",sf.base.addClass([t],"e-popup-close");this.popupObj.show(new sf.base.Animation({name:"FadeIn",duration:100}),this.inputElement),i=this.getCoordinates(this.inputElement,this.getTriggerCharPosition()),this.isCollided?(t.style.left=sf.base.formatUnit(i.left),this.isCollided=!1):t.style.cssText="top: ".concat(i.top.toString(),"px;\n left: ").concat(i.left.toString(),"px;\nposition: absolute;\n display: block;"),t.style.width="100%"===this.options.popupWidth||sf.base.isNullOrUndefined(this.options.popupWidth)?"auto":sf.base.formatUnit(this.options.popupWidth),"auto"!==this.options.popupHeight?(this.list.style.maxHeight=(parseInt(s,10)-2).toString()+"px",t.style.maxHeight=sf.base.formatUnit(this.options.popupHeight)):t.style.height="auto",t.style.zIndex=1e3===this.options.zIndex?sf.popups.getZindexPartial(t).toString():this.options.zIndex.toString(),this.isPopupOpen()||this.inputElement.removeAttribute("aria-activedescendant")}},i.prototype.search=function(n,i,s){var o=this,r=this.getTextRange(),a=this.getLastLetter(r);this.options.ignoreCase&&(n===a||n===a.toLowerCase())||!this.options.ignoreCase&&n===a?this.dotNetRef.invokeMethodAsync(e).then((function(){sf.base.isNullOrUndefined(o.popupObj)||(o.popupObj.element.style.left=sf.base.formatUnit(i),o.popupObj.element.style.top=sf.base.formatUnit(s))})):this.isPopupOpen()&&this.dotNetRef.invokeMethodAsync(t)},i.prototype.getCoordinates=function(t,e){var n,i,s,o,r,a,l;if(this.isContentEditable(this.inputElement)){var p=this.getTriggerCharPosition();o=this.range,s=document.createRange(),this.getTextRange()&&-1!==this.getTextRange().lastIndexOf(this.options.mentionChar)?(s.setStart(o.startContainer,p),s.setEnd(o.startContainer,p)):(s.setStart(o.startContainer,o.startOffset),s.setEnd(o.startContainer,o.endOffset)),s.collapse(!1),l=0===s.getBoundingClientRect().top?s.startContainer.getClientRects()[0]:s.getBoundingClientRect()}else n=sf.base.createElement("div",{className:"e-form-mirror-div"}),document.body.appendChild(n),a=getComputedStyle(t),n.style.position="absolute",n.style.visibility="hidden",["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"].forEach((function(t){n.style[t]=a[t]})),n.textContent=t.value.substring(0,e),"INPUT"===this.inputElement.nodeName&&(n.textContent=n.textContent.replace(/\s/g," ")),(i=sf.base.createElement("span")).textContent=t.value.substring(e)||".",n.appendChild(i),l=t.getBoundingClientRect();var h=document.documentElement,d=(window.pageXOffset||h.scrollLeft)-(h.clientLeft||0),u=(window.pageYOffset||h.scrollTop)-(h.clientTop||0),c=0;if(!sf.base.isNullOrUndefined(s)&&0===s.getBoundingClientRect().top)for(var f=0;f<this.range.startContainer.childNodes.length;f++)if(this.range.startContainer.childNodes[f].nodeType!==Node.TEXT_NODE&&""!==this.range.startContainer.childNodes[f].textContent.trim())c+=this.range.startContainer.childNodes[f].getClientRects()[0].width;else if(""!==this.range.startContainer.childNodes[f].textContent){var g=document.createElement("span");g.innerHTML=this.range.startContainer.childNodes[f].nodeValue,document.body.appendChild(g);var m=g.offsetWidth;document.body.removeChild(g),c+=m}return this.isContentEditable(this.inputElement)?r={top:l.top+u+parseInt(getComputedStyle(this.inputElement).fontSize),left:l.left+d+c}:(r={top:l.top+u+i.offsetTop+parseInt(a.borderTopWidth,10)+parseInt(a.fontSize,10)+3-t.scrollTop,left:l.left+d+i.offsetLeft+parseInt(a.borderLeftWidth,10)},document.body.removeChild(n)),r},i.prototype.getTriggerCharPosition=function(){var t,e=this.getTextRange();if(null!=e){t=0;var n=e.lastIndexOf(this.options.mentionChar);n>=t&&(t=n)}return t},i.prototype.isContentEditable=function(t){return t&&"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName},i.prototype.wireListEvents=function(){sf.base.EventHandler.add(this.list,"mouseover",this.onMouseOver,this),sf.base.EventHandler.add(this.list,"mouseout",this.onMouseLeave,this)},i.prototype.unWireListEvents=function(){sf.base.EventHandler.remove(this.list,"mouseover",this.onMouseOver),sf.base.EventHandler.remove(this.list,"mouseout",this.onMouseLeave)},i.prototype.onMouseOver=function(t){var e=sf.base.closest(t.target,".e-list-item");this.setHover(e)},i.prototype.onMouseLeave=function(t){this.removeHover()},i.prototype.checkCollision=function(t){(!sf.base.Browser.isDevice||sf.base.Browser.isDevice&&"SfMention"!==this.options.moduleName)&&(sf.popups.isCollide(t).length>0&&(t.style.marginTop=-parseInt(getComputedStyle(t).marginTop,10)+"px"))},i.prototype.destroy=function(){sf.base.EventHandler.remove(document,"mousedown",this.onDocumentClick)},i.prototype.initializePopup=function(t,e,n){var i=this;this.popupContainer=t,this.popupObj=new sf.popups.Popup(this.popupContainer,{width:this.setWidth(),targetType:"relative",relateTo:this.inputElement,collision:{X:"flip",Y:"flip"},offsetY:e,enableRtl:this.options.enableRtl,offsetX:n,position:{X:"top",Y:"left"},actionOnScroll:"hide",zIndex:this.options.zIndex,close:function(){i.unWireListEvents(),i.popupObj&&i.popupObj.destroy(),!i.isDisposed&&document.body.contains(i.inputElement)&&i.dotNetRef.invokeMethodAsync("ClosePopupAsync").catch((function(){})),i.popupObj=null},open:function(){sf.base.EventHandler.add(document,"mousedown",i.onDocumentClick,i)}})},i.prototype.setValue=function(t,e){var n,i,s,o,r,a=this.inputElement.ownerDocument.getSelection(),l=this.getTriggerCharPosition();if(n="string"==typeof this.options.suffixText?this.options.suffixText:"",null!==t.text&&(i=this.mentionVal(t.text)),this.isContentEditable(this.inputElement)){s=this.getTriggerCharPosition()+this.options.mentionChar.length,this.range&&this.range.startContainer.textContent.trim()!==this.options.mentionChar&&(s=this.range.endOffset),r=this.range,o=document.createRange(),this.getTextRange()&&-1!==this.getTextRange().lastIndexOf(this.options.mentionChar)||this.getTextRange()&&this.getTextRange().trim()===this.options.mentionChar?(o.setStart(r.startContainer,l),o.setEnd(r.startContainer,s)):""!==r.commonAncestorContainer.textContent.trim()&&!sf.base.isNullOrUndefined(r.commonAncestorContainer.textContent.trim())&&this.getTextRange()&&-1!==this.getTextRange().lastIndexOf(this.options.mentionChar)?(o.setStart(r.startContainer,r.startOffset-1),o.setEnd(r.startContainer,r.endOffset-1)):(o.setStart(r.startContainer,r.startOffset),o.setEnd(r.startContainer,r.endOffset)),o.deleteContents();var p=sf.base.createElement("div");p.innerHTML=i;for(var h=document.createDocumentFragment(),d=void 0,u=void 0;d=p.firstChild;)u=h.appendChild(d);o.insertNode(h),u&&((o=o.cloneRange()).setStartAfter(u),o.collapse(!0),a.removeAllRanges(),a.addRange(o)),this.isPopupOpen()&&this.inputElement.focus();var c=new CustomEvent("UpdateEditorValue",{detail:{click:e}});return this.inputElement.dispatchEvent(c),!0}var f=this.inputElement,g=this.getTextRange().substring(l+this.options.mentionChar.length,this.getTextRange().length);return i+=n,s=l+this.options.mentionChar.length,s+=g.length,f.value=f.value.substring(0,l)+i+f.value.substring(s,f.value.length),f.selectionStart=l+i.length,f.selectionEnd=l+i.length,this.isPopupOpen()&&this.inputElement.focus(),!0},i.prototype.mentionVal=function(t){var e=this.options.showMentionChar?this.options.mentionChar:"";return this.options.hasDisplayTemplate&&(t=this.removeComments(document.querySelector("#"+this.dataId+"_displayTemplate"))),this.isContentEditable(this.inputElement)?'<span contenteditable="false" class="e-mention-chip">'+e+t+"</span>".concat("string"==typeof this.options.suffixText?this.options.suffixText:" "):e+t},i.prototype.removeComments=function(t){var e=t.innerHTML;return(e=e.replace(/<!--[\s\S]*?-->/g,"")).trim()},i.prototype.setWidth=function(){var t=sf.base.formatUnit(this.options.popupWidth);t.indexOf("%")>-1&&(t=(this.inputElement.offsetWidth*parseFloat(t)/100).toString()+"px");return t},i.prototype.onDocumentClick=function(e){var n=e.target;!sf.base.isNullOrUndefined(this.popupObj)&&sf.base.closest(n,"#"+this.popupObj.element.id)||!this.isPopupOpen()||this.dotNetRef.invokeMethodAsync(t)},i.prototype.closePopup=function(t,e){if(this.options=e,this.isPopupOpen()&&!t.cancel&&this.popupObj){this.popupObj.hide(new sf.base.Animation({name:"FadeOut",duration:20,delay:0})),this.inputElement.removeAttribute("aria-owns"),this.inputElement.removeAttribute("aria-activedescendant")}},i.prototype.setScrollPosition=function(t){if(sf.base.isNullOrUndefined(t))this.scrollBottom(!0);else switch(t.action){case"pageDown":case"down":case"end":this.scrollBottom();break;default:this.scrollTop()}},i.prototype.scrollBottom=function(t){if(this.list&&this.list.querySelector(".e-active")&&!t){var e=this.list.querySelector(".e-active"),n=this.list.offsetHeight,i=e.offsetTop+e.offsetHeight-this.list.scrollTop,s=this.list.scrollTop+i-n;s=t?s+2*parseInt(getComputedStyle(this.list).paddingTop,10):s+parseInt(getComputedStyle(this.list).paddingTop,10);var o=e.offsetTop+e.offsetHeight-this.list.scrollTop;0===this.activeIndex?this.list.scrollTop=0:(i>n||!(o>0&&this.list.offsetHeight>o))&&(this.list.scrollTop=s)}},i.prototype.scrollTop=function(){if(this.list&&this.list.querySelector(".e-active")){var t=this.list.querySelector(".e-active"),e=t.offsetTop-this.list.scrollTop,n=t.offsetTop+t.offsetHeight-this.list.scrollTop;0===this.activeIndex?this.list.scrollTop=0:e<0?this.list.scrollTop=this.list.scrollTop+e:n>0&&this.list.offsetHeight>n||(this.list.scrollTop=t.offsetTop)}},i.prototype.setHover=function(t){t&&!t.classList.contains("e-hover")&&(this.removeHover(),sf.base.addClass([t],"e-hover"))},i.prototype.removeHover=function(){if(this.list){var t=this.list.querySelectorAll(".e-hover");t&&t.length&&sf.base.removeClass(t,"e-hover")}},i.prototype.isPopupOpen=function(){return this.popupObj&&document.body.contains(this.popupObj.element)},i}();return{initialize:function(t,e,n,s,o){if(document.querySelector(e)){var r=n?document.querySelector(e).firstElementChild:document.querySelector(e);new i(t,e,n,s,o).initialize(r)}},renderPopup:function(t,e,n){var i=window.sfBlazor.getCompInstance(t),s=document.querySelector("#"+t+"_popup");!sf.base.isNullOrUndefined(i)&&s&&i.renderPopup(s,e,n)},search:function(t,e,n,i){var s=window.sfBlazor.getCompInstance(t);sf.base.isNullOrUndefined(s)||s.search(e,n,i)},closePopup:function(t,e,n){var i=window.sfBlazor.getCompInstance(t);sf.base.isNullOrUndefined(i)||i.closePopup(e,n)},setValue:function(t,e,n){var i=window.sfBlazor.getCompInstance(t);sf.base.isNullOrUndefined(i)||i.setValue(e,n)},updateScrollPosition:function(t,e){var n=window.sfBlazor.getCompInstance(t);sf.base.isNullOrUndefined(n)||n.setScrollPosition(e)},onPropertyChanged:function(t){var e=window.sfBlazor.getCompInstance(t.dataId);sf.base.isNullOrUndefined(e)||e.onPropertyChanged(t)},destroy:function(t,e,n){var i=window.sfBlazor.getCompInstance(t),s=document.querySelector(n.target),o=document.querySelector("#"+t+"_popup");sf.base.EventHandler.remove(s,"keyup",this.onKeyUp),sf.base.isNullOrUndefined(i)||(o&&o instanceof HTMLElement&&(i.isDisposed=!0,i.closePopup(e,n)),i.destroy())}}}()}}]);(async()=>{await import(`${document.baseURI}_content/Syncfusion.Blazor.Core/scripts/syncfusion-blazor-base.min.js?v=23.1.undefined`).then(()=>{sfBlazor.loadDependencies('sfmention');})})();